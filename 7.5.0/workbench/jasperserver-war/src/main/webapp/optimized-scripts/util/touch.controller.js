define(["require","exports","module","jquery"],function(t,e,i){var s=t("jquery"),h=function(t,e,i){if(this.element=t,this.parent=e,this.children=[],this.hbar=null,this.vbar=null,i=i||{},i.absolute?this.element.style.position="absolute":this.element.style.position="relative",this.useParent=i.useParent?this.observer=e:this.observer=t,this.translate3d=!1!==i.translate3d,this.forceLayout=!0===i.forceLayout,this.use2Fingers=!0===i.use2Fingers,this.fit=i.fit,i.debug&&(e.style.border="solid 1px #f00",t.style.border="solid 1px #00f"),this.translate3d&&!i.noInit3d){var h=s(t).position();t.style.webkitTransform="translate3d("+h.left+"px,"+h.top+"px,0)",t.style.top="",t.style.left=""}if(!0===i.scrollbars){var n=s('<div style="position:absolute;bottom:4px;left:0;right:0;"><div style="position:relative;background:#3fb8fa;min-height:4px;width:24px;opacity:0.4;"></div></div>').appendTo(e),o=s('<div style="position:absolute;top:0;bottom:0;right:4px;"><div style="position:relative;background:#3fb8fa;min-width:4px;height:24px;opacity:0.4;"></div></div>').appendTo(e);this.hbar=n.children().eq(0),this.vbar=o.children().eq(0)}this.computeBoundaries(),this.dragging=!1,this.drag_sensitivity=20,this.scale=1,this.element.style.top=0,this.element.style.left=0,this.maxX=0,this.maxY=0,this.startTouchY=0,this.startTouchX=0,this.contentOffsetX=0,this.contentOffsetY=0,this.observer.addEventListener("touchstart",this,!1),this.observer.addEventListener("touchmove",this,!1),this.observer.addEventListener("touchend",this,!1)};h.prototype.handleEvent=function(t){switch(t.type){case"touchstart":this.onTouchStart(t);break;case"touchmove":this.onTouchMove(t);break;case"touchend":this.onTouchEnd(t)}},h.prototype.computeBoundaries=function(){this.maxX=this.parent.clientWidth-this.element.clientWidth,this.maxY=this.parent.clientHeight-this.element.clientHeight,this.maxX=this.maxX<0?this.maxX:0,this.maxY=this.maxY<0?this.maxY:0,this.hbar&&0!==this.maxX?(this.hratio=this.parent.clientWidth/this.element.clientWidth,this.hbar.width(this.hratio*this.parent.clientWidth),this.hbar.show()):this.hbar&&this.hbar.hide(),this.vbar&&0!==this.maxY?(this.vratio=this.parent.clientHeight/this.element.clientHeight,this.vbar.height(this.vratio*this.parent.clientHeight),this.vbar.show()):this.vbar&&this.vbar.hide(),0===this.maxX&&0===this.maxY&&(this.element.style.minWidth=this.parent.clientWidth+"px",this.element.style.minHeight=this.parent.clientHeight+"px","reportContainer"===this.element.id&&(this.element.style.maxWidth=this.parent.clientWidth+"px",this.element.style.maxHeight=this.parent.clientHeight+"px"))},h.prototype.onTouchStart=function(t){this.scale_pre=!1,this.computeBoundaries(),this.startTouchX=t.touches[0].clientX,this.startTouchY=t.touches[0].clientY,this.contentStartOffsetX=this.contentOffsetX,this.contentStartOffsetY=this.contentOffsetY},h.prototype.onTouchMove=function(t){var e=t.touches[0].clientY,i=t.touches[0].clientX;(!this.use2Fingers||this.use2Fingers&&2==t.touches.length)&&(this.dragging?this.animateTo(i,e):this.isDragging(t)&&(h.element_scrolled=!0,this.forceLayout&&(this.element.style.top=0,this.element.style.webkitTransform="translate3d(0,"+this.contentOffsetY+"px,0)"),this.animateTo(i,e)))},h.prototype.onTouchEnd=function(t){this.dragging&&(this.forceLayout&&(this.element.style.webkitTransform="translate3d(0,0,0)",this.element.style.top=this.contentOffsetY+"px"),this.hbar&&this.hbar.hide(),this.vbar&&this.vbar.hide(),t.preventDefault(),this.shouldStartMomentum()),this.dragging=!1},h.prototype.animateTo=function(t,e){var i=t-this.startTouchX,h=e-this.startTouchY,n=i+this.contentStartOffsetX,o=h+this.contentStartOffsetY,a=s(this.element).position();this.translate3d?(n>0&&(n=0),o>0&&(o=0),n<this.maxX&&(n=this.maxX),o<this.maxY&&(o=this.maxY)):(n+a.left>0&&(n=-1*a.left),o+a.top>0&&(o=-1*a.top),a.left+n<this.maxX&&(n=this.maxX-a.left),a.top+o<this.maxY&&(o=this.maxY-a.top)),this.contentOffsetX=n,this.contentOffsetY=o,this.translate3d||this.use2Fingers?this.element.style.webkitTransform="scale("+this.scale+") translate3d("+n+"px,"+o+"px, 0)":(this.element.style.top=a.top+o+"px",this.element.style.left=a.left+n+"px"),this.hbar&&this.hbar.css("left",-1*n*this.hratio+"px"),this.vbar&&this.vbar.css("top",-1*o*this.vratio+"px")},h.prototype.isDragging=function(t){var e=t.touches[0].clientX-this.startTouchX,i=t.touches[0].clientY-this.startTouchY,s=Math.abs(e),h=Math.abs(i);return this.dragging=s>this.drag_sensitivity||h>this.drag_sensitivity,this.dragging},h.prototype.shouldStartMomentum=function(){return!1},h.prototype.reset=function(){var t=this.contentOffsetX,e=this.contentOffsetY;this.maxX=this.parent.clientWidth-this.element.clientWidth,this.maxY=this.parent.clientHeight-this.element.clientHeight,this.translate3d?(this.element.style.webkitTransform="scale("+this.scale+") translate3d("+t+"px,"+e+"px, 0)",this.element.style.webkitTransform="scale("+this.scale+") translate3d(0,0,0)",this.contentOffsetX=0,this.contentOffsetY=0):(this.element.style.top=0,this.element.style.left=0)},h.prototype.forceRefresh=function(){},h.prototype.isBottom=function(){return!(this.maxY>=0)&&this.contentOffsetY-this.maxY<10},h.prototype.addPadding=function(t,e){var i=s("#"+t),h=i.width()+e.right,n=i.height()+e.bottom;this.element.style.width=h+"px",this.element.style.height=n+"px"},window.TouchController=h,i.exports=h});