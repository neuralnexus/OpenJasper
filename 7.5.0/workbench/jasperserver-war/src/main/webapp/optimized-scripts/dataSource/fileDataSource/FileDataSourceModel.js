define(["require","exports","module","underscore","../model/CustomDataSourceModel","./enum/fileSourceTypes","runtime_dependencies/js-sdk/src/jrs.configs","bundle!jasperserver_messages"],function(e,r,i){var n=e("underscore"),s=e("../model/CustomDataSourceModel"),l=e("./enum/fileSourceTypes"),t=e("runtime_dependencies/js-sdk/src/jrs.configs"),o=e("bundle!jasperserver_messages"),a=s.extend({fileTypes:[],validation:function(){var e={};return n.extend(e,s.prototype.validation,{repositoryFileName:[{fn:function(e,r,i){return"repository"===i.fileSourceType&&(n.isNull(e)||n.isUndefined(e)||n.isString(e)&&""===e)?o["fillParameters.error.mandatoryField"]:null}},{fn:function(e,r,i){return"repository"!==i.fileSourceType||n.isString(e)&&""!==e&&-1!==e.lastIndexOf(".")&&-1!==n.indexOf(this.fileTypes,e.substr(e.lastIndexOf(".")+1))?null:o["resource.file.extension"]}}],serverFileName:[{fn:function(e,r,i){return"serverFileSystem"===i.fileSourceType&&(n.isNull(e)||n.isUndefined(e)||n.isString(e)&&""===e)?o["fillParameters.error.mandatoryField"]:null}}],serverAddress:[{fn:function(e,r,i){return"ftpServer"===i.fileSourceType&&(n.isNull(e)||n.isUndefined(e)||n.isString(e)&&""===e)?o["fillParameters.error.mandatoryField"]:null}}],serverPath:[{fn:function(e,r,i){return"ftpServer"===i.fileSourceType&&(n.isNull(e)||n.isUndefined(e)||n.isString(e)&&""===e)?o["fillParameters.error.mandatoryField"]:null}}],ftpsPort:[{fn:function(e,r,i){return"ftpServer"===i.fileSourceType&&(n.isNull(e)||n.isUndefined(e)||n.isString(e)&&""===e)?o["fillParameters.error.mandatoryField"]:null}}]}),e}(),parse:function(){var e=s.prototype.parse.apply(this,arguments);if(n.isString(e.fileName)){if(-1!==e.fileName.indexOf("repo:")){var r=e.fileName.split(":");e.fileSourceType=l.REPOSITORY.name,e.repositoryFileName=r[1]}else e.fileSourceType=l.SERVER_FILE_SYSTEM.name,e.serverFileName=e.fileName;delete e.fileName}return e.useFirstRowAsHeader="true"===e.useFirstRowAsHeader,e},customFieldsToJSON:function(e,r){return e.fileSourceType===l.REPOSITORY.name?e.fileName="repo:"+e.repositoryFileName+(t.organizationId?"|"+t.organizationId:""):e.fileSourceType===l.SERVER_FILE_SYSTEM.name&&(e.fileName=e.serverFileName),delete e.repositoryFileName,delete e.serverFileName,s.prototype.customFieldsToJSON.call(this,e,r)},resetValidation:function(){this.validation=n.clone(a.prototype.validation)}});i.exports=a});