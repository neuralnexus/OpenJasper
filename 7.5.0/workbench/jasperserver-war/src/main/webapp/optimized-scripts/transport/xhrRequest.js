define(["require","exports","module","jquery","underscore","runtime_dependencies/js-sdk/src/common/logging/logger"],function(e,r,o){function n(){p.trigger.apply(p,arguments)}function s(e){(401==e.status||e.getResponseHeader("LoginRequested"))&&(i(window).trigger("sessionExpired"),u.warn("Session timed-out. Redirecting to login page."),window.location.reload())}var t,i=e("jquery"),a=e("underscore"),d=e("runtime_dependencies/js-sdk/src/common/logging/logger"),u=d.register("request");if("undefined"==typeof document)t={};else{var p=i(document);t=function(e){return a.partial(n,"request:before").apply(null,arguments),i.ajax(e).fail(s).fail(function(e,r,o){e.getResponseHeader("adhocException")?u.error(e.getResponseHeader("adhocException")):(500==e.status||e.getResponseHeader("JasperServerError")&&!e.getResponseHeader("SuppressError"))&&u.error(e.responseText)}).fail(a.partial(n,"request:failure")).done(a.partial(n,"request:success"))}}o.exports=t});