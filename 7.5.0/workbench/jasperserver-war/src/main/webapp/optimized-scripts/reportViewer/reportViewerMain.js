define("controls/controls.base",["require","exports","module","prototype","../core/core.layout","../util/utils.common","../components/components.dialogs","jquery","underscore"],function(e,t,i){var s=e("prototype"),n=s.$,o=s.$$,r=s.Template,l=s.$break,a=e("../core/core.layout"),h=e("../util/utils.common"),c=h.matchAny,d=e("../components/components.dialogs"),u=e("jquery"),p=e("underscore"),m={INPUT_CONTROLS_FORM:"inputControlsForm",INPUT_CONTROLS_CONTAINER:"inputControlsContainer",INPUT_CONTROLS_DIALOG:"inputControls",SAVE_REPORT_OPTIONS_DIALOG:"saveValues",REPORT_OPTIONS_SELECTOR:"savedValues",TOOLBAR_CONTROLS_BUTTON:"ICDialog",DEFAULT_OPTION_TEXT:"Options",NULL_SUBSTITUTION_VALUE:null,NULL_SUBSTITUTION_LABEL:null,NOTHING_SUBSTITUTION_VALUE:null,_BUTTON_OK:"ok",_BUTTON_SAVE:"save",_BUTTON_REMOVE:"remove",_BUTTON_APPLY:"apply",_BUTTON_CANCEL:"cancel",TEMP_REPORT_CONTAINER:"tempReportContainer",WRAPPER_ERROR_FLAG_PREFIX_SELECTOR:"div[id^=error_]",WRAPPERS_ERRORS_DIV:"wrappersErrors",EVAL_SCRIPT_ELEMENT_NAME:"_evalScript",CALENDAR_ICON_SPAN:'<span class="button picker calTriggerWrapper" />',_messages:{},getMessage:function(e,t){var i=this._messages[e];return i?new r(i).evaluate(t||{}):""},setControlError:function(e,t){e&&(e=n(e),t?(e.up().addClassName(a.ERROR_CLASS),e.nextSiblings()[0].update(t)):(e.up().removeClassName(a.ERROR_CLASS),e.nextSiblings()[0].update("")))},setControlsErrors:function(e){var t=o(m.WRAPPER_ERROR_FLAG_PREFIX_SELECTOR),i=0,s=-1;t.each(function(t){var n=!1;e&&e.each(function(e){if(t.id.indexOf(e[0])>-1)throw m.setControlError(t,e[1]),s<0&&(u("#inputControlsForm .leaf").each(function(e,t){e<i&&(s+=t.clientHeight)}),u(".groupBox .content .body")[0].scrollTop=s),n=!0,l;i++}),n||m.setControlError(t,"")})},buildParams:function(e){var t="";if(p.isObject(e)&&!p.isEmpty(e)){var i=function(e){return e.length>0&&"&"!=e[e.length-1]&&(e+="&"),e};p.each(e,function(e,s){t=i(t),p.isArray(e)?p.each(e,function(e){t=i(t),t+=s+"="+encodeURIComponent(e)}):t+=s+"="+encodeURIComponent(e)})}return t},buildSelectedDataUri:function(e,t){var i=m.buildParams(e);if(p.isObject(t)&&!p.isEmpty(t)){return i+"&"+m.buildParams(t)}return i}},f=function(e){var t=this;this._dom=n(m.INPUT_CONTROLS_DIALOG),this.buttonActions=e,u("#"+m.INPUT_CONTROLS_DIALOG).on("mouseup touchend","button",function(e){if(this.id&&!this.id.empty()&&!this.disabled){var i=t.buttonActions["button#"+this.id];i&&i()}})};f.addMethod("_dialogClickHandler",function(e){var t=e.element();for(var i in this.buttonActions)if(c(t,[i],!0))return this.buttonActions[i](),void e.stop()}),f.addMethod("show",function(){d.popup.show(this._dom)}),f.addMethod("hide",function(){d.popup.hide(this._dom)});var g=function(e){this._dom=n(m.SAVE_REPORT_OPTIONS_DIALOG),this.input=this._dom.select("input#savedValuesName")[0],this.overwrite=!1,this.buttonActions=e,this._dialogClickHandler=this._dialogClickHandler.bindAsEventListener(this),this._dom.observe("click",this._dialogClickHandler)};g.addMethod("remove",function(){this._dom.stopObserving("click",this._dialogClickHandler)}),g.addMethod("_dialogClickHandler",function(e){var t=e.element();for(var i in this.buttonActions)if(c(t,[i],!0))return this.buttonActions[i](),void e.stop()}),g.addMethod("show",function(){this.input.setValue(m.DEFAULT_OPTION_TEXT),d.popup.show(this._dom)}),g.addMethod("hide",function(){d.popup.hide(this._dom),this.hideWarning()}),g.addMethod("showWarning",function(e){var t=u("#"+m.SAVE_REPORT_OPTIONS_DIALOG).find(".warning");e&&t.text(e),t.show()}),g.addMethod("hideWarning",function(){var e=u("#"+m.SAVE_REPORT_OPTIONS_DIALOG).find(".warning");e.text(""),e.hide()}),t.ControlsBase=m,t.OptionsDialog=g,t.ControlDialog=f}),define("reportViewer/report.view.base",["require","exports","module","../core/core.ajax","../core/core.layout","../util/utils.common","../components/components.dialogs","underscore","../controls/controls.base","jquery","prototype"],function(e,t,i){var s=e("../core/core.ajax"),n=s.ajax,o=e("../core/core.layout"),r=e("../util/utils.common"),l=r.doNothing,a=e("../components/components.dialogs"),h=e("underscore"),c=e("../controls/controls.base"),d=c.ControlsBase,u=e("jquery"),p=e("prototype"),m=p.$;!function(e){var t=window.dashboardViewFrame,i=window.Template,s={_messages:{},_scroll:null,pageActions:{},viewReportForm:null,pageIndex:0,lastPageIndex:0,pageTimestamp:null,checkPageUpdatedTimeoutId:null,emptyReport:!0,reportForceControls:!1,hasInputControls:!1,reportControlsLayout:null,refreshReportCanceled:!1,reportParameterValues:null,allRequestParameters:null,requestedInputParameters:{},parametersWithoutDefaultValues:null,isLoaded:!1,EXPORT_ACTION_FORM:"exportActionForm",TOOLBAR_SUBMENU:"toolbarText",PAGINATION_PAGE_FIRST:"page_first",PAGINATION_PAGE_PREV:"page_prev",PAGINATION_PAGE_CURRENT:"page_current",PAGINATION_PAGE_NEXT:"page_next",PAGINATION_PAGE_LAST:"page_last",PAGINATION_PAGE_TOTAL:"page_total",DATA_TIMESTAMP_SPAN:"dataTimestampMessage",DATA_REFRESH_BUTTON:"dataRefreshButton",ASYNC_CANCEL_BUTTON:"asyncCancel",REPORT_COMPONENT_ID:"report",getMessage:function(e,t){var s=this._messages[e];return s?new i(s).evaluate(t||{}):""},commonInit:function(e){var t=u("#"+n.LOADING_ID);t.length>0&&(t.addClass(o.CANCELLABLE_CLASS),t.find("#cancel").click(function(){this._reportIsCanceled||(this._reportIsCanceled=!0,s.cancelReportExecution())})),document.location.href.indexOf("frame=0")>0&&(u("#reportViewFrame > .content > .header").hide(),u("#reportViewFrame").css("margin",0),u("#innerPagination").css("margin","none"),u("#reportViewFrame > .content > .body").css({top:0,"margin-top":0}))},navigateToReportPage:function(e,t,i){window.viewer.jive&&window.viewer.jive.hide(),window.viewer.reportInstance.gotoPage(e)},goToPage:function(e){parseInt(e,10)&&parseInt(e,10)>0&&(null==s.lastPageIndex||parseInt(e,10)<=s.lastPageIndex+1)?s.navigateToReportPage(parseInt(e,10)-1):l()},reportExecutionKey:function(){return s.flowExecutionKeyOutput?s.flowExecutionKeyOutput:window.dashboardViewFrame?t.flowExecutionKey:s.flowExecutionKey},refreshReport:function(e,t,i){var o=/(\?|&)output=([^&]*)/.exec(location.href),r=o&&3===o.length?o[2]:"";a.popup.showShared(m(n.LOADING_ID),!0,{owner:this.REPORT_COMPONENT_ID}),e=e||{},e._flowExecutionKey=e._flowExecutionKey?e._flowExecutionKey:s.reportExecutionKey(),e._eventId=e._eventId?e._eventId:"refreshReport",e.decorate="no",e.confirm="true",e.decorator="empty",e.ajax||(e.ajax="true");var l="flow.html?"+Object.toQueryString(e);return s.requestedInputParameters=i||this.getParametersFromRequest(),e.freshData&&(s.requestedInputParameters+="&freshData=true"),""===r||"html"===r?s.isLoaded?(window.viewer.reportInstance.eventManager.triggerEvent("beforeAction",{name:"beforeAction",type:"reportRefresh"}),window.viewer.reportInstance.refreshPage(0)):window.viewer.loadReport().always(function(){s.isLoaded=!0}):"pdf"===r||"swf"===r?s.exportReport(r,l):void(window.location.href=l+"&"+s.requestedInputParameters)},cancelReportExecution:function(){document.body.style.cursor="default",a.popup.hideShared(m(n.LOADING_ID),this.REPORT_COMPONENT_ID),window.viewer.reportInstance?window.viewer.reportInstance.cancelExecution().then(function(){s.isLoaded||(this._reportIsCanceled=!1,s.goBack())},function(){}):(this._reportIsCanceled=!1,s.goBack())},getParametersFromRequest:function(){return d.buildParams(s.getAllRequestParameters())},getAllRequestParameters:function(){return h.isObject(s.allRequestParameters)?s.allRequestParameters:{}},canSaveReport:function(){return!s.isReportReadOnly},confirmExit:function(){return!0},confirmAndLeave:function(){return!!s.confirmExit()&&s.closeViewerOnExit},closeViewerOnExit:function(e){window.viewer.exit().then(function(){e()})},showAjaxDialog:function(){a.popup.showShared(m(n.LOADING_ID),!0,{owner:this.REPORT_COMPONENT_ID})},hideAjaxDialog:function(){a.popup.hideShared(m(n.LOADING_ID),this.REPORT_COMPONENT_ID)}};e.Report=s}(window),i.exports=window.Report}),define("controls/controls.logging",["require","exports","module","../namespace/namespace"],function(e,t,i){var s=e("../namespace/namespace"),n=s.JRS;n.Log=function(e){window.console||(window.console={log:function(){},debug:function(){},error:function(){}})}(),i.exports=n.Log}),define("controls/controls.core",["require","exports","module","prototype","../namespace/namespace","../core/core.ajax","underscore","../components/components.dialogs","jquery","./controls.logging"],function(e,t,i){var s=e("prototype"),n=s.$,o=e("../namespace/namespace"),r=o.JRS,l=e("../core/core.ajax"),a=l.ajax,h=e("underscore"),c=e("../components/components.dialogs"),d=e("jquery");e("./controls.logging"),r.Controls=function(e,t,i){function s(e){return function(i){return t.template(e)(t.defaults({data:void 0,uuid:void 0,message:void 0,description:void 0},i))}}var o=navigator.userAgent.toLowerCase().indexOf("msie")>-1;return{Base:t.extend(function(){},{extend:function(e,i){var s,n=this;s=e&&t.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},t.extend(s,n,i);var o=function(){this.constructor=s};return o.prototype=n.prototype,s.prototype=new o,e&&t.extend(s.prototype,e),s.__super__=n.prototype,s}}),TemplateEngine:{render:function(e,i,n){if(!n)return s(e)(i);if(n==this.STD_PLACEHOLDERS){var o=String(e);return t.each(i,function(e,t){var i=new RegExp("\\{"+t+"\\}");o=o.replace(i,e)}),o}},renderUrl:function(e,i,s){var n=t.template(e)(i);return o&&!s&&(n=encodeURI(n)),n},getTemplateText:function(t){return e("#"+t).html()},createTemplate:function(t){var i=e("#"+t),n=i.html();if(n&&n.length>0)return s(n)},createTemplateSection:function(e,t){var i="\x3c!--#val--\x3e(\\s|\\S)*\x3c!--/val--\x3e",n=i.replace(/val/g,e),o=new RegExp(n,"g");return s(this.getTemplateText(t).match(o)[0])},STD_PLACEHOLDERS:"std_placeholder"},Utils:{LOADING_DIALOG_DELAY:800,INPUT_CONTROLS_COMPONENT_ID:"input-controls",isElementInDom:function(e){var t=e.nextSibling,i=e.parentNode&&11!==e.parentNode.nodeType;return t||i},setInnerHtml:function(i,s,n){var r,l,a;if(this.isElementInDom(i)&&(r=i.nextSibling,l=i.parentNode,a=i.style.display,i.style.display="none",l.removeChild(i)),e(i).html(""),o&&"SELECT"==i.tagName){var h=document.createDocumentFragment();t.each(n.data,function(i){var s=document.createElement("OPTION");s.value=t.isUndefined(i.value)?i.id:i.value,e(s).html(i.label),i.selected&&s.setAttribute("selected","selected"),h.appendChild(s)}),i.appendChild(h)}else e(i).html(s(n));if(r?l.insertBefore(i,r):l.appendChild(i),i.style.display=a,o&&"SELECT"==i.tagName){var c=i.getAttribute("style");i.removeAttribute("style"),i.setAttribute("style",c)}},wait:function(t){return e.Deferred(function(e){setTimeout(e.resolve,t)})},showLoadingDialogOn:function(s,o,r){this.wait(o||this.LOADING_DIALOG_DELAY).then(t.bind(function(){"pending"==s.state()&&(i.popup.showShared(n(a.LOADING_ID),r,{focus:!1,owner:this.INPUT_CONTROLS_COMPONENT_ID}),e.when(s).always(t.bind(function(){var e=this.INPUT_CONTROLS_COMPONENT_ID;this.wait(500).then(function(){window.viewer&&window.viewer.loading?window.viewer.loaded&&i.popup.hideShared(n(a.LOADING_ID),e):i.popup.hideShared(n(a.LOADING_ID),e)})},this)))},this))},createTimer:function(t){var i=new e.Deferred;return i.done(function(e){var i=(new Date).getTime(),s=i-e;console.log(t+" took time: "+s+" msec.")}),{start:function(){return this.startTime=(new Date).getTime(),this},stop:function(){return i.resolve(this.startTime),this}}}},listen:function(i,s){t.each(i,function(i,s){e(document).on(s,t.bind(i,this))},s||this)},ignore:function(t,i){e(document).off(t,i)}}}(d,h,c),window.Controls=r.Controls,i.exports=r.Controls}),define("controls/controls.options",["require","exports","module"],function(e,t,i){function s(){}i.exports=s}),define("runtime_dependencies/js-sdk/src/common/util/classUtil",["require","exports","module","underscore"],function(e,t,i){var s=e("underscore"),n={mixin:function(){var e,t,i=Array.prototype,s=i.shift.call(arguments);for(e=0;e<arguments.length;e+=1)if(arguments[e])for(t in arguments[e])arguments[e].hasOwnProperty(t)&&(s[t]=arguments[e][t]);return s},inherit:function(e,t){var i;i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)};var o=function(){};return o.prototype=e.prototype,i.prototype=new o,t&&s.extend(i.prototype,t),i.prototype.constructor=i,i.parent=e.prototype,i.extend=function(e){return n.inherit(i,e)},i},extend:function(e){return n.inherit(function(){},e)}};i.exports=n}),define("runtime_dependencies/js-sdk/src/common/component/base/Dimmer",["require","exports","module","jquery","../../util/classUtil"],function(e,t,i){var s,n,o=e("jquery"),r=e("../../util/classUtil");i.exports=r.extend({constructor:function(e){s||(n=0,s=o("<div id='dialogDimmer' class='dimmer'></div>").css(e),o(document.body).append(s),s.hide()),n++},css:function(e){return s.css(e),this},show:function(){var e=this.getCount()||0;return this.setCount(++e),s.show(),this},hide:function(){if(this.isVisible()){var e=this.getCount();return this.setCount(--e),!e&&s.hide(),this}},setCount:function(e){s.data({count:e})},getCount:function(){return parseInt(s.data("count"),10)},isVisible:function(){return s.is(":visible")},remove:function(){this._removed||(this._removed=!0,s&&(--n||(s.remove(),s=null)))}})}),define("text!runtime_dependencies/js-sdk/src/common/component/panel/template/panelTemplate.htm",[],function(){return'<div class="panel {{- additionalCssClasses }}">\n\n    <js-templateNonce></js-templateNonce>\n    <div class="header">\n        <div class="title">{{- title}}</div>\n    </div>\n    <div class="subcontainer"></div>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/common/component/panel/Panel",["require","exports","module","underscore","backbone","text!./template/panelTemplate.htm"],function(e,t,i){var s=e("underscore"),n=e("backbone"),o=e("text!./template/panelTemplate.htm");i.exports=n.View.extend({defaultTemplate:o,el:function(){var e=this.getTemplateArguments();return this.template(e)},getTemplateArguments:function(){return{title:this.title,additionalCssClasses:this.additionalCssClasses}},constructor:function(e){e||(e={}),this.template=s.template(e.template||this.defaultTemplate),this.title=e.title||"",this.dataNameAttribute=e.dataNameAttribute||"",this.additionalCssClasses=e.additionalCssClasses||"",this.content=e.content||"",this.collapsed=!e.collapsed,this.openClass=e.openClass||"open",this.closedClass=e.closedClass||"closed",this.loadingClass=e.loadingClass||"loading",this.fixedHeight=e.fixedHeight||!1,this.contentContainer=e.contentContainer||".subcontainer",this.overflow=e.overflow||"auto",this.traits=e.traits||[],s.each(this.traits,s.bind(function(e){e.extension&&s.extend(this,e.extension)},this)),this.invokeTraits("onConstructor",e),n.View.apply(this,arguments)},invokeTraits:function(e){var t=Array.prototype.slice.call(arguments,1),i=this;s.each(this.traits,function(s){s[e]&&s[e].apply(i,t)})},initialize:function(e){this.invokeTraits("beforeInitialize",e),this.content&&this.setContent(this.content),this.toggleCollapsedState(),this.dataNameAttribute&&this.$el.attr("data-name",this.dataNameAttribute),this.invokeTraits("afterInitialize",e)},setElement:function(e){this.invokeTraits("beforeSetElement",e);var t=n.View.prototype.setElement.apply(this,arguments);return this.$contentContainer=this.$(this.contentContainer),this.$contentContainer[this.collapsed?"hide":"show"](),this.invokeTraits("afterSetElement",e),t},open:function(e){return this.invokeTraits("beforeOpen",e),this.$contentContainer.show(),this.$el.removeClass(this.closedClass).addClass(this.openClass),this.collapsed=!1,e&&e.renderContent&&this.renderContent(),this.invokeTraits("afterOpen",e),e&&e.silent||this.trigger("open",this),this},close:function(e){return this.invokeTraits("beforeClose",e),this.$contentContainer.hide(),this.$el.removeClass(this.openClass).addClass(this.closedClass),this.collapsed=!0,this.invokeTraits("afterClose",e),e&&e.silent||this.trigger("close",this),this},setContent:function(e,t){this.content=e;var i=this.renderContent();this.$contentContainer[!0===t?"append":"html"](i)},renderContent:function(){return this.content instanceof n.View?this.content.render().$el:this.content},setHeight:function(e){var t=this.$("> .header").outerHeight();this.$contentContainer.css({height:s.isNumber(e)?e-t+"px":"auto",overflow:this.overflow})},toggleCollapsedState:function(){return this.collapsed?this.open():this.close(),this},remove:function(){this.invokeTraits("onRemove"),this.content&&this.content.remove&&this.content.remove(),n.View.prototype.remove.call(this)}})}),define("runtime_dependencies/js-sdk/src/common/component/base/OptionView",["require","exports","module","backbone","underscore"],function(e,t,i){var s=e("backbone"),n=e("underscore");i.exports=s.View.extend({events:{click:"select",mouseover:"mouseover",mouseout:"mouseout"},constructor:function(e){if(!e||!e.template)throw new Error("Option should have defined template");if(!(e.model&&e.model instanceof s.Model))throw new Error("Option should have associated Backbone.Model");this.template=n.template(e.template),this.disabledClass=e.disabledClass,this.hiddenClass=e.hiddenClass,this.toggleClass=e.toggleClass,this.overClass=e.overClass||"over",s.View.apply(this,arguments)},initialize:function(){s.View.prototype.initialize.apply(this,arguments);var e=this;!0===this.model.get("disabled")&&this.disable(),!0===this.model.get("hidden")&&this.hide(),!0===this.model.get("selected")&&this.addSelection(),this.listenTo(this.model,"change:over",function(t,i){i?e.$("> p").addClass(e.overClass):e.$("> p").removeClass(e.overClass)})},el:function(){return this.template(this.model.toJSON())},enable:function(){this.$el.removeAttr("disabled").removeClass(this.disabledClass)},disable:function(){this.$el.attr("disabled","disabled").addClass(this.disabledClass)},over:function(){this.model.set({over:!0})},leave:function(){this.model.set({over:!1})},show:function(){this.$el.show().removeClass(this.hiddenClass)},hide:function(){this.$el.hide().addClass(this.hiddenClass)},isVisible:function(){return this.$el.is(":visible")},isDisabled:function(){return this.$el.is(":disabled")},select:function(e){this.model.trigger("select",this,this.model,e),this.trigger("click",this,this.model,e)},addSelection:function(){this.$el.addClass(this.toggleClass),this.model.set("selected",!0)},removeSelection:function(){this.$el.removeClass(this.toggleClass),this.model.unset("selected")},mouseover:function(e){this.trigger("mouseover",this,this.model,e)},mouseout:function(e){this.trigger("mouseout",this,this.model,e)}})}),define("runtime_dependencies/js-sdk/src/common/component/base/OptionContainer",["require","exports","module","backbone","underscore","./OptionView"],function(e,t,i){function s(e){if(!e||o.isEmpty(e))throw new Error("Init options must be specified");if(!e.options||!e.options.length)throw new Error("Option views descriptors must be specified");if(!e.mainTemplate&&!e.el)throw new Error("Option container must have a template");if(!e.optionTemplate)throw new Error("Option container must have an option template")}var n=e("backbone"),o=e("underscore"),r=e("./OptionView");i.exports=n.View.extend({events:{mouseout:"_mouseout",mouseover:"_mouseover"},el:function(){return o.template(this.template)()},constructor:function(e){s(e),this.contextName=e.contextName||"option",this.contentContainer=e.contentContainer?e.contentContainer:e.el||".content > ul",this.toggle=!!e.toggle,this.toggleClass=e.toggleClass||"active",this.options=[],this.collection=e.collection||new n.Collection,delete e.collection,e.options&&this.collection.reset(e.options),this.hasGroups=!(!this.collection.models[0]||!this.collection.models[0].get("groupId")),this.defalutOptionView=this.hasGroups?this.collection.where({default:!0}):[this.collection.findWhere({default:!0})],this.listenTo(this.collection,"select",this._selectOption),this.listenTo(this.collection,"update reset",this.render),this.template=e.mainTemplate,this.optionTemplate=e.optionTemplate,n.View.apply(this,arguments)},_mouseout:function(){this.trigger("container:mouseout")},_mouseover:function(){this.trigger("container:mouseover")},setElement:function(e){var t=n.View.prototype.setElement.apply(this,arguments);return this.$contentContainer=this.contentContainer?this.$(this.contentContainer).addBack().filter(this.contentContainer):this.$el,t},initialize:function(){this.render(),this.toggle&&this.defalutOptionView&&o.each(this.defalutOptionView,function(e){e&&this.getOptionView(e.get("action")).addSelection()},this)},render:function(){var e=this;o.each(this.options,function(t){e.stopListening(t,"mouseover"),e.stopListening(t,"mouseout"),t.remove()}),this.options=[],this.collection.forEach(function(t){var i=new r({template:e.optionTemplate,model:t,toggleClass:e.toggleClass});e.listenTo(i,"mouseover",function(t,i){e.trigger("mouseover",t,e,i)}),e.listenTo(i,"mouseout",function(t,i){e.trigger("mouseout",t,e,i)}),e.options.push(i),e.$contentContainer.append(i.$el)})},_onKeyDown:function(e){var t=this.getOptionView(e.keyCode,"triggerOnKeyCode");t&&!t.isDisabled()&&t.select()},_selectOption:function(e,t){if(this.toggle){var i=t.get("groupId"),s=this.hasGroups?o.reduce(this.options,function(e,t){return t.model.get("groupId")===i&&e.push(t),e},[]):this.options;o.each(s,function(e){e.removeSelection()},this),e.addSelection()}this.trigger("selection",e,t),this.trigger(this.contextName+":"+t.get("action"),e,t)},getOptionView:function(e,t){return o.find(this.options,function(i){return i.model.get(t||"action")===e})},resetSelection:function(e,t){e=e||[],this.toggle&&(this.hasGroups?(e.length<this.defalutOptionView.length&&o.each(this.defalutOptionView,function(t){var i={groupId:t.get("groupId")};!o.findWhere(e,i)&&t&&e.push(o.extend(i,{action:t.get("action")}))}),e=o.pluck(e,"action")):!e.length&&this.defalutOptionView[0]&&e.push(this.defalutOptionView[0].get("action")),o.each(this.options,function(i){e.length&&o.contains(e,i.model.get("action"))?t?this._selectOption(i,i.model):i.addSelection():i.removeSelection()},this))},select:function(){var e=Array.prototype.slice.call(arguments,0);this.toggle&&o.each(this.options,function(t){!e.length||o.contains(e,t.model.get("action"))?t.addSelection():t.removeSelection()},this)},deselect:function(){var e=Array.prototype.slice.call(arguments,0);this.toggle&&o.each(this.options,function(t){(!e.length||o.contains(e,t.model.get("action")))&&t.removeSelection()},this)},getSelection:function(){return o.chain(this.options).filter(function(e){return e.model.get("selected")}).map(function(e){return e.model.get("action")}).value()},show:function(){return o.each(this.options,function(e){var t=e.model.get("test");t&&!t()?e.hide():e[e.model.get("hidden")?"hide":"show"]()}),this.$el.show(),this.trigger("show",this),this},hide:function(){return this.$el.hide(),this.trigger("hide",this),this},enable:function(e){var t=Array.prototype.slice.call(arguments);o.each(this.options,function(e){(!t.length||o.contains(t,e.model.get("action")))&&e.enable()})},disable:function(e){var t=Array.prototype.slice.call(arguments);o.each(this.options,function(e){(!t.length||o.contains(t,e.model.get("action")))&&e.disable()})},addOptions:function(e,t){this.collection.add(e,o.extend(t||{},{silent:!0})),this.collection.reset(this.collection.toJSON())},removeOptions:function(e){var t=this.collection.filter(function(t){return!o.contains(e,t.get("action"))});t.length<this.collection.length&&this.collection.reset(t)},remove:function(){o.invoke(this.options,"remove"),n.View.prototype.remove.apply(this,arguments)}})}),define("runtime_dependencies/js-sdk/src/common/component/panel/trait/abstractPanelTrait",["require","exports","module"],function(e,t,i){var s={extension:{},onConstructor:function(){},beforeInitialize:function(){},afterInitialize:function(){},beforeSetElement:function(){},afterSetElement:function(){},beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){},onRemove:function(){}};i.exports=s}),function(e){"function"==typeof define&&define.amd?define("jquery-ui/ui/disable-selection",["jquery","./version"],e):e(jQuery)}(function(e){return e.fn.extend({disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}})}),function(e){"function"==typeof define&&define.amd?define("jquery-ui/ui/widgets/resizable",["jquery","./mouse","../disable-selection","../plugin","../version","../widget"],e):e(jQuery)}(function(e){return e.widget("ui.resizable",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseFloat(e)||0},_isNumber:function(e){return!isNaN(parseFloat(e))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[s]>0||(t[s]=1,n=t[s]>0,t[s]=0,n)},_create:function(){var t,i=this.options,s=this;this._addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,t={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(t),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(t),this._proportionallyResize()),this._setupHandles(),i.autoHide&&e(this.element).on("mouseenter",function(){i.disabled||(s._removeClass("ui-resizable-autohide"),s._handles.show())}).on("mouseleave",function(){i.disabled||s.resizing||(s._addClass("ui-resizable-autohide"),s._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_setOption:function(e,t){switch(this._super(e,t),e){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var t,i,s,n,o,r=this.options,l=this;if(this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),s=this.handles.split(","),this.handles={},i=0;i<s.length;i++)t=e.trim(s[i]),n="ui-resizable-"+t,o=e("<div>"),this._addClass(o,"ui-resizable-handle "+n),o.css({zIndex:r.zIndex}),this.handles[t]=".ui-resizable-"+t,this.element.append(o);this._renderAxis=function(t){var i,s,n,o;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=e(this.handles[i]),this._on(this.handles[i],{mousedown:l._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=e(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){l.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),l.axis=o&&o[1]?o[1]:"se")}),r.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)((s=e(this.handles[i])[0])===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,s,n,o=this.options,r=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),o.containment&&(i+=e(o.containment).scrollLeft()||0,s+=e(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===n?this.axis+"-resize":n),this._addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,s,n=this.originalMousePosition,o=this.axis,r=t.pageX-n.left||0,l=t.pageY-n.top||0,a=this._change[o];return this._updatePrevProperties(),!!a&&(i=a.apply(this,[t,r,l]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1)},_mouseStop:function(t){this.resizing=!1;var i,s,n,o,r,l,a,h=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:c.sizeDiff.height,o=s?0:c.sizeDiff.width,r={width:c.helper.width()-o,height:c.helper.height()-n},l=parseFloat(c.element.css("left"))+(c.position.left-c.originalPosition.left)||null,a=parseFloat(c.element.css("top"))+(c.position.top-c.originalPosition.top)||null,h.animate||this.element.css(e.extend(r,{top:a,left:l})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!h.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,
height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,n,o,r=this.options;o={minWidth:this._isNumber(r.minWidth)?r.minWidth:0,maxWidth:this._isNumber(r.maxWidth)?r.maxWidth:1/0,minHeight:this._isNumber(r.minHeight)?r.minHeight:0,maxHeight:this._isNumber(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||e)&&(t=o.minHeight*this.aspectRatio,s=o.minWidth/this.aspectRatio,i=o.maxHeight*this.aspectRatio,n=o.maxWidth/this.aspectRatio,t>o.minWidth&&(o.minWidth=t),s>o.minHeight&&(o.minHeight=s),i<o.maxWidth&&(o.maxWidth=i),n<o.maxHeight&&(o.maxHeight=n)),this._vBoundaries=o},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,o=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,r=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,l=this.originalPosition.left+this.originalSize.width,a=this.originalPosition.top+this.originalSize.height,h=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return o&&(e.width=t.minWidth),r&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),o&&h&&(e.left=l-t.minWidth),s&&h&&(e.left=l-t.maxWidth),r&&c&&(e.top=a-t.minHeight),n&&c&&(e.top=a-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)i[t]=parseFloat(s[t])||0,i[t]+=parseFloat(n[t])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;t<this._proportionallyResizeElements.length;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize;return{left:this.originalPosition.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize;return{top:this.originalPosition.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),r=o&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,l=o?0:i.sizeDiff.width,a={width:i.size.width-l,height:i.size.height-r},h=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,c=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(a,c&&h?{top:c,left:h}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,s,n,o,r,l,a=e(this).resizable("instance"),h=a.options,c=a.element,d=h.containment,u=d instanceof e?d.get(0):/parent/.test(d)?c.parent().get(0):d;u&&(a.containerElement=e(u),/document/.test(d)||d===document?(a.containerOffset={left:0,top:0},a.containerPosition={left:0,top:0},a.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(u),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,s){i[e]=a._num(t.css("padding"+s))}),a.containerOffset=t.offset(),a.containerPosition=t.position(),a.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=a.containerOffset,n=a.containerSize.height,o=a.containerSize.width,r=a._hasScroll(u,"left")?u.scrollWidth:o,l=a._hasScroll(u)?u.scrollHeight:n,a.parentData={element:u,left:s.left,top:s.top,width:r,height:l}))},resize:function(t){var i,s,n,o,r=e(this).resizable("instance"),l=r.options,a=r.containerOffset,h=r.position,c=r._aspectRatio||t.shiftKey,d={top:0,left:0},u=r.containerElement,p=!0;u[0]!==document&&/static/.test(u.css("position"))&&(d=a),h.left<(r._helper?a.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-a.left:r.position.left-d.left),c&&(r.size.height=r.size.width/r.aspectRatio,p=!1),r.position.left=l.helper?a.left:0),h.top<(r._helper?a.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-a.top:r.position.top),c&&(r.size.width=r.size.height*r.aspectRatio,p=!1),r.position.top=r._helper?a.top:0),n=r.containerElement.get(0)===r.element.parent().get(0),o=/relative|absolute/.test(r.containerElement.css("position")),n&&o?(r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top):(r.offset.left=r.element.offset().left,r.offset.top=r.element.offset().top),i=Math.abs(r.sizeDiff.width+(r._helper?r.offset.left-d.left:r.offset.left-a.left)),s=Math.abs(r.sizeDiff.height+(r._helper?r.offset.top-d.top:r.offset.top-a.top)),i+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-i,c&&(r.size.height=r.size.width/r.aspectRatio,p=!1)),s+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-s,c&&(r.size.width=r.size.height*r.aspectRatio,p=!1)),p||(r.position.left=r.prevPosition.left,r.position.top=r.prevPosition.top,r.size.width=r.prevSize.width,r.size.height=r.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,s=t.containerOffset,n=t.containerPosition,o=t.containerElement,r=e(t.helper),l=r.offset(),a=r.outerWidth()-t.sizeDiff.width,h=r.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(o.css("position"))&&e(this).css({left:l.left-n.left-s.left,width:a,height:h}),t._helper&&!i.animate&&/static/.test(o.css("position"))&&e(this).css({left:l.left-n.left-s.left,width:a,height:h})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options;e(i.alsoResize).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseFloat(t.width()),height:parseFloat(t.height()),left:parseFloat(t.css("left")),top:parseFloat(t.css("top"))})})},resize:function(t,i){var s=e(this).resizable("instance"),n=s.options,o=s.originalSize,r=s.originalPosition,l={height:s.size.height-o.height||0,width:s.size.width-o.width||0,top:s.position.top-r.top||0,left:s.position.left-r.left||0};e(n.alsoResize).each(function(){var t=e(this),s=e(this).data("ui-resizable-alsoresize"),n={},o=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var i=(s[t]||0)+(l[t]||0);i&&i>=0&&(n[t]=i||null)}),t.css(n)})},stop:function(){e(this).removeData("ui-resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}),t._addClass(t.ghost,"ui-resizable-ghost"),!1!==e.uiBackCompat&&"string"==typeof t.options.ghost&&t.ghost.addClass(this.options.ghost),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),s=i.options,n=i.size,o=i.originalSize,r=i.originalPosition,l=i.axis,a="number"==typeof s.grid?[s.grid,s.grid]:s.grid,h=a[0]||1,c=a[1]||1,d=Math.round((n.width-o.width)/h)*h,u=Math.round((n.height-o.height)/c)*c,p=o.width+d,m=o.height+u,f=s.maxWidth&&s.maxWidth<p,g=s.maxHeight&&s.maxHeight<m,v=s.minWidth&&s.minWidth>p,b=s.minHeight&&s.minHeight>m;s.grid=a,v&&(p+=h),b&&(m+=c),f&&(p-=h),g&&(m-=c),/^(se|s|e)$/.test(l)?(i.size.width=p,i.size.height=m):/^(ne)$/.test(l)?(i.size.width=p,i.size.height=m,i.position.top=r.top-u):/^(sw)$/.test(l)?(i.size.width=p,i.size.height=m,i.position.left=r.left-d):((m-c<=0||p-h<=0)&&(t=i._getPaddingPlusBorderDimensions(this)),m-c>0?(i.size.height=m,i.position.top=r.top-u):(m=c-t.height,i.size.height=m,i.position.top=r.top+o.height-m),p-h>0?(i.size.width=p,i.position.left=r.left-d):(p=h-t.width,i.size.width=p,i.position.left=r.left+o.width-p))}}),e.ui.resizable}),define("runtime_dependencies/js-sdk/src/common/component/panel/trait/resizablePanelTrait",["require","exports","module","underscore","./abstractPanelTrait","jquery-ui/ui/widgets/resizable"],function(e,t,i){function s(e,t){this.trigger("resize",e,t)}function n(e,t){this.trigger("resizeStart",e,t)}function o(e,t){this.trigger("resizeStop",e,t)}var r=e("underscore"),l=e("./abstractPanelTrait");e("jquery-ui/ui/widgets/resizable"),i.exports=r.extend({},l,{onConstructor:function(e){e||(e={}),this.handles=e.handles||"e, s, se",this.minWidth=e.minWidth||10,this.minHeight=e.minHeight||10,this.maxWidth=e.maxWidth||null,this.maxHeight=e.maxHeight||null,this.alsoResize=e.alsoResize||!1,this.resizableEl=e.resizableEl},afterSetElement:function(){this.$resizableEl=this.$el.find(this.resizableEl).length?this.$el.find(this.resizableEl):this.$el;var e=this.handles;"function"==typeof e&&(e=e(this.$el)),this.$resizableEl.resizable({handles:e,minHeight:this.minHeight,minWidth:this.minWidth,maxWidth:this.maxWidth,maxHeight:this.maxHeight,alsoResize:this.alsoResize,resize:r.bind(s,this),start:r.bind(n,this),stop:r.bind(o,this)})},onRemove:function(){try{this.$el.resizable("destroy")}catch(e){}}})}),define("text!runtime_dependencies/js-sdk/src/common/component/dialog/template/dialogTemplate.htm",[],function(){return'<div class="jr-mDialog jr {{- additionalCssClasses }}" tabindex="-1">\n\n    <js-templateNonce></js-templateNonce>\n    <div class="jr-mDialog-header mover jr">\n        <h1 class="jr-mDialog-header-title jr">{{- title }}</h1>\n    </div>\n    <div class="jr-mDialog-body jr {{- additionalBodyCssClasses }}">\n        <div class="jr-mDialog-body-wrapper jr subcontainer"></div>\n    </div>\n    <div class="jr-mDialog-footer jr"></div>\n\n</div>\n'}),define("text!runtime_dependencies/js-sdk/src/common/component/dialog/template/dialogButtonTemplate.htm",[],function(){return"<button class=\"button action up {{- primary ? 'primary' : ''}} {{- (typeof float !== 'undefined' ? 'right' : '') }}\">\n\n    <js-templateNonce></js-templateNonce>\n    <span class=\"wrap\">{{- label }}<span class=\"icon\"></span></span>\n</button>\n"}),define("runtime_dependencies/js-sdk/src/common/component/dialog/Dialog",["require","exports","module","underscore","jquery","../base/Dimmer","../panel/Panel","../base/OptionContainer","../panel/trait/resizablePanelTrait","text!./template/dialogTemplate.htm","text!./template/dialogButtonTemplate.htm","jquery-ui/ui/widgets/draggable"],function(e,t,i){var s=e("underscore"),n=e("jquery"),o=e("../base/Dimmer"),r=e("../panel/Panel"),l=e("../base/OptionContainer"),a=e("../panel/trait/resizablePanelTrait"),h=e("text!./template/dialogTemplate.htm"),c=e("text!./template/dialogButtonTemplate.htm");e("jquery-ui/ui/widgets/draggable");var d=r.extend({defaultTemplate:h,events:{mousedown:"_focus",touchstart:"_focus",keydown:"_onKeyDown",keyup:"_onKeyboardEvent",keypress:"_onKeyboardEvent",resize:"_onDialogResize"},constructor:function(e){e||(e={}),e.traits||(e.traits=[]),this.resizable=e.resizable||!1,this.modal=e.modal||!1,this.additionalBodyCssClasses=e.additionalBodyCssClasses||"",this.resizable&&-1===s.indexOf(e.traits,a)&&e.traits.push(a),r.call(this,e)},initialize:function(e){this.dialogOptions=s.extend({},e),this.collapsed=!this.collapsed,this.resetSizeOnOpen=!!s.isUndefined(e.resetSizeOnOpen)||e.resetSizeOnOpen,s.isEmpty(e.buttons)||(this.buttons=new l({options:e.buttons,el:this.$(".jr-mDialog-footer")[0]||this.$(".footer")[0],contextName:"button",optionTemplate:e.dialogButtonTemplate||c})),r.prototype.initialize.apply(this,arguments),this.buttons&&this.listenTo(this.buttons,s.map(e.buttons,function(e){return"button:"+e.action}).join(" "),s.bind(function(e,t){this.trigger("button:"+t.get("action"),e,t)},this)),this.render()},getTemplateArguments:function(){var e=r.prototype.getTemplateArguments.apply(this,arguments);return s.extend(e,{additionalBodyCssClasses:this.additionalBodyCssClasses})},setElement:function(e){var t=r.prototype.setElement.apply(this,arguments);return this.buttons&&this.buttons.setElement(this.$(".jr-mDialog-footer")[0]||this.$(".footer")[0]),t},setTitle:function(e){this.$(".jr-mDialog-header > .jr-mDialog-header-title").text(e)},render:function(){return this.$el.hide(),this.modal&&(this.dimmer=new o({zIndex:900})),n("body").append(this.$el),this.$el.draggable({handle:".mover",addClasses:!1,containment:"document"}),this},open:function(e){if(this.isVisible())return this;this.resetSizeOnOpen&&(this.$el.css({height:"",width:""}),this.$el.find("textarea").css({height:"",width:""})),r.prototype.open.apply(this,arguments),this.modal&&this.dimmer.css({zIndex:++d.highestIndex}).show(),this._setMinSize();var t=this._position(e);return this.$el.css({top:t.top,left:t.left,position:"absolute"}),this._increaseZIndex(),this.buttons&&this.buttons.$(".over").removeClass("over"),this.$el.show(),this.$el.find("input").first().focus(),this._onDialogResize(),this.trigger("dialog:visible"),this},close:function(){if(this.isVisible())return this.$el.css({zIndex:--d.highestIndex}),this.modal&&this.dimmer.css({zIndex:--d.highestIndex}).hide(),this.$el.hide(),r.prototype.close.apply(this,arguments),this},addCssClasses:function(e){this.$el.addClass(e)},toggleCollapsedState:function(){return this},enableButton:function(e){this.buttons.enable(e)},disableButton:function(e){this.buttons.disable(e)},isVisible:function(){return this.$el.is(":visible")},_setMinSize:function(){this.dialogOptions.minWidth&&this.$el.css({minWidth:this.dialogOptions.minWidth}),this.dialogOptions.minHeight&&this.$el.css({minHeight:this.dialogOptions.minHeight}),this.dialogOptions.setMinSizeAsSize&&this.$el.css({width:this.dialogOptions.minWidth,height:this.dialogOptions.minHeight})},_position:function(e){var t,i,s=n("body"),o=this.$el.height(),r=this.$el.width();if(e&&void 0!==e.top&&void 0!==e.left){t=e.top,i=e.left;var l=s.height(),a=s.width(),h=l-e.top,c=a-e.left;h<o&&(t=e.top-o,t=t<0?l/2-o/2:t),c<r&&(i=e.left-r,i=i<0?a/2-r/2:i)}else t=n(window).height()/2-o/2,i=n(window).width()/2-r/2;return{top:Math.max(0,t),left:Math.max(0,i)}},_focus:function(){!this.modal&&this._increaseZIndex()},_increaseZIndex:function(){this.$el.css({zIndex:++d.highestIndex})},_onKeyDown:function(e){this.buttons._onKeyDown(e),e.stopPropagation()},_onKeyboardEvent:function(e){e.stopPropagation()},_onDialogResize:function(){},remove:function(){this.buttons&&this.buttons.remove(),this.dimmer&&this.dimmer.remove();try{this.$el.draggable("destroy")}catch(e){}r.prototype.remove.call(this)}},{highestIndex:5e3,resetHighestIndex:function(e){d.highestIndex=e||5e3}});i.exports=d}),define("text!runtime_dependencies/js-sdk/src/common/component/dialog/template/confirmDialogTemplate.htm",[],function(){return"<p class='confirmationText'>\n\n    <js-templateNonce></js-templateNonce>\n    {{ print(_.xssSoftEscape(text)) }}\n</p>"}),define("runtime_dependencies/js-sdk/src/common/component/dialog/ConfirmationDialog",["require","exports","module","underscore","./Dialog","text!./template/confirmDialogTemplate.htm","bundle!CommonBundle"],function(e,t,i){var s=e("underscore"),n=e("./Dialog"),o=e("text!./template/confirmDialogTemplate.htm"),r=e("bundle!CommonBundle");i.exports=n.extend({constructor:function(e){e||(e={}),this.confirmDialogTemplate=e.confirmDialogTemplate||s.template(o),n.prototype.constructor.call(this,{modal:!0,additionalCssClasses:e.additionalCssClasses||"confirmationDialog",title:e.title||r["dialog.confirm.title"],content:this.confirmDialogTemplate({text:e.text}),buttons:[{label:e.yesLabel||r["button.yes"],action:"yes",primary:!0},{label:e.noLabel||r["button.no"],action:"no",primary:!1}]})},initialize:function(){n.prototype.initialize.apply(this,arguments),this.on("button:yes",this.close),this.on("button:no",this.close)},setContent:function(e){n.prototype.setContent.call(this,this.confirmDialogTemplate({text:e}))}})}),define("text!runtime_dependencies/js-sdk/src/components/overlay/template/overlayTemplate.htm",[],function(){return'<div class="jr-mOverlay jr-isHidden jr">\n\n    <js-templateNonce></js-templateNonce>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/overlay/Overlay",["require","exports","module","underscore","jquery","backbone","text!./template/overlayTemplate.htm"],function(e,t,i){var s=e("underscore"),n=(e("jquery"),e("backbone")),o=e("text!./template/overlayTemplate.htm");i.exports=n.View.extend({el:function(){return this.template()},template:s.template(o),initialize:function(e){e=s.defaults(e||{},{zIndex:4e3}),this.delay=e.delay,this.$el.css({zIndex:e.zIndex}),this.$el.parent().css({position:"relative"})},show:function(e){var t=this,i=function(){t.$el.show(),t.$el.removeClass("jr-isHidden")};this.delay||e?this._timer||(this._timer=setTimeout(i,this.delay||e)):i()},hide:function(){this._timer&&(clearTimeout(this._timer),this._timer=null),this.$el.hide(),this.$el.addClass("jr-isHidden")}})}),define("controls/controls.dataconverter",["require","exports","module","../namespace/namespace","underscore","./controls.core"],function(e,t,i){var s=e("../namespace/namespace"),n=s.JRS,o=e("underscore");e("./controls.core"),function(e,t,i){var s=i.Base.extend({structureFormater:function(e){if(!e)return e;var i=t.map(e.inputControl,function(e){return e.readOnly="true"==String(e.readOnly),e.uri=e.uri.replace("repo:",""),e}),s=t.map(i,function(e){return e.state});return s=t.compact(s),t.each(i,function(e){delete e.state}),t.extend({structure:i},this.convertResponseToControlsState(s))},convertResponseToControlsState:function(e){var i={},s=e.inputControlState?e.inputControlState:e,n=function(e){var t={value:e.value,label:e.label};return"true"==String(e.selected)&&(t.selected=!0),t},o=function(e){return t.isArray(e)?t.map(e,n):[]},r=function(e){return t.isUndefined(e.value)||t.isNull(e.value)?o(e.options):e.value};return t.each(s,function(e){e&&e.uri&&(i[e.id]={error:t.isUndefined(e.error)?null:e.error,values:r(e)})}),{state:i}}});e.DataConverter=s}(n.Controls,o,n.Controls),i.exports=n.Controls}),define("controls/controls.datatransfer",["require","exports","module","../namespace/namespace","runtime_dependencies/js-sdk/src/jrs.configs","../components/components.dialogs","underscore","jquery","./controls.core","./controls.dataconverter"],function(e,t,i){var s=e("../namespace/namespace"),n=s.JRS,o=e("runtime_dependencies/js-sdk/src/jrs.configs"),r=e("../components/components.dialogs"),l=e("underscore"),a=e("jquery");e("./controls.core"),e("./controls.dataconverter"),n.Controls=function(e,t,i,s){function n(t){var n;try{try{n=e.parse(t.responseText)}catch(e){}if(n&&n.error)i.each(n.error,function(e){var t=s.getViewModel(),i=e.inputControlUri.replace("repo:",""),n=t.find({uri:i});e.errorCode?n.set({error:e.errorCode}):e.defaultMessage&&n.set({error:e.defaultMessage})});else if(t.getResponseHeader("LoginRequested")||401===t.status)document.location=o.urlContext;else if(500==t.status||t.getResponseHeader("JasperServerError")&&!t.getResponseHeader("SuppressError")){var l="";l=n?i.template("<div><b>{{-message}}</b></div><p>{{ if (parameters) for (var i = 0; i < parameters.length; i++) { }}<div>{{-parameters[i]}}</div>{{ } }}</p>")(n):window.statusText,r.errorPopup.show(l)}}catch(e){}}return i.extend(s,{DataTransfer:s.Base.extend({CONTROLS_STRUCTURE_TEMPLATE_URI:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}",INITIAL_CONTROLS_VALUES_TEMPLATE_URL:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/values",CONTROLS_VALUES_TEMPLATE_URL:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}/values",constructor:function(e){this.dataConverter=e.dataConverter,this.initialize(e)},initialize:function(e){},setReportUri:function(e){this.currentReportUri=e},buildUrl:function(e,t,n){return t=i.isArray(t)?t.join(";"):t||"",s.TemplateEngine.renderUrl(n,{reportUri:e,controlIds:t})},sendRequest:function(s,r,l){var a={url:s,type:"GET",dataType:"json",cache:!1};i.isEmpty(r)||i.extend(a,{type:"POST",processData:!1,data:e.stringify(r),contentType:"application/json"});var h=i.defaults(l||{},a);return h.headers||(h.headers={}),i.defaults(h.headers,{"X-Suppress-Basic":"true","Accept-Language":o.userLocale.replace(/_/g,"-")}),t.ajax(h).fail(n)},fetchControlsStructure:function(e,t){var n=this.buildUrl(this.currentReportUri,e,this.CONTROLS_STRUCTURE_TEMPLATE_URI),o=this.sendRequest(n,t).then(i.bind(this.dataConverter.structureFormater,this.dataConverter));return s.Utils.showLoadingDialogOn(o,null,!0),o},updateControlsStructure:function(e,t){var s=this.buildUrl(t||this.currentReportUri,null,this.CONTROLS_STRUCTURE_TEMPLATE_URI);return this.sendRequest(s,e,{type:"PUT"}).then(i.bind(this.dataConverter.structureFormater,this.dataConverter))},fetchInitialControlValues:function(e,t){var i=this.buildUrl(e,null,this.INITIAL_CONTROLS_VALUES_TEMPLATE_URL),n=this.sendRequest(i,t).then(this.dataConverter.convertResponseToControlsState);return s.Utils.showLoadingDialogOn(n,null,!0),n},fetchControlsUpdatedValues:function(e,n){var o=this.buildUrl(this.currentReportUri,e,this.CONTROLS_VALUES_TEMPLATE_URL),r=this.dataConverter;this.fullUpdateDeferred&&"pending"==this.fullUpdateDeferred.state()&&this.fullUpdateDeferred.reject();var l=new t.Deferred,a=s.Utils.wait(s.DataTransfer.FREQUENT_CHANGES_MIN_DELAY);return a.done(i.bind(function(){this.sendRequest(o,n).then(r.convertResponseToControlsState).done(function(e){"pending"==l.state()&&l.resolve(e)}).fail(function(){l.reject(this,arguments)})},this)),l.fail(function(){a.reject()}),s.Utils.showLoadingDialogOn(l,null,!0),this.fullUpdateDeferred=l,l}},{CONTROLS_STRUCTURE_TEMPLATE_URI:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}",INITIAL_CONTROLS_VALUES_TEMPLATE_URL:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/values",CONTROLS_VALUES_TEMPLATE_URL:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}/values",FREQUENT_CHANGES_MIN_DELAY:400})})}(JSON,a,l,n.Controls),i.exports=n.Controls}),define("controls/controls.basecontrol",["require","exports","module","../namespace/namespace","underscore","jquery","./controls.core"],function(e,t,i){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=e("../namespace/namespace"),o=n.JRS,r=e("underscore"),l=e("jquery");e("./controls.core"),o.Controls=function(e,t,i){function n(e){if(t.isArray(e)){var i=t.filter(e,function(e){return e.selected});return t.map(i,function(e){return e.id||""===e.id?e:e.value})}return e}return t.extend(i,{BaseControl:i.Base.extend({id:null,elem:null,error:null,templateChunks:{},constructor:function(e){this.initialize.apply(this,arguments)},getElem:function(){return this.elem},setElem:function(e){this.elem=e},bindCustomEventListeners:function(){},isSingleSelect:function(){return!t.isArray(this.get("selection"))},isSingleValue:function(){return!t.isArray(this.get("values"))},getTemplateSection:function(e){return this.templateChunks[this.type+"_"+e]||(this.templateChunks[this.type+"_"+e]=i.TemplateEngine.createTemplateSection(e,this.type)),this.templateChunks[this.type+"_"+e]},initialize:function(e){this.baseRender(e),this.isVisible(e)&&this.bindCustomEventListeners()},fireControlSelectionChangeEvent:function(t){e(document).trigger(i.CHANGE_CONTROL,this,t)},baseRender:function(s){s&&t.extend(this,s);var n=i.TemplateEngine.createTemplate(this.type);if(n){var o=e(n(this));this.setElem(o)}},update:function(e){},get:function(e){return this[e]},isValid:function(){return null===this.error||this.error&&this.error instanceof String&&0===this.error.length},isVisible:function(e){return!e||void 0===e.visible||!0===e.visible},updateWarningMessage:function(){var e=null!=this.error?this.error:"";this.getElem()&&this.getElem().find(".warning").text(e)},refresh:function(){var e=this.get("values"),t=this.get("selection");e=this.isSingleValue()?t:i.BaseControl.merge(e,t),this.values=e,this.initialize(this),this.isVisible(this)&&this.update(e)},set:function(e,i){if(t.extend(this,e),void 0!==e.values&&(this.isVisible(this)&&this.update(e.values),this.isSingleValue()?this.selection=e.values:this.isSingleSelect()?this.selection=n(e.values)[0]:this.selection=n(e.values)),void 0!==e.selection&&(this.isSingleValue()&&(this.values=e.selection),!i&&this.fireControlSelectionChangeEvent()),void 0!==e.disabled&&!this.get("readOnly")){var s=e.disabled;i||(s?this.disable():this.enable())}void 0!==e.error&&this.updateWarningMessage()},find:function(e){if(void 0!==e&&e&&"object"==s(e)){var i=t.keys(e)[0],n=t.values(e)[0];return t.find(this.get("values"),function(e){return e[i]===n})}},enable:function(){this.getElem().find("input").prop("disabled",!1),this.getElem().find("select").prop("disabled",!1)},disable:function(){this.getElem().find("input").prop("disabled",!0),this.getElem().find("select").prop("disabled",!0)}},{merge:function(e,i){return t.isNull(e)||t.isUndefined(e)?i:t.isNull(i)||t.isUndefined(i)?e:t.isArray(i)?t.map(e,function(e){return void 0!==t.find(i,function(t){return t===e.value})?e.selected=!0:delete e.selected,e}):this.merge(e,[i])}}),CHANGE_CONTROL:"changed:control"})}(l,r,o.Controls),i.exports=o.Controls}),function(e){"function"==typeof define&&define.amd?define("jquery-ui/ui/widgets/sortable",["jquery","./mouse","../data","../ie","../scroll-parent","../version","../widget"],e):e(jQuery)}(function(e){return e.widget("ui.sortable",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&e<t+i},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),e.each(this.items,function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),e(t.target).parents().each(function(){if(e.data(this,o.widgetName+"-item")===o)return s=e(this),!1}),e.data(t.target,o.widgetName+"-item")===o&&(s=e(t.target)),!!s&&(!(this.options.handle&&!i&&(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),!n))&&(this.currentItem=s,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,i,s){var n,o,r=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",r.cursor),this.storedStylesheet=e("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(o)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),
!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,o,r=this.options,l=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=l=this.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=l=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=l=this.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=l=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(t.pageY-this.document.scrollTop()<r.scrollSensitivity?l=this.document.scrollTop(this.document.scrollTop()-r.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<r.scrollSensitivity&&(l=this.document.scrollTop(this.document.scrollTop()+r.scrollSpeed)),t.pageX-this.document.scrollLeft()<r.scrollSensitivity?l=this.document.scrollLeft(this.document.scrollLeft()-r.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<r.scrollSensitivity&&(l=this.document.scrollLeft(this.document.scrollLeft()+r.scrollSpeed))),!1!==l&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],(o=this._intersectsWithPointer(s))&&s.instance===this.currentContainer&&!(n===this.currentItem[0]||this.placeholder[1===o?"next":"prev"]()[0]===n||e.contains(this.placeholder[0],n)||"semi-dynamic"===this.options.type&&e.contains(this.element[0],n))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,r={};o&&"x"!==o||(r.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(r.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new e.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=e.left,r=o+e.width,l=e.top,a=l+e.height,h=this.offset.click.top,c=this.offset.click.left,d="x"===this.options.axis||s+h>l&&s+h<a,u="y"===this.options.axis||t+c>o&&t+c<r,p=d&&u;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<r&&l<s+this.helperProportions.height/2&&n-this.helperProportions.height/2<a},_intersectsWithPointer:function(e){var t,i,s="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width);return!(!s||!n)&&(t=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===t?2:1:t&&("down"===t?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){l.push(this)}var s,n,o,r,l=[],a=[],h=this._connectWith();if(h&&t)for(s=h.length-1;s>=0;s--)for(o=e(h[s],this.document[0]),n=o.length-1;n>=0;n--)(r=e.data(o[n],this.widgetFullName))&&r!==this&&!r.options.disabled&&a.push([e.isFunction(r.options.items)?r.options.items.call(r.element):e(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(a.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=a.length-1;s>=0;s--)a[s][0].each(i);return e(l)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;i<t.length;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,o,r,l,a,h,c=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],u=this._connectWith();if(u&&this.ready)for(i=u.length-1;i>=0;i--)for(n=e(u[i],this.document[0]),s=n.length-1;s>=0;s--)(o=e.data(n[s],this.widgetFullName))&&o!==this&&!o.options.disabled&&(d.push([e.isFunction(o.options.items)?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]),this.containers.push(o));for(i=d.length-1;i>=0;i--)for(r=d[i][1],l=d[i][0],s=0,h=l.length;s<h;s++)a=e(l[s]),a.data(this.widgetName+"-item",r),c.push({item:a,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,o;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),o=n.offset(),s.left=o.left,s.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]);return t._addClass(n,"ui-sortable-placeholder",i||t.currentItem[0].className)._removeClass(n,"ui-sortable-helper"),"tbody"===s?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(n)):"tr"===s?t._createTrPlaceholder(t.currentItem,n):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){i&&!s.forcePlaceholderSize||(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,i){var s=this;t.children().each(function(){e("<td>&#160;</td>",s.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(t){var i,s,n,o,r,l,a,h,c,d,u=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(u&&e.contains(this.containers[i].element[0],u.element[0]))continue;u=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(u)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,o=null,c=u.floating||this._isFloating(this.currentItem),r=c?"left":"top",l=c?"width":"height",d=c?"pageX":"pageY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(a=this.items[s].item.offset()[r],h=!1,t[d]-a>this.items[s][l]/2&&(h=!0),Math.abs(t[d]-a)<n&&(n=Math.abs(t[d]-a),o=this.items[s],this.direction=h?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),s[0].style.width&&!i.forceHelperSize||s.width(this.currentItem.width()),s[0].style.height&&!i.forceHelperSize||s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),"document"!==n.containment&&"window"!==n.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,o=t.pageX,r=t.pageY,l="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(l[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((r-this.originalPageY)/n.grid[1])*n.grid[1],r=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:l.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:l.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)"auto"!==this._storedCSS[s]&&"static"!==this._storedCSS[s]||(this._storedCSS[s]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;s<n.length;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})}),define("controls/controls.viewmodel",["require","exports","module","../namespace/namespace","underscore","jquery","runtime_dependencies/js-sdk/src/common/util/browserDetection","./controls.core","./controls.basecontrol","jquery-ui/ui/widgets/sortable"],function(e,t,i){var s=e("../namespace/namespace"),n=s.JRS,o=e("underscore"),r=e("jquery"),l=e("runtime_dependencies/js-sdk/src/common/util/browserDetection");e("./controls.core"),e("./controls.basecontrol"),e("jquery-ui/ui/widgets/sortable"),n.Controls=function(e,t,i){var s=l.isIE(),n=function(){var t,i=(new Date).getTime();return function(){var s=(new Date).getTime(),n=this;s-i>400&&(i=s,e(this).trigger("scrollstart")),clearTimeout(t),t=setTimeout(function(){e(n).trigger("scrollstop")},300)}}(),o=i.Base.extend({constructor:function(e){this.containerSelector=e&&e.containerSelector||i.ViewModel.DEFAULT_CONTAINER,this.controls={},i.getViewModel=t.bind(function(){return this},this),t.bindAll(this,"registerEvents","onControlChange","_getAllSlaveControlIds","_getParentControlIds"),this.registerEvents()},registerEvents:function(){i.ignore("changed:control",this.onControlChange),i.listen({"changed:control":this.onControlChange})},onControlChange:function(s,n){var o,r,l=n.slaveDependencies&&n.slaveDependencies.length;if(l){r=this._getAllSlaveControlIds(n.id);var a=this._getParentControlIds(r),h=t.union(r,a);o=this.get("selection"),t.isEmpty(h)||t.each(o,function(e,i){-1===t.indexOf(h,i)&&delete o[i]})}else o=this.get("selection");e(document).trigger(i.ViewModel.CHANGE_SELECTION,[o,r,l]),l||e(document).trigger(i.ViewModel.CHANGE_VALUES,[this.state])},_getAllSlaveControlIds:function(e){var i=[],s=this.findControl({id:e});return s&&!t.isEmpty(s.slaveDependencies)&&t.each(s.slaveDependencies,function(e){i.push(e),i.push.apply(i,this._getAllSlaveControlIds(e))},this),t.uniq(i)},_getParentControlIds:function(e){var i=[];return t.each(e,function(e){var t=this.findControl({id:e});i.push.apply(i,t.masterDependencies)},this),t.uniq(i)}},{DEFAULT_CONTAINER:"#inputControlsContainer",CHANGE_VALUES:"viewmodel:values:changed",CHANGE_SELECTION:"viewmodel:selection:changed",CHANGE_ORDER:"viewmodel:order:changed",isSelectionChanged:function(e,i){var s=e?t(e).keys():[],n=i?t(i).keys():[];if(t.union(s,n).length===s.length){var o=e?t.flatten(t(e).values()):[],r=i?t.flatten(t(i).values()):[];return t.difference(o,r).length>0||t.difference(r,o).length>0}return!0}}),r={getControls:function(){return this.controls},instantiate:function(e){this.controls={},t.each(e,this.createControl,this)},createControl:function(e){var t=function(e){for(var t in i)if(e.toLowerCase()===t.toLowerCase())return i[t]}(e.type);if(!t)throw new Error("Can not find implementation of the control type: "+e.type);return this.controls[e.id]=new t(e),this.controls[e.id]},removeControl:function(e){delete this.controls[e]},reorderControl:function(t,s){if(1!=this.structure.length){for(var n,o=t<s?1:-1,r=t<s?Math.min(t,s):Math.max(t,s),l=t<s?Math.max(t,s):Math.min(t,s),a=r;a!=l;a+=o)n=this.structure[a],this.structure[a]=this.structure[a+o],this.structure[a+o]=n;e(document).trigger(i.ViewModel.CHANGE_ORDER,[this.structure])}},set:function(s,n){if(s){if(t.extend(this,s),void 0!==s.structure){var o=s.structure;this.instantiate(o),this.draw(o)}if(void 0!==s.state){var r=s.state;this.update(r),!n&&e(document).trigger(i.ViewModel.CHANGE_VALUES,[s.state])}}},get:function(e){if(e){if("selection"===e){var i={};return t.each(this.getControls(),function(e){var s=e.get("selection");s instanceof Array?i[e.id]=s:t.isUndefined(s)||(i[e.id]=[s])}),i}return this[e]}},findControl:function(e){var i=t.keys(e)[0],s=t.values(e)[0];return t.find(this.getControls(),function(e){return e[i]===s})},pluck:function(e){return t.pluck(this.getControls(),e)}},a={draw:function(e){var i=this.getContainer();if(i.empty(),s&&(i.attr("js-stdnav","false"),i.attr("js-navtype","none")),t.each(e,function(e){if(e.visible){var t=this.findControl({id:e.id});t.makeResizable&&t.makeResizable(),i.append(t.getElem())}},this),window.Report&&window.Report.icReorderEnabled){var n=window.Controls.layouts.LAYOUT_TOP_OF_PAGE==Report.reportControlsLayout;/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)||this._initSortable({container:i,horizontalLayout:n})}},update:function(e){t.each(e,function(e,t){this.findControl({id:t}).set({values:e.values,error:e.error})},this)},getContainer:function(){return this.container&&1==this.container.length?this.container:(this.container=e(this.containerSelector),this.container)},removeValidationMessages:function(){t.each(this.getControls(),function(e){e.set({error:null})})},areAllControlsValid:function(){return t.isEmpty(t.filter(this.getControls(),function(e){return!e.isValid()}))},setContainer:function(t){this.container=e(t)},reloadContainer:function(){return this.container=e(this.containerSelector),this.container},disable:function(){t.each(this.getControls(),function(e){e.set({disabled:!0})})},enable:function(){t.each(this.getControls(),function(e){e.set({disabled:!1})})},_initSortable:function(i){var o=i.container,r=i.horizontalLayout,l=!1,a=this,h=e(o).sortable({delay:200,placeholder:r?"verticalPlaceholder":"horizontalPlaceholder",axis:r?"x":"y",items:"> .leaf",cancel:"input,textarea,button,select,option,.list.inputSet,.jr-mSizer",start:function(e,t){t.item.data("oldIndex",t.item.index()),l=!0},stop:t.bind(function(e,t){var i=t.item.data("oldIndex"),s=t.item.index();i!=s&&this.reorderControl(i,s),l=!1},this)});if(s){var c=i.parent||h.parent();c.off("scroll",n),c.off("scrollstart"),c.off("scrollstop"),c.on("scroll",n),c.on("scrollstart",function(){if(!l)try{h.sortable("destroy")}catch(e){}}),c.on("scrollstop",function(){!l&&a._initSortable({parent:c,container:o,horizontalLayout:r})})}}};return t.extend(o.prototype,r,a),t.extend(i,{ViewModel:o})}(r,o,n.Controls),i.exports=n.Controls}),define("runtime_dependencies/js-sdk/src/components/singleSelect/manager/KeyboardManager",["require","exports","module","underscore"],function(e,t,i){var s=e("underscore"),n=function(e){return this.initialize(e),this};s.extend(n.prototype,{systemKeyCodes:[16,17,18,91],keydownHandlers:{38:"onUpKey",40:"onDownKey",13:"onEnterKey",27:"onEscKey",36:"onHomeKey",35:"onEndKey",9:"onTabKey",33:"onPageUpKey",34:"onPageDownKey"},initialize:function(e){s.bindAll(this,"onKeydown"),e.keydownHandlers&&(this.keydownHandlers=e.keydownHandlers),this.stopPropagation=e.stopPropagation,this.keydownTimeout=e.keydownTimeout||200,this.context=e.context,this.deferredKeydownHandler=e.deferredKeydownHandler,this.immediateHandleCondition=e.immediateHandleCondition,this.immediateKeydownHandler=e.immediateKeydownHandler},onKeydown:function(e){this._isSystemKeyPressed(e)||(this._canImmediatelyHandleKeyboardEvent(e)?this._immediatelyHandleKeyboardEvent(e):this.deferredHandleKeyboardEvent(e),this.stopPropagation&&e.stopPropagation())},deferredHandleKeyboardEvent:function(e){this.deferredKeydownHandler&&(this.keydownTimeout>0?(clearTimeout(this.deferredTimeout),this.deferredTimeout=setTimeout(s.bind(this.deferredKeydownHandler,this.context,e),this.keydownTimeout)):this.deferredKeydownHandler.call(this.context,e))},_isSystemKeyPressed:function(e){return s.indexOf(this.systemKeyCodes,e.which)>-1},_immediateHandleCondition:function(e){return this.immediateHandleCondition&&this.immediateHandleCondition.call(this.context,e)},_canImmediatelyHandleKeyboardEvent:function(e){var t=this.keydownHandlers[""+e.which];return t&&"function"==typeof this.context[t]||this._immediateHandleCondition(e)},_immediatelyHandleKeyboardEvent:function(e){var t=this.keydownHandlers[""+e.which];t&&"function"==typeof this.context[t]?this.context[t].call(this.context,e):this._immediateHandleCondition(e)&&this.immediateKeydownHandler&&this.immediateKeydownHandler.call(this.context,e)}}),i.exports=n}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/ScalableListModel",["require","exports","module","backbone","underscore"],function(e,t,i){var s=e("backbone"),n=e("underscore"),o=s.Model.extend({initialize:function(e){e=e||{},n.bindAll(this,"_fetchComplete","fetchFailed","afterFetchComplete","fetch"),this.set({items:[]},{silent:!0}),this.getData=e.getData,this.bufferSize=e.bufferSize||100,this.loadFactor=e.loadFactor||.95},_fetchComplete:function(e){this.attributes.total=e.total,this.set({items:e.data},{silent:!0}),this.attributes.bufferEndIndex=Math.max(0,Math.min(this.attributes.bufferStartIndex+this.bufferSize-1,this.attributes.bufferStartIndex+e.data.length-1)),this.attributes.bufferEndIndex<this.attributes.bufferStartIndex+this.bufferSize-1&&(this.attributes.total=Math.min(e.total,this.attributes.bufferEndIndex+1)),this.afterFetchComplete&&this.afterFetchComplete(e.data,this.attributes.total),this.trigger("change",this)},_isBufferReloadNecessary:function(e,t){if(void 0===this.get("bufferStartIndex")||void 0===this.get("bufferEndIndex"))return!0;if(e>=0&&e<this.get("bufferStartIndex")||t<this.get("total")&&t>this.get("bufferEndIndex"))return!0;if(e===this.get("bufferStartIndex")&&t===this.get("bufferEndIndex"))return!1;var i=1-(e-this.get("bufferStartIndex"))/this.bufferSize,s=1-(this.get("bufferEndIndex")-t)/this.bufferSize;return this.get("bufferStartIndex")>0&&i>=this.loadFactor||this.get("bufferEndIndex")<this.get("total")&&s>=this.loadFactor},afterFetchComplete:function(e,t){},fetchFailed:function(e,t){this.trigger("fetchFailed",e,t)},fetch:function(e){if(e=n.extend({top:this.get("bufferStartIndex")||0,bottom:this.get("bufferEndIndex")||this.bufferSize-1},e),e.force||this._isBufferReloadNecessary(e.top,e.bottom)){if(e.top!==this.attributes.bufferStartIndex||e.bottom!==this.attributes.bufferEndIndex||e.force){var t=e.top+Math.floor((e.bottom-e.top)/2),i=Math.floor(this.bufferSize/2);this.attributes.bufferStartIndex=Math.max(0,t-i),this.get("total")&&!e.force?this.attributes.bufferEndIndex=Math.min(this.get("total"),this.attributes.bufferStartIndex+this.bufferSize)-1:this.attributes.bufferEndIndex=this.attributes.bufferStartIndex+this.bufferSize-1}this.getData({offset:this.get("bufferStartIndex"),limit:this.get("bufferEndIndex")-this.get("bufferStartIndex")+1}).done(this._fetchComplete).fail(this.fetchFailed)}else this.afterFetchComplete&&this.afterFetchComplete(this.get("items"),this.get("total"))},reset:function(e){this.attributes={},this.set({items:[]},{silent:!0}),e&&e.silent||this.trigger("change",this)}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/BaseListWithSelectionModel",["require","exports","module","underscore","./ScalableListModel"],function(e,t,i){var s=e("underscore"),n=e("./ScalableListModel"),o=n.extend({initialize:function(e){n.prototype.initialize.call(this,e),this.select(e.value,{silent:!0})},_addToSelection:function(e,t){throw"Not implemented"},_removeFromSelection:function(e,t){throw"Not implemented"},_clearSelection:function(){throw"Not implemented"},_selectionContains:function(e,t){throw"Not implemented"},
_getSelection:function(){throw"Not implemented"},_triggerSelectionChange:function(e){e&&e.silent||this.trigger("change"),this.trigger("selection:change")},_addRangeToSelection:function(e,t,i){for(var s=0;s<e.length;s++)this._addToSelection(e[s].value,s+t);this.trigger("selection:addRange",{start:t,end:i,selection:this.getSelection()})},_fetchAllDataAndModifySelection:function(e,t){return this.getData().done(function(i){for(var s=0;s<i.data.length;s++)e(i.data[s].value,s);t&&t()}).fail(this.fetchFailed),this},addValueToSelection:function(e,t){return this.selectionStartIndex=t,this._addToSelection(e,t),this.trigger("selection:add",{value:e,index:t})},addRangeToSelection:function(e,t){if(void 0===this.selectionStartIndex)return void this.addValueToSelection(e,t);if(this.selectionStartIndex!==t){var i=Math.min(this.selectionStartIndex,t),s=Math.max(this.selectionStartIndex,t);if(this.selectionStartIndex=t,i>=this.get("bufferStartIndex")&&s<=this.get("bufferEndIndex")){var n=Array.prototype.slice.call(this.get("items"),i-this.get("bufferStartIndex"),s-this.get("bufferStartIndex")+1);this._addRangeToSelection(n,i,s)}else{var o=this;this.getData({offset:i,limit:s-i+1}).done(function(e){o._addRangeToSelection(e.data,i,s)}).fail(this.fetchFailed)}}},removeValueFromSelection:function(e,t){this._removeFromSelection(e,t),this.trigger("selection:remove",{value:e,index:t})},toggleSelection:function(e,t){this.selectionContains(e,t)?this.removeValueFromSelection(e,t):this.addValueToSelection(e,t)},selectionContains:function(e,t){return this._selectionContains(e,t)},clearSelection:function(){return this._clearSelection(),this.trigger("selection:clear")},getSelection:function(){return this._getSelection()},select:function(e,t){throw"Not implemented"},selectAll:function(){var e=this,t=!0;this._fetchAllDataAndModifySelection(function(i,s){t&&(e._clearSelection(),t=!1),e._addToSelection(i,s)},s.bind(this._triggerSelectionChange,this))},invertSelection:function(){var e=this;this._fetchAllDataAndModifySelection(function(t,i){e._selectionContains(t,i)?e._removeFromSelection(t,i):e._addToSelection(t,i)},s.bind(this._triggerSelectionChange,this))}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/ListWithSelectionModel",["require","exports","module","underscore","./BaseListWithSelectionModel"],function(e,t,i){var s=e("underscore"),n=e("./BaseListWithSelectionModel"),o=n.extend({_addToSelection:function(e,t){this.selection[t]=e},_removeFromSelection:function(e,t){this.selection[t]=void 0},_clearSelection:function(){this.selection=[]},_selectionContains:function(e,t){return this.selection[t]===e},_getSelection:function(){return this.selection},_isSelectionEmpty:function(e){if(!e)return!0;if(s.isArray(e)&&0===e.length)return!0;if(s.isArray(e)||"string"==typeof e)return!1;for(var t in e)if(e.hasOwnProperty(t)&&void 0!==e[t])return!1;return!0},_selectPendingSelection:function(e,t){if(0===this.get("bufferStartIndex")&&this.get("bufferEndIndex")==this.get("total")-1)this._convertInitialArrayToSelection(this.get("items"),e,t);else{var i=this;this.getData().done(function(s){i._convertInitialArrayToSelection(s.data,e,t)}).fail(this.fetchFailed)}},_convertInitialArrayToSelection:function(e,t,i){for(var s=0;s<e.length;s++)t[e[s].value]&&this._addToSelection(e[s].value,s);this._triggerSelectionChange(i)},_triggerSelectionChange:function(e){this._calcSelectionStartIndex&&this._calcSelectionStartIndex(),n.prototype._triggerSelectionChange.call(this,e)},_calcSelectionStartIndex:function(){if(void 0===this.selectionStartIndex)for(var e in this.selection)if(this.selection.hasOwnProperty(e)&&void 0!==this.selection[e]){this.selectionStartIndex=parseInt(e,10);break}},select:function(e,t){if(this._clearSelection(),this._isSelectionEmpty(e))return void this._triggerSelectionChange(t);if(s.isArray(e)||"string"==typeof e){var i={};if("string"==typeof e)i[e]=!0;else for(var n=0;n<e.length;n++)i[e[n]]=!0;this._selectPendingSelection(i,t)}else{for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];void 0!==r&&this._addToSelection(r,o)}this._triggerSelectionChange(t)}}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/listWithNavigationModelTrait",["require","exports","module","underscore"],function(e,t,i){var s=e("underscore"),n={activate:function(e,t){if("number"!=typeof e)return void this.setActive(s.extend({},t));if(t=t||{},e>=this.get("bufferStartIndex")&&e<=this.get("bufferEndIndex")){var i=this.get("items")[e-this.get("bufferStartIndex")];i&&this.setActive(s.extend(t,{index:e,item:i}))}else{var n=this;this.getData({offset:e,limit:1}).done(function(i){n.setActive(s.extend(t,{index:e,item:i.data[0]}))}).fail(this.fetchFailed)}},setActive:function(e){this.active&&e.index===this.active.index&&e.item.value===this.active.value||(this.active=e&&"number"==typeof e.index?{index:e.index,value:e.item.value,label:e.item.label}:void 0,e&&e.silent||(this.trigger("change"),this.trigger("active:changed",this.active)))},getActive:function(){return this.active}};i.exports=n}),define("runtime_dependencies/js-sdk/src/components/singleSelect/model/SingleSelectListModel",["require","exports","module","underscore","../../scalableList/model/ListWithSelectionModel","../../scalableList/model/listWithNavigationModelTrait"],function(e,t,i){var s=e("underscore"),n=e("../../scalableList/model/ListWithSelectionModel"),o=e("../../scalableList/model/listWithNavigationModelTrait"),r=n.extend(o);r=r.extend({setActive:function(e){o.setActive.call(this,s.extend(e,{silent:!0}));var t={};"number"==typeof e.index&&(t[e.index]=e.item.value),this.select(t)},_convertInitialArrayToSelection:function(e,t,i){for(var s=0;s<e.length;s++)t[e[s].value]&&(this._addToSelection(e[s].value,s),this.getActive()||o.setActive.call(this,{index:s,item:e[s],silent:!0}));this._triggerSelectionChange(i)},_convertSelectionObject:function(e){for(var t in e)if(e.hasOwnProperty(t)&&void 0!==e[t]){var i=e[t];return{index:parseInt(t,10),value:i}}},_select:n.prototype.select,select:function(e,t){var i,n=!1;if(!e||"string"==typeof e||s.isArray(e))o.setActive.call(this,{silent:!0});else if(i=this._convertSelectionObject(e)){var r=this.getActive();r&&i.value===r.value&&i.index===r.index||(n=!0)}else o.setActive.call(this,{silent:!0});return n?this.activate(i.index):this._select(e,t),this}}),i.exports=r}),define("text!runtime_dependencies/js-sdk/src/components/scalableList/templates/viewPortChunksTemplate.htm",[],function(){return'{{_.each(chunks, function(chunk) { }}\n<div class="jr-jViewPortChunk" style="height: {{- chunk.height}}px">\n\n    <js-templateNonce></js-templateNonce>\n</div>\n{{ }); }}\n'}),define("text!runtime_dependencies/js-sdk/src/components/scalableList/templates/itemsTemplate.htm",[],function(){return'<ul class="jr-mSelectlist jr" style="top: {{- top}}px; position: relative;">\n\n    <js-templateNonce></js-templateNonce>\n    {{_.each(items, function(item) { }}\n    <li class="jr-mSelectlist-item {{ if (item.selected) print(\'jr-isSelected\'); }} {{ if (item.active) print(\' jr-isHovered\'); }} jr" title="{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}" data-index="{{- item.index}}">\n        <div class="jr-mSelectlist-item-wrapper jr">\n            <a class="jr-mSelectlist-item-text jr">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}</a>\n        </div>\n    </li>\n    {{ }); }}\n</ul>'}),define("runtime_dependencies/js-sdk/src/components/scalableList/view/ScalableList",["require","exports","module","jquery","backbone","underscore","../model/ScalableListModel","text!../templates/viewPortChunksTemplate.htm","text!../templates/itemsTemplate.htm"],function(e,t,i){var s=e("jquery"),n=e("backbone"),o=e("underscore"),r=e("../model/ScalableListModel"),l=e("text!../templates/viewPortChunksTemplate.htm"),a=e("text!../templates/itemsTemplate.htm"),h=n.View.extend({ListModel:r,listItemSelector:"li",events:{scroll:"onScroll",touchmove:"onScroll"},attributes:{style:"overflow-y: auto; height: 100px; min-height: 100px;"},initialize:function(e){return o.bindAll(this,"_fetchVisibleData"),this.model=e.model||new this.ListModel(e),this.chunksTemplate=o.template(e.chunksTemplate||l),this.itemsTemplate=o.template(e.itemsTemplate||a),this.defaultChunkHeight=this.chunkHeight=e.chunkHeight||1e6,this.scrollTimeout=void 0!==e.scrollTimeout?e.scrollTimeout:50,this.manualScrollInterval=e.manualScrollInterval||50,this.lazy=e.lazy,this.defaultItemHeight=e.listItemHeight||21,this.listItemSelector=e.listItemSelector||this.listItemSelector,this.render(),this.initListeners(),this.lazy||this.model.fetch(),this},initListeners:function(){this.listenTo(this.model,"change",this.onModelChange,this),this.listenTo(this.model,"fetchFailed",this.onFetchFailed,this)},render:function(){return this},onScroll:function(e){this.scrollTimeout>0?(clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(this._fetchVisibleData,this.scrollTimeout)):this._fetchVisibleData()},onModelChange:function(){this.renderData()},onFetchFailed:function(e,t){this.trigger("listRenderError",e,t)},postProcessChunkModelItem:function(e,t){e.index=this.model.get("bufferStartIndex")+t,void 0===e.label&&(e.label=e.value),e.label=s.trim(e.label)},_renderItems:function(){var e=this.model.get("bufferStartIndex"),t=this.model.get("bufferEndIndex"),i=this.itemsPerChunk?Math.ceil((e+1)/this.itemsPerChunk):1,n=this.itemsPerChunk?Math.ceil((t+1)/this.itemsPerChunk):1,o=this;this.$el.find(".jr-jViewPortChunk").each(function(r,l){var a=s(l),h=o._getChunkModel({index:r+1,firstChunkWithData:i,lastChunkWithData:n,bufferStart:e,bufferEnd:t,total:o.totalItems,itemsPerChunk:o.itemsPerChunk,itemHeight:o.itemHeight,chunkHeight:o.chunkHeight,model:o.model}),c=h?o.itemsTemplate(h):"",d=l.children[0];d&&l.removeChild(d),a.append(c)})},_renderViewChunks:function(e){var t,i=this;(this.totalItems!==this.model.get("total")||e)&&(this.totalItems=this.model.get("total"),t=Array.prototype.slice.call(this.$el[0].children),t.forEach(function(e){i.$el[0].removeChild(e)}),this.$el.append(this.chunksTemplate({_:o,chunks:this._getViewChunksModel()})),this.$firstViewChunk=this.$el.find(".jr-jViewPortChunk:first"))},_getViewChunksModel:function(){for(var e=this.itemsPerChunk?Math.ceil(this.totalItems/this.itemsPerChunk):1,t=e>0?this.itemHeight?this.totalItems*this.itemHeight-(e-1)*this.chunkHeight:this.chunkHeight:1,i=[],s=1;s<e;s++)i.push({height:this.chunkHeight});return i.push({height:t}),i},_calcViewPortConstants:function(){this.viewPortConstantsInitialized||(this.itemHeight=this.defaultItemHeight,this.$firstViewChunk&&(this.itemHeight=this.$el.find(this.listItemSelector+":first").outerHeight(!0),!this.itemHeight||this.itemHeight<=2?(this.itemHeight=this.defaultItemHeight,this.viewPortConstantsInitialized=!1):this.viewPortConstantsInitialized=!0),this._calcViewPortHeight(),this.itemsPerChunk=Math.floor(this.defaultChunkHeight/this.itemHeight),this.chunkHeight=this.itemsPerChunk*this.itemHeight,this._renderViewChunks(!0),this._renderItems())},resizeViewPort:function(e){this.viewPortHeight=e,this.$el.outerHeight(this.viewPortHeight),this.itemsPerView=Math.floor(this.viewPortHeight/this.itemHeight)-1,this.itemsPerChunk=Math.floor(this.defaultChunkHeight/this.itemHeight),this.chunkHeight=this.itemsPerChunk*this.itemHeight,this._renderViewChunks(!0),this._renderItems()},_calcViewPortHeight:function(){this.viewPortHeight=this.$el.height(),this.itemsPerView=Math.floor(this.viewPortHeight/this.itemHeight)-1},_getItemsPerView:function(){return this._calcViewPortConstants(),this.itemsPerView},_getChunkModel:function(e){var t=e.index;if(t<e.firstChunkWithData||t>e.lastChunkWithData)return null;var i=e.itemsPerChunk?Math.max(e.bufferStart,e.itemsPerChunk*(t-1)):e.bufferStart,s=e.itemsPerChunk?Math.min(e.bufferEnd,e.itemsPerChunk*t-1):e.bufferEnd,n=e.itemHeight?i*e.itemHeight-(t-1)*e.chunkHeight:0,r=Array.prototype.slice.call(e.model.get("items"),i-e.bufferStart,s-e.bufferStart+1);return o.each(r,function(t,s){this.postProcessChunkModelItem(t,s+(i-e.bufferStart))},this),{top:n,items:r}},_fetchVisibleData:function(){var e=this._getVisibleItems();this.model.fetch({top:e.top,bottom:e.bottom})},_getVisibleItems:function(){var e=this._getScrollPos(),t=this.model.get("total"),i=Math.min(t-this.itemsPerView,Math.floor(e/this.itemHeight));return{top:i,bottom:Math.min(t-1,i+this.itemsPerView+1)}},_getScrollPos:function(){this._calcViewPortConstants();var e=0;if(this.$firstViewChunk){var t=this.$el.offset(),i=this.$firstViewChunk.offset();t&&i&&(e=t.top-i.top)}return e},renderData:function(){return!this.lazy&&this.model.has("bufferStartIndex")&&this.model.has("bufferEndIndex")?(this.trigger("before:render:data"),this._renderViewChunks(),this._renderItems(),this._calcViewPortConstants(),this.trigger("render:data")):(this.lazy=null,this.model.fetch()),this},resize:function(){if(this.$el.is(":visible")){var e=this.$el.outerHeight();e!==this._componentHeight&&(this._componentHeight=e,this.viewPortConstantsInitialized=!1,this._calcViewPortConstants())}},fetch:function(e,t){this.lazy=!1,t=t||{};var i;t.keepPosition?i=this.$el.get(0).scrollTop:this.reset({silent:!0,lazy:!1}),this.model.once("change",function(){t.keepPosition&&this.$el.scrollTop(i),e&&e.apply(this,arguments)},this).fetch({force:!0})},reset:function(e){e=o.defaults(e||{},{lazy:!0}),this.$el.scrollTop(0),this.lazy=e.lazy,this.model.reset(e)},scrollTo:function(e){if("number"==typeof e){var t=this._getScrollPos();if(this.viewPortConstantsInitialized){this._calcViewPortHeight();var i=null,s=e*this.itemHeight;s<t?i=s:s+this.itemHeight>t+this.viewPortHeight&&(i=s+this.itemHeight-this.viewPortHeight),null!==i&&this.$el.scrollTop(i)}}}});i.exports=h}),define("runtime_dependencies/js-sdk/src/components/scalableList/view/ListWithSelection",["require","exports","module","jquery","underscore","../model/ListWithSelectionModel","./ScalableList"],function(e,t,i){var s=e("jquery"),n=e("underscore"),o=e("../model/ListWithSelectionModel"),r=e("./ScalableList"),l={LEFT:"left",RIGHT:"right"},a=r.extend({ListModel:o,initialize:function(e){return n.bindAll(this,"onGlobalMouseup","onGlobalMousemove","_autoScroll","fetch"),this.eventListenerPattern=e.eventListenerPattern||"li",this.markerClass=e.markerClass?e.markerClass:"",this.selectedClass=e.selectedClass?e.selectedClass:"jr-isSelected",this._initSelection(e.selection),r.prototype.initialize.call(this,e)},delegateEvents:function(){var e=r.prototype.delegateEvents.apply(this,arguments);return this.$el.on("mousedown",this.eventListenerPattern,n.bind(this.onMousedown,this)).on("mousemove",this.eventListenerPattern,n.bind(this.onMousemove,this)).on("dblclick",this.eventListenerPattern,n.bind(this.onMousedblclick,this)).on("contextmenu",this.eventListenerPattern,n.bind(this.onItemEvent,this,this.$el)).on("click",this.eventListenerPattern,n.bind(this.onItemEvent,this,this.$el)).on("mouseout",this.eventListenerPattern,n.bind(this.onItemEvent,this,this.$el)).on("mouseover",this.eventListenerPattern,n.bind(this.onItemEvent,this,this.$el)),e},undelegateEvents:function(){var e=r.prototype.undelegateEvents.apply(this,arguments);return this.$el.off("mouseup").off("mousedown").off("mousemove").off("dblclick").off("contextmenu").off("click").off("mouseout").off("mouseover"),e},_initSelection:function(e){e=n.extend({allowed:{}},e);var t=e.allowed,i=n.isObject(t)?t.left:t;this.selection={allowed:{left:void 0===i||i,right:void 0!==t.right&&t.right},multiple:void 0===e.multiple||e.multiple}},initListeners:function(){r.prototype.initListeners.call(this),this.listenTo(this.model,"selection:clear",this.clearSelection,this),this.listenTo(this.model,"selection:add",this.selectValue,this),this.listenTo(this.model,"selection:addRange",this.selectRange,this),this.listenTo(this.model,"selection:remove",this.deselectValue,this),s("body").on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},postProcessChunkModelItem:function(e,t){r.prototype.postProcessChunkModelItem.call(this,e,t),e.selected=this.model.selectionContains&&this.model.selectionContains(e.value,e.index)},onMousedblclick:function(e){if(!this.selection.multiple&&(this.selection.allowed.left||this.selection.allowed.right)&&!this.getDisabled()){var t=this._getDomItemData(e.currentTarget);this._singleSelect(e,t.value,t.index),this.selectionChanged&&(this._triggerSelectionChanged(),this._triggerDblclicked(),this.selectionChanged=!1)}},getItemByEvent:function(e){return this._getDomItemData(e.currentTarget).item},onItemEvent:function(e,t){var i=t.type,s=this.getItemByEvent(t);this.trigger("list:item:"+i,s,t)},onMousedown:function(e){if(!this.getDisabled()&&(this.selection.allowed.left&&1===e.which||this.selection.allowed.right&&3===e.which)){var t=1===e.which?l.LEFT:l.RIGHT;this.selection.multiple&&(this[t+"MouseButtonPressed"]=!0,this.mouseDownPos=this._getMousePos(e));var i=this._getDomItemData(e.currentTarget);this.selection.multiple?this._multiSelect(e,i.value,i.index):this._singleSelect(e,i.value,i.index)}},onMousemove:function(e){if(this._allowMouseMoveSelection()&&(this._stopAutoScroll(),this._mouseMoved(e,this.mouseDownPos))){this.mouseDownPos=this._getMousePos(e);var t=this._getDomItemData(e.currentTarget);this.model.selectionContains(t.value,t.index)||this.model.addRangeToSelection(t.value,t.index)}},onGlobalMouseup:function(e){var t=this;(this.leftMouseButtonPressed||this.rightMouseButtonPressed)&&(n.each(l,function(e){t[e+"MouseButtonPressed"]=!1}),delete this.mouseDownPos,this._stopAutoScroll(),this.selectionChanged&&(this._triggerSelectionChanged(),this.selectionChanged=!1))},onGlobalMousemove:function(e){this._allowMouseMoveSelection()&&(this.mousePosY=e.clientY,this.scrollInterval||(this.scrollInterval=setInterval(this._autoScroll,this.manualScrollInterval)))},clearSelection:function(){this.$el.find("li."+this.selectedClass+this.markerClass).removeClass(this.selectedClass),this.selectionChanged=!0},selectValue:function(e){this._selectItemByIndex(e.index),this.selection.multiple?this.selectionChanged=!0:this._triggerSelectionChanged()},selectRange:function(e){var t=this,i=Math.max(this.model.get("bufferStartIndex"),e.start),n=Math.min(this.model.get("bufferEndIndex"),e.end);this.$el.find("li"+this.markerClass+":not(."+this.selectedClass+")").each(function(){var e=s(this),o=parseInt(e.attr("data-index"),10);if(o>=i&&o<=n){var r=t.model.get("items")[o-t.model.get("bufferStartIndex")];t.model.selectionContains(r.value,o)&&e.addClass(t.selectedClass)}}),this.selectionChanged=!0},deselectValue:function(e){this._deselectItemByIndex(e.index),this.selection.multiple?this.selectionChanged=!0:this._triggerSelectionChanged()},_selectItemByIndex:function(e){this.$el.find("li"+this.markerClass+"[data-index='"+e+"']:not(."+this.selectedClass+")").addClass(this.selectedClass)},_deselectItemByIndex:function(e){this.$el.find("li[data-index='"+e+"']."+this.selectedClass+this.markerClass).removeClass(this.selectedClass)},_autoScroll:function(){var e,t=this.$el.offset().top,i=this.$el.scrollTop(),s=void 0!==this.scrollTop?this.scrollTop:i,n=!1;this.mousePosY<t?(e=s-3*this.itemHeight,n=e<i):this.mousePosY>t+this.viewPortHeight&&(e=s+3*this.itemHeight,n=e>i),n&&(this.$el.scrollTop(e),this.scrollTop=this.$el.scrollTop(),this._fetchVisibleData()),this._selectRangeOnAutoScroll(s,e)},_selectRangeOnAutoScroll:function(e,t){var i;if(e<t?i=this._getVisibleItems().bottom:e>t&&(i=this._getVisibleItems().top),i){var s=this.model.get("items")[i-this.model.get("bufferStartIndex")];s&&(this.model.selectionContains(s.value,i)||this.model.addRangeToSelection(s.value,i))}},_stopAutoScroll:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=void 0,this.scrollTop=void 0)},_multiSelect:function(e,t,i){e.shiftKey?this.model.addRangeToSelection(t,i):e.ctrlKey||e.metaKey?this._singleSelect(e,t,i):this.model.toggleSelection(t,i)},_singleSelect:function(e,t,i){this.model.clearSelection().addValueToSelection(t,i)},_triggerSelectionChanged:function(){this.trigger("selection:change",this.getValue())},_triggerDblclicked:function(){this.trigger("item:dblclick",this.getValue())},_getDomItemData:function(e){for(var t=s(e),i=t.attr("data-index");void 0===i;)t=t.parent(),i=t.attr("data-index");i=parseInt(i,10);var n=this.model.get("items")[i-this.model.get("bufferStartIndex")];return{item:n,value:n.value,index:i}},_mouseMoved:function(e,t){return Math.abs(t.x-e.clientX)+Math.abs(t.y-e.clientY)>=1},_getMousePos:function(e){return{x:e.clientX,y:e.clientY}},_allowMouseMoveSelection:function(){return(this.selection.allowed.left&&this.leftMouseButtonPressed||this.selection.allowed.right&&this.rightMouseButtonPressed)&&this.selection.multiple&&!this.getDisabled()},getValue:function(){return this.model.getSelection()},setValue:function(e,t){return t=t||{},t&&t.silent||t.modelOptions&&t.modelOptions.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),t=t.modelOptions,this.model.select(e,t),this},selectAll:function(e){return e&&e.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),this.model.selectAll(),this},selectNone:function(e){return this.setValue({},e)},invertSelection:function(e){return e&&e.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),this.model.invertSelection(),this},setDisabled:function(e){return this.disabled=e,this.disabled?this.$el.addClass("disabled"):this.$el.removeClass("disabled"),this},getDisabled:function(){return this.disabled},remove:function(){return s("body").off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove),r.prototype.remove.call(this)}});i.exports=a}),define("runtime_dependencies/js-sdk/src/components/scalableList/view/ListWithNavigation",["require","exports","module","./ListWithSelection","../model/ListWithSelectionModel","../model/listWithNavigationModelTrait"],function(e,t,i){var s=e("./ListWithSelection"),n=e("../model/ListWithSelectionModel"),o=e("../model/listWithNavigationModelTrait"),r=s.extend({canActivate:!0,initialize:function(e){e=e||{};var t=n.extend(o);e.model=e.model||new t(e),s.prototype.initialize.call(this,e)},onMousemove:function(e){if(s.prototype.onMousemove.call(this,e),!this.mouseMovePos||this._mouseMoved(e,this.mouseMovePos)){this.mouseMovePos=this._getMousePos(e);var t=this._getDomItemData(e.currentTarget);this.activate(t.index)}},setCanActivate:function(e){this.canActivate=e},getCanActivate:function(){return this.canActivate&&!this.getDisabled()},activateFirst:function(){this.activate(0)},activateLast:function(){this.activate(Math.max(0,this.model.get("total")-1))},activateNext:function(){this.activate(Math.min(this.model.get("total")-1,this._getActiveIndex()+1))},activatePrevious:function(){this.activate(Math.max(0,this._getActiveIndex()-1))},pageDown:function(){this.activate(Math.min(this.model.get("total")-1,this._getActiveIndex()+this._getItemsPerView()))},pageUp:function(){this.activate(Math.max(0,this._getActiveIndex()-this._getItemsPerView()))},getActiveValue:function(){return this.model.getActive&&this.model.getActive()},activate:function(e,t){if(this.getCanActivate()){var i=this.getActiveValue();if(i&&i.index===e)return;if(!t||!t.silent){var s=this;this.model.once("active:changed",function(){s.trigger("active:changed",s.getActiveValue())})}this.model.activate(e,t)}},postProcessChunkModelItem:function(e,t){s.prototype.postProcessChunkModelItem.call(this,e,t);var i=this._getActiveIndex&&this._getActiveIndex();e.active=void 0!==i&&i===this.model.get("bufferStartIndex")+t},_getActiveIndex:function(){var e=this.getActiveValue();return e&&e.index}});i.exports=r}),define("runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelectList",["require","exports","module","underscore","../model/SingleSelectListModel","../../scalableList/view/ListWithNavigation"],function(e,t,i){var s=e("underscore"),n=e("../model/SingleSelectListModel"),o=e("../../scalableList/view/ListWithNavigation"),r=o.extend({events:s.extend({},o.prototype.events,{"mouseup li":"onMouseup"}),initialize:function(e){var t=e.model||new n(e);o.prototype.initialize.call(this,s.extend({model:t,lazy:!0,selection:{allowed:!0,multiple:!1}},e))},onMouseup:function(){this.trigger("item:mouseup")},activate:function(e){if(this.getCanActivate()){var t=this.getActiveValue();if(t&&t.index===e)return;this.model.once("selection:change",this._triggerSelectionChanged,this).activate(e)}}});i.exports=r}),define("runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/SearcheableDataProvider",["require","exports","module","jquery","underscore"],function(e,t,i){var s=e("jquery"),n=e("underscore"),o=function(e){n.bindAll(this,"getData","_filterValues","_shouldFilter"),this.indexMapping={},this.internalGetData=e.getData};n.extend(o.prototype,{getData:function(e){var t=new s.Deferred;if(e&&void 0!==e.criteria)return this.dataCache=null,this.criteria=e.criteria,t.resolve(),t.promise();var i=this;return i._shouldFilter()?(this.dataCache?this._resolvePromise(e,t):this.internalGetData().done(function(s){i.indexMapping={},i.reverseIndexMapping={},i.dataCache=i._filterValues(s.data),i._resolvePromise(e,t)}).fail(t.reject),t.promise()):(this.indexMapping=null,this.reverseIndexMapping=null,this.dataCache=null,this.internalGetData(e))},getIndexMapping:function(){return this.indexMapping},getReverseIndexMapping:function(){return this.reverseIndexMapping},_resolvePromise:function(e,t){var i=e&&e.offset?e.offset:0,s=e&&e.limit?i+e.limit:this.dataCache.length,n=this._getDataSegment(this.dataCache,i,s);t.resolve({data:n,total:this.dataCache.length})},_shouldFilter:function(){return this.criteria},_filterValues:function(e){for(var t=[],i=0,s=0;s<e.length;s++){var n=e[s];(void 0===n.label?n.value:n.label).toLowerCase().indexOf(this.criteria.toLowerCase())>-1&&(t[i]=n,this.indexMapping[i]=s,this.reverseIndexMapping[s]=i,i+=1)}return t},_getDataSegment:function(e,t,i){i=Math.min(i,e.length);for(var s=[],n=t;n<i;n++)s.push({label:e[n].label,value:e[n].value});return s}}),i.exports=o}),define("runtime_dependencies/js-sdk/src/components/singleSelect/manager/DropDownManager",["require","exports","module","underscore","jquery"],function(e,t,i){var s=e("underscore"),n=e("jquery"),o=n("body"),r=function(e){return this.initialize(e),this};s.extend(r.prototype,{initialize:function(e){s.bindAll(this,"checkOffset","setNewOffset"),this.$dropDownEl=e.dropDownEl,this.calcOffset=e.calcOffset,this.isOffsetChanged=e.isOffsetChanged||this._isOffsetChanged,this.recalcInterval=e.recalcInterval||500,this.onOffsetChanged=e.onOffsetChanged},startCalc:function(){this.checkOffset(this.setNewOffset),clearInterval(this.recalcTimer),this.recalcTimer=setInterval(s.bind(this.checkOffset,this,this.onOffsetChanged),this.recalcInterval)},stopCalc:function(){clearInterval(this.recalcTimer)},checkOffset:function(e){var t=this.calcOffset(),i=this.$dropDownEl.position(),s=o.offset();(s.top||s.left)&&(i.top+=s.top,i.left+=s.left),this.$dropDownEl.width()!==t.width&&this.setNewOffset(t),this.isOffsetChanged(i,t)&&e&&e(t)},setNewOffset:function(e){this.$dropDownEl.css("top",e.top-o.offset().top).css("left",e.left-o.offset().left).css("width",e.width)},_isOffsetChanged:function(e,t){return Math.floor(e.top)!==Math.floor(t.top)||Math.floor(e.left)!==Math.floor(t.left)}}),i.exports=r}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/singleSelectTemplate.htm",[],function(){return'<div class="jr-mSingleselect jr">\n\n    <js-templateNonce></js-templateNonce>\n    <a class="jr-mSingleselect-input jr">\n        <span class="jr-mSingleselect-input-placeholder jr">{{- i18n[\'sic.singleselect.select.one\'] }}</span>\n        <span class="jr-mSingleselect-input-selection jr">{{- value}}</span>\n        <div class="jr-mSingleselect-input-expander jr"></div>\n    </a>\n    <div class="jr-mSingleselect-search jr">\n        <input type="text" placeholder="{{- i18n[\'sic.multiselect.search\'] }}" class="jr-mInput-search jr" value="{{- value}}">\n    </div>\n</div>\n'}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/singleSelectTemplate_IE10_11.htm",[],function(){return'<div class="jr-mSingleselect jr">\n\n    <js-templateNonce></js-templateNonce>\n    <a class="jr-mSingleselect-input jr">\n        <span class="jr-mSingleselect-input-placeholder jr">Click to select item...</span>\n        <span class="jr-mSingleselect-input-selection jr">{{- value}}</span>\n        <div class="jr-mSingleselect-input-expander jr"></div>\n    </a>\n    <div class="jr-mSingleselect-search jr">\n        <input type="text" class="jr-mInput-search jr" value="{{- value}}">\n    </div>\n</div>\n'}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/listTemplate.htm",[],function(){return'<div class="jr-mScalablelist jr" draggable="false" ondragstart="return false" unselectable="on" onselectstart="return false">\n\n    <js-templateNonce></js-templateNonce>\n</div>'}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/itemsTemplate.htm",[],function(){return'<ul class="jr-mSelectlist jr" style="top: {{- top}}px;">\n\n    <js-templateNonce></js-templateNonce>\n    {{_.each(items, function(item) { }}\n    <li class="jr-mSelectlist-item {{ if (item.selected) print(\'jr-isSelected\'); }} jr" title="{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}" data-index="{{- item.index}}">\n        <div class="jr-mSelectlist-item-wrapper jr">\n            <a class="jr-mSelectlist-item-text jr">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}</a>\n        </div>\n    </li>\n    {{ }); }}\n</ul>'}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/dropDownTemplate.htm",[],function(){return'<div class="jr-mSingleselect-dropdownContainer jr">\n    <js-templateNonce></js-templateNonce>\n    <div class="jr-mSingleselect-dropdown jr"></div>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelect",["require","exports","module","jquery","backbone","underscore","../manager/KeyboardManager","./SingleSelectList","../model/SingleSelectListModel","../dataprovider/SearcheableDataProvider","../manager/DropDownManager","text!../templates/singleSelectTemplate.htm","text!../templates/singleSelectTemplate_IE10_11.htm","text!../templates/listTemplate.htm","text!../templates/itemsTemplate.htm","text!../templates/dropDownTemplate.htm","bundle!ScalableInputControlsBundle","../../../common/util/browserDetection","../../../common/util/xssUtil"],function(e,t,i){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=e("jquery"),o=e("backbone"),r=e("underscore"),l=e("../manager/KeyboardManager"),a=e("./SingleSelectList"),h=e("../model/SingleSelectListModel"),c=e("../dataprovider/SearcheableDataProvider"),d=e("../manager/DropDownManager"),u=e("text!../templates/singleSelectTemplate.htm"),p=e("text!../templates/singleSelectTemplate_IE10_11.htm"),m=e("text!../templates/listTemplate.htm"),f=e("text!../templates/itemsTemplate.htm"),g=e("text!../templates/dropDownTemplate.htm"),v=e("bundle!ScalableInputControlsBundle"),b=e("../../../common/util/browserDetection"),_=e("../../../common/util/xssUtil"),w=n("body"),C=o.View.extend({events:function(){return{keydown:this.keyboardManager.onKeydown,input:this.keyboardManager.onKeydown,"focus input":"onFocus","blur input":"onBlur",mousedown:"onMousedown",mouseup:"onMouseup","click .jr-mSingleselect-input":"onClickOnInput"}},initialize:function(e){r.bindAll(this,"onGlobalMouseup","onGlobalMousedown","onGlobalMousemove","onMousedown","calcOffsetForListView","collapse"),
this.model||(this.model=new o.Model),this.model.set("expanded",!1,{silent:!0}),this.model.set("criteria","",{silent:!0}),this.model.set("value",{},{silent:!0});var t=u;(b.isIE10()||b.isIE11())&&(t=p),this.dropUpDirection=!1,this.label=e.label,this.template=r.template(e.template||t),this.dropDownTemplate=r.template(e.dropDownTemplate||g),this.keyboardManager=new l({keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0}),this.listViewModel=this._createListViewModel(e),this.listView=this._createListView(e),this.render(),this.dropDownManager=new d({dropDownEl:this.$dropDownElContainer,calcOffset:this.calcOffsetForListView,isOffsetChanged:this.isDimensionsChangedforListView,onOffsetChanged:this.collapse}),this.initListeners(),this.setValue(e.value,{modelOptions:{silent:!0}})},_createListView:function(e){return new a({el:e.listElement||n(m),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate||f,scrollTimeout:e.scrollTimeout})},_createListViewModel:function(e){return this.searcheableDataProvider=new c({getData:e.getData}),new h({getData:this._getGetData(),bufferSize:e.bufferSize,loadFactor:e.loadFactor})},_getGetData:function(){return this.searcheableDataProvider.getData},_getActiveValueIndex:function(e){var t=this.searcheableDataProvider.getIndexMapping();return t?t[e.index]:e.index},initListeners:function(){this.listenTo(this.listView,"selection:change",this.selectionChange,this),this.listenTo(this.listView,"item:mouseup",this.itemMouseup,this),this.listenTo(this.listView,"listRenderError",this.listRenderError,this),this.listenTo(this.model,"change:expanded",this.changeExpandedState,this),this.listenTo(this.model,"change:value",this.changeValue,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),this.listenTo(this.model,"change:criteria",this.changeFilter,this),this.$dropDownEl.on("mousedown",this.onMousedown),w.on("mousedown",this.onGlobalMousedown).on("dataavailable",this.onGlobalMousedown).on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},render:function(){var e=n(this.template({label:this.label,isIPad:b.isIPad(),value:this.model.get("value").label,expanded:this.model.get("expanded"),i18n:v}));return this.renderListView(),this.$el.empty(),this.$el.append(e),this.$singleSelect=e,this.$searchBlock=this.$el.find(".jr-mSingleselect-search"),this.$inputBlock=this.$el.find(".jr-mSingleselect-input"),this.$input=this.$searchBlock.find("input"),this},renderListView:function(){this.listRendered||(this.$dropDownElContainer=n(this.dropDownTemplate({isIPad:"iPad"===navigator.platform})),this.$dropDownEl=this.$dropDownElContainer.find(".jr-mSingleselect-dropdown"),this.listView.undelegateEvents(),this.$dropDownEl.append(this.listView.$el),w.append(this.$dropDownElContainer),this.listView.delegateEvents(),this.listRendered=!0),this.$scalablelist=this.$dropDownElContainer.find(".jr-mScalablelist"),this.model.get("expanded")?this.$dropDownElContainer.show():this.$dropDownElContainer.hide()},renderData:function(){return this.listView.renderData(),this},listRenderError:function(e,t){this.trigger("listRenderError",e,t)},itemMouseup:function(){if(!this.model.get("disabled")){delete this.preventBlur,this.$input.focus();var e=this.model.get("activeValue");e.value!==this.model.get("value").value?(this.model.unset("activeValue"),this.model.set("value",e)):this.collapse()}},selectionChange:function(){var e=this.listView.getActiveValue();e?(this.listView.scrollTo(e.index),this.model.set("activeValue",{value:e.value,label:e.label,index:this._getActiveValueIndex(e)}),this.updateValueFromActive()):this.model.unset("activeValue")},onClickOnInput:function(){this.model.get("expanded")?this.collapse():this.expand()},onFocus:function(){this.model.get("expanded")||this.$inputBlock.addClass("jr-isFocused")},onBlur:function(){this.preventBlur||(this.collapse(),this.$inputBlock.removeClass("jr-isFocused"))},onMousedown:function(){this.preventBlur=!0},onMouseup:function(){this.preventBlur&&(delete this.preventBlur,this.model.get("expanded")&&this.$input.focus())},changeExpandedState:function(e){e.get("expanded")?this.doExpand():this.doCollapse()},changeValue:function(){this.collapse(),this.updateControlLabel(),this.silent?delete this.silent:this.trigger("selection:change",this.model.get("value").value),this.$input.val(""),this.model.set("criteria","")},changeDisabled:function(){var e=this.model.get("disabled");e?(this.$input.attr("disabled","disabled"),this.collapse()):this.$input.removeAttr("disabled"),this.listView.setDisabled(e)},onGlobalMousedown:function(e){if(this.model.get("expanded")){if(e.target===this.el||this.$el.find(e.target).length>0||e.target===this.$dropDownEl[0]||this.$dropDownEl.find(e.target).length>0)return void this.$input.focus();this.preventBlur=!1}this.onBlur()},onGlobalMouseup:function(){this.onMouseup()},onGlobalMousemove:function(e){this.preventBlur&&e.stopPropagation()},onUpKey:function(){if(this.model.get("expanded")){var e=this.listView.getActiveValue();if(!e||0===e.index)return void this.collapse();this.listView.activatePrevious()}else this.expand()},onDownKey:function(){if(this.model.get("expanded")){this.listView.getActiveValue()?this.listView.activateNext():this.listView.activateFirst()}else this.expand()},onEnterKey:function(e){e.preventDefault(),this.model.get("expanded")?this.model.get("activeValue")?this.itemMouseup():this.collapse():this.expand()},onEscKey:function(){this.model.get("expanded")&&this.collapse()},onHomeKey:function(){this.model.get("expanded")?this.listView.activateFirst():this.expand()},onEndKey:function(){this.model.get("expanded")?this.listView.activateLast():this.expand()},onPageUpKey:function(){this.model.get("expanded")?this.listView.pageUp():this.expand()},onPageDownKey:function(){this.model.get("expanded")?this.listView.pageDown():this.expand()},onTabKey:function(){},updateDropDirection:function(){var e=n("html").scrollTop(),t=this.$el.offset(),i=this.$el.height(),s=this.$searchBlock.outerHeight(),o=t.top-e,r=n(window).height()-o-i;this.dropUpDirection=o>r;var l=this.dropUpDirection?o:r;l-=s+i,this.$scalablelist.css("max-height",l+"px")},doExpand:function(){this.updateDropDirection(),this.dropUpDirection&&(this.$dropDownEl.addClass("jr-mSingleselect-dropdownTop"),this.$singleSelect.addClass("jr-mSingleselectTop")),this.$searchBlock.addClass("jr-isOpen"),this.$inputBlock.addClass("jr-isOpen"),this.$inputBlock.removeClass("jr-isFocused"),this.$input.focus(),this.listView.onScroll(),this.expandListView(),this.listView.lazy?this.listView.fetch(r.bind(this.listView.resize,this.listView)):this.listView.resize(),void 0!==this.model.get("value").value&&this.setValueToList(),this.trigger("expand",this)},expandListView:function(){this.$dropDownElContainer.show(),this.dropDownManager.startCalc()},doCollapse:function(){this.model.unset("activeValue"),this.$searchBlock.removeClass("jr-isOpen"),this.$inputBlock.removeClass("jr-isOpen"),this.$dropDownEl.removeClass("jr-mSingleselect-dropdownTop"),this.$singleSelect.removeClass("jr-mSingleselectTop"),this.$inputBlock.addClass("jr-isFocused"),this.$input.val(""),this.$dropDownElContainer.hide(),this.model.set("criteria",""),this.dropDownManager.stopCalc(),this.trigger("collapse",this)},calcOffsetForListView:function(){var e,t=this.$el.offset(),i=w.offset().left+t.left,s=this.$el.height();return e=this.dropUpDirection?w.offset().top+t.top-this.$searchBlock.outerHeight():w.offset().top+t.top+s+this.$searchBlock.height(),{top:e,left:i,width:this.el.getBoundingClientRect().width}},isDimensionsChangedforListView:function(e,t){return Math.floor(e.top)!==Math.floor(t.top)||Math.floor(e.left)!==Math.floor(t.left)},immediateHandleCondition:function(e){return!this.model.get("expanded")},immediateKeydownHandler:function(e){this.expand(),this.keyboardManager.deferredHandleKeyboardEvent(e)},processKeydown:function(){this.model.set("criteria",this.$input.val())},changeFilter:function(){var e=this;this._getGetData()({criteria:this.model.get("criteria")}).done(function(){e.listView.fetch(function(){e.setValueToList()})})},setValueToList:function(e){var t=this.model.get("value"),i=t.value;if(void 0!==t.index){var s=this.searcheableDataProvider.getReverseIndexMapping(),n=s?s[t.index]:t.index;i={},void 0!==n&&(i[n]=t.value)}this.listView.setValue(i,e)},convertExternalValueToInternalFormat:function(e){var t={};if(void 0!==e)if("string"==typeof e||null===e)t={value:e};else for(var i in e)if(e.hasOwnProperty(i)&&void 0!==e[i]){t="object"===s(e[i])?{value:e[i].value,index:parseInt(i,10),label:e[i].label}:{value:e[i],index:parseInt(i,10)};break}return t},updateValueFromActive:function(){var e=this.model.get("value"),t=this.model.get("activeValue");e.value===t.value&&void 0===e.label&&(e.label=t.label,this.updateControlLabel())},updateControlLabel:function(){var e,t=this.model.get("value"),i=this.$inputBlock.find(".jr-mSingleselect-input-placeholder"),s=this.$inputBlock.find(".jr-mSingleselect-input-selection");r.isEmpty(t)||null==t.value?(i.removeClass("jr-isHidden"),this.render()):(e=this.getControlLabelByValue(t),i.addClass("jr-isHidden"),this.$inputBlock.attr("title",e),s.html(_.hardEscape(e)))},getControlLabelByValue:function(e){return null==e.label?e.value:e.label},fetch:function(e,t){return this.listView.fetch(e,t),this},reset:function(e){return this.listView.reset(e),this},expand:function(){if(!this.model.get("disabled"))return this.model.set("expanded",!0),this},collapse:function(){return this.model.set("expanded",!1),this},getValue:function(){return this.model.get("value").value},setValue:function(e,t){var e=this.convertExternalValueToInternalFormat(e);t&&t.silent&&(this.silent=!0),this.model.set("value",e),this.setValueToList()},setDisabled:function(e){return this.model.set("disabled",e),this},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.$dropDownEl.off("mousedown",this.onMousedown).remove(),this.listView.remove(),this.$dropDownElContainer.remove(),o.View.prototype.remove.call(this),w.off("mousedown",this.onGlobalMousedown).off("dataavailable",this.onGlobalMousedown).off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove)}});i.exports=C}),define("runtime_dependencies/js-sdk/src/common/util/parse/NumberUtils",["require","exports","module","underscore"],function(e,t,i){var s=e("underscore"),n=function(e){function t(e){return"."===e?e="\\.":" "===e&&(e="\\s"),e}e=e||{},this.DECIMAL_SEPARATOR=e.decimalSeparator||".",this.GROUPING_SEPARATOR=e.groupingSeparator||",",this.decimalSeparator=t(this.DECIMAL_SEPARATOR),this.groupingSeparator=t(this.GROUPING_SEPARATOR),this.DECIMAL_NUMBER_PATTERN=new RegExp("^-?([1-9]{1}[0-9]{0,2}("+this.groupingSeparator+"[0-9]{3})*("+this.decimalSeparator+"[0-9]+)?|[1-9]{1}[0-9]{0,}("+this.decimalSeparator+"[0-9]+)?|0("+this.decimalSeparator+"[0-9]+)?)$"),this.INTEGER_NUMBER_PATTERN=new RegExp("^-?([1-9]{1}[0-9]{0,2}("+this.groupingSeparator+"[0-9]{3})*|[1-9]{1}[0-9]{0,}|0)$")};n.prototype.number_format=function(e,t,i,s){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,r=void 0===s?",":s,l=void 0===i?".":i,a=(o?function(e,t){var i=Math.pow(10,t);return""+(Math.round(e*i)/i).toFixed(t)}(n,o):""+Math.round(n)).split(".");return a[0].length>3&&(a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(a[1]||"").length<o&&(a[1]=a[1]||"",a[1]+=new Array(o-a[1].length+1).join("0")),a.join(l)},n.prototype.isInt=function(e){return this.isNumberInt(e)||this.isStringInt(e)},n.prototype.isNumberInt=function(e){return s.isNumber(e)&&!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY&&(e===+e&&e===(0|e)||e%1==0)},n.prototype.isStringInt=function(e){return s.isString(e)&&this.INTEGER_NUMBER_PATTERN.test(e)},n.prototype.isInt32=function(e){return this.isInt(e)&&this.parseNumber(e)>=-2147483648&&this.parseNumber(e)<=2147483647},n.prototype.isDecimal=function(e){return s.isNumber(e)&&!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY||s.isString(e)&&this.DECIMAL_NUMBER_PATTERN.test(e)},n.prototype.parseNumber=function(e){if(s.isNumber(e))return e;if(s.isString(e)&&this.DECIMAL_NUMBER_PATTERN.test(e)){e=e.replace(new RegExp(this.groupingSeparator,"g"),"").replace(new RegExp(this.decimalSeparator,"g"),".");var t=1*e;return t>9007199254740992||t<-9007199254740992?(window.console&&window.console.warn(e+" is out of the ["+-9007199254740992+", 9007199254740992] bounds. Parsing results may be corrupted. Use string representation instead. For more details see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number."),!1):t}},n.prototype.formatNumber=function(e,t){t=t||{};var i=e.toString().split(".")[1],n=i?i.length:0;s.isUndefined(t.decimalPlacesAmount)||(n=t.decimalPlacesAmount);try{return this.number_format(e,n,t.decimalSeparator||this.DECIMAL_SEPARATOR,t.groupingSeparator||this.GROUPING_SEPARATOR)}catch(t){return e.toString()}},i.exports=n}),define("runtime_dependencies/js-sdk/src/components/scalableList/util/domAndCssUtil",["require","exports","module","underscore","jquery"],function(e,t,i){var s=e("underscore"),n=e("jquery");i.exports={doCalcOnVisibleNodeClone:function(e){if(!e||!e.el)throw"Missing required option: el";if(s.defaults(e,{css:{},classes:"",container:"<div/>",appendTo:"body",callback:function(){throw"no callback was defined"},alwaysClone:!1,cloneHandlers:!1}),s.defaults(e.css,{position:"absolute",left:"-9999px"}),!e.alwaysClone&&n(e.el).is(":visible"))e.callback(n(e.el));else{var t=n(e.el).clone(),i=n(e.container).css(e.css).addClass(e.classes).appendTo(n(e.appendTo)).append(t);e.callback(t),i.remove()}}}}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/ListWithSelectionAsObjectHashModel",["require","exports","module","underscore","./BaseListWithSelectionModel"],function(e,t,i){var s=e("underscore"),n=e("./BaseListWithSelectionModel"),o=n.extend({_addToSelection:function(e,t){this.selection[e]=!0},_removeFromSelection:function(e,t){delete this.selection[e]},_clearSelection:function(){this.selection={}},_selectionContains:function(e,t){return this.selection[e]},_getSelection:function(){return s.keys(this.selection)},select:function(e,t){if(this._clearSelection(),"string"==typeof e)this._addToSelection(e);else if(s.isArray(e))for(var i=0;i<e.length;i++)this._addToSelection(e[i]);else if(void 0!==e)for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];void 0!==o&&this._addToSelection(o,n)}this._afterSelect&&this._afterSelect(e,t),this._triggerSelectionChange(t)}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/multiSelect/mixin/scalableListItemHeightCalculationTrait",["require","exports","module","jquery","../../scalableList/model/ScalableListModel","../../../common/util/browserDetection","../../scalableList/util/domAndCssUtil"],function(e,t,i){var s=e("jquery"),n=e("../../scalableList/model/ScalableListModel"),o=e("../../../common/util/browserDetection"),r=e("../../scalableList/util/domAndCssUtil"),l=r.doCalcOnVisibleNodeClone,a={render:function(){return this._itemHeightSet||(this._calcItemHeight(),this._itemHeightSet=!0),this},_calcItemHeight:function(){var e=this;this._model=this.model,this._lazy=this.lazy,this._visibility=this.$el.css("visibility"),this._display=this.$el.css("display"),this.model=new n({getData:function(){var e=new s.Deferred;return e.resolve({total:1,data:[{value:"test value",label:"test label"}]}),e}}),this.$el.css({visibility:"hidden",display:"block"}),this.model.once("change",this.onModelChange,this),this.renderData(),l({el:this.$el,css:{width:"100px"},classes:" jr "+(o.isIPad()?"ipad":""),callback:function(t){e.itemHeight=t.find("li").outerHeight(!0),e.itemsPerChunk=Math.floor(e.defaultChunkHeight/e.itemHeight),e.chunkHeight=e.itemsPerChunk*e.itemHeight}}),this.$el.empty().css({visibility:this._visibility,display:this._display}),delete this._visibility,delete this._display,this.totalItems=void 0,this.$firstViewChunk=void 0,this.model=this._model,delete this._model,this.lazy=this._lazy,this._lazy&&delete this._lazy},_calcViewPortConstants:function(){if(!this.viewPortConstantsInitialized){if(!this._itemHeightSet)return;this._calcViewPortHeight(),this._renderViewChunks(!0),this._renderItems(),this.viewPortConstantsInitialized=!0}}};i.exports=a}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/availableItemsTemplate.htm",[],function(){return'<div class="jr-mMultiselect-search jr">\n\n    <js-templateNonce></js-templateNonce>\n    <input class="jr-mInput-search jr" type="text" placeholder="{{- i18n[\'sic.multiselect.search\']}}">\n</div>\n\n<div class="jr-mMultiselect-list jr"></div>\n\n<div class="jr-mMultiselect-buttonContainer jr">\n    <ul class="jr-mItemselector jr">\n        <li  title="{{- i18n[\'sic.multiselect.selectAll\'] }}" class="jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectAll">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-checkmark jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.selectAll\'] }}</span>\n            </a>\n        </li>\n\n        <li  title="{{- i18n[\'sic.multiselect.deselectAll\'] }}" class="jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectNone">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-cancel jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.deselectAll\'] }}</span>\n            </a>\n        </li>\n\n        <li  title="{{- i18n[\'sic.multiselect.inverse\'] }}" class="jr-mItemselector-button jr-uWidth-40pc jr jr-jInvert">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-invert jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.inverse\'] }}</span>\n            </a>\n        </li>\n    </ul>\n</div>\n'}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/availableItemsTemplate_IE10_11.htm",[],function(){return'<div class="jr-mMultiselect-search jr">\n\n    <js-templateNonce></js-templateNonce>\n    <input class="jr-mInput-search jr" type="text">\n</div>\n\n<div class="jr-mMultiselect-list jr"></div>\n\n<div class="jr-mMultiselect-buttonContainer jr">\n    <ul class="jr-mItemselector jr">\n        <li  title="{{- i18n[\'sic.multiselect.selectAll\'] }}" class="jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectAll">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-checkmark jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.selectAll\'] }}</span>\n            </a>\n        </li>\n\n        <li  title="{{- i18n[\'sic.multiselect.deselectAll\'] }}" class="jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectNone">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-cancel jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.deselectAll\'] }}</span>\n            </a>\n        </li>\n\n        <li  title="{{- i18n[\'sic.multiselect.inverse\'] }}" class="jr-mItemselector-button jr-uWidth-40pc jr jr-jInvert">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-invert jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.inverse\'] }}</span>\n            </a>\n        </li>\n    </ul>\n</div>'}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/listTemplate.htm",[],function(){return'<div class="jr-mScalablelist jr j-scalable-list" onselectstart="return false" unselectable="on" ondragstart="return false" draggable="false">\n\n    <js-templateNonce></js-templateNonce>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/multiSelect/view/AvailableItemsList",["require","exports","module","jquery","backbone","underscore","../../../common/util/browserDetection","bundle!ScalableInputControlsBundle","../../singleSelect/manager/KeyboardManager","../../scalableList/view/ListWithNavigation","../../scalableList/util/domAndCssUtil","../../scalableList/model/listWithNavigationModelTrait","../../scalableList/model/ListWithSelectionAsObjectHashModel","../mixin/scalableListItemHeightCalculationTrait","text!../templates/availableItemsTemplate.htm","text!../templates/availableItemsTemplate_IE10_11.htm","text!../templates/listTemplate.htm"],function(e,t,i){var s=e("jquery"),n=e("backbone"),o=e("underscore"),r=e("../../../common/util/browserDetection"),l=e("bundle!ScalableInputControlsBundle"),a=e("../../singleSelect/manager/KeyboardManager"),h=e("../../scalableList/view/ListWithNavigation"),c=e("../../scalableList/util/domAndCssUtil"),d=e("../../scalableList/model/listWithNavigationModelTrait"),u=e("../../scalableList/model/ListWithSelectionAsObjectHashModel"),p=e("../mixin/scalableListItemHeightCalculationTrait"),m=e("text!../templates/availableItemsTemplate.htm"),f=e("text!../templates/availableItemsTemplate_IE10_11.htm"),g=e("text!../templates/listTemplate.htm"),v=c.doCalcOnVisibleNodeClone,b=[{selector:".jr-jSelectAll",strings:[l["sic.multiselect.selectAll"],l["sic.multiselect.all"],""]},{selector:".jr-jSelectNone",strings:[l["sic.multiselect.deselectAll"],l["sic.multiselect.none"],""]},{selector:".jr-jInvert",strings:[l["sic.multiselect.inverse"],""]}],_=n.View.extend({className:"jr-mMultiselect-listContainer jr-isActive jr",events:function(){return{"keydown input.jr-mInput-search":this.keyboardManager.onKeydown,"focus input.jr-mInput-search":"onFocus","blur input.jr-mInput-search":"onBlur","click .jr-jSelectAll":"onSelectAll","click .jr-jSelectNone":"onSelectNone","click .jr-jInvert":"onInvertSelection","click input.jr-mInput-search":"onClickOnInput","touchend input.jr-mInput-search":"onClickOnInput",mousedown:"onMousedown",mouseup:"onMouseup"}},keydownHandlers:o.extend({65:"onAKey"},a.prototype.keydownHandlers),initialize:function(e){o.bindAll(this,"onGlobalMouseup","onGlobalMousedown","onResize","onGlobalMousemove","onMousedown","onMouseup","onEscKey","onSelectAll","onSelectNone","onInvertSelection"),this._debouncedOnResize=o.debounce(this.onResize,500),this.model||(this.model=new n.Model),this.model.set("criteria","",{silent:!0});var t;t=r.isIE10()||r.isIE11()?f:m,this.label=e.label,this.template=o.template(e.availableItemsTemplate||t),this.keyboardManager=new a({keydownHandlers:this.keydownHandlers,keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0}),this.listViewModel=this._createListViewModel(e),this.setValue(e.value,{silent:!0}),this.listView=this._createListView(e),this.render(),this.initListeners()},_createListViewModel:function(e){this.getData=e.getData;var t=u.extend(d);return e.listViewModel||new t({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor})},_createListView:function(e){var t=e.listView||new h({el:e.listElement||s(g),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate,scrollTimeout:e.scrollTimeout,lazy:!0,selectedClass:"jr-isSelected",selection:{allowed:!0,multiple:!0}});return o.extend(t,p),t},initListeners:function(){this.listenTo(this.listView,"active:changed",this.activeChange,this),this.listenTo(this.listView,"mousedown",this.onMousedown,this),this.listenTo(this.listView,"render:data",this.onRenderData,this),this.listenTo(this.listView,"listRenderError",this.listRenderError,this),this.listenTo(this.listViewModel,"change",this.onListViewModelChanged,this),this.listenTo(this.listViewModel,"selection:clear",this.selectionClear,this),this.listenTo(this.listViewModel,"selection:add",this.selectionAdd,this),this.listenTo(this.listViewModel,"selection:addRange",this.selectionAddRange,this),this.listenTo(this.listViewModel,"selection:remove",this.selectionRemove,this),this.listenTo(this.model,"change:totalValue",this.onChangeTotalValue,this),this.listenTo(this.model,"change:value",this.changeValue,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),this.listenTo(this.model,"change:criteria",this.changeFilter,this),s("body").on("mousedown",this.onGlobalMousedown).on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove),s(window).on("resize",this._debouncedOnResize)},render:function(){return this.$el.empty(),this.$el.append(s(this.template(this.getModelForRendering()))),this.listView.undelegateEvents(),this.$el.find(".jr-mMultiselect-list").append(this.listView.el),this.listView.render(),this.listView.fetch(o.bind(this.listView.resize,this.listView)),this.listView.delegateEvents(),this._tuneCSS(),this.setBulkSelectionText(),this},_tuneCSS:function(){var e=this;this._paddingHeightsSet||(v({el:this.$el,css:{width:"500px"},classes:"jr "+(r.isIPad()?"ipad":""),callback:function(t){e.searchBarHeight=Math.round(t.find(".jr-mMultiselect-search").outerHeight()),e.buttonsContainerHeight=Math.round(t.find(".jr-mMultiselect-buttonContainer").outerHeight())}}),this._paddingHeightsSet=!0),this.$el.find(".jr-mMultiselect-list").css({height:"100%","padding-top":this.searchBarHeight,"padding-bottom":this.buttonsContainerHeight})},renderData:function(){return this.listView.renderData(),this},activeChange:function(e){e&&(this.activeChangedWithShift&&(delete this.activeChangedWithShift,this.listViewModel.addRangeToSelection(e.value,e.index)),this.listView.scrollTo(e.index))},selectionAdd:function(e){this.model.get("value")[e.value]=!0,this.model.trigger("change:value")},selectionAddRange:function(e){var t=e.selection,i=this.model.get("value"),s=0,n=t.length;for(s;s<n;s+=1)i[t[s]]=!0;this.model.trigger("change:value")},selectionRemove:function(e){delete this.model.get("value")[e.value],this.model.trigger("change:value")},selectionClear:function(){this.model.attributes.value={}},onSelectAll:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.clearFilter(o.bind(this.listView.selectAll,this.listView)))},onSelectNone:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.clearFilter(o.bind(this.listView.selectNone,this.listView)))},onInvertSelection:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.clearFilter(o.bind(this.listView.invertSelection,this.listView)))},onRenderData:function(){this.trigger("render:data")},listRenderError:function(e,t){this.trigger("listRenderError",e,t)},onListViewModelChanged:function(){if(void 0===this.model.get("totalValues")){var e=this.listViewModel.get("total");o.isNumber(e)&&!o.isNaN(e)&&this.model.set("totalValues",e)}},onChangeTotalValue:function(){this.listView.resize()},setBulkSelectionText:function(){if(this.$el.is(":visible")){var e=this.$el.outerWidth();if(e!==this._componentWidth){this._componentWidth=e;var t=this.$el.find(".jr-mMultiselect-buttonContainer"),i=t.outerWidth();v({el:t,css:{left:0-2*i+"px",width:i+"px"},classes:"jr "+(r.isIPad()?"ipad":""),alwaysClone:!0,callback:function(e){o.each(b,function(i){var s=!1;o.each(i.strings,function(n){if(!s){var o=e.find(i.selector),r=o.find(".jr-mItemselector-button-label span").text(n);(o[0].getBoundingClientRect().right-r[0].getBoundingClientRect().right>=3||""===n)&&(s=!0,t.find(i.selector+" .jr-mItemselector-button-label span").text(n))}})})}})}}},changeValue:function(){this.trigger("selection:change",this.getValue())},changeDisabled:function(){var e=this.model.get("disabled");e?this.$el.find("input[type='text']").attr("disabled","disabled"):this.$el.find("input[type='text']").removeAttr("disabled"),this.listView.setDisabled(e)},onClickOnInput:function(){this.onFocus()},onFocus:function(){var e=this.$el.find("input");e.val()==e.attr("placeholder")&&(e.val(""),e.removeClass("jr-mMultiselect-input-placeholder"))},onBlur:function(){var e=this.$el.find("input");if(""!==e.val()&&e.val()!==e.attr("placeholder")||(e.addClass("jr-mMultiselect-input-placeholder"),e.val(e.attr("placeholder"))),this.preventBlur)return!1},onMousedown:function(){r.isIPad()||(this.preventBlur=!0)},onMouseup:function(){this.preventBlur&&(delete this.preventBlur,this.$el.find("input.jr-mInput-search").focus())},onGlobalMousedown:function(e){this.preventBlur&&e.target!==this.el&&0===this.$el.find(e.target).length&&(delete this.preventBlur,this.onBlur())},onGlobalMouseup:function(){this.onMouseup()},onGlobalMousemove:function(e){this.preventBlur&&e.stopPropagation()},onResize:function(){this.resize()},onUpKey:function(e){var t=this;this._onUpDownNavigation(e,function(){t.listView.activatePrevious()},function(){t.listView.activateLast()})},onDownKey:function(e){var t=this;this._onUpDownNavigation(e,function(){t.listView.activateNext()},function(){t.listView.activateFirst()})},_onUpDownNavigation:function(e,t,i){var s,n=this.listView.getActiveValue();n?(e.shiftKey&&(this.activeChangedWithShift=!0),t(),s=this.listView.getActiveValue(),s.index===n.index&&i()):i()},onEnterKey:function(e){e.preventDefault();var t=this.listView.getActiveValue();t&&(e.shiftKey?this.listViewModel.addRangeToSelection(t.value,t.index):e.ctrlKey||e.metaKey?(this.listViewModel.clearSelection(),this.listViewModel.addValueToSelection(t.value,t.index)):this.listViewModel.toggleSelection(t.value,t.index))},onEscKey:function(){},onHomeKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateFirst()},onEndKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateLast()},onPageUpKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.pageUp()},onPageDownKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.pageDown()},onTabKey:function(){},onAKey:function(e){e.ctrlKey||e.metaKey?(e.stopPropagation(),this.onSelectAll()):this.keyboardManager.deferredHandleKeyboardEvent(e)},processKeydown:function(){this.model.set("criteria",this.$el.find("input.jr-mInput-search").val())},changeFilter:function(e){var t=this,i=this.model.get("criteria");void 0!==i&&""!==i||this.model.unset("totalValues",{silent:!0}),this.listView.scrollTo(0),t.listView.activate(null,{silent:!0}),this.getData({criteria:i,offset:0,limit:1}).done(function(){t.listViewModel.once("change",e&&"function"==typeof e?e:function(){t.listView.setValue(o.keys(t.model.get("value")),{silent:!0}),t.listView.activate(0)}),t.listView.fetch()})},clearFilter:function(e){this.model.get("criteria")?(this.$el.find("input").val(""),this.model.set("criteria","",{silent:!0}),this.changeFilter(e)):(this.model.unset("totalValues",{silent:!0}),e&&e())},processSelectionThroughApi:function(e,t){var i={},s=0,n=e.length;for(this.selectionClear(),s;s<n;s+=1)i[e[s]]=!0;this.model.attributes.value=i,t&&t.silent||this.model.trigger("change:value")},convertSelectionForListViewModel:function(e){return e},getModelForRendering:function(){return{label:this.label,isIPad:r.isIPad(),disabled:this.model.get("disabled"),i18n:l}},fetch:function(e,t){var i=this.model.get("criteria");void 0!==i&&""!==i||this.model.unset("totalValues",{silent:!0}),this.listView.fetch(e,t)},resize:function(){this.listView.resize(),this.setBulkSelectionText()},reset:function(e){var t=this;this.clearFilter(function(){t.listView.reset(e)})},getValue:function(){return o.keys(this.model.get("value"))},setValue:function(e,t){t=t||{},this.listViewModel.once("selection:change",function(){this.selectionClear()
;var e=this.listViewModel.getSelection(),i=0,s=e.length;for(i;i<s;i++)this.model.attributes.value[e[i]]=!0;t&&t.silent||this.changeValue()},this),o.isArray(e)||"string"==typeof e||(e=this.convertSelectionForListViewModel(e)),this.listViewModel.select(e,t.modelOptions)},setDisabled:function(e){this.model.set("disabled",e)},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.listView.remove(),n.View.prototype.remove.call(this),s("body").off("mousedown",this.onGlobalMousedown).off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove),s(window).off("resize",this._debouncedOnResize)}});i.exports=_}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/selectedItemsTemplate.htm",[],function(){return'\x3c!--\nthis input only for technical purposes:\nit allows selected items list to get focus\nand have proper tab position\n(simple tabindex="0" on DOM element will broke tab index sequence)\n--\x3e\n\n    <js-templateNonce></js-templateNonce>\n<div class="jr-mMultiselect-list jr">\n    <input type="text" style="position: absolute; left: -9999px" {{ if (disabled) { }}disabled="disabled"{{ } }}>\n    \x3c!-- list position --\x3e\n    <div class="jr-mMultiselect-list-message jr-isHidden jr">\n        {{- i18n[\'sic.multiselect.noSelection\'] }}\n    </div>\n</div>'}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/selectedItemsListTemplate.htm",[],function(){return'<ul class="jr-mSelectlist jr-mSelectlistSelected jr" style="top: {{- top}}px; position: relative;">\n\n    <js-templateNonce></js-templateNonce>\n    {{_.each(items, function(item) { }}\n    <li class="jr-mSelectlist-item jr-isSelected {{ if (item.active) print(\' jr-isHovered\'); }} jr" title="{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}" data-index="{{- item.index}}">\n        <div class="jr-mSelectlist-item-wrapper jr">\n            <a class="jr-mSelectlist-item-delete jr"></a>\n            <a class="jr-mSelectlist-item-text jr">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}</a>\n        </div>\n    </li>\n    {{ }); }}\n</ul>\n'}),define("runtime_dependencies/js-sdk/src/components/multiSelect/view/ListViewForSelectedItemsList",["require","exports","module","jquery","../../scalableList/view/ListWithNavigation"],function(e,t,i){var s=e("jquery"),n=e("../../scalableList/view/ListWithNavigation"),o=n.extend({_multiSelect:function(e,t,i){s(e.target).hasClass("jr-mSelectlist-item-delete")?this.model.selectionContains(t,i)||this._singleSelect(e,t,i):n.prototype._multiSelect.call(this,e,t,i)}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/multiSelect/view/SelectedItemsList",["require","exports","module","jquery","backbone","underscore","../../../common/util/browserDetection","bundle!ScalableInputControlsBundle","../../singleSelect/manager/KeyboardManager","../../scalableList/model/ListWithSelectionModel","../../scalableList/model/listWithNavigationModelTrait","../mixin/scalableListItemHeightCalculationTrait","text!../templates/selectedItemsTemplate.htm","text!../templates/selectedItemsListTemplate.htm","text!../templates/listTemplate.htm","../view/ListViewForSelectedItemsList"],function(e,t,i){var s=e("jquery"),n=e("backbone"),o=e("underscore"),r=e("../../../common/util/browserDetection"),l=e("bundle!ScalableInputControlsBundle"),a=e("../../singleSelect/manager/KeyboardManager"),h=e("../../scalableList/model/ListWithSelectionModel"),c=e("../../scalableList/model/listWithNavigationModelTrait"),d=e("../mixin/scalableListItemHeightCalculationTrait"),u=e("text!../templates/selectedItemsTemplate.htm"),p=e("text!../templates/selectedItemsListTemplate.htm"),m=e("text!../templates/listTemplate.htm"),f=e("../view/ListViewForSelectedItemsList"),g=n.View.extend({className:"jr-mMultiselect-listContainer jr-isInactive jr",events:function(){return{"keydown input":this.keyboardManager.onKeydown,"focus input":"onFocus","blur input":"onBlur","mouseup .jr-mSelectlist-item-delete":"onMouseupOnDeleteButton",mousedown:"onMousedown",mouseup:"onMouseup"}},keydownHandlers:o.extend({65:"onAKey",8:"onDeleteKey",46:"onDeleteKey"},a.prototype.keydownHandlers),initialize:function(e){this.model||(this.model=new n.Model),this.model.set("focused",!1,{silent:!0}),this.template=o.template(u),this.keyboardManager=new a({keydownHandlers:this.keydownHandlers,keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0});var t=h.extend(c);this.listViewModel=e.listViewModel||new t({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor}),this.listView=e.listView||o.extend(new f({el:e.listElement||s(m),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate||p,scrollTimeout:e.scrollTimeout,lazy:!0,selectedClass:"is-selected",selection:{allowed:!0,multiple:!1}}),d),this.initListeners(),this.render().resize()},initListeners:function(){this.listenTo(this.listView,"active:changed",this.activeChange,this),this.listenTo(this.model,"change:focused",this.focusStateChanged,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),this.listenTo(this.listViewModel,"change",this.onModelChange,this)},render:function(){this.listView.undelegateEvents();var e=s(this.template({disabled:this.model.get("disabled"),i18n:l}));return this.$el.empty().append(e).find(".jr-mMultiselect-list").append(this.listView.el),this.listView.render(),this.listView.delegateEvents(),this},renderData:function(){return this.listView.renderData(),this},activeChange:function(e){e?this.listView.scrollTo(e.index):this.listViewModel.clearSelection()},changeDisabled:function(){var e=this.model.get("disabled");e?(this.$el.find("input[type='text']").attr("disabled","disabled"),this.listView.setValue({}),this.listView.activate(void 0)):this.$el.find("input[type='text']").removeAttr("disabled"),this.listView.setDisabled(e)},focusStateChanged:function(){this.model.get("focused")?this.$el.find(".mSelect-svListPlaceholder").addClass("focused"):this.$el.find(".mSelect-svListPlaceholder").removeClass("focused")},onModelChange:function(){this.listViewModel.get("total")?this.listView.$el.show():this.listView.$el.hide()},onFocus:function(){this.model.set("focused",!0)},onBlur:function(){this.preventBlur||this.model.set("focused",!1)},onMouseupOnDeleteButton:function(e){this.onDeleteKey(e)},onMousedown:function(){r.isIPad()||(this.preventBlur=!0,this.model.get("focused")||this.$el.find("input").focus())},onMouseup:function(){this.preventBlur&&(this.$el.find("input").focus(),delete this.preventBlur)},onUpKey:function(e){this.listView.activatePrevious()},onDownKey:function(e){this.listView.getActiveValue()?this.listView.activateNext():this.listView.activateFirst()},onEnterKey:function(e){},onHomeKey:function(e){this.listView.activateFirst()},onEndKey:function(e){this.listView.activateLast()},onPageUpKey:function(e){this.listView.pageUp()},onPageDownKey:function(e){this.listView.pageDown()},onTabKey:function(){},onAKey:function(e){},onDeleteKey:function(e){var t=this.listView.getValue();if(t&&t.length>0){var i=!0;for(var s in t)if(t.hasOwnProperty(s)&&void 0!==t[s]){i=!1;break}i||this.trigger("selection:remove",t)}},fetch:function(e,t){this.listView.setValue({}),this.listView.activate(void 0),this.listView.fetch(e,t)},resize:function(){this.listView.resize()},setDisabled:function(e){this.model.set("disabled",e)},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.listView.remove(),n.View.prototype.remove.call(this)}});i.exports=g}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/multiSelectTemplate.htm",[],function(){return'<div class="jr-mMultiselect-toggleContainer jr">\n\n    <js-templateNonce></js-templateNonce>\n    <div class="jr-mMultiselect-toggle jr-mMultiselect-toggleAvailable jr-isActive jr" title="">\n        <span class="jr-mMultiselect-toggle-label jr" title=""></span>\n    </div>\n    <div class="jr-mMultiselect-toggle jr-mMultiselect-toggleSelected jr-isInactive jr">\n        <span class="jr-mMultiselect-toggle-label jr" title=""></span>\n    </div>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/CacheableDataProvider",["require","exports","module","jquery","underscore"],function(e,t,i){var s=e("jquery"),n=e("underscore"),o=function(e){n.bindAll(this,"getData","getAllCachedData"),this.data=e||[]};n.extend(o.prototype,{setData:function(e){this.data=e||[]},getAllCachedData:function(){return this.data},getData:function(e){var t=new s.Deferred,i=e&&e.offset?e.offset:0,n=e&&e.limit?i+e.limit:this.data.length,o=this._getDataSegment(this.data,i,n);return t.resolve({data:o,total:this.data.length}),t.promise()},_getDataSegment:function(e,t,i){i=Math.min(i,e.length);for(var s=[],n=t;n<i;n++)s.push({label:e[n].label,value:e[n].value});return s}}),i.exports=o}),define("runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/SelectedItemsDataProvider",["require","exports","module","underscore","../../singleSelect/dataprovider/CacheableDataProvider"],function(e,t,i){var s=e("underscore"),n=e("../../singleSelect/dataprovider/CacheableDataProvider"),o=function(e){e=e||{},s.defaults(e,{sortFunc:this._sortFunc,formatLabel:this._formatLabel}),this.sortFunc=e.sortFunc,this.formatLabel=e.formatLabel,n.call(this,e.data)};s.extend(o.prototype,n.prototype),s.extend(o.prototype,{setData:function(e){e=this._convertToStandardData(e),e=this._sortData(e),n.prototype.setData.call(this,e)},_sortFunc:function(e,t){return e.label.localeCompare(t.label)},_formatLabel:function(e){return e},_sortData:function(e){return e=e||[],e.sort(this.sortFunc)},_convertToStandardData:function(e){var t=this;return s.map(e,function(e){return{value:e,label:t.formatLabel(e)}})}}),i.exports=o}),define("text!runtime_dependencies/js-sdk/src/components/sizer/template/sizerTemplate.htm",[],function(){return'<div class="jr-mSizer jr-mSizerVertical ui-resizable-s jr">\n\n    <js-templateNonce></js-templateNonce>\n    <span class="ui-icon ui-icon-grip-solid-horizontal"></span>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/sizer/Sizer",["require","exports","module","jquery","backbone","underscore","text!./template/sizerTemplate.htm","../../common/logging/logger","jquery-ui/ui/widgets/resizable"],function(e,t,i){var s=e("jquery"),n=e("backbone"),o=e("underscore"),r=e("text!./template/sizerTemplate.htm"),l=e("../../common/logging/logger");e("jquery-ui/ui/widgets/resizable");var a=l.register("Sizer");i.exports=n.View.extend({template:o.template(r),el:function(){return this.template()},initialize:function(e){this.container=e.container,this.sizerOptions=o.clone(e),delete this.sizerOptions.container,this.$container=s(this.container),this.render()},render:function(){return o.defaults(this.sizerOptions,{minHeight:this.$container.height(),handles:{s:this.$el}}),this.$container.resizable(this.sizerOptions),this},show:function(){return this.$el.removeClass("jr-isInvisible"),this},hide:function(){return this.$el.addClass("jr-isInvisible"),this},updateMinMax:function(e){this.$container.resizable("option","minHeight",e.minHeight),this.$container.resizable("option","maxHeight",e.maxHeight)},remove:function(){try{this.$container.resizable("destroy")}catch(e){a.debug(e)}n.View.prototype.remove.apply(this,arguments)}})}),define("runtime_dependencies/js-sdk/src/components/multiSelect/view/MultiSelect",["require","exports","module","jquery","backbone","underscore","../../singleSelect/dataprovider/SearcheableDataProvider","../../../common/util/parse/NumberUtils","../../scalableList/util/domAndCssUtil","../../../common/util/browserDetection","bundle!ScalableInputControlsBundle","../../../common/util/xssUtil","../view/AvailableItemsList","../view/SelectedItemsList","text!../templates/multiSelectTemplate.htm","../dataprovider/SelectedItemsDataProvider","../../sizer/Sizer"],function(e,t,i){var s=e("jquery"),n=e("backbone"),o=e("underscore"),r=e("../../singleSelect/dataprovider/SearcheableDataProvider"),l=e("../../../common/util/parse/NumberUtils"),a=e("../../scalableList/util/domAndCssUtil"),h=e("../../../common/util/browserDetection"),c=e("bundle!ScalableInputControlsBundle"),d=e("../../../common/util/xssUtil"),u=e("../view/AvailableItemsList"),p=e("../view/SelectedItemsList"),m=e("text!../templates/multiSelectTemplate.htm"),f=e("../dataprovider/SelectedItemsDataProvider"),g=e("../../sizer/Sizer"),v=a.doCalcOnVisibleNodeClone,b=new l;i.exports=n.View.extend({className:"jr-mMultiselect jr",events:function(){return{"click  .jr-mMultiselect-toggle":"toggleLists"}},initialize:function(e){this.template=o.template(m),this.i18n={selected:c["sic.multiselect.toggle.selected"],available:c["sic.multiselect.toggle.available"]},this.heightAutoAdjustment=!!o.isUndefined(e.heightAutoAdjustment)||e.heightAutoAdjustment,this.availableItemsListModel=this._createAvailableItemsListModel(e),this.availableItemsList=this._createAvailableItemsList(e),this.selectedItemsDataProvider=this._createSelectedItemsListDataProvider(e),this.selectedItemsList=this._createSelectedItemsList(e),this.height=e.height,this.resizable=e&&e.resizable,this.initListeners(),void 0!==e.value&&(this.silent=!0,this.availableItemsList.setValue(e.value)),e&&e.resizable&&(this.sizer=new g({container:this.$el,stop:o.bind(function(){this.resize()},this)})),this.render()},_createAvailableItemsListModel:function(e){return new n.Model},_createAvailableItemsList:function(e){return e.availableItemsList||new u({model:this.availableItemsListModel,getData:new r({getData:e.getData}).getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout})},_createSelectedItemsListDataProvider:function(e){return e.selectedItemsDataProvider||new f(e.selectedListOptions)},_createSelectedItemsList:function(e){return this.formatValue=e.formatValue,new p({getData:this.selectedItemsDataProvider.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout})},initListeners:function(){this.listenTo(this.availableItemsList,"selection:change",this.selectionChange,this),this.listenTo(this.availableItemsList,"listRenderError",this.listRenderError,this),this.listenTo(this.availableItemsListModel,"change:totalValues",this._availableItemsTotalCountChange,this),this.listenTo(this.selectedItemsList,"selection:remove",this.selectionRemoved,this)},render:function(){return this.sizer&&this.sizer.$el.detach(),this.$el.html(s(this.template({i18n:c}))),this.$toggleContainer=this.$el.find(".jr-mMultiselect-toggleContainer"),this.availableItemsList.undelegateEvents(),this.selectedItemsList.undelegateEvents(),this.selectedItemsList.$el.insertAfter(this.$toggleContainer),this.availableItemsList.$el.insertAfter(this.$toggleContainer),this.availableItemsList.render(),this.selectedItemsList.render(),this._updateAvailableItemsCountLabel(),this._updateSelectedItemsCountLabel(),this.availableItemsList.delegateEvents(),this.selectedItemsList.delegateEvents(),this._tuneCSS(),this._renderSizer(),this},_renderSizer:function(){this.sizer&&(this.heightAutoAdjustment&&this._handleHeight(),this.$el.append(this.sizer.$el))},_tuneCSS:function(){var e=this;this._cssDepententSizesSet||(v({el:this.$el,css:{width:"500px"},classes:"jr",alwaysClone:!0,callback:function(t){e.toggleContainerHeight=t.find(".jr-mMultiselect-toggleContainer").outerHeight(),e._tuneCSSInternal(t),t.find(".jr-mScalablelist").css({height:"0"}),e._emptyContainerHeight=t.outerHeight();var i;i=e.height?e.height:e._calcHeightByItemsCount(10),e.$el.css("height",i)}}),this._cssDepententSizesSet=!0),this._tuneCSSInternal(this.$el)},_tuneCSSInternal:function(e){var t=this.toggleContainerHeight;h.isIPad()&&this.$el.addClass("ipad"),e.find(".jr-mMultiselect-listContainer").css("padding-top",t)},listRenderError:function(e,t){this.trigger("listRenderError",e,t)},toggleLists:function(e){e.stopPropagation(),s(e.currentTarget).hasClass("jr-isActive")||(this.$el.find(".jr-mMultiselect-toggle").toggleClass("jr-isActive jr-isInactive"),this.$el.find(".jr-mMultiselect-listContainer").toggleClass("jr-isActive jr-isInactive"),h.isIPad()||this.$el.find(".jr-mMultiselect-listContainer.jr-isActive input").focus())},selectionChange:function(e){clearTimeout(this.selectionChangeTimeout),this.selectionChangeTimeout=setTimeout(o.bind(this.selectionChangeInternal,this,e),100)},selectionRemoved:function(e){var t,i=this.availableItemsList.model.get("value"),s=e.length;for(t=0;t<s;t+=1)delete i[e[t]];this.availableItemsList.setValue(o.keys(i))},selectionChangeInternal:function(e){var t=this,i=this.selectedItemsList.listView.getActiveValue(),s=this.selectedItemsList.listView.$el.scrollTop();this.selectedItemsDataProvider.setData(e),this.selectedItemsList.fetch(function(){if(t._updateSelectedItemsCountLabel(),t.selectedItemsList.resize(),t.selectedItemsList.listView.$el.scrollTop(s),i&&t.selectedItemsList.$el.hasClass("j-active")){var e=t.selectedItemsList.listView.model.get("total");e&&e>i.index?t.selectedItemsList.listView.activate(i.index):e&&t.selectedItemsList.listView.activate(i.index-1)}}),this.silent?delete this.silent:this.triggerSelectionChange()},_setToggleLabel:function(e,t,i){var s=b.formatNumber(t),n=this.$el.find(e+" .jr-mMultiselect-toggle-label"),o=i+": "+s;n.text(o).attr("title",d.hardEscape(o))},_handleHeight:function(){var e=this.availableItemsList.model.get("totalValues")||0;if(this._cssDepententSizesSet&&e){var t=this.$el.height(),i=this.$el.height(),s=this._calcHeightByItemsCount(3),n=this._calcHeightByItemsCount(e);e<=10?s=n=i=this._calcHeightByItemsCount(Math.max(3,e)):t>n&&(i=this._calcHeightByItemsCount(e)),this.$el.css("height",i+"px"),this._updateSizerVisibility({minHeight:s,maxHeight:n})}},_updateSizerVisibility:function(e){this.sizer&&(this.sizer.updateMinMax(e),e.minHeight===e.maxHeight?this.sizer.hide():this.sizer.show())},_calcHeightByItemsCount:function(e){return e*this.availableItemsList.listView.itemHeight+this._emptyContainerHeight},_availableItemsTotalCountChange:function(){this._updateAvailableItemsCountLabel(),this.heightAutoAdjustment&&this._handleHeight()},_updateAvailableItemsCountLabel:function(){var e=this.availableItemsList.model.get("totalValues")||0;this._setToggleLabel(".jr-mMultiselect-toggleAvailable",e||0,this.i18n.available)},_updateSelectedItemsCountLabel:function(){var e=this.$el.find(".jr-mMultiselect-list-message"),t=this.selectedItemsList.listView.model.get("total")||0;this._setToggleLabel(".jr-mMultiselect-toggleSelected",t,this.i18n.selected),0===t?e.removeClass("jr-isHidden"):e.addClass("jr-isHidden")},triggerSelectionChange:function(){this.trigger("selection:change",this.getValue())},renderData:function(){return this.availableItemsList.renderData(),this.selectedItemsList.renderData(),this},fetch:function(e,t){this.availableItemsList.fetch(e,t)},reset:function(e){this.availableItemsList.reset(e)},resize:function(){o.debounce(o.bind(function(){this.availableItemsList.resize(),this.selectedItemsList.resize()},this),500)()},setValue:function(e,t){t&&t.silent&&(this.silent=!0),delete t.silent,this.availableItemsList.setValue(e,t)},getValue:function(){var e=this.availableItemsList.getValue(),t=[],i=0;for(var s in e)e.hasOwnProperty(s)&&void 0!==e[s]&&(t[i++]=e[s]);return t},setDisabled:function(e){return this.availableItemsList.setDisabled(e),this.selectedItemsList.setDisabled(e),this},getDisabled:function(){return this.availableItemsList.getDisabled()},remove:function(){this.availableItemsList.remove(),this.selectedItemsList.remove(),this.sizer&&this.sizer.remove(),n.View.prototype.remove.call(this)}})}),define("runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/DataProviderWithLabelHash",["require","exports","module","underscore","../../singleSelect/dataprovider/CacheableDataProvider"],function(e,t,i){var s=e("underscore"),n=e("../../singleSelect/dataprovider/CacheableDataProvider"),o=function(){n.apply(this,arguments)};s.extend(o.prototype,n.prototype),s.extend(o.prototype,{setData:function(e){n.prototype.setData.call(this,e),this.dataLabelsHash={};for(var t=0;t<this.data.length;t++)this.dataLabelsHash[this.data[t].value]=this.data[t].label},getDataLabelHash:function(){return this.dataLabelsHash}}),i.exports=o}),define("runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory",["require","exports","module"],function(e,t,i){i.exports={create:function(e){return function(t,i){return t.label===e?-1:i.label===e?1:t.label.localeCompare(i.label)}}}}),define("runtime_dependencies/js-sdk/src/common/util/datetime/RelativeDate",["require","exports","module","underscore"],function(e,t,i){var s=e("underscore"),n=function(e,t,i){this.setKeyword(e),this.setSign(t),this.setNumber(i)};n.prototype.setKeyword=function(e){this.keyword=e.toUpperCase()},n.prototype.setSign=function(e){this.sign=e},n.prototype.setNumber=function(e){if(s.isNumber(e))this.number=e;else{var t=parseInt(e,10);isNaN(t)?this.number=0:this.number=t}},n.prototype.toString=function(){return s.isNumber(this.number)&&!isNaN(this.number)&&this.number>0&&("+"===this.sign||"-"===this.sign)&&this.keyword in n.PATTERNS?this.keyword+this.sign+this.number.toString():this.keyword in n.PATTERNS?this.keyword:""},n.PATTERNS={DAY:/^(DAY)(([+|\-])(\d{1,9}))?$/i,WEEK:/^(WEEK)(([+|\-])(\d{1,9}))?$/i,MONTH:/^(MONTH)(([+|\-])(\d{1,9}))?$/i,QUARTER:/^(QUARTER)(([+|\-])(\d{1,9}))?$/i,SEMI:/^(SEMI)(([+|\-])(\d{1,9}))?$/i,YEAR:/^(YEAR)(([+|\-])(\d{1,9}))?$/i},n.parse=function(e){if(n.isValid(e))for(var t in n.PATTERNS){var i=n.PATTERNS[t].exec(e);if(null!==i&&s.isArray(i)&&5===i.length)return new n(i[1],i[3],i[4])}},n.isValid=function(e){if(e instanceof n)return""!==e.toString();if(s.isString(e))for(var t in n.PATTERNS)if(n.PATTERNS[t].test(e))return!0;return!1},i.exports=n}),define("runtime_dependencies/js-sdk/src/common/util/datetime/RelativeTimestamp",["require","exports","module","./RelativeDate","underscore"],function(e,t,i){var s=e("./RelativeDate"),n=e("underscore"),o=function(){s.apply(this,arguments)},r=function(){};r.prototype=s.prototype,o.prototype=new r,o.prototype.constructor=o,o.PATTERNS={DAY:/^(DAY)(([+|\-])(\d{1,9}))?$/i,WEEK:/^(WEEK)(([+|\-])(\d{1,9}))?$/i,MONTH:/^(MONTH)(([+|\-])(\d{1,9}))?$/i,QUARTER:/^(QUARTER)(([+|\-])(\d{1,9}))?$/i,SEMI:/^(SEMI)(([+|\-])(\d{1,9}))?$/i,YEAR:/^(YEAR)(([+|\-])(\d{1,9}))?$/i},o.parse=function(e){if(o.isValid(e))for(var t in o.PATTERNS){var i=o.PATTERNS[t].exec(e);if(null!==i&&n.isArray(i)&&5===i.length)return new o(i[1],i[3],i[4])}},o.isValid=function(e){if(e instanceof o)return""!==e.toString();if(n.isString(e))for(var t in o.PATTERNS)if(o.PATTERNS[t].test(e))return!0;return!1},i.exports=o}),define("runtime_dependencies/js-sdk/src/common/util/parse/date",["require","exports","module","momentExtension","../../../jrs.configs","underscore","../datetime/RelativeDate","../datetime/RelativeTimestamp"],function(e,t,i){function s(e){var t=e;return t=e.indexOf("yy")>-1?t.replace("yy","YYYY"):t.replace("y","YY"),e.indexOf("mm")>-1?t=t.replace("mm","MM"):e.indexOf("MM")>-1?t=t.replace("MM","MMMM"):e.indexOf("m")>-1?t=t.replace("m","M"):e.indexOf("M")>-1&&(t=t.replace("M","MMM")),e.indexOf("dd")>-1?t=t.replace("dd","DD"):e.indexOf("DD")>-1?t=t.replace("DD","dddd"):e.indexOf("d")>-1?t=t.replace("d","D"):e.indexOf("D")>-1&&(t=t.replace("D","ddd")),t}function n(e){return e.toUpperCase()}function o(e){return e.toLowerCase().replace("hh","HH")}function r(e){return e.replace("aaa","a")}function l(e,t,i){var n=s(e),r=o(t);return n+(null!=i?i:" ")+r}function a(e,t,i){i=void 0!==i&&i,t=t||" ";var l=e.split(t),a=l[0],h=l.length>1?l[1]:null,c=i?n:s,d=i?r:o;(a.indexOf("h")>0||a.indexOf("H")>0||a.indexOf("s")>0)&&(h=a,a=null);var u="";return a&&(u+=c(a)),h&&(u&&(u+=t),u+=d(h)),u}function h(e){return z(e,s($.dateFormat),!0)}function c(e){return z(e,l($.dateFormat,$.timeFormat,$.timestampSeparator),!0)}function d(e){return H.isValid(e)}function u(e){return U.isValid(e)}function p(e){return k.isDate(e)&&z(e).isValid()||k.isString(e)&&""!==e&&h(e).isValid()}function m(e){return k.isDate(e)&&z(e).isValid()||k.isString(e)&&""!==e&&c(e).isValid()}function f(e){return z(e,B,!0).isValid()}function g(e,t){if(p(e)&&p(t)){return b(k.isDate(e)?z(e):h(e),k.isDate(t)?z(t):h(t))}}function v(e,t){if(m(e)&&m(t)){return b(k.isDate(e)?z(e):c(e),k.isDate(t)?z(t):c(t))}}function b(e,t){return e.isBefore(t)?-1:e.isAfter(t)?1:0}function _(e){var t=z(e);if(k.isDate(e)&&t.isValid())return t.format(B)}function w(e){var t=z(e,B,!0);if(t.isValid())return t.toDate()}function C(e){return E(e,l($.dateFormat,$.timeFormat,$.timestampSeparator),B)}function S(e){return E(e,B,l($.dateFormat,$.timeFormat,$.timestampSeparator))}function y(e){return E(e,s($.dateFormat),G)}function T(e){return E(e,G,s($.dateFormat))}function I(e){return E(e,o($.timeFormat),q)}function x(e){return E(e,q,o($.timeFormat))}function E(e,t,i){if(H.isValid(e))return e;var s=z(e,t,!0);return s.isValid()?s.format(i):e}function A(e){return z(e,G,!0)}function P(e){return e.format(G)}function O(e){return e.format(s($.dateFormat))}function N(e,t){var i;return i=t?z.tz(e,t).tz(F):z.utc(e).tz(F),i.format(s($.dateFormat))}function D(e,t){var i=z.duration(e),s=z.utc();return t&&s.tz(t),s.hours(i.hours()),s.minutes(i.minutes()),s.seconds(i.seconds()),s.tz(F).format(o($.timeFormat))}function j(e,t){var i;return i=t?z.tz(e,t).tz(F):z.utc(e).tz(F),i.format(l($.dateFormat,$.timeFormat,$.timestampSeparator))}function L(e,t){e=y(e);var i=z.tz(e,F);return i=t?i.tz(t):i.utc(),i.format(G)}function R(e,t){var i=z.duration(e),s=z.utc(),n=s.tz(F);n.hours(i.hours()),n.minutes(i.minutes()),n.seconds(i.seconds());var o;return o=t?n.tz(t):n.utc(),o.format(q)}function M(e,t){e=C(e);var i=z.tz(e,F);return i=t?i.tz(t):i.utc(),i.format(B)}var z=e("momentExtension"),V=e("../../../jrs.configs"),k=e("underscore"),H=e("../datetime/RelativeDate"),U=e("../datetime/RelativeTimestamp"),$=V.localeSettings,F=V.userTimezone,B="YYYY-MM-DD[T]HH:mm:ss",G="YYYY-MM-DD",q="HH:mm:ss";i.exports={isRelativeDate:d,isRelativeTimestamp:u,isDate:p,isTimestamp:m,isIso8601Timestamp:f,compareDates:g,compareTimestamps:v,iso8601DateToMoment:A,momentToIso8601Date:P,momentToLocalizedDate:O,dateObjectToIso8601Timestamp:_,iso8601TimestampToDateObject:w,localizedTimestampToIsoTimestamp:C,isoTimestampToLocalizedTimestamp:S,localizedDateToIsoDate:y,isoDateToLocalizedDate:T,localizedTimeToIsoTime:I,isoTimeToLocalizedTime:x,toMomentDateOrTimeOrTimestampPattern:a,isoDateToLocalizedDateByTimezone:N,localizedDateToIsoDateByTimezone:L,isoTimeToLocalizedTimeByTimezone:D,localizedTimeToIsoTimeByTimezone:R,isoTimestampToLocalizedTimestampByTimezone:j,localizedTimestampToIsoTimestampByTimezone:M}}),define("controls/controls.components",["require","exports","module","../namespace/namespace","jquery","underscore","./controls.base","runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelect","runtime_dependencies/js-sdk/src/components/multiSelect/view/MultiSelect","runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/CacheableDataProvider","runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/DataProviderWithLabelHash","runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/SearcheableDataProvider","runtime_dependencies/js-sdk/src/components/dateAndTime/DateAndTimePicker","runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory","runtime_dependencies/js-sdk/src/common/util/parse/date","./controls.core","./controls.basecontrol"],function(e,t,i){var s=e("../namespace/namespace"),n=s.JRS,o=e("jquery"),r=e("underscore"),l=e("./controls.base"),a=l.ControlsBase,h=e("runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelect"),c=e("runtime_dependencies/js-sdk/src/components/multiSelect/view/MultiSelect"),d=e("runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/CacheableDataProvider"),u=e("runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/DataProviderWithLabelHash"),p=e("runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/SearcheableDataProvider"),m=e("runtime_dependencies/js-sdk/src/components/dateAndTime/DateAndTimePicker"),f=e("runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory"),g=e("runtime_dependencies/js-sdk/src/common/util/parse/date");e("./controls.core"),e("./controls.basecontrol"),n.Controls=function(e,t,i){function s(e){this.set({selection:e})}function o(e){return e.toUpperCase().replace(/([\s]+$|^[\s]+)/g,"").replace(/[\s]*(\+|\-)[\s]*/g,"$1")}function r(e,t){if(!e)return null;for(var i={},s=0;s<e.length;s++){var n=e[s];if(n.selected){if(t){i[s]={value:n.value,label:n.label};break}i[s]=n.value}}return i}return t.extend(i,{Bool:i.BaseControl.extend({update:function(e){var t=this.getElem(),i=t.find("input");"true"==e?i.prop("checked",!0):i.prop("checked",!1)},bindCustomEventListeners:function(){this.getElem()&&this.getElem().on("change","input",t.bind(function(e){var t=null==e.target.getValue()?"false":"true";this.set({selection:t})},this))}}),SingleValueText:i.BaseControl.extend({update:function(e){var t=e==a.NULL_SUBSTITUTION_VALUE?a.NULL_SUBSTITUTION_LABEL:e,i=this.getElem();i&&(i.find("input").attr("value",t),i.find("input").val(t))},bindCustomEventListeners:function(){this.getElem()&&this.getElem().on("change","input",t.bind(function(e){var t=e.target.value,i=t==a.NULL_SUBSTITUTION_LABEL?a.NULL_SUBSTITUTION_VALUE:t;this.set({selection:i})},this))}}),SingleValueNumber:i.BaseControl.extend({update:function(e){this.getElem()&&this.getElem().find("input").attr("value",e),this.getElem()&&this.getElem().find("input").val(e)},bindCustomEventListeners:function(){this.getElem()&&this.getElem().on("change","input",t.bind(function(e){this.set({selection:e.target.value})},this))}}),SingleValueDate:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.getElem()&&this.setupCalendar()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return g.localizedDateToIsoDate(t)},set:function(e,t){e.values&&(e.values=g.isoDateToLocalizedDate(e.values)),i.BaseControl.prototype.set.call(this,e,t)},setupCalendar:function(){var i=this.getElem().find("input");this.picker=new m({el:i,showOn:"button",dateFormat:n.i18n.bundledCalendarFormat,disabled:i[0].disabled,onSelect:t.bind(s,this)}),i.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(o(t.target.value)),s.call(this,e(t.target).val())},this)),i.after("&nbsp;"),this.getElem().find("button").wrap(a.CALENDAR_ICON_SPAN).empty()},update:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleValueDatetime:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.getElem()&&this.setupCalendar()},getInput:function(){var e=this.getElem();return e&&e.find("input")},destroyCalendar:function(){this.getInput().off(),this.picker&&this.picker.remove()},setupCalendar:function(){var i=this.getElem(),r=this.getInput();this.destroyCalendar(),this.picker=new m({el:r[0],showOn:"button",dateFormat:n.i18n.bundledCalendarFormat,timeFormat:n.i18n.bundledCalendarTimeFormat,disabled:r[0].disabled,onSelect:t.bind(s,this)}),r.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(o(t.target.value)),s.call(this,e(t.target).val())},this)),r.after("&nbsp;"),i.find("button").wrap(a.CALENDAR_ICON_SPAN).empty()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return g.localizedTimestampToIsoTimestamp(t)},set:function(e,t){e.values&&(e.values=g.isoTimestampToLocalizedTimestamp(e.values)),
e.values||e.selection||!this.getInput()||this.setupCalendar(),i.BaseControl.prototype.set.call(this,e,t)},update:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleValueTime:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.getElem()&&this.setupCalendar()},getInput:function(){var e=this.getElem();return e&&e.find("input")},destroyCalendar:function(){this.getInput().off(),this.picker&&this.picker.remove()},setupCalendar:function(){var i=this.getElem(),r=this.getInput();this.destroyCalendar(),this.picker=new m({el:r[0],showOn:"button",timeFormat:n.i18n.bundledCalendarTimeFormat,disabled:r[0].disabled,onClose:t.bind(s,this)}),r.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(o(t.target.value)),s.call(this,e(t.target).val())},this)),r.after("&nbsp;"),i.find("button").wrap(a.CALENDAR_ICON_SPAN).empty()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return g.localizedTimeToIsoTime(t)},set:function(e,t){e.values&&(e.values=g.isoTimeToLocalizedTime(e.values)),e.values||e.selection||!this.getInput()||this.setupCalendar(),i.BaseControl.prototype.set.call(this,e,t)},update:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleSelect:i.BaseControl.extend({baseRender:function(s){this.singleSelect||(this.dataProvider=new d,this.singleSelect=new h({getData:this.dataProvider.getData}).setDisabled(s.readOnly)),s&&t.extend(this,s);var n=i.TemplateEngine.createTemplate(this.type);if(n){this.singleSelect.undelegateEvents();var o=e(n(this));this.singleSelect.render().renderData(),o.find(".ssPlaceholder").append(this.singleSelect.el),this.setElem(o),this.singleSelect.delegateEvents()}},update:function(e){this.dataProvider.setData(e);var t=this;this.singleSelect.fetch(function(){t.singleSelect.setValue(r(e,!0),{silent:!0})})},bindCustomEventListeners:function(){this.singleSelect.off("selection:change").on("selection:change",function(e){this.set({selection:e})},this)}}),MultiSelect:i.BaseControl.extend({baseRender:function(s){var n=this;this.multiSelect||(this.dataProvider=new u,this.multiSelect=new c({getData:new p({getData:this.dataProvider.getData}).getData,selectedListOptions:{formatLabel:function(e){return n.dataProvider.getDataLabelHash()[e]},sortFunc:f.create(a.NULL_SUBSTITUTION_LABEL)},resizable:!0}),this.multiSelect.setDisabled(s.readOnly),this._resize=t.debounce(t.bind(this.multiSelect.resize,this.multiSelect),500)),s&&t.extend(this,s);var o=i.TemplateEngine.createTemplate(this.type);if(o){this.multiSelect.undelegateEvents();var r=e(o(this));this.multiSelect.render().renderData(),r.find(".msPlaceholder").append(this.multiSelect.el),this.setElem(r),this.multiSelect.delegateEvents()}},update:function(e){this.dataProvider.setData(e);var t=this;this.multiSelect.fetch(function(){var i=r(e);t.multiSelect.setValue(i,{silent:!0}),t._resize()})},bindCustomEventListeners:function(){this.multiSelect.off("selection:change").on("selection:change",function(e){this.set({selection:e})},this)},get:function(e){var i=this[e];return"selection"==e&&t.isEmpty(i)?[a.NOTHING_SUBSTITUTION_VALUE]:i},makeResizable:function(){var e=this.multiSelect.$el.find(".jr-mSizer");e.length&&e.detach().insertAfter(this.getElem()&&this.getElem().find(".resizeOverlay"))}}),SingleSelectRadio:i.BaseControl.extend({update:function(s){(new Date).getTime();if(this.getElem()){var n=this.getElem().find("ul")[0],o=t.map(s,function(e){var i=t.clone(e);return i.readOnly=this.readOnly,i.name=this.getOptionName(),i.uuid=t.uniqueId(this.id),i},this),r=this.getTemplateSection("data");i.Utils.setInnerHtml(n,r,{data:o}),n=e(n),n.html(n.html()+"&nbsp;"),n.find("li").length<5&&this.getElem()[0].clientHeight<125?(this.getElem().find(".jr-mSizer").addClass("hidden"),this.getElem().find(".inputSet").removeClass("sizable").attr("style",!1)):this.resizable&&(this.getElem().find(".jr-mSizer").removeClass("hidden"),this.getElem().find(".inputSet").addClass("sizable"))}},getOptionName:function(){return this.id+"_option"},bindCustomEventListeners:function(){this.getElem()&&this.getElem().on("change","input",t.bind(function(e){var t=e.target.value,i=this;setTimeout(function(){i.set({selection:t})})},this))},makeResizable:function(){if(this.resizable=!0,this.getElem()){var e=this.getElem().find("ul"),t=this.getElem().find(".jr-mSizer").removeClass("hidden");t.addClass("ui-resizable-s"),e.resizable({handles:{s:t}})}}}),MultiSelectCheckbox:i.BaseControl.extend({update:function(s){var n=t.map(s,function(e){var i=t.clone(e);return i.readOnly=this.readOnly,i.uuid=t.uniqueId(this.id),i},this);if(this.getElem()){var o=this.getElem().find("ul")[0],r=this.getTemplateSection("data");i.Utils.setInnerHtml(o,r,{data:n}),e(o).find("li").length<5&&this.getElem()[0].clientHeight<125?(this.getElem().find(".jr-mSizer").addClass("hidden"),this.getElem().find(".inputSet").removeClass("sizable").attr("style",!1)):this.resizable&&(this.getElem().find(".jr-mSizer").removeClass("hidden"),this.getElem().find(".inputSet").addClass("sizable"))}},getSelection:function(){var i=this.getElem().find(":checkbox").filter(":checked");return t.map(i,function(t){return e(t).val()})},bindCustomEventListeners:function(){this.getElem()&&this.getElem().on("change","input",t.bind(function(e){var t=this.getSelection(),i=this;setTimeout(function(){i.set({selection:t})})},this)),this.getElem()&&this.getElem().on("click","a",t.bind(function(i){var s=this.getElem().find("input"),n=e(i.target)[0].name;"multiSelectAll"===n||"multiSelectNone"===n?t.each(s,function(e){e.checked="multiSelectAll"===n}):"multiSelectInverse"===n&&t.each(s,function(e){e.checked=!e.checked}),this.getElem().find("input").change()},this))},get:function(e){var i=this[e];return"selection"==e&&t.isEmpty(i)?[a.NOTHING_SUBSTITUTION_VALUE]:i},makeResizable:function(){if(this.resizable=!0,this.getElem()){var e=this.getElem().find("ul"),t=this.getElem().find(".jr-mSizer").removeClass("hidden");t.addClass("ui-resizable-s"),e.resizable({handles:{s:t}})}}})})}(o,r,n.Controls),i.exports=n.Controls}),jQuery.url=function(e){function t(e){for(var t="",i=0,s=0,n=0;i<e.length;)s=e.charCodeAt(i),s<128?(t+=String.fromCharCode(s),i++):s>191&&s<224?(n=e.charCodeAt(i+1),t+=String.fromCharCode((31&s)<<6|63&n),i+=2):(n=e.charCodeAt(i+1),c3=e.charCodeAt(i+2),t+=String.fromCharCode((15&s)<<12|(63&n)<<6|63&c3),i+=3);return t}function i(t,i){var s={},n={true:!0,false:!1,null:null};return e.each(t.replace(/\+/g," ").split("&"),function(t,o){var l,a=o.split("="),h=r(a[0]),c=s,d=0,u=h.split("]["),p=u.length-1;if(/\[/.test(u[0])&&/\]$/.test(u[p])?(u[p]=u[p].replace(/\]$/,""),u=u.shift().split("[").concat(u),p=u.length-1):p=0,2===a.length)if(l=r(a[1]),i&&(l=l&&!isNaN(l)?+l:"undefined"===l?void 0:void 0!==n[l]?n[l]:l),p)for(;d<=p;d++)h=""===u[d]?c.length:u[d],c=c[h]=d<p?c[h]||(u[d+1]&&isNaN(u[d+1])?{}:[]):l;else e.isArray(s[h])?s[h].push(l):void 0!==s[h]?s[h]=[s[h],l]:s[h]=l;else h&&(s[h]=i?void 0:"")}),s}function s(e){e=e||window.location;for(var t=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,s=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],n=t.exec(e),o={},r=s.length;r--;)o[s[r]]=n[r]||"";return o.query&&(o.params=i(o.query,!1)),o}function n(t){if(t.source)return encodeURI(t.source);var i=[];return t.protocol&&("file"==t.protocol?i.push("file:///"):"mailto"==t.protocol?i.push("mailto:"):i.push(t.protocol+"://")),t.authority?i.push(t.authority):(t.userInfo?i.push(t.userInfo+"@"):t.user&&(i.push(t.user),t.password&&i.push(":"+t.password),i.push("@")),t.host&&(i.push(t.host),t.port&&i.push(":"+t.port))),t.path?i.push(t.path):(t.directory&&i.push(t.directory),t.file&&i.push(t.file)),t.query?i.push("?"+t.query):t.params&&i.push("?"+e.param(t.params)),t.anchor&&i.push("#"+t.anchor),i.join("")}function o(e){return encodeURIComponent(e)}function r(e){return t(unescape(e.replace(/\+/g," ")))}return{encode:o,decode:r,parse:s,build:n}}(jQuery),define("jquery.urldecoder",["jquery"],function(e){return function(){return e.jQuery}}(this)),define("controls/controls.controller",["require","exports","module","jquery","../namespace/namespace","underscore","./controls.core","./controls.datatransfer","./controls.viewmodel","./controls.components","jquery.urldecoder"],function(e,t,i){var s=e("jquery"),n=e("../namespace/namespace"),o=n.JRS,r=e("underscore");e("./controls.core"),e("./controls.datatransfer"),e("./controls.viewmodel"),e("./controls.components"),e("jquery.urldecoder"),function(e,t,i){function s(t){var i=e.url.parse(location.href).params;return i&&i[t]}t.extend(i,{Controller:i.Base.extend({constructor:function(s){t.bindAll(this,"fetchControlsStructure","detectReportUri","getReportUri","getDataTransfer","getViewModel","updateControlsValues","reset","update","validate"),this.viewModel=s&&s.viewModel?s.viewModel:new i.ViewModel,this.dataTransfer=s&&s.dataTransfer?s.dataTransfer:new i.DataTransfer({dataConverter:new i.DataConverter}),this.initialize(s),i.listen({"viewmodel:selection:changed":t.bind(function(e,t,i,s){t&&s&&this.updateControlsValues(t,i)},this),"reportoptions:selection:changed":t.bind(function(e,t){var i=t&&t.reportOption,s=t&&t.selectedData;this.reset(i&&i.uri,s)},this)}),i.getController=t.bind(function(){return this},this),e(document).trigger("controls:initialized",[this.getViewModel()])},initialize:function(e){this.dataTransfer.setReportUri(this.detectReportUri(e))},fetchControlsStructure:function(e,i){var s=this.dataTransfer,n=this.viewModel,o=i&&!t.isEmpty(e)?t.keys(e):[];return s.fetchControlsStructure(o,e).done(function(e){e&&n.set({structure:e.structure,state:e.state})})},detectReportUri:function(e){if(this.reportUri=e&&e.reportUri||s("reportUnitURI"),!this.reportUri)throw Error("Can't initialize without reportUri");return this.reportOptionUri=e&&e.reportOptionUri||s("reportOptionsURI"),this.getReportUri()},getReportUri:function(){return this.reportOptionUri||this.reportUri},getDataTransfer:function(){return this.dataTransfer},getViewModel:function(){return this.viewModel},updateControlsValues:function(e,i){var s=this.getDataTransfer(),n=this.getViewModel(),o=i||t.map(n.getControls(),function(e){return e.id});return s.fetchControlsUpdatedValues(o,e).done(function(e){n.set(e)})},reset:function(e,t){var i=this;return this.getDataTransfer().fetchInitialControlValues(e||this.getReportUri(),t).done(function(e){i.getViewModel().set(e)})},update:function(e){return e||(e=this.getViewModel().get("selection")),this.updateControlsValues(e)},validate:function(){var e=this.getDataTransfer(),i=this.getViewModel(),s=t.map(i.getControls(),function(e){return e.id}),n=i.get("selection");return e.fetchControlsUpdatedValues(s,n).then(function(e){var s=t(e.state).reduce(function(e,t,i){return e[i]={error:t.error},e},{});i.set({state:s})}).then(function(){return i.areAllControlsValid()})}})})}(s,r,o.Controls),i.exports=o.Controls}),define("controls/controls.report",["require","exports","module","prototype","../namespace/namespace","../core/core.layout","./controls.core","../util/utils.common","../components/components.dialogs","./controls.base","./controls.options","../namespace/namespace","../reportViewer/report.view.base","settings!inputControls","jquery","underscore","runtime_dependencies/js-sdk/src/common/component/dialog/ConfirmationDialog","runtime_dependencies/js-sdk/src/components/overlay/Overlay","../reportViewer/report.view.base","./controls.controller"],function(e,t,i){var s=e("prototype"),n=s.$,o=s.$$,r=e("../namespace/namespace"),l=r.JRS,a=e("../core/core.layout"),h=e("./controls.core"),c=e("../util/utils.common"),d=c.centerElement,u=c.matchAny,p=c.triggerNativeEvent,m=c.isIPad,f=c.selectAndFocusOn,g=e("../components/components.dialogs"),v=e("./controls.base"),b=v.ControlsBase,_=v.OptionsDialog,w=v.ControlDialog,C=e("./controls.options"),S=e("../namespace/namespace"),y=S.isProVersion,T=e("../reportViewer/report.view.base"),I=e("settings!inputControls"),x=e("jquery"),E=e("underscore"),A=e("runtime_dependencies/js-sdk/src/common/component/dialog/ConfirmationDialog"),P=e("runtime_dependencies/js-sdk/src/components/overlay/Overlay");e("../reportViewer/report.view.base"),e("./controls.controller");var O=function(e,t,i,s){return t.extend(i,{_messages:{},layouts:{LAYOUT_POPUP_SCREEN:1,LAYOUT_SEPARATE_PAGE:2,LAYOUT_TOP_OF_PAGE:3,LAYOUT_IN_PAGE:4},controlDialog:null,reportOptionsDialog:null,inputControlsLocation:null,toggleControlsOn:!1,controller:null,hideControls:null,selectionChanged:!0,initialize:function(){this.controller=new l.Controls.Controller({reportUri:s.reportUnitURI,reportOptionUri:s.reportOptionsURI});var o=t.extend(s.getAllRequestParameters(),s.reportParameterValues);this.controller.fetchControlsStructure(o).always(function(n){var o=i.controller.getViewModel(),r=o.areAllControlsValid(),h=!t.isUndefined(t.find(s.parametersWithoutDefaultValues,function(e){return!t.contains(t.keys(s.getAllRequestParameters()),e)}));s.hasInputControls&&((s.reportForceControls||h)&&t.isEmpty(s.reportParameterValues)||!r)?((!n||"number"!=typeof n.status||n.status<300)&&i.show(),s&&s.nothingToDisplay&&(s.nothingToDisplay.removeClassName(a.HIDDEN_CLASS),d(s.nothingToDisplay,{horz:!0,vert:!0}),e("#"+s.DATA_REFRESH_BUTTON).attr(a.DISABLED_ATTR_NAME,a.DISABLED_ATTR_NAME)),i.lastSelection=o.get("selection")):i.refreshReport(),l.Controls.listen({"viewmodel:selection:changed":function(){i.selectionChanged=!0},"reportoptions:selection:changed":function(e,t){i.selectionChanged=!0}})}),this.viewModel=i.controller.getViewModel(),this.initializeOptions(),this.buttonActions={"button#ok":t.bind(i.applyInputValues,i,!0),"button#apply":t.bind(i.applyInputValues,i),"button#cancel":t.bind(i.cancel,i),"button#reset":i.resetToInitial,"button#save":i.save,"button#remove":i.remove};var r={"button#ok":t.bind(i.applyInputValues,i,!0),"button#cancel":t.bind(i.cancel,i),"button#reset":i.resetToInitial,"button#apply":t.bind(i.applyInputValues,i),"button#save":i.save,"button#remove":i.remove};n(b.INPUT_CONTROLS_DIALOG)&&(this.controlDialog=new w(r)),n(b.INPUT_CONTROLS_FORM)&&n(b.INPUT_CONTROLS_FORM).observe("click",function(e){var t=e.element();for(var i in this.buttonActions)if(u(t,[i],!0))return this.buttonActions[i](),void e.stop()}.bindAsEventListener(this)),this.inputControlsLocation=n(n(b.INPUT_CONTROLS_CONTAINER)?b.INPUT_CONTROLS_CONTAINER:b.INPUT_CONTROLS_FORM),n(b.TOOLBAR_CONTROLS_BUTTON)&&(this.toggleControlsOn=n(b.TOOLBAR_CONTROLS_BUTTON).hasClassName("down"))},initializeOptions:function(){function o(){var t;(t=e(i.layouts.LAYOUT_POPUP_SCREEN==s.reportControlsLayout?"#"+b.INPUT_CONTROLS_DIALOG:"#"+b.INPUT_CONTROLS_FORM))&&t.length>0&&t.addClass("showingSubHeader")}function r(){var t;(t=e(i.layouts.LAYOUT_POPUP_SCREEN==s.reportControlsLayout?"#"+b.INPUT_CONTROLS_DIALOG:"#"+b.INPUT_CONTROLS_FORM))&&t.length>0&&t.removeClass("showingSubHeader")}if(y()){var a;a=this.layouts.LAYOUT_POPUP_SCREEN==s.reportControlsLayout?"#"+b.INPUT_CONTROLS_DIALOG+" .sub.header":(this.layouts.LAYOUT_TOP_OF_PAGE,s.reportControlsLayout,"#"+b.INPUT_CONTROLS_FORM+" .sub.header");var h=new C;h.fetch(s.reportUnitURI,s.reportOptionsURI).done(function(){e(a).append(h.getElem()),i.lastReportOptionsSelection=h.get("selection")}).fail(function(){e(a).addClass("hidden")}).always(function(){i.lastReportOptionsSelection||(i.lastReportOptionsSelection=h.get("defaultOption"))}),h.updateWarningMessage=function(){i.reportOptionsDialog.showWarning(this.error)},l.Controls.listen({"viewmodel:selection:changed":function(){var e=h.find({uri:s.reportUnitURI});h.set({selection:e},!0)},"viewmodel:order:changed":t.bind(function(e,i){s.newIcOrder=t.pluck(i,"id").join(";")},this)});var c={"button#saveAsBtnSave":function(){var t=i.reportOptionsDialog.input.getValue(),n=i.viewModel.get("selection"),r=t===i.reportOptionsDialog.optionNameToOverwrite;h.add(s.reportUnitURI,t,n,r).done(function(){i.reportOptionsDialog.hideWarning(),g.systemConfirm.show(b.getMessage("report.options.option.saved")),o();var t=h.getElem().parent();t.length>0?t.removeClass("hidden"):(e(a).removeClass("hidden"),e(a).append(h.getElem())),i.layouts.LAYOUT_TOP_OF_PAGE==s.reportControlsLayout&&e("#"+b.INPUT_CONTROLS_FORM+" .header").removeClass("hidden"),i.reportOptionsDialog.hide(),delete i.reportOptionsDialog.optionNameToOverwrite}).fail(function(e){if(e)try{"report.options.dialog.confirm.message"===JSON.parse(e.responseText).errorCode&&!r&&(i.reportOptionsDialog.optionNameToOverwrite=t)}catch(e){}})},"button#saveAsBtnCancel":function(){i.reportOptionsDialog.hide(),delete i.reportOptionsDialog.optionNameToOverwrite}};n(b.SAVE_REPORT_OPTIONS_DIALOG)&&(this.reportOptionsDialog=new _(c)),this.remove=function(){var t=h.get("selection").label,n=new A({text:b.getMessage("report.options.option.confirm.remove",{option:t})});n.on("button:yes",function(){h.removeOption(s.reportUnitURI,h.get("selection").id).done(function(){if(!h.get("values")){r();var t=h.getElem().parent();t.length>0?t.addClass("hidden"):(e(a).addClass("hidden"),e(a).html("")),i.layouts.LAYOUT_TOP_OF_PAGE==s.reportControlsLayout&&e("#"+b.INPUT_CONTROLS_FORM+" .header").addClass("hidden")}h.enableRemoveButton(!1),g.systemConfirm.show(b.getMessage("report.options.option.removed"))}),n.remove()}),n.on("button:no",function(){n.remove()}),n.open()},i.reportOptions=h}},cancel:function(){s.reportControlsLayout==i.layouts.LAYOUT_SEPARATE_PAGE&&i.separatePageICLayoutFirstShow?s.goBack():i.controller.update(i.lastSelection).always(function(){s.reportControlsLayout==i.layouts.LAYOUT_POPUP_SCREEN?i.controlDialog.hide():s.reportControlsLayout==i.layouts.LAYOUT_SEPARATE_PAGE&&i.showReport(),i.reportOptions&&i.lastReportOptionsSelection&&i.reportOptions.set({selection:i.lastReportOptionsSelection},!0)})},getLastSelection:function(){return this.lastSelection},save:function(){i.selectionChanged?i.controller.validate().then(i.showOptionDialog):i.showOptionDialog()},refreshReport:function(n){var o=new e.Deferred,r=o.promise(),a=i.viewModel.get("selection");if(n){if(!l.Controls.ViewModel.isSelectionChanged(i.lastSelection,a))return o.resolve(),r()}try{a&&!t.isEmpty(a)?(r=s.refreshReport(null,null,b.buildSelectedDataUri(a)),i.lastSelection=a):(r=s.refreshReport(),i.lastSelection={})}catch(e){alert(e),o.reject(e)}return r},applyInputValues:function(n){var o=i.viewModel;i.selectionChanged?i.controller.validate().then(function(o){if(o){var r,l=i.lastSelection;i.reportOptions&&(r=i.lastReportOptionsSelection),window.viewer&&window.viewer.jive&&window.viewer.jive.hide(),i.refreshReport().then(function(){i.selectionChanged=!1},function(){var o=new P({zIndex:g.errorPopup.getZIndex()-1});e("body").append(o.$el),o.show(),i.lastSelection=l,i.lastReportOptionsSelection=r,g.errorPopup.onClose=function(){i.lastSelection&&!t.isEmpty(i.lastSelection)?s.refreshReport(null,null,b.buildSelectedDataUri(i.lastSelection)):s.refreshReport(),o.remove()},n&&(i.cancel(),i.selectionChanged=!1)}),i.reportOptions&&(i.lastReportOptionsSelection=i.reportOptions.get("selection")),n&&i.hide()}}):o.areAllControlsValid()&&n&&i.hide()},resetToInitial:function(){i.selectionChanged=!0;var e=i.reportOptions;if(e){var n=e.find({uri:s.reportOptionsURI?s.reportOptionsURI:s.reportUnitURI});if(n)return void e.set({selection:n})}var o=null;"true"===I.useUrlParametersOnReset&&(o=t.extend(s.getAllRequestParameters(),s.reportParameterValues)),i.controller.reset(null,o)},show:function(){switch(s.reportControlsLayout){case 2:i.showControls();break;case 3:i.toggleControls();break;case 4:break;default:i.showDialog()}},hide:function(){switch(s.reportControlsLayout){case 2:i.showReport();break;case 3:case 4:break;default:i.controlDialog.hide()}},toggleControls:function(){i.toggleControlsOn?(n(b.TOOLBAR_CONTROLS_BUTTON).removeClassName("down").addClassName("up"),o(".panel.pane.inputControls")[0].addClassName(a.HIDDEN_CLASS),p("resize")):(n(b.TOOLBAR_CONTROLS_BUTTON).removeClassName("up").addClassName("down"),o(".panel.pane.inputControls")[0].removeClassName(a.HIDDEN_CLASS)),i.toggleControlsOn=!i.toggleControlsOn,m()&&s.touchController.reset(),e("#"+b.INPUT_CONTROLS_FORM).show().height()},showDialog:function(){i.controlDialog&&i.controlDialog.show()},showReport:function(){n(a.PAGE_BODY_ID).removeClassName(a.CONTROL_PAGE_CLASS).addClassName(a.ONE_COLUMN_CLASS)},showControls:function(){n(a.PAGE_BODY_ID).removeClassName(a.ONE_COLUMN_CLASS).addClassName(a.CONTROL_PAGE_CLASS),document.getElementById(b.INPUT_CONTROLS_FORM)&&e("#"+b.INPUT_CONTROLS_FORM).show()},showOptionDialog:function(){l.Controls.Utils.wait(200).then(function(){i.viewModel.areAllControlsValid()&&(i.reportOptionsDialog.show(),f(i.reportOptionsDialog.input))})}})}(x,E,h,T);i.exports=O}),define("components/components.toolbarButtons.events",["require","exports","module","jquery","../util/utils.common","../core/core.events.bis","./components.toolbarButtons"],function(e,t,i){var s=e("jquery"),n=e("../util/utils.common"),o=n.isFirefox,r=n.getAsFunction,l=e("../core/core.events.bis"),a=e("./components.toolbarButtons");a.initialize=function(e){a.actionMap=e,s(".toolbar").on("mouseup mouseover mouseout","button",function(e){s(this).prop("disabled")||a["mouse"+e.type.substring(5,6).toUpperCase()+e.type.substring(6)+"Handler"](e,this)}),o()&&s(".toolbar li").each(function(e,t){s(t).css("padding","0 2px")})},a.mouseUpHandler=function(e,t){var i=t.className.indexOf("capsule")>=0?a.actionMap[t.id]:null;if(i){r(i)(e),e.stopPropagation()}},a.mouseOverHandler=function(e,t){t.className.indexOf("capsule")>=0&&t.className.indexOf("mutton")>=0&&!l.isDisabled(t)&&a.showButtonMenu(e.originalEvent,t)},a.mouseOutHandler=function(e,t){},i.exports=a}),define("reportViewer/report.view.runtime",["require","exports","module","prototype","./report.view.base","../controls/controls.report","../controls/controls.base","../components/components.toolbarButtons.events","../util/utils.common","../namespace/namespace","../util/touch.controller","../core/core.layout","../components/components.dialogs","../core/core.ajax","../core/core.events.bis","underscore","jquery","runtime_dependencies/js-sdk/src/common/stdnav/stdnav"],function(e,t,i){var s=e("prototype"),n=s.$,o=e("./report.view.base"),r=e("../controls/controls.report"),l=e("../controls/controls.base"),a=l.ControlsBase,h=e("../components/components.toolbarButtons.events"),c=e("../util/utils.common"),d=c.matchAny,u=c.isIPad,p=c.isSupportsTouch,m=c.centerElement,f=c.addDataToForm,g=e("../namespace/namespace"),v=g.JRS,b=e("../util/touch.controller"),_=e("../core/core.layout"),w=e("../components/components.dialogs"),C=e("../core/core.ajax"),S=C.ajax,y=e("../core/core.events.bis"),T=e("underscore"),I=e("jquery"),x=e("runtime_dependencies/js-sdk/src/common/stdnav/stdnav");o.toolbarActionMap={back:"Report.goBack",ICDialog:"Controls.show",export:"doNothing",undo:"Report.undo",redo:"Report.redo",undoAll:"Report.undoAll"},I.extend(o,{initialize:function(){this.commonInit(),o.exportForm=n(o.EXPORT_ACTION_FORM),this.nothingToDisplay=n("nothingToDisplay"),n(o.DATA_REFRESH_BUTTON)&&n(o.DATA_REFRESH_BUTTON).observe("mouseup",function(){if(window.viewer.jive&&window.viewer.jive.hide(),void 0!==r){var e=r.viewModel.get("selection"),t=a.buildSelectedDataUri(e);this.refreshReport({freshData:!0},null,t?"&"+t:"")}else this.refreshReport({freshData:!0},null,"")}.bindAsEventListener(this)),n(o.ASYNC_CANCEL_BUTTON)&&n(o.ASYNC_CANCEL_BUTTON).observe("mouseup",function(){this.cancelReportAsyncExecution(!0)}.bindAsEventListener(this)),h.ACTION_MODEL_TAG=o.TOOLBAR_SUBMENU,h.initialize(o.toolbarActionMap),n(o.PAGINATION_PAGE_CURRENT)&&(n(o.PAGINATION_PAGE_CURRENT).observe("change",function(e){this.goToPage(n(o.PAGINATION_PAGE_CURRENT).getValue()),e.stop()}.bindAsEventListener(this)),I(".toolsRight")[0].observe("click",function(e){var t=e.element();e.stop();for(var i in this.pageActions)if(d(t,[i],!0))return void this.navigateToReportPage(this.pageActions[i])}.bindAsEventListener(this))),document.location.href.indexOf("noReturn=true")>0&&y.disable(n("back")),void 0!==r?r.initialize.bind(r)(o.refreshReport):o.refreshReport()},reportRefreshed:function(e){var t,i;if(void 0!==v&&v.fid){t=I("#"+v.fid,window.parent.document),i=t.contents().find("#reportContainer"),t.removeClass(_.HIDDEN_CLASS).show(),u()||t.parent().parent().css("background-image","none");i.height(),i.width();p()&&(new b(i.get(0),t.get(0).parentNode.parentNode,{use2Fingers:!0,showBorders:!0,noInit3d:!0}),i.children("div").bind({touchstart:function(){t.parent().parent().siblings().removeClass(_.HOVERED_CLASS),t.parent().parent().addClass(_.HOVERED_CLASS)}})),i.show(),window.reportFrameHeight=window.reportFrameHeight||t.parent().height(),window.reportFrameWidth=window.reportFrameWidth||t.parent().width()}else{var s=n(a.INPUT_CONTROLS_FORM);if(p()){if(this.touchController)this.touchController.reset();else{var r=I("#reportContainer").parent().parent(),l=I("#reportContainer > div").width();r.width()<l&&r.css("width",l+"px"),this.touchController=new b(r[0],r.parent()[0],{noInit3d:!0,scrollbars:!0})}var h=I("#"+a.INPUT_CONTROLS_FORM+" > button.minimize");if(s&&h&&h.is(":visible")){var c=s.hasClassName("minimized");_.maximize(s),c&&_.minimize(s)}}I("#reportContainer").show().height()}I("#reportContainer").parents(".body").slice(0,1).scrollTop(0),o.nothingToDisplay&&(o.nothingToDisplay.addClassName(_.HIDDEN_CLASS),I("#"+o.DATA_REFRESH_BUTTON).removeAttr(_.DISABLED_ATTR_NAME));var d=I("#paginationIndexHolder"),f=I("#emptyReportMessageHolder");if(d.length>0){var g=d.attr("data-lastPageIndex");I("#emptyReportID").addClass(_.HIDDEN_CLASS),"0"===g?I(".control.paging").addClass(_.HIDDEN_CLASS).prev(".divider").addClass(_.HIDDEN_CLASS):I(".control.paging").removeClass(_.HIDDEN_CLASS).prev(".divider").removeClass(_.HIDDEN_CLASS)}if(f&&f.length>0){var C=f.html();I(".control.paging").addClass(_.HIDDEN_CLASS).prev(".divider").addClass(_.HIDDEN_CLASS),I(I("#emptyReportID p.message")[1]).html(C),I("#emptyReportID").removeClass(_.HIDDEN_CLASS),m(I("#emptyReportID"),{horz:!0,vert:!0})}o.refreshPagination(e),o.refreshExporters(),o.refreshSave(),o.refreshAsyncCancel(),this.dataTimestampMessage&&n(o.DATA_TIMESTAMP_SPAN)&&n(o.DATA_TIMESTAMP_SPAN).update(this.dataTimestampMessage),o.allRequestParameters.viewAsDashboardFrame?I("#innerPagination").css("margin","none"):I("#innerPagination").css("margin",0),w.popup.hideShared(n(S.LOADING_ID),o.REPORT_COMPONENT_ID)}}),I.extend(o,{refreshExporters:function(){y[null!=this.lastPageIndex?"enable":"disable"](n("export"))},refreshSave:function(){},refreshPagination:function(e){var t=window.viewer.reportInstance.currentpage,i=window.viewer.reportInstance.status.totalPages;if(this.emptyReport||null!=i&&i<=0)return y.disable(n(o.PAGINATION_PAGE_FIRST)),y.disable(n(o.PAGINATION_PAGE_PREV)),y.disable(n(o.PAGINATION_PAGE_CURRENT)),y.disable(n(o.PAGINATION_PAGE_NEXT)),y.disable(n(o.PAGINATION_PAGE_LAST)),void(n(o.PAGINATION_PAGE_CURRENT)&&(n(o.PAGINATION_PAGE_CURRENT).setValue(""),n(o.PAGINATION_PAGE_TOTAL).update("")));t>0?(y.enable(n(o.PAGINATION_PAGE_FIRST)),y.enable(n(o.PAGINATION_PAGE_PREV))):(y.disable(n(o.PAGINATION_PAGE_FIRST)),y.disable(n(o.PAGINATION_PAGE_PREV))),null==i?(null==this.lastPartialPageIndex||t<this.lastPartialPageIndex?y.enable(n(o.PAGINATION_PAGE_NEXT)):y.disable(n(o.PAGINATION_PAGE_NEXT)),y.disable(n(o.PAGINATION_PAGE_LAST))):t+1<i?(y.enable(n(o.PAGINATION_PAGE_NEXT)),y.enable(n(o.PAGINATION_PAGE_LAST))):(y.disable(n(o.PAGINATION_PAGE_NEXT)),y.disable(n(o.PAGINATION_PAGE_LAST))),y.enable(n(o.PAGINATION_PAGE_CURRENT)),n(o.PAGINATION_PAGE_CURRENT)&&(e||n(o.PAGINATION_PAGE_CURRENT).setValue(t+1),null==i?n(o.PAGINATION_PAGE_TOTAL).update(""):n(o.PAGINATION_PAGE_TOTAL).update(this.getMessage("jasper.report.view.page.of")+i)),this.pageActions={"button#page_first":0,"button#page_prev":t-1,"button#page_next":t+1},null!=window.viewer.reportInstance.status.totalPages&&(this.pageActions["button#page_last"]=i-1);var s=I(".toolsRight .paging.subfocus").find("button");s.length&&s.is(":disabled")?s.is("#"+o.PAGINATION_PAGE_LAST)?x.forceFocus(".toolsRight li.page_first"):s.is("#"+o.PAGINATION_PAGE_FIRST)?x.forceFocus(".toolsRight li.page_last"):s.is("#"+o.PAGINATION_PAGE_NEXT)?x.forceFocus(".toolsRight li.page_prev"):s.is("#"+o.PAGINATION_PAGE_PREV)?x.forceFocus(".toolsRight li.page_next"):s.closest("ul").focus():s.addClass(_.HOVERED_CLASS)},refreshAsyncCancel:function(e){var t=window.viewer.reportInstance.status;n(o.ASYNC_CANCEL_BUTTON)&&(e?(n("asyncIndicator").addClassName(_.HIDDEN_CLASS),y.disable(o.ASYNC_CANCEL_BUTTON),n(o.DATA_REFRESH_BUTTON).removeClassName(_.HIDDEN_CLASS)):t.jasperPrintName&&"running"==t.reportStatus&&null==t.totalPages?(y.enable(o.ASYNC_CANCEL_BUTTON),n("asyncIndicator").removeClassName(_.HIDDEN_CLASS),n(o.DATA_REFRESH_BUTTON).addClassName(_.HIDDEN_CLASS)):(n("asyncIndicator").addClassName(_.HIDDEN_CLASS),y.disable(o.ASYNC_CANCEL_BUTTON),n(o.DATA_REFRESH_BUTTON).removeClassName(_.HIDDEN_CLASS)))}}),I.extend(o,{exportReport:function(e,t){var i,s,n,l,a=o.exportForm;I(a).empty(),a.method="post",a.target="_blank",i=a.action,l=function(){a.target="_self",a.action=i},s={_eventId:"export",_flowExecutionKey:o.reportExecutionKey(),output:""+e};var h=r.getLastSelection();n=T.extend(s,h),f(a,n),t&&(a.action=t),a.submit(),setTimeout(l,500)},goBack:function(){if(o.confirmExit()){var e=o.getAllRequestParameters();y.disable(n("back")),e._ddHyperlink?window.history.back():(o.exportForm._eventId.value="close",o.exportForm._flowExecutionKey.value=o.reportExecutionKey(),o.exportForm.submit())}},open:function(){alert("Not implemented yet: open report")},save:function(){alert("Report saving is not available in community edition")},saveAs:function(){alert("Report saving is not available in community edition")},undo:function(){window.viewer.reportInstance.undo()},redo:function(){window.viewer.reportInstance.redo()},undoAll:function(){window.viewer.reportInstance.undoAll()},cancelReportAsyncExecution:function(e){window.viewer.reportInstance.status.jasperPrintName&&(y.disable(n(o.ASYNC_CANCEL_BUTTON)),window.viewer.reportInstance.cancelExecution(e).then(function(e,t,i){var s=e.result.status;if("finished"!=window.viewer.reportInstance.status.reportStatus&&null==window.viewer.reportInstance.status.totalPages)return e.result.lastPartialPageIndex&&(o.lastPartialPageIndex=e.result.lastPartialPageIndex),"error"==s?void alert("Report execution error: "+e.result.errorMessage):"canceled"==s?(o.refreshAsyncCancel(!0),void w.systemConfirm.show(o.getMessage("jasper.report.view.report.canceled"),5e3)):(e.result.lastPageIndex&&(o.lastPageIndex=e.result.lastPageIndex,window.viewer.reportInstance.status.totalPages=o.lastPageIndex+1),e.result.snapshotSaveStatus&&(o.snapshotSaveStatus=e.result.snapshotSaveStatus),window.viewer.reportInstance.status.reportStatus=s,o.refreshPagination(!0),o.refreshExporters(),o.refreshSave(),o.refreshAsyncCancel(),void 0)},function(e){e.getResponseHeader("lastPartialPageIndex")&&(o.lastPartialPageIndex=e.getResponseHeader("lastPartialPageIndex")),o.refreshPagination(!0)}))}}),i.exports=o}),function(e,t){if("function"!=typeof define||!define.amd)throw"jQuery UI is not loaded.";define("jquery-ui-touch-punch",["jquery","jquery-ui/widget","jquery-ui/widgets/mouse"],e)}(function(e){function t(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var i=e.originalEvent.changedTouches[0],s=document.createEvent("MouseEvents");s.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(s)}}if(e.support.touch="ontouchend"in document,e.support.touch){var i,s=e.ui.mouse.prototype,n=s._mouseInit,o=s._mouseDestroy;s._touchStart=function(e){var s=this;!i&&s._mouseCapture(e.originalEvent.changedTouches[0])&&(i=!0,s._touchMoved=!1,
t(e,"mouseover"),t(e,"mousemove"),t(e,"mousedown"))},s._touchMove=function(e){i&&(this._touchMoved=!0,t(e,"mousemove"))},s._touchEnd=function(e){i&&(t(e,"mouseup"),t(e,"mouseout"),this._touchMoved||t(e,"click"),i=!1)},s._mouseInit=function(){var t=this;t.element.bind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),n.call(t)},s._mouseDestroy=function(){var t=this;t.element.unbind({touchstart:e.proxy(t,"_touchStart"),touchmove:e.proxy(t,"_touchMove"),touchend:e.proxy(t,"_touchEnd")}),o.call(t)}}}),this.jQuery,define("reportViewer/reportViewerMain",["require","exports","module","requirejs-domready","runtime_dependencies/js-sdk/src/jrs.configs","../controls/controls.base","underscore","jquery","../core/core.layout","./report.view.runtime","prototype","../commons/commons.bare.main","../components/components.dialogs","../components/components.toolbarButtons.events","../core/core.events.bis","../core/core.ajax","jquery.urldecoder","../controls/controls.report","jquery-ui-touch-punch"],function(e,t,i){var s=e("requirejs-domready"),n=e("runtime_dependencies/js-sdk/src/jrs.configs"),o=e("../controls/controls.base"),r=o.ControlsBase,l=e("underscore"),a=e("jquery"),h=e("../core/core.layout"),c=e("./report.view.runtime"),d=e("prototype"),u=d.Hash;e("../commons/commons.bare.main"),e("../components/components.dialogs"),e("../components/components.toolbarButtons.events"),e("../core/core.events.bis"),e("../core/core.ajax"),e("jquery.urldecoder"),e("../controls/controls.report"),e("jquery-ui-touch-punch"),window.printRequest=function(){},window.FC_Rendered=function(e){a("#"+e).hide().show()},s(function(){window.Prototype&&(delete Object.prototype.toJSON,delete Array.prototype.toJSON,delete u.prototype.toJSON,delete String.prototype.toJSON),l.extend(r,n.inputControlConstants),l.extend(c,n.reportViewer.ReportSettings),c.allRequestParameters.viewAsDashboardFrame||!c.hasInputControls||2!==c.reportControlsLayout&&4!==c.reportControlsLayout||h.resizeOnClient("inputControlsForm","reportViewFrame"),e(["ReportRequireJsConfig"],function(){e(["./viewer"],function(e){window.viewer=new e({at:"#reportContainer",reporturi:c.reportUnitURI,async:!0,page:0,contextPath:n.contextPath}),window.jasperreports={reportviewertoolbar:window.viewer},c.initialize(),a("body").addClass("jr")})})})});