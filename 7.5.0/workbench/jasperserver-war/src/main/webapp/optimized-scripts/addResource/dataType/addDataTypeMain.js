define("resource/resource.base",["require","exports","module","prototype","../util/touch.controller","../util/utils.common","../core/core.events.bis","../dynamicTree/dynamicTree.utils"],function(e,t,i){var r=e("prototype"),n=r.$,o=r.$$,s=r.$break,a=e("../util/touch.controller"),d=e("../util/utils.common"),c=d.buildActionUrl,l=d.isIPad,u=e("../core/core.events.bis"),p=e("../dynamicTree/dynamicTree.utils"),h={messages:{},resourceLabelMaxLength:100,resourceIdMaxLength:100,resourceDescriptionMaxLength:250,PROPAGATE_EVENT:"propagateEvent",STEP_DISPLAY_ID:"stepDisplay",FLOW_CONTROLS_ID:"flowControls",initSwipeScroll:function(){var e=n(h.STEP_DISPLAY_ID);e&&new a(e.up(),e.up(1),{})},submitForm:function(e,t,i){if(t){var r=c(t);i&&i(),n(e).writeAttribute("method","post").writeAttribute("action",r),n(e).submit()}},registerClickHandlers:function(e,t,i){if(h._bodyClickEventHandlers)return void(i?Array.prototype.unshift:Array.prototype.push).apply(h._bodyClickEventHandlers,e);h._bodyClickEventHandlers=e,o(t||"body")[0].observe("click",function(e){h._bodyClickEventHandlers&&h._bodyClickEventHandlers.each(function(t){var i=t(e);if(i)throw i!==h.PROPAGATE_EVENT&&Event.stop(e),s})})},TreeWrapper:function(e){var t=this;if(this._treeId=e.treeId,this._resourceUriInput=n(e.resourceUriInput||"resourceUri"),this._uri=this._resourceUriInput&&this._resourceUriInput.getValue()||e.uri||"/",!e.providerId)throw"There is no tree provider set for tree #{id}".interpolate({id:this._treeId});var i=["providerId","rootUri","organizationId","publicFolderUri","urlGetNode","urlGetChildren"].inject({},function(t,i){return null!==e[i]&&(t[i]=e[i]),t});return this._tree=new p.createRepositoryTree(this._treeId,i),this._tree.observe("tree:loaded",function(){t._tree.openAndSelectNode(n(t._resourceUriInput).getValue())}),this._tree.observe("leaf:selected",function(e){t._uri=e.memo.node.param.uri,t._resourceUriInput.setValue(t._uri)}),this._tree.observe("node:selected",function(){t._resourceUriInput.setValue(t._uri="")}),{getTreeId:function(){return t._treeId},getTree:function(){return t._tree},selectFolder:function(e){t._tree.openAndSelectNode(e)},getSelectedFolderUri:function(){return t._uri}}},switchButtonState:function(e,t){u[t?"enable":"disable"].call(u,e)},switchDisableState:function(e,t){(e=n(e))&&e[t?"disable":"enable"].call(e)},generateResourceId:function(e){if(window.localContext&&window.localContext.initOptions&&window.localContext.initOptions.resourceIdNotSupportedSymbols)return e.replace(new RegExp(window.localContext.initOptions.resourceIdNotSupportedSymbols,"g"),"_");throw"There is no resourceIdNotSupportedSymbols property in init options."},testResourceId:function(e){if(window.localContext&&window.localContext.initOptions&&window.localContext.initOptions.resourceIdNotSupportedSymbols)return new RegExp(window.localContext.initOptions.resourceIdNotSupportedSymbols,"g").test(e);throw"There is no resourceIdNotSupportedSymbols property in init options."},labelValidator:function(e){var t=!0,i="";return e.blank()?(i=h.messages.labelIsEmpty,t=!1):e.length>h.resourceLabelMaxLength&&(i=h.messages.labelToLong,t=!1),{isValid:t,errorMessage:i}},getLabelValidationEntry:function(e){return{element:e,validators:[{method:"mandatory",messages:{mandatory:h.messages.labelIsEmpty}},{method:"minMaxLength",messages:{tooLong:h.messages.labelToLong},options:{maxLength:h.resourceLabelMaxLength}}]}},getIdValidationEntry:function(e){return{element:e,validators:[{method:"resourceIdChars",messages:h.messages},{method:"mandatory",messages:{mandatory:h.messages.resourceIdIsEmpty}},{method:"minMaxLength",messages:{tooLong:h.messages.resourceIdToLong},options:{maxLength:h.resourceIdMaxLength}}]}},resourceIdValidator:function(e){var t=!0,i="";return this._isEditMode||(e.blank()?(i=h.messages.resourceIdIsEmpty,t=!1):e.length>h.resourceIdMaxLength?(i=h.messages.resourceIdToLong,t=!1):h.testResourceId(e)&&(i=h.messages.resourceIdInvalidChars,t=!1)),{isValid:t,errorMessage:i}},getDescriptionValidationEntry:function(e){return{element:e,validators:[{method:"minMaxLength",messages:{tooLong:h.messages.descriptionToLong},options:{maxLength:h.resourceDescriptionMaxLength}}]}},descriptionValidator:function(e){var t=!0,i="";return e.length>h.resourceDescriptionMaxLength&&(i=h.messages.descriptionToLong,t=!1),{isValid:t,errorMessage:i}},dataSourceValidator:function(e){var t=!0,i="";return""===e.trim()&&(i=h.messages.dataSourceInvalid,t=!1),{isValid:t,errorMessage:i}},queryValidator:function(e){var t=!0,i="";return""===e.trim()&&(i=h.messages.queryInvalid,t=!1),{isValid:t,errorMessage:i}},getValidationEntries:function(e){return e.collect(function(e){return e.validationEntry?e.validationEntry:{validator:e.validator,element:e}})}};void 0===e&&l()&&document.observe("dom:loaded",h.initSwipeScroll.bind(h)),i.exports=h}),define("resource/resource.dataType",["require","exports","module","prototype","./resource.base","../util/utils.common"],function(e,t,i){var r=e("prototype"),n=r.$,o=e("./resource.base"),s=e("../util/utils.common"),a=s.ValidationModule,d={PAGE_ID:"addResource_dataType",DATA_TYPE_ID:"dataType.dataTypeType",LABEL_ID:"dataType.label",RESOURCE_ID_ID:"dataType.name",DESCRIPTION_ID:"dataType.description",SAVE_BUTTON_ID:"done",CHANGE_TYPE_BUTTON_ID:"changeCombo",_canGenerateId:!0,initialize:function(e){this._form=n(this.PAGE_ID).select("form")[0],this._dataType=n(this.DATA_TYPE_ID),this._label=n(this.LABEL_ID),this._resourceId=n(this.RESOURCE_ID_ID),this._description=n(this.DESCRIPTION_ID),this._saveButton=n(this.SAVE_BUTTON_ID),this._changeTypeButton=n(this.CHANGE_TYPE_BUTTON_ID),this._isEditMode=e.isEditMode,this._label.validator=o.labelValidator.bind(this),this._resourceId.validator=o.resourceIdValidator.bind(this),this._description.validator=o.descriptionValidator.bind(this),this._initEvents()},_initEvents:function(){this._dataType.observe("change",function(){this._changeTypeButton.click()}.bindAsEventListener(this)),this._saveButton.observe("click",function(e){this._isDataValid()||e.stop()}.bindAsEventListener(this)),this._form.observe("keyup",function(e){var t=e.element();[this._label,this._resourceId,this._description].include(t)&&(a.validate(o.getValidationEntries([t])),t==this._resourceId&&this._resourceId.getValue()!=o.generateResourceId(this._label.getValue())&&(this._canGenerateId=!1),t==this._label&&!this._isEditMode&&this._canGenerateId&&(this._resourceId.setValue(o.generateResourceId(this._label.getValue())),a.validate(o.getValidationEntries([this._resourceId]))))}.bindAsEventListener(this))},_isDataValid:function(){var e=[this._label,this._resourceId,this._description];return a.validate(o.getValidationEntries(e))}};void 0===e&&document.observe("dom:loaded",function(){d.initialize(window.localContext.initOptions)}),i.exports=d}),define("components/components.calendarInput",["require","exports","module","jquery","underscore","settings!dateTimeSettings","../util/utils.common","../config/dateAndTimeSettings"],function(e,t,i){var r=e("jquery"),n=e("underscore"),o=e("settings!dateTimeSettings"),s=e("../util/utils.common"),a=s.cancelEventBubbling;e("../config/dateAndTimeSettings");var d=function(e){this.container=null,void 0!==e.container&&(this.container=void 0===e.container.jquery?r(e.container):e.container),this.name=e.name,this.id=e.name.replace(".","_"),this.value=e.value,this.onChange=e.onchange||null,this.isReadOnly=void 0!==e.readOnly&&e.readOnly,this.hasDate=void 0!==e.date&&""!==e.date&&"true"===e.date,this.hasTime=void 0!==e.time&&""!==e.time&&"true"===e.time,this.pickerOptions=n.extend({},this.defaultPickerOptions),this.hasDate&&n.extend(this.pickerOptions,o.datepicker),this.hasTime&&n.extend(this.pickerOptions,o.timepicker),void 0!==e.picker&&n.isObject(e.picker)&&n.extend(this.pickerOptions,e.picker),this.field=null};d.prototype.defaultPickerOptions={showOn:"button",buttonText:"",changeYear:!0,changeMonth:!0,showButtonPanel:!0,onChangeMonthYear:null,beforeShow:r.datepicker.movePickerRelativelyToTriggerIcon},d.prototype.create=function(){var e=r("<input type='text'/>").attr({name:this.name,id:this.id,value:this.value});if(e.on("mousedown",a),this.onChange&&e.on("change",this.onChange),this.isReadOnly&&e.attr("disabled","disabled"),this.field=e,this.container.append(this.field),!this.isReadOnly){var t=this.hasDate?"date":"";t+=this.hasTime?"time":"",t+="picker",r.fn[t].call(e,this.pickerOptions).next().addClass("button").addClass("picker"),e[0].getValue=function(){return r(this).val()}}},i.exports=d}),define("addResource/dataType/addDataTypeMain",["require","exports","module","requirejs-domready","../../resource/resource.dataType","underscore","jquery","../../components/components.calendarInput","runtime_dependencies/js-sdk/src/jrs.configs","../../resource/resource.base","../../util/utils.common"],function(e,t,i){function r(){return s.indexOf([3,4,5],c.addDataType.type)>-1}var n=e("requirejs-domready"),o=e("../../resource/resource.dataType"),s=e("underscore"),a=e("jquery"),d=e("../../components/components.calendarInput"),c=e("runtime_dependencies/js-sdk/src/jrs.configs"),l=e("../../resource/resource.base"),u=e("../../util/utils.common"),p=u.isIPad;n(function(){var e=c.addDataType.localContext.initOptions;if(s.extend(window.localContext,c.addDataType.localContext),s.extend(l.messages,c.addDataType.resource.messages),r()){var t=new d(c.addDataType.minValueText);t.container=a("label.minPicker"),t.create();var i=new d(c.addDataType.maxValueText);i.container=a("label.maxPicker"),i.create()}o.initialize(e),p()&&l.initSwipeScroll(),a("body").addClass("jr")})});