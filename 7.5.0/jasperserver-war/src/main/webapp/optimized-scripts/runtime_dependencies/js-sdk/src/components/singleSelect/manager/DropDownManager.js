define(["require","exports","module","underscore","jquery"],function(t,e,s){var f=t("underscore"),i=t("jquery"),o=i("body"),n=function(t){return this.initialize(t),this};f.extend(n.prototype,{initialize:function(t){f.bindAll(this,"checkOffset","setNewOffset"),this.$dropDownEl=t.dropDownEl,this.calcOffset=t.calcOffset,this.isOffsetChanged=t.isOffsetChanged||this._isOffsetChanged,this.recalcInterval=t.recalcInterval||500,this.onOffsetChanged=t.onOffsetChanged},startCalc:function(){this.checkOffset(this.setNewOffset),clearInterval(this.recalcTimer),this.recalcTimer=setInterval(f.bind(this.checkOffset,this,this.onOffsetChanged),this.recalcInterval)},stopCalc:function(){clearInterval(this.recalcTimer)},checkOffset:function(t){var e=this.calcOffset(),s=this.$dropDownEl.position(),f=o.offset();(f.top||f.left)&&(s.top+=f.top,s.left+=f.left),this.$dropDownEl.width()!==e.width&&this.setNewOffset(e),this.isOffsetChanged(s,e)&&t&&t(e)},setNewOffset:function(t){this.$dropDownEl.css("top",t.top-o.offset().top).css("left",t.left-o.offset().left).css("width",t.width)},_isOffsetChanged:function(t,e){return Math.floor(t.top)!==Math.floor(e.top)||Math.floor(t.left)!==Math.floor(e.left)}}),s.exports=n});