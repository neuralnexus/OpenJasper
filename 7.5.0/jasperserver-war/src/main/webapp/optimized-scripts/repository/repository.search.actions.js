define(["require","exports","module","prototype","../components/components.dialogs","underscore","./repository.search.main","../actionModel/actionModel.modelGenerator","../namespace/namespace","../core/core.ajax","../core/core.ajax.utils","../util/utils.common","jquery"],function(e,r,t){var o=e("prototype"),n=o.$,i=e("../components/components.dialogs"),c=e("underscore"),a=e("./repository.search.main"),u=a.repositorySearch,d=a.ResourcesUtils,s=a.invokeResourceAction,R=a.isPropertiesChanged,l=a.isPermissionsChanged,p=e("../actionModel/actionModel.modelGenerator"),f=e("../namespace/namespace"),A=f.JRS,E=e("../core/core.ajax"),I=E.ajax,w=E.ajaxTargettedUpdate,U=E.AjaxRequester,F=e("../core/core.ajax.utils"),T=F.baseErrorHandler,D=e("../util/utils.common"),m=D.ajaxIframeDownload,h=D.doNothing,v=D.redirectToUrl,C=D.downloadFileByUrl,y=e("jquery");u.Action=function(e){Object.isFunction(e)&&(this.invokeAction=e)},u.Action.DEFAULT="default-action",u.Action.addMethod("invokeAction",h),u.folderActionFactory={CreateFolder:function(e){return new u.Action(function(){u.showCreateFolderConfirm(e)})},CopyFolder:function(e){return new u.Action(function(){u.CopyMoveController.copy(e)})},MoveFolder:function(e){return new u.Action(function(){u.CopyMoveController.move(e)})},PasteFolder:function(e){return new u.Action(function(){var r,t=e||u.model.getContextFolder();u.CopyMoveController.object;if(u.CopyMoveController.isCopyFolder())r=u.FolderAction.COPY;else{if(!u.CopyMoveController.isMoveFolder())return;r=u.FolderAction.MOVE}new u.ServerAction.createFolderAction(r,{toFolder:t,folder:u.CopyMoveController.object}).invokeAction()})},PasteResources:function(e){return new u.Action(function(){var r,t=e||u.model.getContextFolder();t||(t=u.model.getSelectedFolder());var o=u.CopyMoveController.object,n=u.CopyMoveController.isBulkAction()?[].concat(o):[o];if(u.CopyMoveController.isCopyResource())r=u.ResourceAction.COPY;else{if(!u.CopyMoveController.isMoveResource())return;r=u.ResourceAction.MOVE}for(var i=0;i<n.length;i++)if(n[i].parentResource){for(var c=n[i].parentResource.URI,a=!1,d=0;d<n.length&&!a;d++)a|=n[d].URI==c;a||n.push(n[i].parentResource)}new u.ServerAction.createResourceAction(r,{resources:n,folder:t}).invokeAction()})},DeleteFolder:function(e){return new u.Action(function(){p.hideMenu(),u.showDeleteFolderConfirm(e)})},ShowFolderProperties:function(e){return new u.Action(function(){u.showFolderProperties(e)})},EditFolderProperties:function(e){return new u.Action(function(){u.editFolderProperties(e)})},AssignPermissions:function(e){return new u.Action(function(){u.editFolderPermissions(e)})},SetActiveThemeFolder:function(e){return new u.Action(function(){new u.ServerAction.createFolderAction(u.ThemeAction.SETTHEME,{folder:e}).invokeAction()})},DownloadTheme:function(e){return new u.Action(function(){new u.ServerAction.createFolderAction(u.ThemeAction.DOWNLOAD_THEME,{folder:e}).initDownload()})},UploadTheme:function(e){return new u.Action(function(){u.showUploadThemeConfirm(e,!1)})},ReuploadTheme:function(e){return new u.Action(function(){u.showUploadThemeConfirm(e,!0)})},Export:function(e){return new u.Action(function(){u.exportDialog.openRepoDialog(e)})}},u.resourceActionFactory={Copy:function(e){return new u.Action(function(){u.CopyMoveController.copy(e)})},Move:function(e){return new u.Action(function(){u.CopyMoveController.move(e)})},Delete:function(e){return new u.Action(function(){p.hideMenu(),u.showDeleteResourceConfirm(e)})},Export:function(e,r){return new u.Action(function(){u.exportDialog.openRepoDialog(e)})},ShowProperties:function(e,r){return new u.Action(function(){u.showResourceProperties(e,r)})},EditProperties:function(e,r){return new u.Action(function(){u.editResourceProperties(e,r)})},AssignPermissionsToResourceAction:function(e){return new u.Action(function(){u.editResourcePermissions(e)})},GenerateResourceAction:function(e,r){return new u.Action(function(){A.CreateReport.selectGenerator(e.URIString)})},ConvertResourceAction:function(e,r){return new u.Action(function(){new u.ServerAction.createConvertAction(u.ResourceAction.CONVERT,{reportUri:e.URIString}).invokeAction()})}},u.bulkActionFactory={Run:function(e){return new u.Action(function(){e.each(function(e,r){u.RedirectAction.createRunResourceAction(e,0!==r).invokeAction()})})},Edit:function(e){return new u.Action(function(){e.each(function(e,r){u.RedirectAction.createEditResourceAction(e,0!==r).invokeAction()})})},Open:function(e){return new u.Action(function(){e.each(function(r,t){u.RedirectAction.createOpenResourceAction(r,e.length>1).invokeAction()})})},Copy:function(e){return new u.Action(function(){u.CopyMoveController.copy(e)})},Move:function(e){return new u.Action(function(){u.CopyMoveController.move(e)})},Delete:function(e){return new u.Action(function(){p.hideMenu(),1==e.length?u.showDeleteResourceConfirm(e[0]):u.showBulkDeleteResourcesConfirm(e)})},ShowProperties:function(e){return new u.Action(function(){e.each(function(r,t){s("ShowProperties",r,{cascade:!0,position:t,number:e.length})})})},EditProperties:function(e){return new u.Action(function(){e.each(function(r,t){s("EditProperties",r,{cascade:!0,position:t,number:e.length})})})},Export:function(e){return new u.Action(function(){u.exportDialog.openRepoDialog(e)})}},u.ServerAction=function(e,r){this.actionURL="flow.html?_flowExecutionKey="+u.flowExecutionKey+"&_eventId="+e,this.data=Object.toQueryString(r.data)},u.ServerAction.addMethod("invokeAction",function(){w(this.actionURL,{postData:this.data,callback:function(e){"OK"==e.status?this.onSuccess(e.data):this.onError(e.data)}.bind(this),errorHandler:this._serverErrorHandler,mode:U.prototype.EVAL_JSON})}),u.ServerAction.addMethod("initDownload",function(){var e=this.actionURL+"&"+this.data;m(e,{onload:function(){var e=y(n("ajax-download-iframe").contentDocument.body).html();try{var r=e.evalJSON();alert(r.data)}catch(e){}}})}),u.ServerAction.addMethod("_serverErrorHandler",function(e){return T(e)}),u.ServerAction.addMethod("onSuccess",h),u.ServerAction.addMethod("onError",h),u.ServerAction.createSearchAction=function(e,r){r.mode=u.mode;var t=new u.ServerAction(e,{data:r});return t.onSuccess=function(t){e==u.SearchAction.NEXT?u.fire(u.Event.RESULT_NEXT,t):e==u.SearchAction.GET_RESOURCE_CHILDREN?u.fire(u.Event.CHILDREN_LOADED,{inputData:r,responseData:t}):(u.fire(u.Event.RESULT_CHANGED,t),u.fire(u.Event.STATE_CHANGED,t),u.mode==u.Mode.SEARCH&&u.fire(u.Event.FILTER_PATH_CHANGED,t))},t.onError=function(e){u.fire(u.Event.RESULT_ERROR,e)},t},u.ServerAction.createFolderAction=function(e,r){var t,o,n;u.FolderAction.DELETE==e?(t={sourceFolderUri:r.folder.URI},o=u.FolderEvent.DELETED,n=u.FolderEvent.DELETE_ERROR):u.FolderAction.CREATE==e?(t={destFolderUri:r.toFolder.URI,folder:Object.toJSON({URI:"",label:r.label,desc:r.desc})},o=u.FolderEvent.CREATED,n=u.FolderEvent.CREATE_ERROR):u.FolderAction.COPY==e?(t={destFolderUri:r.toFolder.URI,sourceFolderUri:r.folder.URI},o=u.FolderEvent.COPIED,n=u.FolderEvent.COPY_ERROR):u.FolderAction.MOVE==e?(t={destFolderUri:r.toFolder.URI,sourceFolderUri:r.folder.URI},o=u.FolderEvent.MOVED,n=u.FolderEvent.MOVE_ERROR):u.FolderAction.UPDATE==e?(t={folder:Object.toJSON({URI:r.folder.URI,label:r.folder.label,desc:r.folder.description})},o=u.FolderEvent.UPDATED,n=u.FolderEvent.UPDATE_ERROR):u.ThemeAction.SETTHEME==e?(r.folder?t={folderUri:r.folder.URI}:r.folderUri&&(t={folderUri:r.folderUri}),o=u.ThemeEvent.UPDATED):u.ThemeAction.DOWNLOAD_THEME==e?(t={folderUri:r.folder.URI},n=u.ThemeEvent.THEME_ERROR):u.ThemeAction.REUPLOAD==e&&(t={themeName:r.themeName,folderUri:r.folderUri},o=u.ThemeEvent.REUPLOADED,n=u.ThemeEvent.THEME_ERROR),t&&o&&n||new Error("Unsupported folder action.");var i=new u.ServerAction(e,{data:t});return i.onSuccess=function(e){u.fire(o,{responseData:e,inputData:r})},i.onError=function(e){u.fire(n,{responseData:e,inputData:r})},i},u.ServerAction.createResourceAction=function(e,r){function t(t,o){i.dependentResources.show(t,{dependenciesBtnOk:function(){new u.ServerAction.createResourceAction(e,{resources:o,folder:r.folder}).invokeAction()}},{buttons:["ok","cancel"],dialogTitle:u.getMessage("dialog.resources.exist.title"),topMessage:u.getMessage("dialog.resources.exist"),bottomMessage:u.getMessage("dialog.resources.exist.confirm.skip")})}function o(o){var n;if(u.ResourceAction.COPY!=e&&u.ResourceAction.MOVE!=e)return o;try{n=JSON.parse(o)}catch(e){return o}if(!n||!n.existingLabels)return o;var i=c.filter(r.resources,function(e){return-1==n.existingLabels.indexOf(e.label)});return 0===i.length?(1==n.existingLabels.length?u.getMessage("dialog.resources.one.exists"):u.getMessage("dialog.resources.all.exist"))+" "+r.folder.URIString:(t(n.existingLabels,i),null)}var n,a,s;if(u.ResourceAction.DELETE==e){var R=d.getResourceUriAndTypeList(r.resources);n={selectedResources:Object.toJSON(R)},a=u.ResourceEvent.DELETED,s=u.ResourceEvent.DELETE_ERROR}else if(u.ResourceAction.COPY==e){var l=d.getResourceUris(r.resources);n={selectedResources:Object.toJSON(l),destFolderUri:r.folder.URI},a=u.ResourceEvent.COPIED,s=u.ResourceEvent.COPY_ERROR}else if(u.ResourceAction.MOVE==e){var p=d.getResourceUris(r.resources);n={selectedResources:Object.toJSON(p),destFolderUri:r.folder.URI},a=u.ResourceEvent.MOVED,s=u.ResourceEvent.MOVE_ERROR}else u.ResourceAction.UPDATE==e&&(n={selectedResource:Object.toJSON(r.resource)},a=u.ResourceEvent.UPDATED,s=u.ResourceEvent.UPDATE_ERROR);n&&a&&s||new Error("Unsupported resource action.");var f=new u.ServerAction(e,{data:n});return f.onSuccess=function(t){u.ResourceAction.MOVE==e&&u.CopyMoveController.cancel(),u.fire(a,{responseData:t,inputData:r})},f.onError=function(e){var t=o(e);t&&u.fire(s,{responseData:t,inputData:r})},f},u.ServerAction.createPermissionAction=function(e,r){var t=new u.ServerAction(e,{data:r}),o=e==u.PermissionAction.UPDATE?u.PermissionEvent.UPDATED:u.PermissionEvent.LOADED;return t.onSuccess=function(t){u.fire(o,{responseData:t,inputData:r,doSet:e!=u.PermissionAction.NEXT})},t.onError=function(e){u.fire(u.PermissionEvent.ERROR,e)},t},u.ServerAction.createGenerateAction=function(e,r){var t=new u.ServerAction(e,{data:{data:Object.toJSON(r)}});return t.actionURL="reportGenerator.html?action="+e,t.onSuccess=function(e){u.fire(u.ResourceEvent.GENERATED,{responseData:e,inputData:r})},t.onError=function(e){u.fire(u.ResourceEvent.GENERATE_ERROR,{responseData:e,inputData:r})},t},u.ServerAction.createConvertAction=function(e,r){var t=new u.ServerAction(e,{data:r});return t.actionURL="dataViewConverter.html?action="+e,t.onSuccess=function(e){u.fire(u.ResourceEvent.CONVERTED,{responseData:e,inputData:r})},t.onError=function(e){u.fire(u.ResourceEvent.CONVERT_ERROR,{responseData:e,inputData:r})},t},u.RedirectAction=function(e,r){this.DIMMER_TIMEOUT=400,this.type=e,this.flowId=r.flowId,this.url=r.url?r.url:this.flowId?this.FLOW_URL:void 0,this.paramsMap=r.paramsMap||{},this.hash=r.hash?"#"+r.hash:"",this.encode=r.encode,this.type!==u.RedirectType.FLOW_REDIRECT&&this.url===this.FLOW_URL&&(this.paramsMap._flowId=this.flowId)},u.RedirectAction.addMethod("FLOW_URL","flow.html"),u.RedirectAction.addMethod("_serializeParams",function(e,r){if(e){var t="";for(var o in e)Object.isUndefined(o)||(t+="&"+o+"="+(r?encodeURIComponent(e[o]):e[o]));return t&&t.length>0?t.substring(1):""}return""}),u.RedirectAction.addMethod("invokeAction",function(e){if(e=e||{},this.type===u.RedirectType.FLOW_REDIRECT){var r=n("redirectForm");n("flowParams").setValue(this.flowId+"?"+this._serializeParams(this.paramsMap,this.encode));var t=new u.ServerAction("isServerAvailable",{data:{}}),o=setTimeout(function(){i.popup.show(I.LOADING_ID,!0)},this.DIMMER_TIMEOUT);t.onSuccess=function(e){"Yes"==e.strip()?(++I.ajaxRequestCount,i.popup.show(I.LOADING_ID,!0),r.submit(),u.fire(u.Event.FLOW_REDIRECT_RUNNING,e)):(c(),u.fire(u.Event.REDIRECT_ERROR,e))},t.onError=function(e){c(),u.fire(u.Event.REDIRECT_ERROR,e)};var c=function(){clearTimeout(o),i.popup.hide(I.LOADING_ID)};t.invokeAction()}else if(this.type===u.RedirectType.LOCATION_REDIRECT){var a=this.url+(y.isEmptyObject(this.paramsMap)?"":"?"+this._serializeParams(this.paramsMap,this.encode))+this.hash;e.isContentResource?C(a):v(a)}else if(this.type===u.RedirectType.WINDOW_REDIRECT){var d=window.open(),s=this._serializeParams(this.paramsMap,this.encode);d.opener=null,d.document.location=this.url+(s?"?"+s:"")+this.hash}}),u.runActionFactory={ReportUnit:function(e,r){var t=r?u.RedirectType.WINDOW_REDIRECT:u.RedirectType.FLOW_REDIRECT;return new u.RedirectAction(t,{url:"flow.html",flowId:"viewReportFlow",paramsMap:{_flowId:"viewReportFlow",reportUnit:r?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:r?encodeURIComponent(e.parentFolder):e.parentFolder}})},AdhocReportUnit:function(e,r){var t=r?u.RedirectType.WINDOW_REDIRECT:u.RedirectType.FLOW_REDIRECT;return new u.RedirectAction(t,{url:"flow.html",flowId:"viewAdhocReportFlow",paramsMap:{reportUnit:r?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:r?encodeURIComponent(e.parentFolder):e.parentFolder}})},OlapUnit:function(e,r){var t=r?u.RedirectType.WINDOW_REDIRECT:u.RedirectType.LOCATION_REDIRECT;return new u.RedirectAction(t,{url:"olap/viewOlap.html",paramsMap:{name:r?encodeURIComponent(e.URIString):e.URIString,new:!0,parentFlow:"searchFlow",ParentFolderUri:r?encodeURIComponent(e.parentFolder):e.parentFolder}})},DashboardResource:function(e,r){var t=r?u.RedirectType.WINDOW_REDIRECT:u.RedirectType.FLOW_REDIRECT;return new u.RedirectAction(t,{url:"flow.html",flowId:"dashboardRuntimeFlow",paramsMap:{dashboardResource:r?encodeURIComponent(e.URIString):e.URIString}})},DashboardModelResource:function(e,r){var t=r?u.RedirectType.WINDOW_REDIRECT:u.RedirectType.LOCATION_REDIRECT;return new u.RedirectAction(t,{url:"dashboard/viewer.html#"+encodeURIComponent(e.URIString)})},ReportOptions:function(e,r){var t,o={reportOptionsURI:r?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:r?encodeURIComponent(e.parentFolder):e.parentFolder},n=e.parentResource;n&&n.typeEquals(u.ResourceType.ADHOC_REPORT_UNIT)?(t="viewAdhocReportFlow",o.reportUnit=r?encodeURIComponent(n.URIString):n.URIString):t="viewReportFlow";var i=r?u.RedirectType.WINDOW_REDIRECT:u.RedirectType.FLOW_REDIRECT;return new u.RedirectAction(i,{url:"flow.html",flowId:t,paramsMap:o})}},u.RedirectAction.createRunResourceAction=function(e,r){e||(e=e||u.model.getSelectedResources()[0]);var t=u.runActionFactory[e.typeSuffix()];return t?t(e,r):new u.Action(function(){alert("Run action for resource type '"+e.resourceType+"' is not implemented!")})},u.RedirectAction.createRunResourceInNewTabAction=function(e,r){return u.RedirectAction.createRunResourceAction(e,!0)},u.editActionFactory={"default-action":function(e,r){return d.isCustomDataSource(e)?u.editActionFactory.JdbcReportDataSource(e,r):new u.Action(function(){alert("Edit action for resource type '"+e.resourceType+"' is not implemented!")})},ReportUnit:function(e,r){return new u.RedirectAction(r,{flowId:"reportUnitFlow",paramsMap:{selectedResource:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocReportUnit:function(e,r){return u.editActionFactory.ReportUnit(e,r)},DataDefinerUnit:function(e,r){return new u.RedirectAction(r,{flowId:"queryBuilderFlow",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})},OlapUnit:function(e,r){return new u.RedirectAction(r,{flowId:"olapUnitFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},DashboardResource:function(e,r){return new u.RedirectAction(r,{flowId:"dashboardRuntimeFlow",paramsMap:{dashboardResource:e.URIString}})},ReportOptions:function(e,r){return new u.RedirectAction(r,{flowId:"reportOptionsEditFlow",paramsMap:{reportOptionsURI:e.URIString,ParentFolderUri:e.parentFolder}})},JdbcReportDataSource:function(e,r){return new u.RedirectAction(r,{flowId:"addDataSourceFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},JndiJdbcReportDataSource:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},CustomReportDataSource:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},BeanReportDataSource:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},VirtualReportDataSource:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},HiveDataSourceService:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},CassandraDataSourceService:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},DiagnosticCustomDataSourceService:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},MongoDbDataSourceService:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},AwsReportDataSource:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},AzureSqlReportDataSource:function(e,r){return u.editActionFactory.JdbcReportDataSource(e,r)},Query:function(e,r){return new u.RedirectAction(r,{flowId:"queryFlow",paramsMap:{currentQuery:e.URIString,isEdit:!0,ParentFolderUri:e.parentFolder}})},InputControl:function(e,r){return new u.RedirectAction(r,{flowId:"addInputControlFlow",paramsMap:{isEdit:!0,resource:e.URIString,ParentFolderUri:e.parentFolder}})},ListOfValues:function(e,r){return new u.RedirectAction(r,{flowId:"addListOfValuesFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},DataType:function(e,r){return new u.RedirectAction(r,{flowId:"dataTypeFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},MondrianConnection:function(e,r){return new u.RedirectAction(r,{flowId:"olapClientConnectionFlow",paramsMap:{selectedResource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},SecureMondrianConnection:function(e,r){return u.editActionFactory.MondrianConnection(e,r)},XMLAConnection:function(e,r){return u.editActionFactory.MondrianConnection(e,r)},MondrianXMLADefinition:function(e,r){return new u.RedirectAction(r,{flowId:"mondrianXmlaSourceFlow",paramsMap:{selectedResource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},FileResource:function(e,r){return new u.RedirectAction(r,{flowId:"addFileResourceFlow",paramsMap:{selectedResource:e.URIString,ParentFolderUri:e.parentFolder}})},SemanticLayerDataSource:function(e,r){return new u.RedirectAction(r,{url:"domaindesigner.html",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})}},u.resourceTypeToDefaultRedirectTypeMap={},u.resourceTypeToDefaultRedirectTypeMap[u.ResourceType.SEMANTIC_LAYER_DATA_SOURCE]=u.RedirectType.LOCATION_REDIRECT,u.getDefaultRedirectTypeByResourceType=function(e){var r=u.resourceTypeToDefaultRedirectTypeMap[e];return r||(r=u.RedirectType.FLOW_REDIRECT),r},u.RedirectAction.createEditResourceAction=function(e,r){e||(e=u.model.getSelectedResources()[0]);var t;t=r?u.RedirectType.WINDOW_REDIRECT:u.getDefaultRedirectTypeByResourceType(e.resourceType);var o=u.editActionFactory[e.typeSuffix()];return o?o(e,t):u.editActionFactory[u.Action.DEFAULT](e,t)},u.openActionFactory={ContentResource:function(e,r){return r===u.RedirectType.FLOW_REDIRECT&&(r=u.RedirectType.LOCATION_REDIRECT),new u.RedirectAction(r,{url:"fileview/fileview"+e.URIString,paramsMap:{}})},DashboardResource:function(e,r){return new u.RedirectAction(r,{flowId:"dashboardDesignerFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},DashboardModelResource:function(e,r){var t=r?u.RedirectType.WINDOW_REDIRECT:u.RedirectType.LOCATION_REDIRECT;return new u.RedirectAction(t,{url:"dashboard/designer.html#"+encodeURIComponent(e.URIString)})},DataDefinerUnit:function(e,r){return new u.RedirectAction(r,{flowId:"queryBuilderFlow",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocReportUnit:function(e,r){return new u.RedirectAction(r,{flowId:"adhocFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocDataView:function(e,r){return new u.RedirectAction(r,{flowId:"adhocFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})}},u.RedirectAction.createOpenResourceAction=function(e,r){e||(e=u.model.getSelectedResources()[0]);var t=r?u.RedirectType.WINDOW_REDIRECT:u.RedirectType.FLOW_REDIRECT,o=u.openActionFactory[e.typeSuffix()];return o?o(e,t):new u.Action(function(){alert("Open action for resource type '"+e.resourceType+"' is not implemented!")})},u.RedirectAction.createRunInBackgroundResourceAction=function(){var e=u.model.getSelectedResources()[0],r="";if(e.resourceType.endsWith(".ReportUnit")||e.resourceType.endsWith(".AdhocReportUnit")||e.resourceType.endsWith(".DashboardModelResource")||e.resourceType.endsWith(".ReportOptions"))return e.parentResource&&(r="@@parentReportURI="+e.parentResource.URIString+"@@"),new u.RedirectAction(u.RedirectType.LOCATION_REDIRECT,{url:A.vars.contextPath+"/scheduler/main.html",paramsMap:{reportUnitURI:e.URIString,parentReportUnitURI:e.parentResource?e.parentResource.URIString:"",resourceType:e.resourceType.substring(e.resourceType.lastIndexOf(".")+1)},hash:"runInBackground@"+e.URIString+r,encode:!0})},u.RedirectAction.createScheduleAction=function(){var e=u.model.getSelectedResources()[0],r="";if(e.resourceType.endsWith(".ReportUnit")||e.resourceType.endsWith(".AdhocReportUnit")||e.resourceType.endsWith(".DashboardModelResource")||e.resourceType.endsWith(".ReportOptions"))return e.parentResource&&(r="@@parentReportURI="+e.parentResource.URIString+"@@"),new u.RedirectAction(u.RedirectType.LOCATION_REDIRECT,{url:A.vars.contextPath+"/scheduler/main.html",paramsMap:{reportUnitURI:e.URIString,resourceType:e.resourceType.substring(1+e.resourceType.lastIndexOf(".")),parentReportUnitURI:e.parentResource?e.parentResource.URIString:""},hash:e.URIString+r,encode:!0})},u.createActionFactory={OlapClientConnection:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"olapClientConnectionFlow",paramsMap:{ParentFolderUri:e.URI}})},OlapUnit:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"olapUnitFlow",paramsMap:{ParentFolderUri:e.URI}})},ReportDataSource:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"addDataSourceFlow",paramsMap:{ParentFolderUri:e.URI}})},SemanticLayerDataSource:function(e){return new u.RedirectAction(u.RedirectType.LOCATION_REDIRECT,{url:"domaindesigner.html",paramsMap:{ParentFolderUri:e.URI}})},FileResource:function(e,r){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"addFileResourceFlow",paramsMap:{expectedFileType:r,parentFolder:e.URI}})},ReportUnit:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"reportUnitFlow",paramsMap:{ParentFolderUri:e.URI}})},Query:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"queryFlow",paramsMap:{ParentFolderUri:e.URI}})},InputControl:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"addInputControlFlow",paramsMap:{ParentFolderUri:e.URI}})},DataType:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"dataTypeFlow",paramsMap:{ParentFolderUri:e.URI}})},ListOfValues:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"addListOfValuesFlow",paramsMap:{ParentFolderUri:e.URI}})},XMLAConnection:function(e){return new u.RedirectAction(u.RedirectType.FLOW_REDIRECT,{flowId:"mondrianXmlaSourceFlow",paramsMap:{ParentFolderUri:e.URI}})}},u.RedirectAction.createCreateResourceAction=function(e,r){var t=u.model.getContextFolder(),o=u.createActionFactory[e];return o?o(t,r):new u.Action(function(){alert("Create action for resource type suffix '"+e+"' is not implemented!")})},u.confirmAndLeave=function(){return new u.Action(function(){return!R()&&!l()||confirm(u.getMessage("RM_CANCEL_EDIT_MESSAGE"))}).invokeAction()},t.exports=u});