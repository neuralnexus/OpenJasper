define(["require","exports","module","jquery","underscore","logger"],function(e,n,t){"use strict";var i=e("jquery"),s=(e("underscore"),e("logger").register(t));return{_onClick:function(e){var n=i(e.target);if(1===n.length){if(null!=this._buildBehavior(n).click){!1===this.runAction("click",e.target)&&(e.stopPropagation(),e.preventDefault())}}},_onMouseDown:function(e){var n=i(e.target);if(1===n.length){if(null!=this._buildBehavior(n).mousedown){!1===this.runAction("mousedown",e.target)&&(e.stopPropagation(),e.preventDefault())}}},_onMouseUp:function(e){var n=i(e.target);if(1===n.length){if(null!=this._buildBehavior(n).mouseup){!1===this.runAction("mouseup",e.target)&&(e.stopPropagation(),e.preventDefault())}}},_onLabeledTagOver:function(e){var n=i(e.currentTarget);n.attr("aria-label")&&n.data("title")&&n.attr("title",n.attr("aria-label"))},_onKeydown:function(e){e.target;if(0!==i(".subfocus").length){var n=i(".subfocus")[0],t=i(n).prop("nodeName");if(i(n).is(":input")||i.inArray(t,["INPUT","SELECT","OBJECT","TEXTAREA"])>-1)if("INPUT"===t){if(0===i(n).closest(".j-toolbar").length)return}else if("BUTTON"!==t&&27!==e.keyCode)return;var s;switch(e.keyCode){case 13:s="enter";break;case 27:s="exit";break;case 32:s="toggle";break;case 33:s="pageup";break;case 34:s="pagedown";break;case 35:s="end";break;case 36:s="home";break;case 37:s="left";break;case 38:s="up";break;case 39:s="right";break;case 40:s="down";break;case 91:s="structleft";break;case 93:s="structright"}if(!this.nullOrUndefined(s)){var a=this.runAction(s,n);this.nullOrUndefined(a)||(e.stopPropagation(),e.preventDefault(),this.forceFocus(a))}}},basicClick:function(e,n){var t=this.runAction("fixfocus",e);return this.nullOrUndefined(t)?s.debug("stdnav.basicClick: "+e.nodeName+"#"+e.id+" has no navigable ancestor, ignoring"):(s.debug("stdnav.basicClick("+e.nodeName+"#"+e.id+") refocusing to "+t.nodeName+"#"+t.id),this.nullOrUndefined(t)||this.forceFocus(t)),!0},basicFixFocus:function(e,n){if(this.isNavigable(e)||i(e).is(":input"))return e;var t=this.closestNavigableAncestor(e);return this.nullOrUndefined(t)?null:t},basicFixSuperfocus:function(e,n){var t=null;if(i(e).is(":input,fieldset")){var s=i(e).closest("form");i(e).closest("form"),s.length>0&&(t=s[0])}else t=this.isNavigable(e)?e:this.closestNavigableAncestor(e);return null!==t&&void 0!==t||(t=e),t},parentFixSuperfocus:function(e,n){return this.basicFixSuperfocus(e.parentNode,n)},basicFixSubfocus:function(e,n){return e},basicFocusIn:function(e,n){return s.debug("stdnav.basicFocusIn("+e.nodeName+"#"+e.id+")"),e},basicFocusOut:function(e,n){return s.debug("stdnav.basicFocusOut("+e.nodeName+"#"+e.id+")"),null},basicMouseDown:function(e,n){var t=this.runAction("fixfocus",e);return this.nullOrUndefined(t)?s.debug("stdnav.basicClick: "+e.nodeName+"#"+e.id+" has no navigable ancestor, ignoring"):(s.debug("stdnav.basicClick("+e.nodeName+"#"+e.id+") refocusing to "+t.nodeName+"#"+t.id),this.nullOrUndefined(t)||this.forceFocus(t)),!0},basicMouseUp:function(e,n){return!0},basicSuperfocusIn:function(e,n){s.debug("stdnav.basicSuperfocusIn("+e.nodeName+"#"+e.id+")");var t=null;if("focusSelector"in n){var a=":input,fieldset,"+n.focusSelector+'[js-navigable!="false"]',o=null;"barrier"in n&&(o=n.barrier);var u=this._maxNavDepth;"maxdepth"in n&&(u=n.maxdepth),"ghostfocus"in n&&!0===n.ghostfocus&&(t=this.closestDescendant(e,a+" .ghostfocus",o,u),i(t).removeClass("ghostfocus")),null==t&&(t=this.closestDescendant(e,a,o,u))}return null==t&&(t=e),t},basicSuperfocusOut:function(e,n){return s.debug("stdnav.basicSuperfocusOut("+e.nodeName+"#"+e.id+")"),"ghostfocus"in n&&!0===n.ghostfocus&&this._priorFocus&&i(this._priorFocus).addClass("ghostfocus"),null},basicSubfocusIn:function(e,n){return s.debug("stdnav.basicSubfocusIn("+e.nodeName+"#"+e.id+")"),null},basicSubfocusOut:function(e,n){return s.debug("stdnav.basicSubfocusOut("+e.nodeName+"#"+e.id+")"),null},basicEnter:function(e,n){s.debug("stdnav.basicEnter("+e.nodeName+"#"+e.id+")");var t=this.closestNavigableDescendant(e);return void 0!==t&&this.runAction("enter",t),e},basicToggle:function(e,n){s.debug("stdnav.basicToggle("+e.nodeName+"#"+e.id+")");var t=this.closestNavigableDescendant(e);return void 0!==t&&this.runAction("toggle",t),null},basicExit:function(e,n){s.debug("stdnav.basicExit("+e.nodeName+"#"+e.id+")");var t=this.closestNavigableAncestor(i(".superfocus"));return t||(t=i("#searchInput")),void 0!==t&&this.runAction("rejoined",t[0]),t[0]},basicRejoined:function(e,n){s.debug("stdnav.basicRejoined("+e.nodeName+"#"+e.id+")")}}});