!function(e){"function"==typeof define&&define.amd?define(["jrs.configs","require"],e):window.xssUtil=e(__jrsConfigs__)}(function(e,t){function r(e){e=null==e?"":e,e=E.test(e)?e.replace(E,function(e){return m[e]}):e;var t=document.createElement("textarea");return t.innerHTML=e,e=t.value,e=R.test(e)?e.replace(R,function(e){return y[e]}):e}function n(){return void 0!==t&&void 0===e.xssNonce&&(e=t("jrs.configs")),e.xssNonce}function i(){if(void 0===i.noncePrefix){var e=n();if(!e)return null;i.noncePrefix="\x3c!--@"+e+"@--\x3e"}return i.noncePrefix}function a(){var r=e.xssHtmlTagWhiteList;return void 0!==t&&void 0===r&&(e=t("jrs.configs"),r=e.xssHtmlTagWhiteList),r="string"==typeof r?r:"",r=r.replace(/\s/g,"")}function o(){var e=a();return e.length>0&&!o.whitelistInitialized&&(p=e.startsWith("+")?p+","+e.substr(1):e,o.whitelistInitialized=!0),p}function s(){if(void 0!==s.leftTagRegexp)return s.leftTagRegexp;var e=o(),t=e.replace(/,/g,"\\b|");return s.leftTagRegexp=RegExp("<(?!/|"+t+"\\b|!--)","ig"),s.leftTagRegexp}function f(){if(void 0!==f.rightTagRegexp)return f.rightTagRegexp;var e=o(),t=e.replace(/,/g,"\\b|");return f.rightTagRegexp=RegExp("</(?!"+t+"\\b)","ig"),f.rightTagRegexp}function c(){var r=e.xssAttribSoftHtmlEscapeMap;if(void 0!==t&&void 0===r){r=t("jrs.configs").xssAttribSoftHtmlEscapeMap,e.xssAttribSoftHtmlEscapeMap=r}return r}function l(){if(void 0!==l.attribSoftEscapeArr)return l.attribSoftEscapeArr;var e=c();if(!e)return l.attribSoftEscapeArr=T,l.attribSoftEscapeArr;try{var t=[],r=[];for(var n in e)e.hasOwnProperty(n)&&(t.push(RegExp(n,"ig")),r.push(e[n]));return l.attribSoftEscapeArr={regex:t,replacement:r},l.attribSoftEscapeArr}catch(e){return console.warn("Unable to parse xss.soft.html.escape.attrib.map.  Using _defaultAttribSoftEscapeMap."),l.attribSoftEscapeArr}}var p="a,abbr,acronym,address,animate,animateMotion,animateTransform,area,article,aside,b,bdi,bdo,big,blockquote,body,br,button,canvas,caption,center,circle,cite,clipPath,code,col,colgroup,color-profile,dd,defs,desc,details,dfn,discard,div,dl,dt,ellipse,em,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistantLight,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,fieldset,filter,font,footer,form,h1,h2,h3,h4,h5,h6,head,header,hr,html,i,g,iframe,image,img,input,js-templateNonce,label,legend,li,line,linearGradient,main,map,mark,marker,mask,menu,menuitem,meta,metadata,mpath,nav,ol,option,p,path,pattern,polygon,polyline,pre,radialGradient,rect,section,select,set,small,span,stop,strike,strong,style,sub,summary,sup,svg,switch,symbol,table,tbody,td,text,textPath,textarea,tfoot,th,thead,title,tr,tspan,u,ul,use,view",g={"(":"&#40;",")":"&#41;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},u=function(e){return null==e?"":e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},d=function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(u(r));return t},h=function(){var e,t={"&#111;":"o","&#110;":"n","&#115;":"s","&#114;":"r","&#99;":"c","&#100;":"d","&amp;":"&"};for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(t[g[e]]=e);return t}(),x=RegExp("(?:"+d(g).join("|")+")","g"),v=function(e){return("string"==typeof e||e instanceof String)&&!(e.indexOf("<")<0&&e.indexOf(">")<0)},b=function(e,t){for(var r=t,n=0;n<e.length;++n)r+=e.charAt(n),r+=t;return r},m=function(){var e,t={};for(e in g)if(Object.prototype.hasOwnProperty.call(g,e)){var r=g[e];t[r]=b(r,"*")}for(var n=["<textarea","</textarea>"],i=0;i<n.length;++i){var a=n[i];t[a]=b(a,"*")}return t}(),y=function(){var e,t={};for(e in m)Object.prototype.hasOwnProperty.call(m,e)&&(t[m[e]]=e);return t}(),E=RegExp("(?:"+d(m).join("|")+")","g"),R=RegExp("(?:"+d(y).join("|")+")","g"),T={regex:[/\bjavascript:/gi,/\bon(\w+?)\s*=/gi,/\bsrcdoc\s*=/gi],replacement:["","&#111;&#110;$1=","&#115;&#114;&#99;doc="]};return{softHtmlEscape:function(e,t){if(e=null==e?"":e,t=t||{},!v(e))return e;var a=i();if(a&&0===e.indexOf(a))return e.substring(a.length);var c=n();if(c&&e.indexOf(c)>0)return e;if(e=r(e),t.whiteList&&t.whiteList instanceof Array&&t.whiteList.length>0){var p=t.whiteList.join("\\b|"),g=RegExp("<(?!/|"+p+"\\b|!--)","ig");e=g.test(e)?e.replace(g,"&lt;"):e;var u=RegExp("</(?!"+p+"\\b)","ig");e=u.test(e)?e.replace(u,"&lt;/"):e,e=a+e}else{var d=s(),h=f();if(d.lastIndex=0,h.lastIndex=0,t.escapeTags&&t.escapeTags instanceof Array){for(var x=o(),b=0;b<t.escapeTags.length;++b)x=x.replace(t.escapeTags[b]+",","");d=RegExp("<(?!/|"+x.replace(/,/g,"\\b|")+"\\b|!--)","ig"),h=RegExp("</(?!"+x.replace(/,/g,"\\b|")+"\\b)","ig")}e=d.test(e)?e.replace(d,"&lt;"):e,e=h.test(e)?e.replace(h,"&lt;/"):e}for(var m=l(),y=m.regex,E=m.replacement,R=0;R<y.length;++R){var T=y[R];T.lastIndex=0;var w=E[R];e=T.test(e)?e.replace(T,w):e}return e},hardEscape:function(e){if(!("string"==typeof(e=null==e?"":e)||e instanceof String))return e;var t=i();return t&&0===e.indexOf(t)&&(e=e.substring(t.length)),x.lastIndex=0,e=x.test(e)?e.replace(x,function(e){return g[e]}):e},unescape:function(e){if(!("string"==typeof(e=null==e?"":e)||e instanceof String))return e;var t=i();t&&0===e.indexOf(t)&&(e=e.substring(t.length));var r=n();if(r&&e.indexOf(r)>=0)return e;var a=RegExp("(?:"+d(h).join("|")+")","ig");return a.test(e)?e.replace(a,function(e){return h[e]}):e}}});