define(["require","underscore","jquery","common/util/cloneDeep","common/util/xssUtil","underscore.string","jrs.configs"],function(e){"use strict";var s=e("underscore"),t=e("jquery"),n=e("common/util/cloneDeep"),r=e("common/util/xssUtil"),a=e("underscore.string"),c=RegExp(/(<js-templateNonce>\s*<\/js-templateNonce>)|(<js-templateNonce\s*\/>)/gi);s.str=a,s.templateSettings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,escape:/\{\{-([\s\S]+?)\}\}/g};var i=s.str.exports(),o=["wrap"];s.mixin(s.omit(i,o));var l=s.template,p=s.isEqual;return s.mixin({xssSoftEscape:r.softHtmlEscape,xssHardEscape:r.hardEscape,template:function(t,n,r){var a=s.templateSettings,i=/($^)/;t=String(t||""),r=s.defaults({},r,a);var o=RegExp((r.escape||i).source+"|$","g");t=t.replace(o,"{{ print(_.xssHardEscape($1)); }}");var p=e("jrs.configs");t=t.replace(c,"\x3c!-- "+p.xssNonce+" (htm xss nonce) --\x3e");var u=l.call(s,t,r);return n?u(n):u},isEqual:function(e,n){return s.isElement(e)&&s.isElement(n)||e instanceof t&&n instanceof t?e===n:p.apply(s,arguments)},cloneDeep:n}),s});