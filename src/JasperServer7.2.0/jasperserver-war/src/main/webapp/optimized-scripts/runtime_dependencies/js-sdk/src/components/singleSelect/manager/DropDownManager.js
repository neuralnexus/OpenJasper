define(["require","underscore","jquery"],function(t){"use strict";var e=t("underscore"),s=t("jquery"),f=s("body"),i=function(t){return this.initialize(t),this};return e.extend(i.prototype,{initialize:function(t){e.bindAll(this,"checkOffset","setNewOffset"),this.$dropDownEl=t.dropDownEl,this.calcOffset=t.calcOffset,this.isOffsetChanged=t.isOffsetChanged||this._isOffsetChanged,this.recalcInterval=t.recalcInterval||500,this.onOffsetChanged=t.onOffsetChanged},startCalc:function(){this.checkOffset(this.setNewOffset),clearInterval(this.recalcTimer),this.recalcTimer=setInterval(e.bind(this.checkOffset,this,this.onOffsetChanged),this.recalcInterval)},stopCalc:function(){clearInterval(this.recalcTimer)},checkOffset:function(t){var e=this.calcOffset(),s=this.$dropDownEl.position(),i=f.offset();(i.top||i.left)&&(s.top+=i.top,s.left+=i.left),this.$dropDownEl.width()!==e.width&&this.setNewOffset(e),this.isOffsetChanged(s,e)&&t&&t(e)},setNewOffset:function(t){this.$dropDownEl.css("top",t.top-f.offset().top).css("left",t.left-f.offset().left).css("width",t.width)},_isOffsetChanged:function(t,e){return Math.floor(t.top)!==Math.floor(e.top)||Math.floor(t.left)!==Math.floor(e.left)}}),i});