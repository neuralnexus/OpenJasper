JRS.Controls=function(e,t,n){function i(e){return function(n){return t.template(e)(t.defaults({data:void 0,uuid:void 0,message:void 0,description:void 0},n))}}var r=navigator.userAgent.toLowerCase().indexOf("msie")>-1;return{Base:t.extend(function(){},{extend:function(e,n){var i,r=this;i=e&&t.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},t.extend(i,r,n);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,e&&t.extend(i.prototype,e),i.__super__=r.prototype,i}}),TemplateEngine:{render:function(e,n,r){if(!r)return i(e)(n);if(r==this.STD_PLACEHOLDERS){var o=String(e);return t.each(n,function(e,t){var n=new RegExp("\\{"+t+"\\}");o=o.replace(n,e)}),o}},renderUrl:function(e,n,i){var o=t.template(e)(n);return r&&!i&&(o=encodeURI(o)),o},getTemplateText:function(t){return e("#"+t).html()},createTemplate:function(t){var n=e("#"+t),r=n.html();if(r&&r.length>0)return i(r)},createTemplateSection:function(e,t){var n="\x3c!--#val--\x3e(\\s|\\S)*\x3c!--/val--\x3e",r=n.replace(/val/g,e),o=new RegExp(r,"g");return i(this.getTemplateText(t).match(o)[0])},STD_PLACEHOLDERS:"std_placeholder"},Utils:{LOADING_DIALOG_DELAY:800,INPUT_CONTROLS_COMPONENT_ID:"input-controls",isElementInDom:function(e){var t=e.nextSibling,n=e.parentNode&&11!==e.parentNode.nodeType;return t||n},setInnerHtml:function(n,i,o){var a,s,u;if(this.isElementInDom(n)&&(a=n.nextSibling,s=n.parentNode,u=n.style.display,n.style.display="none",s.removeChild(n)),e(n).html(""),r&&"SELECT"==n.tagName){var c=document.createDocumentFragment();t.each(o.data,function(n){var i=document.createElement("OPTION");i.value=t.isUndefined(n.value)?n.id:n.value,e(i).html(n.label),n.selected&&i.setAttribute("selected","selected"),c.appendChild(i)}),n.appendChild(c)}else e(n).html(i(o));if(a?s.insertBefore(n,a):s.appendChild(n),n.style.display=u,r&&"SELECT"==n.tagName){var l=n.getAttribute("style");n.removeAttribute("style"),n.setAttribute("style",l)}},wait:function(t){return e.Deferred(function(e){setTimeout(e.resolve,t)})},showLoadingDialogOn:function(i,r,o){this.wait(r||this.LOADING_DIALOG_DELAY).then(t.bind(function(){"pending"==i.state()&&(n.popup.showShared($(ajax.LOADING_ID),o,{focus:!1,owner:this.INPUT_CONTROLS_COMPONENT_ID}),e.when(i).always(t.bind(function(){var e=this.INPUT_CONTROLS_COMPONENT_ID;this.wait(500).then(function(){window.viewer&&window.viewer.loading?window.viewer.loaded&&n.popup.hideShared($(ajax.LOADING_ID),e):n.popup.hideShared($(ajax.LOADING_ID),e)})},this)))},this))},createTimer:function(t){var n=new e.Deferred;return n.done(function(e){var n=(new Date).getTime(),i=n-e;console.log(t+" took time: "+i+" msec.")}),{start:function(){return this.startTime=(new Date).getTime(),this},stop:function(){return n.resolve(this.startTime),this}}}},listen:function(n,i){t.each(n,function(n,i){e(document).on(i,t.bind(n,this))},i||this)},ignore:function(t,n){e(document).off(t,n)}}}(jQuery,_,dialogs);