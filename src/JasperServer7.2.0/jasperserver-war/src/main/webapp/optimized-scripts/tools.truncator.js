var Truncator=Class.create({initialize:function(t,e){if(t&&t[0]){var n=null;e&&(n=e),t.each(function(t){this.truncate(t,n)}.bind(this))}},truncate:function(t,e){if("ABBR"==t.nodeName){var n=t.title.replace("&quot;",'"');t=t.parentNode,t.update(n.strip().escapeHTML())}var r=Object.isUndefined(t.innerText)?t.textContent:t.innerText;t.insert(Truncator.template.evaluate({divId:Truncator.tmpDivId,spanId:Truncator.tmpSpanId}));var a=$(Truncator.tmpSpanId);a.insert(r.escapeHTML());var i=e||t.getWidth();if(a.getWidth()<=i)return void $(Truncator.tmpDivId).remove();for(var p=r,u=0,c=r.length,d=(c-u)/2;d>1;)d+=u,p=r.substr(0,d),isIE()?a.innerText=p:a.update(p.escapeHTML()),a.getWidth()+30>i?c=d:u=d,d=(c-u)/2;$(Truncator.tmpDivId).remove(),t.update(this.truncateString(this.ellipsifyString(p.escapeHTML()),r.escapeHTML().replace('"',"&quot;")))},untruncate:function(t){t.each(function(t){"ABBR"==t.nodeName&&t.update(t.title.strip().escapeHTML())})},ellipsifyString:function(t){return t+"&hellip;"},truncateString:function(t,e){return'<abbr title="'+e+'">'+t+"</abbr>"}});Truncator.tmpDivId="truncator-tmp-div",Truncator.tmpSpanId="truncator-tmp-span",Truncator.template=new Template('    <div id="#{divId}" style="width:9999px; left:-9999px; top:-9999px; display:block; position: absolute">        <span id="#{spanId}"></span>    </div>');