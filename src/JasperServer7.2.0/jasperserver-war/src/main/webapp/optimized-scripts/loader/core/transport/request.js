define(["require","jquery","xdm","fakeXhrFactory","logger"],function(e){"use strict";function r(){var e=[];return e.push({name:"logEnabled",value:i.get("enabled")}),i.get("level")&&e.push({name:"logLevel",value:i.get("level")}),n.param(e)}var t,n=e("jquery"),o=e("xdm"),a=n.Deferred,u=e("fakeXhrFactory"),i=e("logger"),s=function(e){t=new o.Rpc({remote:e+"?"+r(),container:document.body,props:{style:{display:"none"}}},{remote:{request:{},abort:{}}})},c=function(e,r){var n=new a,o=e.error;return r=r||e.success,t?(t.request(e,function(e){n.resolve(e.data,e.status,u(e.xhr))},function(e){n.reject(e.message,e.data)}),r&&n.done(r),o&&n.fail(o)):n.rejectWith(new Error("RPC object is not initialized")),n.promise()};return c.rpc=s,c});