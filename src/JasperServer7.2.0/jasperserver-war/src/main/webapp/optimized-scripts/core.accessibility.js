var accessibilityModule={ATTR_TAB_INDEX:"data-tab-index",ATTR_COMPONENT_TYPE:"data-component-type",delayTime:500,components:[],currentTabIndex:-1,disabled:!0,initialize:function(){$$("*["+this.ATTR_TAB_INDEX+"]").each(function(t){var e=this.getTabIndex(t);e>0&&(this.components[e]=t)}.bind(this)),this.enable()},enable:function(){this.disabled=!1},disable:function(){this.disabled=!0},_focusByType:{tree:function(t){var e=t.readAttribute("id"),i=dynamicTree.trees[e];if(i){var n=i.selectedNodes.last();n=n||(i.bShowRoot?i.getRootNode():i.getRootNode().getFirstChild()),n&&(n.isSelected()||n.select(),accessibilityModule._doFocus(n))}},list:function(t){var e=t.readAttribute("id"),i=dynamicList.lists[e];if(i){var n=i.getSelectedItems().last();n=n||i.getItems().first(),n&&(n.isSelected()||n.select(),accessibilityModule._doFocus(n))}},search:function(t){var e=t.down("input");e&&e.select(),accessibilityModule._doFocus(e)},navigation:function(t){var e=t.down("#main_home");buttonManager.over(e.down(layoutModule.BUTTON_PATTERN)),accessibilityModule._doFocus(e)},linkList:function(t){buttonManager.over(t.down("a")),accessibilityModule._doFocus(t)}},_blurByType:{navigation:function(t){actionModel.hideMenu(),t.select(".over").each(function(t){buttonManager.out(t)})},linkList:function(t){t.select("a.over").each(function(t){buttonManager.out(t)})}},_doFocus:function(t){setTimeout(function(){t.focus()},this.delayTime)},_focusComponent:function(t){var e=t&&this.getType(t)&&this._focusByType[this.getType(t)];return e&&e(t)},_blurComponent:function(t){var e=t&&this.getType(t)&&this._blurByType[this.getType(t)];return e&&e(t)},findTabComponent:function(t){for(var e;t&&!e;)e=t.hasAttribute&&t.hasAttribute(this.ATTR_TAB_INDEX)&&t,t=$(t.parentNode);return e},getTabIndex:function(t){var e=-1;if(t&&t.hasAttribute){t.hasAttribute(this.ATTR_TAB_INDEX)||(t=accessibilityModule.findTabComponent(t));var i=t?t.readAttribute(this.ATTR_TAB_INDEX):this.currentTabIndex;try{i&&i.length>0&&(e=parseInt(i))}catch(t){}}return e},getType:function(t){return t&&t.hasAttribute(this.ATTR_COMPONENT_TYPE)?t.readAttribute(this.ATTR_COMPONENT_TYPE):void 0},getNext:function(t){var e=-1;if(this.components.length>0)for(t||(t=this.currentTabIndex),t<0&&(t=0),e=t+1;Object.isUndefined(this.components[e])&&e!=t;)++e<this.components.length||(e=0);return e},getPrevious:function(t){var e=-1;if(this.components.length>0)for(t||(t=this.currentTabIndex),t<0&&(t=0),e=t-1;Object.isUndefined(this.components[e])&&e!=t;)--e>-1||(e=this.components.length-1);return e},focusNext:function(t){this.focusByIndex(this.getNext(t))},focusPrevious:function(t){this.focusByIndex(this.getPrevious(t))},focusByIndex:function(t){t>-1&&(this.currentTabIndex=t)&&this._focusComponent(this.components[t])},blurCurrent:function(){var t=this.components[this.currentTabIndex];t&&this._blurComponent(t)},blurByIndex:function(t){var e=this.components[t];e&&this._blurComponent(e)}};document.observe("key:tab",function(t){if(!accessibilityModule.disabled){var e=accessibilityModule.getTabIndex(t.element());return accessibilityModule.blurCurrent(),isShiftHeld(t)?accessibilityModule.focusPrevious(e):accessibilityModule.focusNext(e),t.stop(),!1}});