define(["require","underscore"],function(require){function RegExpRepresenter(e){this.charMap={"\\s":" "},this.expressionTokens=this.__parse(e)}var _=require("underscore");return _.extend(RegExpRepresenter.prototype,{__parse:function(e){for(var r=$A(),t=1;t<e.length-1;t++){var n=e.charAt(t);"\\"==n&&(n+=e.charAt(++t)),"\\u"==n&&(n+=e.substring(++t,t+4),t+=3),r.push(n)}return r},getCharacters:function(){var result=$A();return this.expressionTokens.each(function(token){if(token.startsWith("\\u"))result.push(eval('"'+token+'"'));else if(token.startsWith("\\")){var ch=this.charMap[token];result.push(ch?ch:token.substring(1,token.length))}else result.push(token)}.bind(this)),result},getRepresentedString:function(){for(var e="",r=this.getCharacters(),t=r.length,n=0;t>n;n++){var s=r[n];e+=" "==s||"."==s||","==s?"["+s+"]":s,t-1>n&&(e+=", ")}return e}}),RegExpRepresenter});