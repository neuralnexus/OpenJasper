define(["require","jquery","underscore","jrs.configs","common/component/dialog/Dialog","./ExportView","bundle!CommonBundle","bundle!ImportExportBundle","tenantImportExport/export/enum/exportTypesEnum"],function(t){function e(t){return i.isArray(t)?i.pluck(t,"URIString"):[t.URIString]}function o(t){return i.isArray(t)||(t=[t]),!!i.reduce(t,function(t,e){return t||!e.resourceType||e.resourceType.indexOf("ReportUnit")+1||e.resourceType.indexOf("ReportOptions")+1},!1)}var i=(t("jquery"),t("underscore")),n=t("jrs.configs"),r=t("common/component/dialog/Dialog"),s=t("./ExportView"),p=t("bundle!CommonBundle"),l=t("bundle!ImportExportBundle"),a=t("tenantImportExport/export/enum/exportTypesEnum");return r.extend({constructor:function(t){t||(t={}),this.options=t,r.prototype.constructor.call(this,{model:this.model,resizable:!0,modal:!0,content:"",buttons:[{label:p["button.export"],action:"export",primary:!0},{label:p["button.cancel"],action:"cancel",primary:!1}]}),this.on("button:export",i.bind(this._onExportButtonClick,this)),this.on("button:cancel",i.bind(this._closeExportDialog,this))},initialize:function(t){this.exportView=new s,this.listenTo(this.exportView.model,"validated",function(t){t?this.buttons.enable("export"):this.buttons.disable("export")},this),r.prototype.initialize.apply(this,arguments)},openRepoDialog:function(t){var i=e(t),r=n.organizationsFolderUri||"/organizations",s=n.orgTemplateFolderUri||"/org_template",p=new RegExp("^("+r+"/([^/]+))+"),u=new RegExp("^"+r+s+"(/.*)?"),d=!!p.exec(i[0])&&!u.exec(i[0]),c={type:a.REPOSITORY,isSubOrgLevel:d},h=" "+l["export.dialog.repository.title"];this.addCssClasses("repository-export-dialog"),this._openExportDialog(c,h),this.exportView.model.set({uris:i,includeScheduledReportJobs:o(t)})},openTenantDialog:function(t){var e=" "+t.name,o=t.isRoot()?a.ROOT_TENANT:a.TENANT,i={type:o,tenantId:t.id};this.addCssClasses("tenant-export-dialog"),this._openExportDialog(i,e)},fieldIsValid:function(){},fieldIsInvalid:function(t){},_onExportButtonClick:function(){this.exportView.doExport(),this._closeExportDialog()},_closeExportDialog:function(){this.$el.css({width:this.width}),this.close()},_openExportDialog:function(t,e){var o=l["export.dialog.title"]+(e?e:"");this.setContent(this.exportView.render(t).$el),this.setTitle(o),this.exportView.applyEpoxyBindings(),this.exportView.delegateEvents(),r.prototype.open.apply(this,arguments),this.$el.css({minHeight:this.$el.outerHeight()}),this.width=this.$el.outerWidth()}})});