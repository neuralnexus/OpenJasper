define(["require","underscore","jquery","tenantImportExport/import/factory/importModelAttributesFactory","../enum/brokenDependencyStrategyEnum","common/transport/AjaxFormSubmitter","backbone.validation","common/model/BaseModel"],function(e){var t=e("underscore"),r=e("jquery"),i=e("tenantImportExport/import/factory/importModelAttributesFactory"),n=e("../enum/brokenDependencyStrategyEnum"),s=e("common/transport/AjaxFormSubmitter"),o=e("backbone.validation"),a=e("common/model/BaseModel"),u=a.extend({defaults:{fileName:"",update:!0,skipUserUpdate:!1,mergeOrganization:!1,skipThemes:!0,brokenDependencies:n.FAIL},url:"rest_v2/import",validation:{fileName:[{fn:function(e){return!/\.zip$/.test(e)}}]},initialize:function(e,t){this.form=new s(t.form,this.url,"post","multipart/form-data")},parse:function(){return this.attributes},save:function(){var e,i,n=this;return this.isNew()?(e=new r.Deferred,this.form.submit().done(function(r){n.set("id",r.id),t.isUndefined(r.errorCode)&&t.isUndefined(r.error)?e.resolve(r):e.reject(r)}).fail(function(t){n.trigger("error",t),e.reject(t)})):(i=this._convertParameters(),e=a.prototype.save.call(this,{parameters:i},{url:this.url+"/"+this.id}).fail(t.bind(this.trigger,"error"))),e},cancel:function(){var e=this.url+"/"+this.id;this.destroy({url:e})},reset:function(e,r){var n=t.extend({},this.defaults,i(e),r);this.clear().set(t.extend({},n)),this.id=void 0},_convertParameters:function(){var e=[];return this.get("skipUserUpdate")&&e.push("skip-user-update"),this.get("includeAccessEvents")&&e.push("include-access-events"),this.get("includeAuditEvents")&&e.push("include-audit-events"),this.get("includeMonitoringEvents")&&e.push("include-monitoring-events"),this.get("includeServerSettings")&&e.push("include-server-setting"),this.get("mergeOrganization")&&e.push("merge-organization"),this.get("skipThemes")&&e.push("skip-themes"),this.get("update")&&e.push("update"),e}});return t.extend(u.prototype,o.mixin),u});