define(["require","jquery"],function(t){"use strict";var e=t("jquery"),i=function(t,i,s){if(this.element=t,this.parent=i,this.children=[],this.hbar=null,this.vbar=null,s=s||{},s.absolute?this.element.style.position="absolute":this.element.style.position="relative",this.useParent=s.useParent?this.observer=i:this.observer=t,this.translate3d=s.translate3d!==!1?!0:!1,this.forceLayout=s.forceLayout!==!0?!1:!0,this.use2Fingers=s.use2Fingers!==!0?!1:!0,this.fit=s.fit,s.debug&&(i.style.border="solid 1px #f00",t.style.border="solid 1px #00f"),this.translate3d&&!s.noInit3d){var h=e(t).position();t.style.webkitTransform="translate3d("+h.left+"px,"+h.top+"px,0)",t.style.top="",t.style.left=""}if(s.scrollbars===!0){var n=e('<div style="position:absolute;bottom:4px;left:0;right:0;"><div style="position:relative;background:#3fb8fa;min-height:4px;width:24px;opacity:0.4;"></div></div>').appendTo(i),o=e('<div style="position:absolute;top:0;bottom:0;right:4px;"><div style="position:relative;background:#3fb8fa;min-width:4px;height:24px;opacity:0.4;"></div></div>').appendTo(i);this.hbar=n.children().eq(0),this.vbar=o.children().eq(0)}this.computeBoundaries(),this.dragging=!1,this.drag_sensitivity=20,this.scale=1,this.element.style.top=0,this.element.style.left=0,this.maxX=0,this.maxY=0,this.startTouchY=0,this.startTouchX=0,this.contentOffsetX=0,this.contentOffsetY=0,this.observer.addEventListener("touchstart",this,!1),this.observer.addEventListener("touchmove",this,!1),this.observer.addEventListener("touchend",this,!1)};return i.prototype.handleEvent=function(t){switch(t.type){case"touchstart":this.onTouchStart(t);break;case"touchmove":this.onTouchMove(t);break;case"touchend":this.onTouchEnd(t)}},i.prototype.computeBoundaries=function(){this.maxX=this.parent.clientWidth-this.element.clientWidth,this.maxY=this.parent.clientHeight-this.element.clientHeight,this.maxX=this.maxX<0?this.maxX:0,this.maxY=this.maxY<0?this.maxY:0,this.hbar&&0!==this.maxX?(this.hratio=this.parent.clientWidth/this.element.clientWidth,this.hbar.width(this.hratio*this.parent.clientWidth),this.hbar.show()):this.hbar&&this.hbar.hide(),this.vbar&&0!==this.maxY?(this.vratio=this.parent.clientHeight/this.element.clientHeight,this.vbar.height(this.vratio*this.parent.clientHeight),this.vbar.show()):this.vbar&&this.vbar.hide(),0===this.maxX&&0===this.maxY&&(this.element.style.minWidth=this.parent.clientWidth+"px",this.element.style.minHeight=this.parent.clientHeight+"px","reportContainer"===this.element.id&&(this.element.style.maxWidth=this.parent.clientWidth+"px",this.element.style.maxHeight=this.parent.clientHeight+"px"))},i.prototype.onTouchStart=function(t){this.scale_pre=!1,this.computeBoundaries(),this.startTouchX=t.touches[0].clientX,this.startTouchY=t.touches[0].clientY,this.contentStartOffsetX=this.contentOffsetX,this.contentStartOffsetY=this.contentOffsetY},i.prototype.onTouchMove=function(t){var e=t.touches[0].clientY,s=t.touches[0].clientX;(!this.use2Fingers||this.use2Fingers&&2==t.touches.length)&&(this.dragging?this.animateTo(s,e):this.isDragging(t)&&(i.element_scrolled=!0,this.forceLayout&&(this.element.style.top=0,this.element.style.webkitTransform="translate3d(0,"+this.contentOffsetY+"px,0)"),this.animateTo(s,e)))},i.prototype.onTouchEnd=function(t){this.dragging&&(this.forceLayout&&(this.element.style.webkitTransform="translate3d(0,0,0)",this.element.style.top=this.contentOffsetY+"px"),this.hbar&&this.hbar.hide(),this.vbar&&this.vbar.hide(),t.preventDefault(),this.shouldStartMomentum()),this.dragging=!1},i.prototype.animateTo=function(t,i){var s=t-this.startTouchX,h=i-this.startTouchY,n=s+this.contentStartOffsetX,o=h+this.contentStartOffsetY,a=e(this.element).position();this.translate3d?(n>0&&(n=0),o>0&&(o=0),n<this.maxX&&(n=this.maxX),o<this.maxY&&(o=this.maxY)):(n+a.left>0&&(n=-1*a.left),o+a.top>0&&(o=-1*a.top),a.left+n<this.maxX&&(n=this.maxX-a.left),a.top+o<this.maxY&&(o=this.maxY-a.top)),this.contentOffsetX=n,this.contentOffsetY=o,this.translate3d||this.use2Fingers?this.element.style.webkitTransform="scale("+this.scale+") translate3d("+n+"px,"+o+"px, 0)":(this.element.style.top=a.top+o+"px",this.element.style.left=a.left+n+"px"),this.hbar&&this.hbar.css("left",-1*n*this.hratio+"px"),this.vbar&&this.vbar.css("top",-1*o*this.vratio+"px")},i.prototype.isDragging=function(t){var e=t.touches[0].clientX-this.startTouchX,i=t.touches[0].clientY-this.startTouchY,s=Math.abs(e),h=Math.abs(i);return this.dragging=s>this.drag_sensitivity||h>this.drag_sensitivity?!0:!1,this.dragging},i.prototype.shouldStartMomentum=function(){return!1},i.prototype.reset=function(){var t=this.contentOffsetX,e=this.contentOffsetY;this.maxX=this.parent.clientWidth-this.element.clientWidth,this.maxY=this.parent.clientHeight-this.element.clientHeight,this.translate3d?(this.element.style.webkitTransform="scale("+this.scale+") translate3d("+t+"px,"+e+"px, 0)",this.element.style.webkitTransform="scale("+this.scale+") translate3d(0,0,0)",this.contentOffsetX=0,this.contentOffsetY=0):(this.element.style.top=0,this.element.style.left=0)},i.prototype.forceRefresh=function(){},i.prototype.isBottom=function(){return this.maxY>=0?!1:this.contentOffsetY-this.maxY<10},i.prototype.addPadding=function(t,i){var s=e("#"+t),h=s.width()+i.right,n=s.height()+i.bottom;this.element.style.width=h+"px",this.element.style.height=n+"px"},window.TouchController=i,i});