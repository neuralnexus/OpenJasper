define(["require","underscore","../util/pathUtil","./getLevelNestingFactory","./getParentIdFactory"],function(e){function r(e,r,t){var n=0,i=e.getLevelNesting(t),s=a.split(r,e.escapeCharacter,e.separator,!1).slice(1),o=a.split(t,e.escapeCharacter,e.separator,!1).slice(1);s.splice(i,s.length).join("/");for(var c=e.separator+s.join("/"),l=e.separator+o.join("/"),p=0;p<s.length&&(n-=p||1,e.getParentId(c)!==e.getParentId(l));p++)c=e.separator+s.slice(0,n).join(e.separator),l=e.separator+o.slice(0,n).join(e.separator);return{firstId:c,secondId:l}}var t=e("underscore"),a=e("../util/pathUtil"),n=e("./getLevelNestingFactory"),i=e("./getParentIdFactory");return{create:function(e,a){var s=n.create(e,a),o=i.create(e,a);return t.partial(r,{escapeCharacter:e,separator:a,getParentId:o,getLevelNesting:s})}}});