define(["require","./jquery.ui.core","./jquery.ui.mouse","./jquery.ui.widget"],function(e){e("./jquery.ui.core"),e("./jquery.ui.mouse");var t=e("./jquery.ui.widget");return t.widget("ui.selectable",t.ui.mouse,{version:"@VERSION",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,s=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(s.options.filter,s.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),s=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:s.left,top:s.top,right:s.left+e.outerWidth(),bottom:s.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var s=this,l=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(l.filter,this.element[0]),this._trigger("start",e),t(l.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),l.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var l=t.data(this,"selectable-item");l.startselected=!0,e.metaKey||e.ctrlKey||(l.$element.removeClass("ui-selected"),l.selected=!1,l.$element.addClass("ui-unselecting"),l.unselecting=!0,s._trigger("unselecting",e,{unselecting:l.element}))}),t(e.target).parents().addBack().each(function(){var l,i=t.data(this,"selectable-item");return i?(l=!e.metaKey&&!e.ctrlKey||!i.$element.hasClass("ui-selected"),i.$element.removeClass(l?"ui-unselecting":"ui-selected").addClass(l?"ui-selecting":"ui-unselecting"),i.unselecting=!l,i.selecting=l,i.selected=l,l?s._trigger("selecting",e,{selecting:i.element}):s._trigger("unselecting",e,{unselecting:i.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var s,l=this,i=this.options,n=this.opos[0],c=this.opos[1],a=e.pageX,u=e.pageY;return n>a&&(s=a,a=n,n=s),c>u&&(s=u,u=c,c=s),this.helper.css({left:n,top:c,width:a-n,height:u-c}),this.selectees.each(function(){var s=t.data(this,"selectable-item"),r=!1;s&&s.element!==l.element[0]&&("touch"===i.tolerance?r=!(s.left>a||s.right<n||s.top>u||s.bottom<c):"fit"===i.tolerance&&(r=s.left>n&&s.right<a&&s.top>c&&s.bottom<u),r?(s.selected&&(s.$element.removeClass("ui-selected"),s.selected=!1),s.unselecting&&(s.$element.removeClass("ui-unselecting"),s.unselecting=!1),s.selecting||(s.$element.addClass("ui-selecting"),s.selecting=!0,l._trigger("selecting",e,{selecting:s.element}))):(s.selecting&&((e.metaKey||e.ctrlKey)&&s.startselected?(s.$element.removeClass("ui-selecting"),s.selecting=!1,s.$element.addClass("ui-selected"),s.selected=!0):(s.$element.removeClass("ui-selecting"),s.selecting=!1,s.startselected&&(s.$element.addClass("ui-unselecting"),s.unselecting=!0),l._trigger("unselecting",e,{unselecting:s.element}))),s.selected&&(e.metaKey||e.ctrlKey||s.startselected||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,l._trigger("unselecting",e,{unselecting:s.element})))))}),!1}},_mouseStop:function(e){var s=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var l=t.data(this,"selectable-item");l.$element.removeClass("ui-unselecting"),l.unselecting=!1,l.startselected=!1,s._trigger("unselected",e,{unselected:l.element})}),t(".ui-selecting",this.element[0]).each(function(){var l=t.data(this,"selectable-item");l.$element.removeClass("ui-selecting").addClass("ui-selected"),l.selecting=!1,l.selected=!0,l.startselected=!0,s._trigger("selected",e,{selected:l.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),t});