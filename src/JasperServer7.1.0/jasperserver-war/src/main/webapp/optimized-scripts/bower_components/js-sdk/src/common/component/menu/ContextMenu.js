define(["require","./Menu","jquery","underscore"],function(t){"use strict";var e=t("./Menu"),i=t("jquery"),s=t("underscore");return e.extend({constructor:function(t,i){e.call(this,t,i),s.bindAll(this,"_tryHide"),this.topPadding=i&&i.topPadding||5,this.leftPadding=i&&i.leftPadding||5,this.hideOnMouseLeave=i&&i.hideOnMouseLeave||!1,this.hideOnMouseLeave&&this.$el.on("mouseleave",this._tryHide)},_tryHide:function(){this.hide(),this._signOffTryHide()},_signOffTryHide:function(){i(document.body).off("click.contextMenu",this._tryHide)},show:function(t,o){if(!t||!s.isNumber(t.top)||!s.isNumber(t.left))throw new Error("Required params (top, left) missing: "+JSON.stringify(t));i(document.body).on("click.contextMenu",this._tryHide);var n=t.top,h=t.left,d=this.topPadding,r=this.leftPadding,f=i("body"),u=this.$el.height(),l=this.$el.width(),p=o?o.height():f.height(),a=o?o.width():f.width(),c=o?o.offset():f.offset(),y=p-t.top,g=a-t.left;return u>y&&(n=t.top-u-d,n<c.top&&(n+=c.top-n+d),n=0>n?p/2-u/2:n),l>g&&(h=t.left-l-r,h<c.left&&(h+=c.left-h+r),h=0>h?a/2-l/2:h),s.extend(this,{top:n,left:h}),this.$el.css({top:this.top,left:this.left}),e.prototype.show.apply(this,arguments)},remove:function(){this._signOffTryHide(),this.hideOnMouseLeave&&this.$el.off("mouseleave",this._tryHide),e.prototype.remove.apply(this,arguments)}})});