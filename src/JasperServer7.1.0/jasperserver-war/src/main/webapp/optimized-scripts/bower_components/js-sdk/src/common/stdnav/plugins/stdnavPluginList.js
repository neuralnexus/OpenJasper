define(["require","exports","module","jquery","underscore","logger","stdnav"],function(t,e,i){"use strict";var l=t("jquery"),n=(t("underscore"),t("logger").register(i)),r=t("stdnav"),s=0,a=function(){s++,this.serial=s};l.extend(a.prototype,{zinit:function(t){return n.debug("stdnavPluginList.init("+t+")\n"),this},activate:function(){this.behavior={ariaprep:[this,this._ariaPrep,null],ariarefresh:[this,this._ariaRefresh,null],down:[this,this._onDown,null],fixfocus:[this,this._fixFocus,null],fixsuperfocus:[this,this._fixSuperfocus,null],inherit:!0,inheritable:!0,left:[this,this._onLeft,null],right:[this,this._onRight,null],up:[this,this._onUp,null],superfocusin:[r,r.basicSuperfocusIn,{maxdepth:1,focusSelector:"li",ghostfocus:!1}],superfocusout:[r,r.basicSuperfocusOut,{ghostfocus:!1}]},r.registerNavtype(this.navtype,this.behavior,this.navtype_tags)},deactivate:function(){r.unregisterNavtype("list",this.behavior)},_ariaPrep:function(t){this._ariaRefresh(t)},_ariaRefresh:function(t){var e=l(t);e.attr("role","application");var i=e.attr("aria-label"),n=e.attr("aria-labelledby"),s=e.children("li"),a=e.attr("js-itemplural");""!==a&&a||(a="items");var o=!1;if(r.nullOrUndefined(i)&&r.nullOrUndefined(n)){var u=s.find("a");u.length===s.length?(e.attr("aria-label","List of "+s.length+" links."),o=!0):e.attr("aria-label","List of "+s.length+a)}return l.each(s,function(t,e){var i=l(e),n=i.find("a");if(n.length>0){i.attr("role","link");var o=i.attr("aria-label"),u=i.attr("aria-labelledby");if(r.nullOrUndefined(o)&&r.nullOrUndefined(u)){var f=i.text();l(n[0]).text();o=f+". "+(t+1)+" of "+s.length+" "+a+".",i.attr("aria-label",o)}}}),null},_fixFocus:function(t){var e,i,n=l(t);if(n.is("fieldset")&&n.children("ul.inputSet").length)return t;if(n.is("ul,ol"))if(e=n.children("li .ghostfocus"),e.length>0)i=e[0];else{var r=n.children("li");i=r.length>0?r[0]:t}else if(n.is("li"))i=t;else{var s=n.closest("li");i=s.length>0?l(s[0]).prop["js-navigable"]===!1?n.closest("ul,ol"):s[0]:n.closest("ul,ol")}return i},_fixSubfocus:function(t){return null},_fixSuperfocus:function(t){var e,i=l(t).closest("ol,ul");return e=i.length>0?i[0]:null},_onClick:function(t){l(t).closest("ul, ol").focus(),r.setSubfocus(this._fixSubfocus(t))},_onSuperfocusIn:function(t){var e,i=l(t).children("li .ghostfocus");if(i.length>0)i.removeClass("ghostfocus"),e=i[0];else{var n=l(t).children('li[js-navigable!="false"]');e=n.length>0?n[0]:t}return e},_onSuperfocusOut:function(t){},_onLeft:function(t){var e=t,i=l(t).closest("ul,ol");if(i.hasClass("horizontal")){var n=l(t).prev("li");if(0===n.length){if("wrap"==i.attr("js-stdnav-wrap")){var r=i.children("li");r.length>0&&(e=r[r.length-1])}}else e=n[0]}return e},_onRight:function(t){var e=t,i=l(t).closest("ul,ol");if(i.hasClass("horizontal")){var n=l(t).next("li");if(0===n.length){if("wrap"==i.attr("js-stdnav-wrap")){var r=i.children("li");r.length>0&&(e=r[0])}}else e=n[0]}return e},_onUp:function(t){var e=t,i=l(t).closest("ul,ol");if(!i.hasClass("horizontal")){var n=l(t).prev("li");if(0===n.length){if("wrap"==i.attr("js-stdnav-wrap")){var r=i.children("li");r.length>0&&(e=r[r.length-1])}}else e=n[0]}return e},_onDown:function(t){var e=t,i=l(t).closest("ul,ol");if(!i.hasClass("horizontal")){var n=l(t).next("li");if(0===n.length){if("wrap"==i.attr("js-stdnav-wrap")){var r=i.children("li");r.length>0&&(e=r[0])}}else e=n[0]}return e}}),l.extend(a.prototype,{navtype:"list",navtype_tags:["UL","OL"]});var o=new a;return o});