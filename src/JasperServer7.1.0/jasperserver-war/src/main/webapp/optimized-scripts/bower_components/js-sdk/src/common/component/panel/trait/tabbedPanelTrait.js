define(["require","underscore","jquery","backbone","./abstractPanelTrait","common/component/base/OptionContainer","text!../template/tabbedPanelButtonTemplate.htm"],function(t){"use strict";function e(t,e){var a=e.get("action");this._contentRendered[a]||(this._contentRendered[a]=!0,this.tabs[a].render&&this.tabs[a].render()),this.$tabs.hide(),this.$tabs.filter(function(){return n(this).data("tab")===a}).show(),this.selectedTab=a,this.trigger("tab:"+a,t,e)}var a=t("underscore"),n=t("jquery"),i=t("backbone"),s=t("./abstractPanelTrait"),o=t("common/component/base/OptionContainer"),r=t("text!../template/tabbedPanelButtonTemplate.htm");return a.extend({},s,{onConstructor:function(t){if(t||(t={}),!t.tabs||!a.isArray(t.tabs)||0===t.tabs.length)throw new Error("Tabbed panel should have at least one tab");this.tabContainerClass=t.tabContainerClass||"tabContainer",this.tabHeaderContainerSelector=t.tabHeaderContainerSelector||"> .header > .tabHeaderContainer",this.tabHeaderContainerClass=t.tabHeaderContainerClass||"tabHeaderContainer",this.tabbedPanelClass=t.tabbedPanelClass||"tabbedPanel",this.tabs={},a.each(t.tabs,a.bind(function(t){this.tabs[t.action]=t.content,delete t.content},this))},afterSetElement:function(){this.$el.addClass(this.tabbedPanelClass),this.$tabHeaderContainer=this.$(this.tabHeaderContainerSelector),this.$tabHeaderContainer.length||(this.$tabHeaderContainer=n("<div></div>").addClass(this.tabHeaderContainerClass),this.$("> .header").append(this.$tabHeaderContainer)),this.$contentContainer.empty(),a.each(this.tabs,a.bind(function(t,e){var a=n("<div></div>").addClass(this.tabContainerClass);a.data("tab",e),a.html(t instanceof i.View?t.$el:t),this.$contentContainer.append(a)},this));var t=this.tabContainerClass.split(" ");this.$tabs=this.$("."+t[0])},afterInitialize:function(t){this.tabHeaderContainer=new o({options:t.tabs,el:this.$tabHeaderContainer,contextName:"tab",toggleClass:t.toggleClass||"active",toggle:!0,optionTemplate:t.optionTemplate||r}),this._contentRendered={},this.listenTo(this.tabHeaderContainer,a.map(t.tabs,function(t){return"tab:"+t.action}).join(" "),a.bind(e,this));for(var n=0;n<t.tabs.length;n++)if(t.tabs[n].primary){this.openTab(t.tabs[n].action);break}},onRemove:function(){a.each(this.tabs,function(t){t.remove&&t.remove()}),this.tabHeaderContainer.remove()},extension:{openTab:function(t){var e=this.tabHeaderContainer.getOptionView(t);e&&e.select()},showTab:function(t){var e=this.tabHeaderContainer.getOptionView(t);e&&e.show()},hideTab:function(t){var e=this.tabHeaderContainer.getOptionView(t);e&&e.hide()}}})});