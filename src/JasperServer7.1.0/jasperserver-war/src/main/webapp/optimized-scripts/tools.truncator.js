var Truncator=Class.create({initialize:function(t,e){if(t&&t[0]){var n=null;e&&(n=e),t.each(function(t){this.truncate(t,n)}.bind(this))}},truncate:function(t,e){if("ABBR"==t.nodeName){var n=t.title.replace("&quot;",'"');t=t.parentNode,t.update(n.strip().escapeHTML())}var r=Object.isUndefined(t.innerText)?t.textContent:t.innerText;t.insert(Truncator.template.evaluate({divId:Truncator.tmpDivId,spanId:Truncator.tmpSpanId}));var a=$(Truncator.tmpSpanId);a.insert(r.escapeHTML());var i=e?e:t.getWidth(),p=a.getWidth();if(i>=p)return void $(Truncator.tmpDivId).remove();for(var u=r,c=0,d=r.length,o=(d-c)/2;o>1;)o+=c,u=r.substr(0,o),isIE()?a.innerText=u:a.update(u.escapeHTML()),a.getWidth()+30>i?d=o:c=o,o=(d-c)/2;$(Truncator.tmpDivId).remove(),t.update(this.truncateString(this.ellipsifyString(u.escapeHTML()),r.escapeHTML().replace('"',"&quot;")))},untruncate:function(t){t.each(function(t){"ABBR"==t.nodeName&&t.update(t.title.strip().escapeHTML())})},ellipsifyString:function(t){return t+"&hellip;"},truncateString:function(t,e){return'<abbr title="'+e+'">'+t+"</abbr>"}});Truncator.tmpDivId="truncator-tmp-div",Truncator.tmpSpanId="truncator-tmp-span",Truncator.template=new Template('    <div id="#{divId}" style="width:9999px; left:-9999px; top:-9999px; display:block; position: absolute">        <span id="#{spanId}"></span>    </div>');