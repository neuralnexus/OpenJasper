var layoutModule={ELEMENT_CONTEXTMENU:"element:contextmenu",SIZEABLE_PATTERN:".sizeable",SIZER_PATTERN:".sizer",RESIZE_OVERLAY_PATTERN:".resizeOverlay",MOVEABLE_PATTERN:".moveable",MOVER_PATTERN:".mover",MINIMIZER_PATTERN:".maximized .minimize",MINIMIZED_PATTERN:".minimized .minimize",TRUNCATE_PATTERN:".trunc",TREE_LEAF_PATTERN:"a.>node",TREE_CONTAINER_PATTERN:".collapsible",TOOLBAR_CAPSULE_PATTERN:"#toolbar .capsule",NAVIGATION_MUTTON_PATTERN:"li.mutton",NAVIGATION_PATTERN:"#navigationOptions li",NAVIGATION_HOVER_PATTERN:"#navigationOptions li.over",META_LINKS_PATTERN:"#metaLinks #main_logOut_link",BUTTON_SET_BUTTON:".buttonSet > *",TABSET_TAB_PATTERN:".tab",BUTTON_PATTERN:".button",PRESSED_PATTERN:".pressed",SELECTED_PATTERN:".selected",LIST_ITEM_PATTERN:".list.responsive > li",LIST_ITEM_WRAP_PATTERN:".wrap",DISCLOSURE_BUTTON_PATTERN:".disclosure",MENU_LIST_PATTERN:"#menu li",SEPARATOR_PATTERN:".separator",MESSAGE_PATTERN:".message",MESSAGE_WARNING_PATTERN:".message.warning",MESSAGE_WARNING_DETAILS_PATTERN:".details",MESSAGE_SUCCESS_PATTERN:".message.success",DETAILS_PATTERN:".details",COLUMN_NODE_WRAPPER_PATTERN:".node > .wrap > .column",COLUMN_LEAF_WRAPPER_PATTERN:".leaf > .wrap > .column",SEARCH_LOCKUP_PATTERN:".searchLockup",DIALOG_PATTERN:".dialog",DIALOG_LOADING_PATTERN:".dialog.loading",SWIPE_SCROLL_PATTERN:".swipeScroll",SCROLL_WRAPPER_PATTERN:".scrollWrapper",ADHOC_MODE_OPTION_CLASS:"tab mode horizontal",DRAGGING_CLASS:"dragging",COPY_CLASS:"copy",PRESSED_CLASS:"pressed",SELECTED_CLASS:"selected",DISABLED_CLASS:"disabled",HOVERED_CLASS:"over",ERROR_CLASS:"error",SUCCESS_CLASS:"error",MESSAGE_CLASS:"error",UP_CLASS:"up",LAST_CLASS:"last",FIRST_CLASS:"first",SCHEDULED_CLASS:"scheduled",MENU_ROOT_CLASS:"menuRoot",NODE_CLASS:"node",LEAF_CLASS:"leaf",ICON_CLASS:"icon",OPEN_CLASS:"open",CLOSED_CLASS:"closed",LOADING_CLASS:"loading",NOTHING_TO_DISPLAY_CLASS:"nothingToDisplay",COLLAPSIBLE_CLASS:"collapsible",RESPONSIVE_CLASS:"responsive",HIDDEN_CLASS:"hidden",NO_GENERATORS_CLASS:"noGenerators",STACKTRACE_CLASS:"stacktrace",EMPHASIS_CLASS:"emphasis",ASCENDING_CLASS:"ascending",DESCENDING_CLASS:"descending",CANCELLABLE_CLASS:"cancellable",DROP_TARGET_CLASS:"dropTarget",BUTTON_CLASS:"button",ONE_COLUMN_CLASS:"oneColumn",CONTROL_PAGE_CLASS:"controlPage",DISABLED_ATTR_NAME:"disabled",SELECTED_ATTR_NAME:"selected",OPEN_ATTR_NAME:"open",CLOSED_ATTR_NAME:"closed",READONLY_ATTR_NAME:"readonly",DIMMER_ID:"pageDimmer",PAGE_BODY_ID:"display",MENU_ID:"menu",MAIN_NAVIGATION_ID:"mainNavigation",MAIN_NAVIGATION_HOME_ITEM_ID:"main_home",MAIN_NAVIGATION_LIBRARY_ITEM_ID:"main_library",META_LINK_LOGOUT_ID:"main_logOut_link",SCROLL_SENSITIVITY:50,DND_MOVABLE_ZINDEX:2e3,DIMMER_Z_INDEX:900,FOLDERS_RESIZABLE_PANEL_ID:"folders",FILTERS_RESIZABLE_PANEL_ID:"filters",PROPERTIES_RESIZABLE_PANEL_ID:"properties",FIELDS_RESIZABLE_PANEL_ID:"fields",FOLDERS_RESIZABLE_PANEL_COOKIE_NAME:"foldersPanelWidth",FOLDERS_MINIMIZED_PANEL_COOKIE_NAME:"foldersMinimized",FILTERS_RESIZABLE_PANEL_COOKIE_NAME:"filtersPanelWidth",FILTERS_MINIMIZED_PANEL_COOKIE_NAME:"filtersMinimized",PROPERTIES_RESIZABLE_PANEL_COOKIE_NAME:"propertiesPanelWidth",PROPERTIES_MINIMIZED_PANEL_COOKIE_NAME:"propertiesMinimized",FIELDS_RESIZABLE_PANEL_COOKIE_NAME:"fieldsPanelWidth",FIELDS_MINIMIZED_PANEL_COOKIE_NAME:"fieldsMinimized",PANEL_WIDTH:"PanelWidth",MINIMIZED:"Minimized",PANEL_STATE_CHANGED_MANUALLY:"PSCM",scrolls:$H(),initialize:function(e){e=$(e)||$(document.body),new Truncator(e.select(layoutModule.TRUNCATE_PATTERN)),isIE7()&&this.fixIE7Sizes(),e.select(this.SIZEABLE_PATTERN).each(this.createSizer.bind(this)),e.select(this.MOVEABLE_PATTERN).each(this.createMover.bind(this)),e.select(".centered_horz,.centered_vert").each(function(e){var i=parseFunc(e,"centered_fn_");i||(i=centerElement),i(e,{horz:e.match(".centered_horz"),vert:e.match(".centered_vert")})}),null!=$(layoutModule.DIMMER_ID)&&($(layoutModule.DIMMER_ID).style.zIndex=layoutModule.DIMMER_Z_INDEX),jQuery.datepicker&&jQuery.datepicker.initialized&&(jQuery.datepicker.initialized=!1),jQuery(function(){0===jQuery("#ajaxbuffer").length&&jQuery("body").append(jQuery('<div id="ajaxbuffer" style="display:none"></div>'))}),jQuery(window).resize(function(){this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(function(){jQuery(this).trigger("resizeEnd")},500)})},updateOnOrientation:function(){},isVisible:function(e){return e&&!$(e).hasClassName(layoutModule.HIDDEN_CLASS)},createScroller:function(e,i){if(e){e=e.identify?e:$(e);var t=layoutModule.scrolls.get(e.identify());t&&t.destroy();var n=["mainTableContainer","resultsContainer","filtersPanel","foldersPodContent"];e.identify().startsWith("iframeScroll_")&&n.push(e.identify()),i=Object.extend({hideScrollbar:!1,useTransform:!n.include(e.identify()),bounce:["resultsContainer"].include(e.identify())},i||{});var a=new iScroll(e,i);return layoutModule.scrolls.set(e.identify(),a),a}return null},createSizer:function(e,i){e=$(e);var t=i&&i.sizer?$(i.sizer):e.down(this.SIZER_PATTERN);if(t&&!matchMeOrUp(e,"."+layoutModule.HIDDEN_CLASS)){var n=this.getSizerType(t),a=this.alignmentModule.getSizerAlignment(t,n),l=new Draggable(t);l.resizeablePanel=e,l.primaryPanel=$(e).siblings().find(function(e){return e.match(".primary")}),i&&i.fillerPattern&&(l.filler=$(jQuery(e).find(i.fillerPattern)[0]));var o=function(){return function(e){l.pointerX=e.pointerX(),l.pointerY=e.pointerY()}}();t.observe("mousedown",o),jQuery(t).bind({touchstart:function(e){o(e.originalEvent),this.style.background="#666",this.style.zIndex=9},touchend:function(){this.style.background="transparent"}}),l.sizerType=n,l.alignment=a,l.options={constraint:"diagonal"===n?"":n,onStart:layoutModule.beginSizerDragging.bind(layoutModule),onDrag:isIPad()?doNothing:layoutModule.respondToDrag.bind(layoutModule),onEnd:layoutModule.endSizerDragging.bind(layoutModule)}}},getSizerType:function(e){return e.match(".horizontal")&&"horizontal"||e.match(".vertical")&&"vertical"||e.match(".diagonal")&&"diagonal"},alignmentModule:{alignments:[["left","right"],["top","bottom"]],alignmentIndexes:{horizontal:0,vertical:1},dimensions:["width","height"],getSizerAlignment:function(e,i){var t=["",""];if("diagonal"===i)return["right","bottom"];var n=this.alignmentIndexes[i],a=this.alignments[n],l=[0,1].map(function(i){return parseInt(e.getStyle(a[i]))}),o=isNaN(l[0])||l[0]>l[1]?a[1]:a[0];return t[n]=o,t}},beginSizerDragging:function(e,i){var t=e.element;e.parentOffset=[t.getStyle(e.alignment[0]),t.getStyle(e.alignment[1])],e.offsetUnit="px",e.pointerX=e.pointerX||i.pointerX(),e.pointerY=e.pointerY||i.pointerY(),e.element.addClassName(layoutModule.DRAGGING_CLASS),$$(layoutModule.RESIZE_OVERLAY_PATTERN).each(function(e){e.removeClassName(layoutModule.HIDDEN_CLASS)})},endSizerDragging:function(e,i){layoutModule.respondToDrag(e,i),e.element.removeClassName(layoutModule.DRAGGING_CLASS),$$(layoutModule.RESIZE_OVERLAY_PATTERN).each(function(e){e.addClassName(layoutModule.HIDDEN_CLASS)}),document.fire("dragger:sizer",{targetEvent:i,element:e.element}),jQuery(window).trigger("resize",{targetEvent:i,element:e.element})},respondToDrag:function(e,i){"vertical"!==e.sizerType&&this.resizeOnDrag(e,i,"horizontal"),"horizontal"!==e.sizerType&&this.resizeOnDrag(e,i,"vertical")},resizeOnDrag:function(e,i,t){var n={};n.axis="horizontal"==t?0:1,n.myAlignments=this.alignmentModule.alignments[n.axis],n.dimension=this.alignmentModule.dimensions[n.axis],n.sizeProperty=n.axis?"offsetHeight":"offsetWidth";var a=n.axis?"pointerY":"pointerX",l={pointerY:"clientY",pointerX:"clientX"};e.element;n.sizeableAnchorage=e.alignment[n.axis]===n.myAlignments[0]?n.myAlignments[1]:n.myAlignments[0];var o=i.changedTouches?i.changedTouches[0][l[a]]:i[a](),r=e[a]?o-e[a]:0;r=e.alignment[n.axis]===n.myAlignments[1]?r:0-r,n.dragDelta=r,e[a]=i[a](),this.resizePanelsOnDrag(e,n)},resizePanelsOnDrag:function(e,i){var t=this.getSizeTracker();t.checkpoint(e.resizeablePanel[i.sizeProperty]),e.filler&&!e["fillerDelta"+i.dimension]&&(e["fillerDelta"+i.dimension]=e.resizeablePanel[i.sizeProperty]-e.filler[i.sizeProperty]);var n=getDimensionInPx(e.resizeablePanel,i.dimension);if((this.isInBounds(e,i)||!this.isInBounds(e,i)&&i.dragDelta<0)&&(e.resizeablePanel.setStyle(i.dimension+":"+(n+i.dragDelta)+"px"),e.filler&&e.filler.setStyle(i.dimension+":"+(n+i.dragDelta-e["fillerDelta"+i.dimension])+"px")),window.localStorage&&localStorage.setItem(e.resizeablePanel.identify()+layoutModule.PANEL_WIDTH,e.resizeablePanel.getWidth()),!t.changed(e.resizeablePanel[i.sizeProperty])){var a=getActualDimension(e.resizeablePanel,i.dimension);return e.alignment[i.axis]!=i.myAlignments[0]&&(e.element.style[i.myAlignments[0]]=""),e.element.setStyle(e.alignment[i.axis]+":"+e.parentOffset[i.axis]),e.resizeablePanel.setStyle(i.dimension+":"+a+"px"),e.primaryPanel&&e.primaryPanel.style.zIndex==e.resizeablePanel.style.zIndex&&e.primaryPanel.setStyle(i.sizeableAnchorage+":"+a+"px"),void(e.filler&&e.filler.setStyle(i.dimension+":"+(a-e["fillerDelta"+i.dimension])+"px"))}var l;if(e.resizeablePanel.currentStyle?l=e.resizeablePanel.currentStyle.minWidth:(l=document.defaultView.getComputedStyle(e.resizeablePanel,null),l=l["min-width"]?l["min-width"]:l.minWidth),l=l.substring(0,l.indexOf("px")),e.primaryPanel&&e.primaryPanel.style.zIndex==e.resizeablePanel.style.zIndex){var o=getDimensionInPx(e.primaryPanel,i.sizeableAnchorage)+i.dragDelta,r=l>o?l:o;e.primaryPanel.setStyle(i.sizeableAnchorage+":"+r+"px")}e.alignment[i.axis]!=i.myAlignments[0]&&(e.element.style[i.myAlignments[0]]=""),e.element.setStyle(e.alignment[i.axis]+":"+e.parentOffset[i.axis]),jQuery("body").trigger("layout_update")},isInBounds:function(e,i){var t,n,a,l,o,r=jQuery(e.primaryPanel),s=r.parent(),d=i.dimension;if(e.primaryPanel){d=d.replace(d.charAt(0),d.charAt(0).toUpperCase()),o=jQuery.fn["outer"+d],l=o.call(r,!0)-o.call(r),t=parseInt(r.css("min-"+i.dimension)),isNaN(t)&&(t=0),n=parseInt(r.css(i.sizeableAnchorage)),a=parseInt(s.css(i.dimension));var u=s.children("div:visible:not(.minimized)");return jQuery.each(u,function(){var i=jQuery(this),t=0===i.width()||0===i.height();e.resizeablePanel==this||e.primaryPanel==this||t||(a-=o.call(i,!0))}),a-n-i.dragDelta>t+l}return!0},getSizeTracker:function(){return lastSize=-1,{checkpoint:function(e){lastSize=e},changed:function(e){return e!=lastSize}}},createMover:function(e){var i=e.down(this.MOVER_PATTERN);if(i&&!matchMeOrUp(e,"."+layoutModule.HIDDEN_CLASS)){var t=Math.max(this.DND_MOVABLE_ZINDEX,e.getStyle("zIndex"));new Draggable(e,{handle:i,zindex:t})}},maximize:function(e,i){function t(){a.removeClassName("minimized_if_vertical_orientation"),a.removeClassName("minimized"),a.addClassName("maximized"),window.localStorage&&localStorage.setItem(a.identify()+layoutModule.MINIMIZED,!1),jQuery("div.content",a).show()}i=!0;var n=e.hasClassName?e:$(e),a=n.hasClassName("column")?n:n.up(".column");0===window.orientation&&("filters"==a.id&&layoutModule.minimize(document.getElementById("fields")),"fields"==a.id&&layoutModule.minimize(document.getElementById("filters")));var l,o=layoutModule.alignmentModule.alignments[0],r=o.map(function(e){return parseInt(a.getStyle(e))}),s=o[0===r[0]?0:1],d=a.siblings().find(function(e){return e.match(".primary")});d&&window.localStorage&&(l=localStorage.getItem(a.identify()+layoutModule.PANEL_WIDTH)),l&&!isNaN(l)&&(l+="px",a.setStyle({width:l}),i?(d.style[s]=l,a.removeClassName("minimized_if_vertical_orientation"),a.removeClassName("minimized"),a.addClassName("maximized"),window.localStorage&&localStorage.setItem(a.identify()+layoutModule.MINIMIZED,!1),jQuery("div.content",a).show(),jQuery("div.vtitle",a).hide()):(new Effect.Morph(d,{style:s+":"+l,duration:.6,afterFinish:function(){jQuery("body").trigger("layout_update")}}),new Effect.Opacity(a,{to:0,from:1,duration:.3,queue:{position:"front",scope:"sidePanel"},afterFinish:t}),new Effect.Opacity(a,{to:1,from:0,duration:.3,queue:{position:"end",scope:"sidePanel"}}))),jQuery(a).find(".sizer").show(),jQuery("body").trigger("layout_update",{elem:e.parentNode,type:"panel-maximize"}),jQuery(".column.secondary > div.content > .body").show().height()},minimize:function(e,i){function t(){o.addClassName("minimized"),o.removeClassName("maximized"),o.removeClassName("minimized_if_vertical_orientation"),window.localStorage&&localStorage.setItem(o.identify()+layoutModule.MINIMIZED,!0),jQuery("div.content",o).hide()}var n,a;i=!0;var l=e.hasClassName?e:$(e),o=l.hasClassName("column")?l:l.up(".column"),r=window.localStorage&&"true"==localStorage.getItem(o.identify()+layoutModule.MINIMIZED);!r&&window.localStorage&&localStorage.setItem(o.identify()+layoutModule.PANEL_WIDTH,o.getWidth());var s=layoutModule.alignmentModule.alignments[0],d=s.map(function(e){return parseInt(o.getStyle(e))}),u=s[0===d[0]?0:1];if(n=o.siblings().find(function(e){return e.match(".primary")}))if(a=n.getStyle(u),i){var m=jQuery("div.title",o).eq(0),E=jQuery("div.vtitle",o),c=m.html(),S=m.width();S=7*jQuery.trim(m.text()).length,n.style[u]="24px",o.addClassName("minimized"),o.removeClassName("maximized"),o.removeClassName("minimized_if_vertical_orientation"),window.localStorage&&localStorage.setItem(o.identify()+layoutModule.MINIMIZED,!0),E.length||(E=jQuery('<div class="vtitle"></div>').appendTo(o),E.on("mouseup touchend",function(e){layoutModule.maximize(E[0]),e.preventDefault()}),E.html(jQuery.trim(c)).width(S+24)),isIE7()||isIE8()||isIE9()?E.css({top:0,left:0}):E.css("top",S+24+"px"),location.href.indexOf("nui=1")>0?E.hide():E.show(),jQuery("div.content",o).hide()}else new Effect.Morph(n,{style:u+":0px",duration:.6,afterFinish:function(){jQuery("body").trigger("layout_update")}}),new Effect.Opacity(o,{to:0,from:1,duration:.3,queue:{position:"front",scope:"sidePanel"},afterFinish:t}),new Effect.Opacity(o,{to:1,from:0,duration:.3,queue:{position:"end",scope:"sidePanel"}});jQuery(o).find(".sizer").hide(),jQuery("body").trigger("layout_update",{elem:e.parentNode,type:"panel-minimize"})},resizeOnClient:function(e,i,t){var n,a=[],l=jQuery("#"+i),o=jQuery("#display").width()-20-parseInt(l.width());jQuery.each([e,t],function(e,i){i&&(a.push({id:i,isLeft:0===e,jo:jQuery("#"+i),width:window.localStorage?parseInt(localStorage.getItem(i+layoutModule.PANEL_WIDTH)):250}),a[e].minimized=window.localStorage?localStorage.getItem(i+layoutModule.MINIMIZED):!1,a[e].minimized=Object.isUndefined(a[e].minimized)?a[e].jo.hasClass("minimized"):"true"==a[e].minimized,n=a[e].jo[0].currentStyle?a[e].jo[0].currentStyle.minWidth:document.defaultView.getComputedStyle(a[e].jo[0],null).minWidth,a[e].minWidth=(n&&n.indexOf("px"))>0?n.substring(0,n.indexOf("px")):200,a[e].width=a[e].width?a[e].width:a[e].jo.width(),o-=a[e].width)});var r=0>o?Math.abs(o):0;o=0,jQuery.each(a,function(e,i){i.jo.length&&i.jo.is(":visible")&&(i.minimized?(i.jo.removeClass("maximized").addClass("minimized"),layoutModule.minimize(i.jo[0],!0)):(1==e&&!a[0].minimized&&a[0].jo.is(":visible")&&(i.width-=r,i.width<i.minWidth&&(o=i.width-i.minWidth,i.width=i.minWidth)),i.jo.removeClass("minimized").addClass("maximized"),l.css(i.isLeft?"left":"right",i.width+"px"),i.jo.css("width",i.width+"px")))}),0!==o&&(a[0].width+=o,a[0].width=a[0].width<a[0].minWidth?a[0].minWidth:a[0].width,l.css("left",a[0].width+"px"),a[0].jo.css("width",a[0].width+"px"))},autoMaximize:function(e){var i=window.localStorage?localStorage.getItem(e.identify()+layoutModule.MINIMIZED):"false";"true"==i?e.hasClassName("minimized")&&layoutModule.maximize(e,!0):!e.hasClassName("minimized")&&layoutModule.minimize(e,!0)},autoMinimize:function(e){var i=window.localStorage?localStorage.getItem(e.identify()+layoutModule.MINIMIZED):"false";"false"==i?layoutModule.minimize(e,!0):e.removeClassName("minimized")},fixIE7Sizes:function(){$$(".control.tabSet.buttons.vertical").each(function(e){e.immediateDescendants().each(function(i){i.style.width=e.clientWidth||e.offsetWidth})})},storePanelWidth:function(e,i){window.localStorage&&localStorage.setItem(e+layoutModule.PANEL_WIDTH,i)},getPanelWidth:function(e){return window.localStorage?localStorage.getItem(e+layoutModule.PANEL_WIDTH):void 0},getPanelMinimizedState:function(e){return window.localStorage?localStorage.getItem(e+layoutModule.MINIMIZED):void 0},storePanelMinimizedState:function(e,i){window.localStorage&&localStorage.setItem(e+layoutModule.MINIMIZED,i.toString())},manuallyChangePanelState:function(e,i,t){window.localStorage&&localStorage.setItem(e+layoutModule.PANEL_STATE_CHANGED_MANUALLY+i,t)},panelStateWasManuallyChanged:function(e,i){return window.localStorage?"true"===localStorage.getItem(e+layoutModule.PANEL_STATE_CHANGED_MANUALLY+i):!1}};