var toolbarButtonModule={UP:"up",DOWN:"down",OVER:"over",DISABLED:"disabled",PRESSED:"pressed",CONTENT_PREFIX:"toolbar_",MenuClass:"menu vertical dropDown",TOOLBAR_MENU_CLASS:"menu vertical dropDown fitable",ACTION_MODEL_TAG:"adhocActionModel",CAPSULE_PATTERN:"capsule",showButtonMenu:function(e,t){t=jQuery(t);var s=this.CONTENT_PREFIX+t.attr("id"),o="adhocActionModel"==this.ACTION_MODEL_TAG?this.actionModel:this.ACTION_MODEL_TAG;actionModel.showDropDownMenu(e,t,s,this.TOOLBAR_MENU_CLASS,o)},setActionModel:function(e){this.actionModel=e},isToolBarButton:function(e){return e?jQuery(e).hasClass("capsule"):!1},enable:function(e,t){buttonManager.enable(e)},disable:function(e){buttonManager.disable(e)},setButtonState:function(e,t){t?this.enable(e):this.disable(e)}};define("components.toolbarButtons",["jquery","prototype"],function(e){return function(){var t;return t||e.toolbarButtonModule}}(this)),toolbarButtonModule.initialize=function(e){toolbarButtonModule.actionMap=e,jQuery(".toolbar").on("mouseup mouseover mouseout","button",function(e){jQuery(this).prop("disabled")||toolbarButtonModule["mouse"+e.type.substring(5,6).toUpperCase()+e.type.substring(6)+"Handler"](e,this)}),isFirefox()&&jQuery(".toolbar li").each(function(e,t){jQuery(t).css("padding","0 2px")})},toolbarButtonModule.mouseUpHandler=function(e,t){var s=t.className.indexOf("capsule")>=0?toolbarButtonModule.actionMap[t.id]:null;if(s){var o=getAsFunction(s);o(e),e.stopPropagation()}},toolbarButtonModule.mouseOverHandler=function(e,t){t.className.indexOf("capsule")>=0&&t.className.indexOf("mutton")>=0&&!buttonManager.isDisabled(t)&&toolbarButtonModule.showButtonMenu(e.originalEvent,t)},toolbarButtonModule.mouseOutHandler=function(e,t){},define("components.toolbar",["jquery","prototype","utils.common","components.toolbarButtons"],function(e){return function(){var t;return t||e.toolbarButtonModule}}(this));var messageListModule={_list:null,_messageListId:"messageList",_flowExecutionKey:null,_systemConfirmMessages:[],toolbar:{_buttons:null,_id:"toolbar",initialize:function(){toolbarButtonModule.initialize({}),this._buttons=document.body.select(layoutModule.TOOLBAR_CAPSULE_PATTERN),this._initEventHandlers()},refresh:function(){this._buttons.each(function(e){toolbarButtonModule.setButtonState(e,messageListModule.hasSelectedMessages())}.bind(this))},_initEventHandlers:function(){$(this._id).observe("click",function(e){var t=matchAny(e.element(),[layoutModule.BUTTON_PATTERN],!0),s=t.identify();messageListModule.doAction(s,Object.toQueryString({selectedIds:messageListModule.getSelectedIds()}))}.bindAsEventListener(this))}},filter:{_id:"messageFilter",initialize:function(){this._initEventHandlers()},_initEventHandlers:function(){$(this._id).observe("change",function(e){e.element();messageListModule.doAction("changeEventsType",Object.toQueryString({messageFilter:$(this._id).getValue()}))}.bindAsEventListener(this))}},initialize:function(e){this._flowExecutionKey=e.flowExecutionKey,this._systemConfirmMessages=e.systemConfirmMessages,this._list=new dynamicList.List(this._messageListId,{listTemplateDomId:"list_fourColumn_type_message",itemTemplateDomId:"list_fourColumn_type_message:unread",multiSelect:!0});var t=this._list.selectItem;this._list.selectItem=function(e){e.getValue().isHeader||t.apply(this,arguments)},this._initListEvents(),this.toolbar.initialize(),this.filter.initialize(),this.doAction("getMessages","")},_getMessageItems:function(e){var t=function(e){var t=e.select(".subject a")[0];t.update(xssUtil.escape(this.getValue().subject)),t.writeAttribute("href","flow.html?_flowExecutionKey="+messageListModule._flowExecutionKey+"&_eventId=viewMessage&id="+this.getValue().id);var s=e.select(".date")[0];s.update(xssUtil.escape(this.getValue().date)),s.writeAttribute("title",this.getValue().timestamp);var o=e.select(".type")[0];o.update(xssUtil.escape(this.getValue().type));var i=e.select(".component")[0];return i.update(xssUtil.escape(this.getValue().component)),e};return e.unshift({isHeader:!0}),e.collect(function(e){var s;s=e.isHeader?"list_fourColumn_type_message:header":e.isRead?"list_fourColumn_type_message:read":"list_fourColumn_type_message:unread";var o=new dynamicList.ListItem({cssClassName:layoutModule.LEAF_CLASS,value:e,templateDomId:s});return e.isHeader?o.processTemplate=function(e){return e}:o.processTemplate=t,o}.bind(this))},_initListEvents:function(){this._list.observe("item:selected",function(e){this.refreshToolbar()}.bindAsEventListener(this)),this._list.observe("item:unselected",function(e){this.refreshToolbar()}.bindAsEventListener(this))},refreshToolbar:function(){messageListModule.toolbar.refresh()},hasSelectedMessages:function(){return this._list.getSelectedItems().length>0},getSelectedIds:function(){return this._list.getSelectedItems().collect(function(e){return e.getValue().id})},doAction:function(e,t){var s="flow.html?_flowExecutionKey="+messageListModule._flowExecutionKey+"&_eventId="+e;this._list.setItems([]),this.refreshToolbar(),ajaxTargettedUpdate(s,{postData:t,callback:function(e){"OK"==e.status?(this._list.setItems(this._getMessageItems(e.data)),this._list.show()):alert(e.data.message)}.bind(this),errorHandler:this._serverErrorHandler,mode:AjaxRequester.prototype.EVAL_JSON})},_serverErrorHandler:function(e){e.getResponseHeader("LoginRequested")&&(document.location="flow.html?_flowId=logEventFlow"),showErrorPopup=function(){window.alert("Server Error")};var t=baseErrorHandler(e);t||500!=e.status||(document.location="flow.html?_flowId=logEventFlow&_eventId=error",document.location="flow.html?_flowId=logEventFlow&_eventId=error")}};"undefined"==typeof require&&document.observe("dom:loaded",function(){messageListModule.initialize(localContext.initOptions)}),define("messages/list/messageList",["prototype","components.list","components.toolbar","core.layout"],function(e){return function(){var t;return t||e.messageListModule}}(this)),define("messages/list/messageListMain",["require","!domReady","./messageList","jrs.configs"],function(e){"use strict";var t=e("!domReady"),s=e("./messageList"),o=e("jrs.configs");t(function(){s.initialize(o.messagesListInitOptions)})});