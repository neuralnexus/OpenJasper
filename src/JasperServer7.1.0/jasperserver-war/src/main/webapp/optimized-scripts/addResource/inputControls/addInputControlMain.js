var resource={messages:{},resourceLabelMaxLength:100,resourceIdMaxLength:100,resourceDescriptionMaxLength:250,PROPAGATE_EVENT:"propagateEvent",STEP_DISPLAY_ID:"stepDisplay",FLOW_CONTROLS_ID:"flowControls",initSwipeScroll:function(){var e=$(resource.STEP_DISPLAY_ID);e&&new TouchController(e.up(),e.up(1),{})},submitForm:function(e,t,r){if(t){var o=buildActionUrl(t);r&&r(),$(e).writeAttribute("method","post").writeAttribute("action",o),$(e).submit()}},registerClickHandlers:function(e,t,r){if(resource._bodyClickEventHandlers)return void(r?Array.prototype.unshift:Array.prototype.push).apply(resource._bodyClickEventHandlers,e);resource._bodyClickEventHandlers=e;var o=t||"body";$$(o)[0].observe("click",function(e){resource._bodyClickEventHandlers&&resource._bodyClickEventHandlers.each(function(t){var r=t(e);if(r)throw r!==resource.PROPAGATE_EVENT&&Event.stop(e),$break})})},TreeWrapper:function(e){var t=this;if(this._treeId=e.treeId,this._resourceUriInput=$(e.resourceUriInput||"resourceUri"),this._uri=this._resourceUriInput&&this._resourceUriInput.getValue()||e.uri||"/",!e.providerId)throw"There is no tree provider set for tree #{id}".interpolate({id:this._treeId});var r=["providerId","rootUri","organizationId","publicFolderUri","urlGetNode","urlGetChildren"].inject({},function(t,r){return null!==e[r]&&(t[r]=e[r]),t});return this._tree=new dynamicTree.createRepositoryTree(this._treeId,r),this._tree.observe("tree:loaded",function(){t._tree.openAndSelectNode($(t._resourceUriInput).getValue())}),this._tree.observe("leaf:selected",function(e){t._uri=e.memo.node.param.uri,t._resourceUriInput.setValue(t._uri)}),this._tree.observe("node:selected",function(){t._resourceUriInput.setValue(t._uri="")}),{getTreeId:function(){return t._treeId},getTree:function(){return t._tree},selectFolder:function(e){t._tree.openAndSelectNode(e)},getSelectedFolderUri:function(){return t._uri}}},switchButtonState:function(e,t){buttonManager[t?"enable":"disable"].call(buttonManager,e)},switchDisableState:function(e,t){(e=$(e))&&e[t?"disable":"enable"].call(e)},generateResourceId:function(e){if(localContext&&localContext.initOptions&&localContext.initOptions.resourceIdNotSupportedSymbols)return e.replace(new RegExp(localContext.initOptions.resourceIdNotSupportedSymbols,"g"),"_");throw"There is no resourceIdNotSupportedSymbols property in init options."},testResourceId:function(e){if(localContext&&localContext.initOptions&&localContext.initOptions.resourceIdNotSupportedSymbols)return new RegExp(localContext.initOptions.resourceIdNotSupportedSymbols,"g").test(e);throw"There is no resourceIdNotSupportedSymbols property in init options."},labelValidator:function(e){var t=!0,r="";return e.blank()?(r=resource.messages.labelIsEmpty,t=!1):e.length>resource.resourceLabelMaxLength&&(r=resource.messages.labelToLong,t=!1),{isValid:t,errorMessage:r}},getLabelValidationEntry:function(e){return{element:e,validators:[{method:"mandatory",messages:{mandatory:resource.messages.labelIsEmpty}},{method:"minMaxLength",messages:{tooLong:resource.messages.labelToLong},options:{maxLength:resource.resourceLabelMaxLength}}]}},getIdValidationEntry:function(e){return{element:e,validators:[{method:"resourceIdChars",messages:resource.messages},{method:"mandatory",messages:{mandatory:resource.messages.resourceIdIsEmpty}},{method:"minMaxLength",messages:{tooLong:resource.messages.resourceIdToLong},options:{maxLength:resource.resourceIdMaxLength}}]}},resourceIdValidator:function(e){var t=!0,r="";return this._isEditMode||(e.blank()?(r=resource.messages.resourceIdIsEmpty,t=!1):e.length>resource.resourceIdMaxLength?(r=resource.messages.resourceIdToLong,t=!1):resource.testResourceId(e)&&(r=resource.messages.resourceIdInvalidChars,t=!1)),{isValid:t,errorMessage:r}},getDescriptionValidationEntry:function(e){return{element:e,validators:[{method:"minMaxLength",messages:{tooLong:resource.messages.descriptionToLong},options:{maxLength:resource.resourceDescriptionMaxLength}}]}},descriptionValidator:function(e){var t=!0,r="";return e.length>resource.resourceDescriptionMaxLength&&(r=resource.messages.descriptionToLong,t=!1),{isValid:t,errorMessage:r}},dataSourceValidator:function(e){var t=!0,r="";return""===e.trim()&&(r=resource.messages.dataSourceInvalid,t=!1),{isValid:t,errorMessage:r}},queryValidator:function(e){var t=!0,r="";return""===e.trim()&&(r=resource.messages.queryInvalid,t=!1),{isValid:t,errorMessage:r}},getValidationEntries:function(e){return e.collect(function(e){return e.validationEntry?e.validationEntry:{validator:e.validator,element:e}})}};"undefined"==typeof require&&isIPad()&&document.observe("dom:loaded",resource.initSwipeScroll.bind(resource)),define("resource.base",["prototype","utils.common","core.layout"],function(e){return function(){var t;return t||e.resource}}(this));var addInputControl={PAGE_ID:"addResource_inputControl",LABEL_ID:"label",RESOURCE_ID_ID:"name",DESCRIPTION_ID:"description",NEXT_BUTTON_ID:"next",NEXT_AND_SUBMIT_BUTTON_ID:"nextAndSubmit",TYPE_ID:"dataTypeKind",_canGenerateId:!0,initialize:function(e){this._form=$(this.PAGE_ID).select("form")[0],this._label=$(this.LABEL_ID),this._resourceId=$(this.RESOURCE_ID_ID),this._description=$(this.DESCRIPTION_ID),this._nextButton=$(this.NEXT_BUTTON_ID),this._nextAndSubmitButton=$(this.NEXT_AND_SUBMIT_BUTTON_ID),this._typeId=$(this.TYPE_ID),this._isEditMode=e.isEditMode,this._label.validator=resource.labelValidator.bind(this),this._resourceId.validator=resource.resourceIdValidator.bind(this),this._description.validator=resource.descriptionValidator.bind(this),this._initEvents()},_initEvents:function(){var e=function(e){this._isDataValid()||e.stop()}.bindAsEventListener(this);this._nextButton.observe("click",e),this._nextAndSubmitButton.observe("click",e),this._form.observe("keyup",function(e){var t=e.element(),r=[this._label,this._resourceId,this._description];r.include(t)&&(ValidationModule.validate(resource.getValidationEntries([t])),t==this._resourceId&&this._resourceId.getValue()!=resource.generateResourceId(this._label.getValue())&&(this._canGenerateId=!1),t==this._label&&!this._isEditMode&&this._canGenerateId&&(this._resourceId.setValue(resource.generateResourceId(this._label.getValue())),ValidationModule.validate(resource.getValidationEntries([this._resourceId]))))}.bindAsEventListener(this)),this._typeId.observe("change",function(e){1==e.element().value?(this._nextButton.addClassName("hidden"),this._nextAndSubmitButton.removeClassName("hidden")):(this._nextButton.removeClassName("hidden"),this._nextAndSubmitButton.addClassName("hidden"))}.bindAsEventListener(this))},_isDataValid:function(){var e=[this._label,this._resourceId,this._description];return ValidationModule.validate(resource.getValidationEntries(e))}};"undefined"==typeof require&&document.observe("dom:loaded",function(){addInputControl.initialize(localContext.initOptions)}),define("resource.inputControl",["resource.base","prototype","utils.common"],function(e){return function(){var t;return t||e.addInputControl}}(this)),define("addResource/inputControls/addInputControlMain",["require","!domReady","resource.inputControl","underscore","jrs.configs","resource.base","utils.common"],function(e){"use strict";var t=e("!domReady"),r=e("resource.inputControl"),o=e("underscore"),i=e("jrs.configs"),n=e("resource.base");e("utils.common"),t(function(){var e=i.addInputControl.localContext.initOptions;o.extend(window.localContext,i.addInputControl.localContext),o.extend(n.messages,i.addInputControl.resource.messages),r.initialize(e),isIPad()&&n.initSwipeScroll()})});