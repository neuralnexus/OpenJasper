var resource={messages:{},resourceLabelMaxLength:100,resourceIdMaxLength:100,resourceDescriptionMaxLength:250,PROPAGATE_EVENT:"propagateEvent",STEP_DISPLAY_ID:"stepDisplay",FLOW_CONTROLS_ID:"flowControls",initSwipeScroll:function(){var e=$(resource.STEP_DISPLAY_ID);e&&new TouchController(e.up(),e.up(1),{})},submitForm:function(e,r,t){if(r){var o=buildActionUrl(r);t&&t(),$(e).writeAttribute("method","post").writeAttribute("action",o),$(e).submit()}},registerClickHandlers:function(e,r,t){if(resource._bodyClickEventHandlers)return void(t?Array.prototype.unshift:Array.prototype.push).apply(resource._bodyClickEventHandlers,e);resource._bodyClickEventHandlers=e;var o=r||"body";$$(o)[0].observe("click",function(e){resource._bodyClickEventHandlers&&resource._bodyClickEventHandlers.each(function(r){var t=r(e);if(t)throw t!==resource.PROPAGATE_EVENT&&Event.stop(e),$break})})},TreeWrapper:function(e){var r=this;if(this._treeId=e.treeId,this._resourceUriInput=$(e.resourceUriInput||"resourceUri"),this._uri=this._resourceUriInput&&this._resourceUriInput.getValue()||e.uri||"/",!e.providerId)throw"There is no tree provider set for tree #{id}".interpolate({id:this._treeId});var t=["providerId","rootUri","organizationId","publicFolderUri","urlGetNode","urlGetChildren"].inject({},function(r,t){return null!==e[t]&&(r[t]=e[t]),r});return this._tree=new dynamicTree.createRepositoryTree(this._treeId,t),this._tree.observe("tree:loaded",function(){r._tree.openAndSelectNode($(r._resourceUriInput).getValue())}),this._tree.observe("leaf:selected",function(e){r._uri=e.memo.node.param.uri,r._resourceUriInput.setValue(r._uri)}),this._tree.observe("node:selected",function(){r._resourceUriInput.setValue(r._uri="")}),{getTreeId:function(){return r._treeId},getTree:function(){return r._tree},selectFolder:function(e){r._tree.openAndSelectNode(e)},getSelectedFolderUri:function(){return r._uri}}},switchButtonState:function(e,r){buttonManager[r?"enable":"disable"].call(buttonManager,e)},switchDisableState:function(e,r){(e=$(e))&&e[r?"disable":"enable"].call(e)},generateResourceId:function(e){if(localContext&&localContext.initOptions&&localContext.initOptions.resourceIdNotSupportedSymbols)return e.replace(new RegExp(localContext.initOptions.resourceIdNotSupportedSymbols,"g"),"_");throw"There is no resourceIdNotSupportedSymbols property in init options."},testResourceId:function(e){if(localContext&&localContext.initOptions&&localContext.initOptions.resourceIdNotSupportedSymbols)return new RegExp(localContext.initOptions.resourceIdNotSupportedSymbols,"g").test(e);throw"There is no resourceIdNotSupportedSymbols property in init options."},labelValidator:function(e){var r=!0,t="";return e.blank()?(t=resource.messages.labelIsEmpty,r=!1):e.length>resource.resourceLabelMaxLength&&(t=resource.messages.labelToLong,r=!1),{isValid:r,errorMessage:t}},getLabelValidationEntry:function(e){return{element:e,validators:[{method:"mandatory",messages:{mandatory:resource.messages.labelIsEmpty}},{method:"minMaxLength",messages:{tooLong:resource.messages.labelToLong},options:{maxLength:resource.resourceLabelMaxLength}}]}},getIdValidationEntry:function(e){return{element:e,validators:[{method:"resourceIdChars",messages:resource.messages},{method:"mandatory",messages:{mandatory:resource.messages.resourceIdIsEmpty}},{method:"minMaxLength",messages:{tooLong:resource.messages.resourceIdToLong},options:{maxLength:resource.resourceIdMaxLength}}]}},resourceIdValidator:function(e){var r=!0,t="";return this._isEditMode||(e.blank()?(t=resource.messages.resourceIdIsEmpty,r=!1):e.length>resource.resourceIdMaxLength?(t=resource.messages.resourceIdToLong,r=!1):resource.testResourceId(e)&&(t=resource.messages.resourceIdInvalidChars,r=!1)),{isValid:r,errorMessage:t}},getDescriptionValidationEntry:function(e){return{element:e,validators:[{method:"minMaxLength",messages:{tooLong:resource.messages.descriptionToLong},options:{maxLength:resource.resourceDescriptionMaxLength}}]}},descriptionValidator:function(e){var r=!0,t="";return e.length>resource.resourceDescriptionMaxLength&&(t=resource.messages.descriptionToLong,r=!1),{isValid:r,errorMessage:t}},dataSourceValidator:function(e){var r=!0,t="";return""===e.trim()&&(t=resource.messages.dataSourceInvalid,r=!1),{isValid:r,errorMessage:t}},queryValidator:function(e){var r=!0,t="";return""===e.trim()&&(t=resource.messages.queryInvalid,r=!1),{isValid:r,errorMessage:t}},getValidationEntries:function(e){return e.collect(function(e){return e.validationEntry?e.validationEntry:{validator:e.validator,element:e}})}};"undefined"==typeof require&&isIPad()&&document.observe("dom:loaded",resource.initSwipeScroll.bind(resource)),define("resource.base",["prototype","utils.common","core.layout"],function(e){return function(){var r;return r||e.resource}}(this));var resourceAnalysisView={LABEL_ID:"labelID",RESOURCE_ID_ID:"nameID",DESCRIPTION_ID:"addFileInputDescription",NEXT_BUTTON_ID:"next",_canGenerateId:!0,initialize:function(e){this._form=$(document.body).select("form")[0],this._label=$(this.LABEL_ID),this._resourceId=$(this.RESOURCE_ID_ID),this._description=$(this.DESCRIPTION_ID),this._nextButton=$(this.NEXT_BUTTON_ID),this._isEditMode=e.isEditMode,this._label.validator=resource.labelValidator.bind(this),this._resourceId.validator=resource.resourceIdValidator.bind(this),this._description.validator=resource.descriptionValidator.bind(this),this._initEvents()},_initEvents:function(){this._nextButton.observe("click",function(e){this._isDataValid()||e.stop()}.bindAsEventListener(this)),this._form.observe("keyup",function(e){var r=e.element(),t=[this._label,this._resourceId,this._description];t.include(r)&&(ValidationModule.validate(resource.getValidationEntries([r])),r==this._resourceId&&this._resourceId.getValue()!=resource.generateResourceId(this._label.getValue())&&(this._canGenerateId=!1),r==this._label&&!this._isEditMode&&this._canGenerateId&&(this._resourceId.setValue(resource.generateResourceId(this._label.getValue())),ValidationModule.validate(resource.getValidationEntries([this._resourceId]))))}.bindAsEventListener(this))},_isDataValid:function(){var e=[this._label,this._resourceId,this._description];return ValidationModule.validate(resource.getValidationEntries(e))}};"undefined"==typeof require&&document.observe("dom:loaded",function(){resourceAnalysisView.initialize(localContext.initOptions)}),define("resource.analysisView",["resource.base","utils.common","prototype"],function(e){return function(){var r;return r||e.resourceAnalysisView}}(this)),define("addResource/analysisView/addOLAPViewMain",["require","!domReady","resource.analysisView","underscore","jrs.configs","resource.base","utils.common"],function(e){"use strict";var r=e("!domReady"),t=e("resource.analysisView"),o=e("underscore"),i=e("jrs.configs"),s=e("resource.base");e("utils.common"),r(function(){var e=i.addOLAPView.localContext.initOptions;o.extend(window.localContext,i.addOLAPView.localContext),o.extend(s.messages,i.addOLAPView.resource.messages),t.initialize(e),isIPad()&&s.initSwipeScroll()})});