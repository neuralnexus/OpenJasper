var dialogs={};dialogs.systemConfirm={container:null,message:null,show:function(e,t,s){if(window.isEmbeddedDesigner)s&&(e='<span class="warning">'+e+"</span>"),jQuery(document).trigger("adhocDesigner:notification",[e,t]);else{if(this.container=this.container||jQuery("#systemMessageConsole").on("mouseup touchend",function(){dialogs.systemConfirm.container.slideUp()}),this.message=this.message||document.getElementById("systemMessage"),!this.message)return void console.warn(e);this.closeText||(this.closeText=this.message.innerHTML.toLowerCase()),e=xssUtil.escape(e)+' <span>| <a href="#">'+xssUtil.escape(this.closeText)+"</a></span>",s?this.message.innerHTML='<span class="warning">'+e+"</span>":this.message.innerHTML=e,dialogs.systemConfirm.container.slideDown(),setTimeout("dialogs.systemConfirm.hide()",t?t:2e3)}},showWarning:function(e,t){this.show(e,t,!0)},hide:function(){dialogs.systemConfirm.container&&dialogs.systemConfirm.container.slideUp()}},jQuery(document).on("systemDialogWarn",function(e,t,s){dialogs.systemConfirm.showWarning(t,s)}),dialogs.errorPopup={_dom:null,_content:null,_DOM_ID:"standardAlert",_CONTENT_ID:"errorPopupContents",_PAGE_CONTENT_PATTERN:"#errorPageContent",_DIALOG_WIDTH:"546px",_DIALOG_HEIGHT:"350px",clickHandler:null,show:function(e,t,s){s||(s={});var o=Builder.node("DIV",{style:"display:none"});o.innerHTML=xssUtil.escape(e,{softHTMLEscape:!0}),document.body.insertBefore(o,document.body.firstChild);var i=$$(this._PAGE_CONTENT_PATTERN)[0],n=i?i.innerHTML:e,a=i&&i.innerHTML;if(o.remove(),n&&(this._dom||(this._dom=$(this._DOM_ID),this._content=$(this._CONTENT_ID),this.clickHandler=this._clickHandler.bindAsEventListener(this)),this._dom)){var l=n;a||(l=Builder.node("P",{"class":"message"}),l.update(xssUtil.escape(n,{softHTMLEscape:!0}))),this._content.update(xssUtil.escape(l,{softHTMLEscape:!0})),this._dom.observe("click",this.clickHandler),this._dom.setStyle({height:s.height||this._DIALOG_HEIGHT,width:s.width||this._DIALOG_WIDTH}),t&&this._dom.addClassName(layoutModule.STACKTRACE_CLASS),dialogs.popup.show(this._dom,t);var d=document.getElementById("completeStackTrace");d&&isIPad()&&new TouchController(d,d.parentNode,{noInit3d:!0})}},_hide:function(){this._dom&&(this._dom.stopObserving("click",this.clickHandler),dialogs.popup.hide(this._dom))},_clickHandler:function(e){var t=e.element();matchAny(t,["button"],!0)&&this._hide()}},dialogs.clusterErrorPopup=_.extend({},dialogs.errorPopup,{show:function(e){var t=this;require(["bundle!jasperserver_messages","bundle!jsexceptions_messages"],function(e,s){var o=s["cluster.exception.session.attribute.missing.popup"];dialogs.errorPopup.show.call(t,o);var i=e["button.home"];jQuery("#"+t._DOM_ID).find("button span.wrap").html(i)})},_hide:function(e){dialogs.errorPopup._hide.apply(this,arguments),window.location="home.html"}}),dialogs.popup={OWNER_ATTR:"data-owner",show:function(e,t,s){require(["stdnav","jquery"],function(o,i){if(s=s||{},e=$(e)){"message"in s&&i(e).find(".body").text(xssUtil.unescape(s.message)),t&&(pageDimmer.show(),e.match(layoutModule.DIALOG_LOADING_PATTERN)&&pageDimmer.setZindex(e.getStyle("zIndex")-1)),reParent(e,document.body),e.setOpacity(0),e.removeClassName(layoutModule.HIDDEN_CLASS),layoutModule.createSizer.call(layoutModule,e),s.cascade?cascadeElement(e,{position:s.position,number:s.number,horzOffset:40,vertOffset:40}):centerElement(e,{horz:!0,vert:!0}),dialogs.popup._setHigherZIndex(e),layoutModule.createMover.call(layoutModule,e),isIPad()?e.setOpacity(1)&&e.show():appear(e,.4),i(document.activeElement).addClass("preDialogFocus");var n=e;e&&i(".primary",e).length>0&&(n=i(".primary",e)[0]),(!s||"undefined"==typeof s.focus||s.focus)&&(e.tabIndex=0,n.tabIndex=0,n.focus()),!t&&e.observe("click",dialogs.popup.zIndexHandler),o.beginModalFocus(e)}})},hide:function(e){require(["stdnav","jquery"],function(t,s){t.endModalFocus(e);var o=s(".preDialogFocus");o.length&&o.is(":visible")&&(o[0].focus(),o.removeClass("preDialogFocus")),e&&($elem=$(e),$elem.hasClassName(layoutModule.HIDDEN_CLASS)||($elem.addClassName(layoutModule.HIDDEN_CLASS),pageDimmer.hide(),$elem.match(layoutModule.DIALOG_LOADING_PATTERN)&&pageDimmer.setZindex(layoutModule.DIMMER_Z_INDEX)),$elem.stopObserving("click",dialogs.popup.zIndexHandler))})},showShared:function(e,t,s){e&&($elem=$(e),s=s||{},s.owner&&($elem.writeAttribute(this.OWNER_ATTR,s.owner),$elem.hasClassName(layoutModule.HIDDEN_CLASS)&&this.show($elem,t,s)))},hideShared:function(e,t){if(e){$elem=$(e);var s=$elem.readAttribute(this.OWNER_ATTR);s==t&&($elem.writeAttribute(this.OWNER_ATTR,!1),this.hide($elem))}},zIndexHandler:function(e){var t=Event.element(e),s=matchMeOrUp(t,layoutModule.DIALOG_PATTERN);s&&dialogs.popup._setHigherZIndex(s)},_setHigherZIndex:function(e,t){var s,o,i,n=0,a=0;e&&(i=e.getStyle("zIndex"),t&&(n=t.getStyle("zIndex")),s=document.body.select(layoutModule.DIALOG_PATTERN),s=s.filter(function(t){return t.visible()?t.match(layoutModule.DIALOG_LOADING_PATTERN)?!1:t===e?!1:!0:!1}),s.each(function(e){a=Math.max(a,e.getStyle("zIndex"))}),o=Math.max(n,i,a,layoutModule.DIMMER_Z_INDEX),e.setStyle({zIndex:o}),s.each(function(e){var t=e.getStyle("zIndex");t>=o&&e.setStyle({zIndex:o-1})}))}},dialogs.popupConfirm=_.extend({},dialogs.popup,{show:function(e,t,s){dialogs.popup.show.apply(this,arguments),s=_.extend({okButtonSelector:"button.ok",cancelButtonSelector:"button.cancel"},s);var o=jQuery(e),i=o.find(s.okButtonSelector),n=o.find(s.cancelButtonSelector),a=jQuery.Deferred();return i.on("click",function(){s.validateFunc&&s.validateFunc()===!1||(i.off("click"),n.off("click"),dialogs.popupConfirm.hide(e),a.resolve())}),n.on("click",function(){i.off("click"),n.off("click"),dialogs.popupConfirm.hide(e),a.reject()}),a}}),dialogs.childPopup=_.extend({},dialogs.popup,{cascadePopups:{},show:function(e,t,s,o){s?(o=_.extend({parent:s},o),this.cascadePopups[s.id]||(this.cascadePopups[s.id]=[]),this.cascadePopups[s.id].push(e.id),$(e).setAttribute("data-parentDialog",s.id),dialogs.popup.show.apply(this,[e,t,o]),dialogs.popup._setHigherZIndex(e,s),t&&pageDimmer.setZindex(e.getStyle("zIndex")-1),s.stopObserving("click",dialogs.popup.zIndexHandler)):dialogs.popup.show.apply(this,[e,t,o])},hide:function(e){var t=$(e).getAttribute("data-parentDialog");if(t){this.cascadePopups[t]&&(this.cascadePopups[t]=_.without(this.cascadePopups[t],e.id)),dialogs.popup.hide.apply(this,[e]);var s=$(t);pageDimmer.show(s),dialogs.popup._setHigherZIndex(s)}else dialogs.popup.hide.apply(this,[e])}});