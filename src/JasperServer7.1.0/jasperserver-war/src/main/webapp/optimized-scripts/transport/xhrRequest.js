define(["require","jquery","underscore","logger"],function(e){"use strict";function r(){i.trigger.apply(i,arguments)}function t(e){(401==e.status||e.getResponseHeader("LoginRequested"))&&(n(window).trigger("sessionExpired"),s.warn("Session timed-out. Redirecting to login page."),window.location.reload())}var n=e("jquery"),o=e("underscore"),s=e("logger").register("request");if("undefined"==typeof document)return{};var i=n(document);return function(e){return o.partial(r,"request:before").apply(null,arguments),n.ajax(e).fail(t).fail(function(e,r,t){e.getResponseHeader("adhocException")?s.error(e.getResponseHeader("adhocException")):(500==e.status||e.getResponseHeader("JasperServerError")&&!e.getResponseHeader("SuppressError"))&&s.error(e.responseText)}).fail(o.partial(r,"request:failure")).done(o.partial(r,"request:success"))}});