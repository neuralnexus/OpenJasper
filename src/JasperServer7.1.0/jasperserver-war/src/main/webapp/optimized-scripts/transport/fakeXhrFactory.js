define(["require","underscore"],function(e){var r=e("underscore");return function(e){var s={},t={};return r.extend(e,{getResponseHeader:function(r){var s,t=/^(.*?):[ \t]*([^\r\n]*)$/gm;if(4===e.readyState){if(!this.responseHeaders)for(this.responseHeaders={};s=t.exec(this.responseHeadersString);)this.responseHeaders[s[1].toLowerCase()]=s[2];s=this.responseHeaders[r.toLowerCase()]}return null==s?null:s},getAllResponseHeaders:function(){return 2===e.readyState?this.responseHeadersString:null},setRequestHeader:function(r,n){var a=r.toLowerCase();return e.readyState||(r=s[a]=s[a]||r,t[r]=n),this}})}});