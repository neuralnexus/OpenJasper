JRS.Controls=function(e,t,n,r){var i=navigator.userAgent.toLowerCase().indexOf("msie")>-1;return{Base:t.extend(function(){},{extend:function(e,n){var r,i=this;r=e&&t.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},t.extend(r,i,n);var o=function(){this.constructor=r};return o.prototype=i.prototype,r.prototype=new o,e&&t.extend(r.prototype,e),r.__super__=i.prototype,r}}),TemplateEngine:{render:function(e,r,i){if(!i)return n.to_html(e,r);if(i==this.STD_PLACEHOLDERS){var o=String(e);return t.each(r,function(e,t){var n=new RegExp("\\{"+t+"\\}");o=o.replace(n,e)}),o}},renderUrl:function(e,t,r){var o=n.to_html(e,t);return i&&!r&&(o=encodeURI(o)),o},getTemplateText:function(t){var n=e("#"+t);return n.html()},createTemplate:function(t){var r=e("#"+t),i=r.html();return i&&i.length>0?function(e){return n.to_html(i,e)}:void 0},createTemplateSection:function(e,t){var r="\\{\\{#val\\}\\}(\\s|\\S)*\\{\\{/val\\}\\}",i=r.replace(/val/g,e),o=new RegExp(i,"g"),a=this.getTemplateText(t),u=a.match(o)[0];return function(e){return n.to_html(u,e)}},STD_PLACEHOLDERS:"std_placeholder"},Utils:{LOADING_DIALOG_DELAY:800,INPUT_CONTROLS_COMPONENT_ID:"input-controls",isElementInDom:function(e){var t=e.nextSibling,n=e.parentNode&&11!==e.parentNode.nodeType;return t||n},setInnerHtml:function(e,n,r){var o,a,u;if(this.isElementInDom(e)&&(o=e.nextSibling,a=e.parentNode,u=e.style.display,e.style.display="none",a.removeChild(e)),e.innerHTML="",i&&"SELECT"==e.tagName){var s=document.createDocumentFragment();t.each(r.data,function(e){var n=document.createElement("OPTION");n.value=t.isUndefined(e.value)?e.id:e.value,n.innerHTML=e.label,e.selected&&n.setAttribute("selected","selected"),s.appendChild(n)}),e.appendChild(s)}else e.innerHTML=n(r);if(o?a.insertBefore(e,o):a.appendChild(e),e.style.display=u,i&&"SELECT"==e.tagName){var c=e.getAttribute("style");e.removeAttribute("style"),e.setAttribute("style",c)}},wait:function(t){return e.Deferred(function(e){setTimeout(e.resolve,t)})},showLoadingDialogOn:function(n,i,o){this.wait(i?i:this.LOADING_DIALOG_DELAY).then(t.bind(function(){"pending"==n.state()&&(r.popup.showShared($(ajax.LOADING_ID),o,{focus:!1,owner:this.INPUT_CONTROLS_COMPONENT_ID}),e.when(n).always(t.bind(function(){var e=this.INPUT_CONTROLS_COMPONENT_ID;this.wait(500).then(function(){window.viewer&&window.viewer.loading?window.viewer.loaded&&r.popup.hideShared($(ajax.LOADING_ID),e):r.popup.hideShared($(ajax.LOADING_ID),e)})},this)))},this))},createTimer:function(t){var n=new e.Deferred;return n.done(function(e){var n=(new Date).getTime(),r=n-e;console.log(t+" took time: "+r+" msec.")}),{start:function(){return this.startTime=(new Date).getTime(),this},stop:function(){return n.resolve(this.startTime),this}}}},listen:function(n,r){t.each(n,function(n,r){e(document).bind(r,t.bind(n,this))},r?r:this)},ignore:function(t,n){e(document).unbind(t,n)}}}(jQuery,_,Mustache,dialogs);