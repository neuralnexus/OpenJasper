define("common/enum/httpStatusCodes",{100:"continue",101:"switchingProtocols",200:"ok",201:"created",202:"accepted",203:"nonAuthoritativeInformation",204:"noContent",205:"resetContent",206:"partialContent",300:"multipleChoices",301:"movedPermanently",302:"found",303:"seeOther",304:"notModified",305:"useProxy",307:"temporaryRedirect",400:"badRequest",401:"unauthorized",402:"paymentRequired",403:"forbidden",404:"notFound",405:"methodNotAllowed",406:"notAcceptable",407:"proxyAuthenticationRequired",408:"requestTimeout",409:"conflict",410:"gone",411:"lengthRequired",412:"preconditionFailed",413:"requestEntityTooLarge",414:"requestUriTooLong",415:"unsupportedMediaType",416:"requestedRangeNotSatisfiable",417:"expectationFailed",500:"internalServerError",501:"notImplemented",502:"badGateway",503:"serviceUnavailable",504:"gatewayTimeout",505:"httpVersionNotSupported"}),define("common/enum/errorCodes",["require"],function(e){"use strict";return{UNEXPECTED_ERROR:"unexpected.error",INVALID_RESOURCE_TYPE:"invalid.resource.type"}}),define("common/model/BaseModel",["require","underscore","backbone","common/enum/httpStatusCodes","common/enum/errorCodes"],function(e){"use strict";var t=e("underscore"),i=e("backbone"),n=e("common/enum/httpStatusCodes"),s=e("common/enum/errorCodes"),r=i.Model.extend({initialize:function(){this.on("error",r.unifyServerErrors)},serialize:function(){return t.clone(this.attributes)}},{unifyServerErrors:function(e,t){var i=n[t.status],s=r.createServerError(t);e.trigger("error:"+i,e,s,t),e.trigger("error:all",e,s,t)},createServerError:function(e){var t;try{t=JSON.parse(e.responseText)}catch(i){t={message:"Can't parse server response",errorCode:s.UNEXPECTED_ERROR,parameters:[]}}return t}});return r}),define("bi/repository/model/RepositoryResourceModel",["require","underscore","common/model/BaseModel","backbone.validation","bundle!js-sdk/RepositoryResourceBundle","common/util/i18nMessage","common/enum/httpStatusCodes","request"],function(e){"use strict";function t(e,t,i,n,s){return o({type:t,dataType:"json",url:e.contextPath+"/rest_v2/resources"+i+"?overwrite="+n+"&createFolders="+s,headers:{Accept:"application/json","Content-Location":e.get("uri")}}).done(function(t){e.set("uri",t.uri)})}var i=e("underscore"),n=e("common/model/BaseModel"),s=e("backbone.validation"),r=e("bundle!js-sdk/RepositoryResourceBundle"),a=e("common/util/i18nMessage").extend({bundle:r}),o=(e("common/enum/httpStatusCodes"),e("request")),l={LABEL_MAX_LENGTH:100,NAME_MAX_LENGTH:100,DESCRIPTION_MAX_LENGTH:250,NAME_NOT_SUPPORTED_SYMBOLS:"~!#\\$%^|\\s`@&*()\\-+={}\\[\\]:;\"'\\<\\>,?/\\|\\\\"},d=/application\/repository\.([^\+]+)\+json/,c=n.extend({idAttribute:"uri",type:void 0,urlRoot:function(){return(this.contextPath||"")+"/rest_v2/resources"},defaults:{name:void 0,parentFolderUri:void 0,uri:void 0,label:void 0,description:void 0,permissionMask:void 0,creationDate:void 0,updateDate:void 0,version:void 0},validation:{name:function(e,t,i){return e&&e.length>l.NAME_MAX_LENGTH?new a("error.field.max.length","name",l.NAME_MAX_LENGTH):e&&new RegExp("["+l.NAME_NOT_SUPPORTED_SYMBOLS+"]","g").test(e)?new a("error.field.bad.symbols","name",l.NAME_NOT_SUPPORTED_SYMBOLS):void 0},label:function(e,t,n){return i.isEmpty(e)?new a("error.field.required","label"):e.length>l.LABEL_MAX_LENGTH?new a("error.field.max.length","label",l.LABEL_MAX_LENGTH):void 0},description:function(e,t,i){return e&&e.length>l.NAME_MAX_LENGTH?new a("error.field.max.length","description",l.DESCRIPTION_MAX_LENGTH):void 0},parentFolderUri:[{required:!0,msg:new a("error.field.required","parentFolderUri")}]},url:function(){return this.isNew()?this.urlRoot()+encodeURI(this.get("parentFolderUri")):this.urlRoot()+encodeURI(this.id)},constructor:function(e,t){t||(t={}),i.defaults(t,{parse:!0}),n.call(this,e,t)},initialize:function(e,t){this.contextPath=t.contextPath,t.type&&(this.type=t.type),this.on("change:parentFolderUri change:name",this._updateUri),this.on("change:uri",this._updateNameAndParentFolderUri),n.prototype.initialize.apply(this,arguments)},clone:function(){return new this.constructor(this.attributes,{contextPath:this.contextPath})},parse:function(e){return"undefined"!=typeof e.uri?(e.name=c.getNameFromUri(e.uri),e.parentFolderUri=c.getParentFolderFromUri(e.uri)):e.parentFolderUri&&e.name&&(e.uri=c.constructUri(e.parentFolderUri,e.name)),e},toJSON:function(){var e=this.serialize();return delete e.name,delete e.parentFolderUri,e},_updateUri:function(){var e=this.get("name"),t=this.get("parentFolderUri"),i=c.constructUri(t,e);i&&this.set("uri",i)},_updateNameAndParentFolderUri:function(){var e=this.get("uri"),t=c.getNameFromUri(e),i=c.getParentFolderFromUri(e);this.set({name:t,parentFolderUri:i})},fetch:function(e){return i.defaults(e||(e={}),{headers:{Accept:"application/json"}}),e.url=this.url()+"?expanded="+(e.expanded===!0),delete e.expanded,n.prototype.fetch.call(this,e)},sync:function(e,t,i){if("read"===e){var s=i.success,r=this;i.success=function(e,t,i){var n=i.getResponseHeader("Content-Type"),a=d.exec(n);if(!a||!a[1])throw new Error("Unsupported response content type: "+n);r.type=a[1],s&&s(e,t,i)}}return n.prototype.sync.call(this,e,t,i)},save:function(e,t,s){var r;if(i.isUndefined(e)||i.isNull(e)||i.isObject(e)?(r=e||{},s=t):(r={})[e]=t,!this.type)throw new Error("Resource type is unspecified. It's not possible to save a resource without it's type specified");return i.defaults(s||(s={}),{headers:{Accept:"application/json","Content-Type":"application/repository."+this.type+"+json; charset=UTF-8"}}),s.url=this.url()+"?createFolders="+(s.createFolders===!0),s.url+="&overwrite="+(s.overwrite===!0),s.url+="&expanded="+(s.expanded===!0),s.url+="&dry-run="+(s.dryRun===!0),delete s.createFolders,delete s.overwrite,delete s.expanded,delete s.expanded,delete s.dryRun,n.prototype.save.call(this,r,s)},isWritable:function(){var e=this.get("permissionMask"),t=!1;return i.isUndefined(e)||(t=1===e||4&e),t},copyTo:function(e,i,n){return t(this,"POST",e,!!i,arguments.length<3||n)},moveTo:function(e,i,n){return t(this,"PUT",e,!!i,arguments.length<3||n)}},{settings:l,getNameFromUri:function(e){if(e){var t=e.split("/");return t[t.length-1]}},getParentFolderFromUri:function(e){if(e){var t=e.split("/");return 2===t.length&&""!==t[1]?"/":t.slice(0,t.length-1).join("/")}},constructUri:function(e,t){return t&&e?-1!==e.indexOf("/",e.length-1)?e+t:e+"/"+t:void 0},generateResourceName:function(e){var t="";return e&&(t=e.replace(new RegExp("["+c.settings.NAME_NOT_SUPPORTED_SYMBOLS+"]","g"),"_")),t}});return i.extend(c.prototype,s.mixin),c}),define("bi/repository/enum/repositoryResourceTypes",{RESOURCE_LOOKUP:"resourceLookup",DASHBOARD:"dashboard",LEGACY_DASHBOARD:"legacyDashboard",REPORT_UNIT:"reportUnit",TOPIC:"topic",ADHOC_DATA_VIEW:"adhocDataView",FILE:"file",FOLDER:"folder",SECURE_FILE:"secureFile",DATA_TYPE:"dataType",JDBC_DATA_SOURCE:"jdbcDataSource",AWS_DATA_SOURCE:"awsDataSource",AZURE_SQL_DATA_SOURCE:"azureSqlDataSource",JNDI_DATA_SOURCE:"jndiJdbcDataSource",VIRTUAL_DATA_SOURCE:"virtualDataSource",CUSTOM_DATA_SOURCE:"customDataSource",BEAN_DATA_SOURCE:"beanDataSource",XMLA_CONNECTION:"xmlaConnection",LIST_OF_VALUES:"listOfValues",REPORT_OPTIONS:"reportOptions",QUERY:"query",OLAP_UNIT:"olapUnit",DOMAIN_TOPIC:"domainTopic",SEMANTIC_LAYER_DATA_SOURCE:"semanticLayerDataSource",SECURE_MONDRIAN_CONNECTION:"secureMondrianConnection",MONDRIAN_XMLA_DEFINITION:"mondrianXmlaDefinition",MONDRIAN_CONNECTION:"mondrianConnection",INPUT_CONTROL:"inputControl",ORGANIZATION:"organization",OLAP_CUBE:"olapCube"}),define("dataSource/model/BaseDataSourceModel",["require","bi/repository/model/RepositoryResourceModel","underscore","jquery","backbone","jrs.configs"],function(e){"use strict";var t=e("bi/repository/model/RepositoryResourceModel"),i=e("underscore"),n=e("jquery"),s=e("backbone"),r=e("jrs.configs");return t.extend({defaults:function(){var e={};return i.extend(e,t.prototype.defaults,{connectionType:void 0}),e}(),validation:{},initialize:function(e,n){n=i.defaults(n||{},{contextPath:r.contextPath}),this.options=n,this.isNew()&&n.parentFolderUri&&this.set("parentFolderUri",n.parentFolderUri,{silent:!0});var s=n.parentFolderUri?n.parentFolderUri:e.parentFolderUri;e.name&&s&&!e.uri&&n.isEditMode===!0&&this.set("uri",t.constructUri(s,e.name),{silent:!0}),t.prototype.initialize.call(this,e,n)},testConnection:function(){if(this.validate(),this._isValid){var e=n.Deferred(),t=n("#"+ajax.LOADING_ID)[0],i=!1,a=window.setTimeout(function(){i=!0,dialogs.popup.show(t,!0)},AjaxRequester.prototype.MAX_WAIT_TIME),o=this.toJSON();return s.ajax({type:"POST",url:r.contextPath+"/rest_v2/connections",contentType:o.connectionType,headers:{Accept:"application/json"},data:JSON.stringify(o)}).always(function(){window.clearTimeout(a),i&&dialogs.popup.hide(t)}).done(e.resolve).fail(e.reject),e.promise()}}})}),define("common/util/featureDetection",[],function(){"use strict";return{supportsTouch:function(){return"ontouchstart"in window||navigator.msMaxTouchPoints}()}}),define("util/historyHelper",["require","utils.common","jrs.configs"],function(e){"use strict";e("utils.common");var t=e("jrs.configs");return{saveCurrent:function(e){new JSCookie(e,encodeURIComponent(document.location.href))},saveReferrer:function(e){-1===document.referrer.indexOf("login.html")&&new JSCookie(e,encodeURIComponent(document.referrer))},restore:function(e,i){var n=encodeURIComponent(document.location.href),s=new JSCookie(e).value;if(s&&s!==n){var r=decodeURIComponent(s);if(r)return void redirectToUrl(r)}i=i||"/",redirectToUrl(t.contextPath+i)}}}),define("text!dataSource/template/nameAndDescriptionTemplate.htm",[],function(){return'<fieldset class="group shortFields">\n\n    <legend class="offLeft"><span>{{- i18n[\'resource.dataSource.nameanddesc\']}}</span></legend>\n\n    <label title="{{- i18n[\'resource.dataSource.labelIDtitle\']}}" class="control input text ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.name\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.label }}" name="label">\n        <span class="message warning"></span>\n    </label>\n\n\n    <label title="{{- i18n[\'resource.dataSource.nameIDtitle\']}}" class="control input text ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.resource\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" {{ if (isEditMode) { }}readonly="readonly"{{ } }} value="{{- modelAttributes.name }}" name="name">\n        <span class="message warning"></span>\n    </label>\n\n\n    <label title="{{- i18n[\'resource.dataSource.descriptionTitle\']}}" class="control textArea">\n        <span class="wrap">{{- i18n[\'resource.dataSource.description\']}}</span>\n        <textarea type="text" name="description">{{- modelAttributes.description }}</textarea>\n        <span class="message warning"></span>\n    </label>\n\n</fieldset>'}),define("text!dataSource/template/saveLocationTemplate.htm",[],function(){return'<fieldset class="group">\n\n    <label title="{{- i18n[\'dialog.datasource.destination\']}}" class="control saveLocation browser">\n        <span class="wrap">{{- i18n[\'dialog.datasource.destination\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.parentFolderUri }}" {{ if (isEditMode) { }}disabled="disabled"{{ } }} name="parentFolderUri" id="parentFolderUri">\n        <button class="button action" type="button" {{ if (isEditMode) { }}disabled="disabled"{{ } }} id="parentFolderUriBrowse">\n			<span class="wrap">{{- i18n[\'dialog.file.browse\'] }}...\n				<span class="icon"></span>\n			</span>\n		</button>\n        <span class="message warning"></span>\n    </label>\n\n</fieldset>'}),define("text!dataSource/template/timezoneTemplate.htm",[],function(){return'<fieldset class="group shortFields">\n    <label title="{{- i18n[\'resource.analysisConnection.timeZone\'] }}" class="control select">\n        <span class="wrap">{{- i18n["resource.dataSource.timezone"] }}</span>\n        <select class="fnormal timeZone" name="timezone">\n            <option {{ if (modelAttributes.timezone === "") { }}selected="selected"{{ } }} value="">{{- i18n["jsp.jdbcPropsForm.timezone.default.option"] }}</option>\n            {{ _.each(timezones, function(timezone) { }}\n            <option value="{{- timezone.code }}" {{ if (timezone.code === modelAttributes.timezone) { }}selected="selected"{{ } }}>\n                {{- i18n[\'timezone.option\'].replace(\'{0}\', timezone.code).replace(\'{1}\', timezone.description) }}\n            </option>\n            {{ }); }}\n        </select>\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n["resource.dataSource.hint3"] }}</span>\n    </label>\n</fieldset>'}),define("text!dataSource/template/dialog/selectFromRepository.htm",[],function(){return'<div id="ajaxbuffer" style="display:none"></div>\r\n<div id="{{- dialogId }}" class="panel dialog selectFromRepository overlay moveable sizeable centered_horz centered_vert hidden">\r\n\r\n    <div class="sizer diagonal"></div>\r\n\r\n    <div class="content hasFooter ">\r\n\r\n        <div class="header mover">\r\n            <div class="title">\r\n            </div>\r\n        </div>\r\n        <div class="body  ">\r\n\r\n            <div class="control groupBox fillParent">\r\n\r\n                <div class="content ">\r\n\r\n                    <div class="header ">\r\n                        <div class="title">\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class="body  ">\r\n                        <ul id="{{- treeId }}"></ul>\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="footer ">\r\n\r\n            <button id="selectFromRepoBtnSelect" class="button action primary up"><span class="wrap">{{- i18n["button.select"] }}</span><span class="icon"></span></button>\r\n            <button id="selectFromRepoBtnCancel" class="button action up"><span class="wrap">{{- i18n["button.cancel"] }}</span><span class="icon"></span></button>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</div>'}),define("text!dataSource/template/testConnectionTemplate.htm",[],function(){return'<fieldset class="group">\n\n    <span id="testDataSource" class="button action up"><span class="wrap">{{- i18n[\'button.testConnection\']}}</span></span>\n    <div class="message warning" name="testConnectionMessage">\n        <span></span>\n        <a class="details" name="testConnectionMessageDetails" href="#">{{- i18n[\'button.details\']}}</a>\n    </div>\n\n</fieldset>\n\n<br/>'}),define("dataSource/view/BaseDataSourceView",["require","jquery","underscore","bi/repository/model/RepositoryResourceModel","dataSource/model/BaseDataSourceModel","bundle!jasperserver_messages","settings!userTimeZones","backbone","text!dataSource/template/nameAndDescriptionTemplate.htm","text!dataSource/template/saveLocationTemplate.htm","text!dataSource/template/timezoneTemplate.htm","text!dataSource/template/dialog/selectFromRepository.htm","components.dialogs","text!dataSource/template/testConnectionTemplate.htm","backbone.validation"],function(e){"use strict";var t,i,n=e("jquery"),s=e("underscore"),r=e("bi/repository/model/RepositoryResourceModel"),a=e("dataSource/model/BaseDataSourceModel"),o=e("bundle!jasperserver_messages"),l=e("settings!userTimeZones"),d=e("backbone"),c=(e("text!dataSource/template/nameAndDescriptionTemplate.htm"),e("text!dataSource/template/saveLocationTemplate.htm"),e("text!dataSource/template/timezoneTemplate.htm")),u=(e("text!dataSource/template/dialog/selectFromRepository.htm"),e("components.dialogs")),h=e("text!dataSource/template/testConnectionTemplate.htm"),p=e("backbone.validation");return d.View.extend({PAGE_TITLE_NEW_MESSAGE_CODE:void 0,PAGE_TITLE_EDIT_MESSAGE_CODE:void 0,modelConstructor:a,events:{"keyup input[type='text'], input[type='password'], textarea, select":"updateModelProperty","change input[type='text'], input[type='password'], input[type='radio'], input[type='checkbox'], textarea, select":"updateModelProperty","click #testDataSource":"testConnection","click [name=testConnectionMessageDetails]":"showTestConnectionMessageDetails"},initialize:function(e){this.options=e,this.isEditMode=e.isEditMode,this.timezones=e.timezones?e.timezones:l;var t={};if(e.dataSource&&(t=s.extend(t,e.dataSource)),this.model=new this.modelConstructor(t,e),p.bind(this,{valid:this.fieldIsValid,invalid:this.fieldIsInvalid,forceUpdate:!0,selector:"name"}),this.model.initialization){var i=this;this.model.initialization.done(function(){i.render.apply(i)})}else this.render();this.setPageTitle()},testConnection:function(){if(t!==!0){var e,n,s=this.model.testConnection(),r=this;s&&(t=!0,n=r.$el.find("#testDataSource"),n.addClass("disabled"),e=this.$el.find("[name=testConnectionMessage]"),e.removeClass("warning success").addClass("hidden"),e.parent().addClass("error"),e.find("a").addClass("hidden"),s.done(function(){e.addClass("success").find("span").text(o["resource.dataSource.connectionState.passed"])}).fail(function(t){var n=r.getTestConnectionErrorMessage(t);e.addClass("warning").find("span").text(n.text),n.details&&(e.find("a").removeClass("hidden"),i=n.details)}).always(function(){t=!1,e.removeClass("hidden"),n.removeClass("disabled")}))}},showTestConnectionMessageDetails:function(){u.errorPopup.show(i)},getTestConnectionErrorMessage:function(e){var t=!1,i=o["resource.dataSource.connectionState.failed"],s=!1;try{t=n.parseJSON(e.responseText)}catch(r){s=e.responseText}return t&&(t.parameters&&t.parameters[2]&&(i=t.parameters[2]),t.parameters&&t.parameters[3]&&(s=t.parameters[3])),{text:i,details:s}},updateModelProperty:function(e){var t=n(e.target),i={},s=t.attr("name"),a="checkbox"===t.attr("type")?t.is(":checked"):n.trim(t.val());if(i[s]=a,this.model.set(i),!this.isEditMode)if("name"===s){var o=r.generateResourceName(this.model.get("label"));a!==o&&(this._idUpdatedManually=!0)}else if("label"===s&&!this._idUpdatedManually){var l=r.generateResourceName(a);this.model.set("name",l),this.$("input[name='name']").val(l)}this.model.validate(i)},render:function(){return this.$el.empty(),this},renderTimezoneSection:function(){this.$el.append(s.template(c,this.templateData()))},renderTestConnectionSection:function(){this.$el.append(s.template(h,this.templateData()))},renderOrAddAnyBlock:function(e,t){if(s.isString(t)){try{t=n(t)}catch(i){t=!1}if(!t)return!1}var r=t.first().attr("name");return r?(e.find("[name="+r+"]").length>0?e.find("[name="+r+"]").empty().append(t.children()):e.append(t),!0):!1},templateData:function(){return{_:s,i18n:o,modelAttributes:s.clone(this.model.attributes),timezones:this.timezones,isEditMode:this.isEditMode}},setPageTitle:function(){var e,t=n("#display .showingToolBar > .content > .header > .title");e=this.isEditMode?o[this.PAGE_TITLE_EDIT_MESSAGE_CODE]+": "+this.model.get("label"):o[this.PAGE_TITLE_NEW_MESSAGE_CODE],t.text(e)},fieldIsValid:function(e,t,i){var n=e.$("["+i+'="'+t+'"]').parent();n.removeClass("error"),n.find(".message.warning").text("")},fieldIsInvalid:function(e,t,i,n){if(i!==!0){var s=e.$("["+n+'="'+t+'"]').parent();s.addClass("error"),s.find(".message.warning").text(i)}},validField:function(e){var t=this.$(e).parent();t.removeClass("error"),t.find(".message.warning").text("")},invalidField:function(e,t){var i=this.$(e).parent();i.addClass("error"),i.find(".message.warning").text(t.toString())},remove:function(){return n("div[id^='selectFromRepository1'], div[id^='selectFromRepository2']").remove(),p.unbind(this),d.View.prototype.remove.call(this),this}})}),define("text!dataSource/template/customDataSourceTemplate.htm",[],function(){return'<fieldset name="customFieldsContainer" class="group shortFields">\n\n	<legend class="offLeft"><span>{{- i18n[\'resource.dataSource.accessProp\']}}</span></legend>\n\n	{{\n\n	var buildAttrs = function(attrs) {\n		return _.map(attrs, function(v, k){\n			v = v.toString().replace(/"/g, "\\&quot\\;");\n			return k + \'="\' + _.xssEscape(v) + \'"\';\n		}).join(" ");\n	};\n\n	_.each(customFields, function(field){\n\n		var\n			attrs = {},\n			label = i18n[field.label] || field.label;\n\n		if (field.mandatory) {\n			label = label + " (" + i18n["required.field"] + ")";\n		}\n	}}\n\n		<label title="{{- label }}" class="control input text">\n			<span class="wrap">{{- label }}:</span>\n			{{\n\n				var properties = field.properties || {};\n                var value = modelAttributes[field.name] ? modelAttributes[field.name] : "";\n                if("password" === field.name && value !== ""){\n                    value = i18n[\'input.password.substitution\']\n                }\n\n				if (properties.type === "boolean") {\n					attrs.name = field.name;\n					attrs.type = "checkbox";\n					if (value == \'on\' || value == \'true\') {\n						attrs.checked = "true";\n					}\n					}}\n					<input {{ print(buildAttrs(attrs)) }} />\n					{{\n				} else if (properties.displayHeight != null) {\n					attrs.name = field.name;\n					attrs.rows = properties.displayHeight;\n					attrs.cols = properties.displayWidth != null ? properties.displayWidth : 40;\n					attrs["class"] = "fnormal";\n					}}\n					<textarea {{ print(buildAttrs(attrs)) }} >{{- value }}</textarea>\n					{{\n				} else {\n					attrs.name = field.name;\n					attrs.type = field.name === "password" ? "password" : "text";\n					attrs.size = properties.displayWidth != null ? properties.displayWidth : 40;\n					attrs["class"] = "fnormal";\n					attrs.value = value;\n					}}\n					<input {{ print(buildAttrs(attrs)) }} />\n					{{\n				} }}\n\n			<span class="message hint"></span>\n			<span class="message warning"></span>\n		</label>\n\n	{{ }); }}\n\n</fieldset>\n'}),define("dataSource/enum/connectionTypes",{AWS:"application/repository.awsDataSource+json",AZURE_SQL:"application/repository.azureSqlDataSource+json",BEAN:"application/repository.beanDataSource+json",JDBC:"application/repository.jdbcDataSource+json",JNDI:"application/repository.jndiJdbcDataSource+json",VIRTUAL:"application/repository.virtualDataSource+json",MONGODB:"application/connections.mongodb+json",HIVE:"application/connections.hive+json",TEXT_FILE:"application/connections.txtFile+json",XLS_FILE:"application/connections.xlsFile+json",CUSTOM:"application/repository.customDataSource+json"}),define("dataSource/model/CustomDataSourceModel",["require","dataSource/model/BaseDataSourceModel","underscore","jquery","jrs.configs","requestSettings","dataSource/enum/connectionTypes","bi/repository/enum/repositoryResourceTypes","components.dialogs","bundle!all","bundle!jasperserver_config"],function(e){"use strict";var t=e("dataSource/model/BaseDataSourceModel"),i=e("underscore"),n=e("jquery"),s=e("jrs.configs"),r=e("requestSettings"),a=e("dataSource/enum/connectionTypes"),o=e("bi/repository/enum/repositoryResourceTypes"),l=e("components.dialogs"),d=e("bundle!all"),c=e("bundle!jasperserver_config"),u=t.extend({type:o.CUSTOM_DATA_SOURCE,constructor:function(e,n){this.defaults=i.extend({},this.defaults,{dataSourceName:n.dataSourceType,connectionType:a.CUSTOM}),t.prototype.constructor.apply(this,arguments)},initialize:function(e,i){var s=t.prototype.initialize.apply(this,arguments);return this.customFields=[],this.testable=!1,this.queryTypes=null,this.initialization=n.Deferred(),this.getCustomFieldsDefinition(),s},getCustomFieldsDefinition:function(){var e,t={};return i.extend(t,r,{Accept:"application/json"}),e=n.ajax({type:"GET",headers:t,url:s.contextPath+"/rest_v2/customDataSources/"+this.get("dataSourceName")}).done(i.bind(this.getCustomFieldsDefinitionDone,this)).fail(i.bind(this.getCustomFieldsDefinitionFail,this))},getCustomFieldsDefinitionDone:function(e){var t=this;e&&e.propertyDefinitions&&i.isArray(e.propertyDefinitions)&&(this.resetValidation(),this.testable=!!e.testable,this.queryTypes=e.queryTypes?e.queryTypes:null,i.each(e.propertyDefinitions,function(e){var n={};e.properties&&(e.properties=i(e.properties).reduce(function(e,t){return e[t.key]=t.value,e},{})),t.customFields.push(e),t.defaults[e.name]=e.defaultValue,t.options.isEditMode||t.set(e.name,e.defaultValue),"password"===e.name&&t.options.isEditMode&&!t.isNew()&&t.set("password",c["input.password.substitution"]),e.properties&&e.properties.mandatory&&(n[e.name]={required:!0,msg:d[t.get("dataSourceName")+"."+e.name+".required"]||d["required.field.specify.value"]},i.extend(t.validation,n))})),this.options.isEditMode||this.set(this.parse(this.attributes),{silent:!0}),this.initialization.resolve()},getCustomFieldsDefinitionFail:function(e){var t=!1,i="Failed to load custom data source definition. ";try{t=JSON.parse(e.responseText)}catch(n){}t&&(t[0]&&t[0].errorCode?i+="<br/>The reason is: "+t[0].errorCode:t.message&&(i+="<br/>The reason is: "+t.message),i+="<br/><br/>The full response from the server is: "+e.responseText),l.errorPopup.show(i)},parse:function(e){var n=t.prototype.parse.apply(this,arguments);return n=i.extend(n,this.parseProperties(e.properties)),delete e.properties,n},parseProperties:function(e){var t={};return i.isEmpty(e)||i.each(e,function(e){t[e.key]="password"===e.key?c["input.password.substitution"]:e.value}),t},toJSON:function(){var e=t.prototype.toJSON.apply(this,arguments);return this.customFieldsToJSON(e,this.customFields)},customFieldsToJSON:function(e,t){return i.isEmpty(t)||(e.properties=[],i.each(t,function(t){var i=e[t.name],n="password"===t.name;(!n||n&&i!==c["input.password.substitution"])&&(e.properties.push({key:t.name,value:i}),delete e[t.name])})),e},resetValidation:function(){this.validation=i.clone(u.prototype.validation)}});return u}),define("dataSource/view/CustomDataSourceView",["require","underscore","jquery","bundle!all","dataSource/view/BaseDataSourceView","text!dataSource/template/customDataSourceTemplate.htm","dataSource/model/CustomDataSourceModel"],function(e){"use strict";var t=e("underscore"),i=e("jquery"),n=e("bundle!all"),s=e("dataSource/view/BaseDataSourceView"),r=e("text!dataSource/template/customDataSourceTemplate.htm"),a=e("dataSource/model/CustomDataSourceModel");return s.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.custom.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.custom.page.title.edit",modelConstructor:a,customFieldsTemplate:r,render:function(){return this.$el.empty(),this.renderCustomFieldsSection(),this.model.testable&&this.renderTestConnectionSection(),this},templateData:function(){return t.extend({},s.prototype.templateData.apply(this,arguments),{i18n:n,customFields:this.model.customFields})},renderCustomFieldsSection:function(){var e=t.template(this.customFieldsTemplate,this.templateData()),n=this.$el.find("[name=customFieldsContainer]");n.length>0?n.empty().append(i(e).children()):this.$el.append(e)}},{})}),define("dataSource/enum/dataSourceResourceTypes",{JDBC:"jdbcDataSource",AWS:"awsDataSource",AZURE_SQL:"azureSqlDataSource",JNDI:"jndiJdbcDataSource",VIRTUAL:"virtualDataSource",CUSTOM:"customDataSource",BEAN:"beanDataSource",MONGODB:"MongoDbDataSource",MONGODBJDBC:"mongoDbJDBCDataSource"}),define("dataSource/enum/customDataSourceTypes",{DIAGNOSTIC:"diagnosticCustomDataSource",HIVE:"HiveDataSource",MONGODB:"MongoDbDataSource",TEXT_FILE:"textDataSource"});var XRegExp;XRegExp=XRegExp||function(e){"use strict";function t(e,t,i){var n;for(n in c.prototype)c.prototype.hasOwnProperty(n)&&(e[n]=c.prototype[n]);return e.xregexp={captureNames:t,isNative:!!i},e}function i(e){return(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":"")}function n(e,n,s){if(!c.isRegExp(e))throw new TypeError("type RegExp expected");var r=m.replace.call(i(e)+(n||""),v,"");return s&&(r=m.replace.call(r,new RegExp("["+s+"]+","g"),"")),e=e.xregexp&&!e.xregexp.isNative?t(c(e.source,r),e.xregexp.captureNames?e.xregexp.captureNames.slice(0):null):t(new RegExp(e.source,r),null,!0)}function s(e,t){var i=e.length;if(Array.prototype.lastIndexOf)return e.lastIndexOf(t);for(;i--;)if(e[i]===t)return i;return-1}function r(e,t){return Object.prototype.toString.call(e).toLowerCase()==="[object "+t+"]"}function a(e){return e=e||{},"all"===e||e.all?e={natives:!0,extensibility:!0}:r(e,"string")&&(e=c.forEach(e,/[^\s,]+/,function(e){this[e]=!0},{})),e}function o(e,t,i,n){var s,r,a=A.length,o=null;y=!0;try{for(;a--;)if(r=A[a],("all"===r.scope||r.scope===i)&&(!r.trigger||r.trigger.call(n))&&(r.pattern.lastIndex=t,s=f.exec.call(r.pattern,e),s&&s.index===t)){o={output:r.handler.call(n,s,i),match:s};break}}catch(l){throw l}finally{y=!1}return o}function l(e){c.addToken=u[e?"on":"off"],p.extensibility=e}function d(e){RegExp.prototype.exec=(e?f:m).exec,RegExp.prototype.test=(e?f:m).test,String.prototype.match=(e?f:m).match,String.prototype.replace=(e?f:m).replace,String.prototype.split=(e?f:m).split,p.natives=e}var c,u,h,p={natives:!1,extensibility:!1},m={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},f={},g={},A=[],F="default",C="class",D={"default":/^(?:\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??)/,"class":/^(?:\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S]))/},E=/\$(?:{([\w$]+)}|(\d\d?|[\s\S]))/g,v=/([\s\S])(?=[\s\S]*\1)/g,S=/^(?:[?*+]|{\d+(?:,\d*)?})\??/,b=m.exec.call(/()??/,"")[1]===e,B=RegExp.prototype.sticky!==e,y=!1,T="gim"+(B?"y":"");return c=function(i,s){if(c.isRegExp(i)){if(s!==e)throw new TypeError("can't supply flags when constructing one RegExp from another");return n(i)}if(y)throw new Error("can't call the XRegExp constructor within token definition functions");var r,a,l,d=[],u=F,h={hasNamedCapture:!1,captureNames:[],hasFlag:function(e){return s.indexOf(e)>-1}},p=0;if(i=i===e?"":String(i),s=s===e?"":String(s),m.match.call(s,v))throw new SyntaxError("invalid duplicate regular expression flag");for(i=m.replace.call(i,/^\(\?([\w$]+)\)/,function(e,t){if(m.test.call(/[gy]/,t))throw new SyntaxError("can't use flag g or y in mode modifier");return s=m.replace.call(s+t,v,""),""}),c.forEach(s,/[\s\S]/,function(e){if(T.indexOf(e[0])<0)throw new SyntaxError("invalid regular expression flag "+e[0])});p<i.length;)r=o(i,p,u,h),r?(d.push(r.output),p+=r.match[0].length||1):(a=m.exec.call(D[u],i.slice(p)),a?(d.push(a[0]),p+=a[0].length):(l=i.charAt(p),"["===l?u=C:"]"===l&&(u=F),d.push(l),++p));return t(new RegExp(d.join(""),m.replace.call(s,/[^gimy]+/g,"")),h.hasNamedCapture?h.captureNames:null)},u={on:function(e,t,i){i=i||{},e&&A.push({pattern:n(e,"g"+(B?"y":"")),handler:t,scope:i.scope||F,trigger:i.trigger||null}),i.customFlags&&(T=m.replace.call(T+i.customFlags,v,""))},off:function(){throw new Error("extensibility must be installed before using addToken")}},c.addToken=u.off,c.cache=function(e,t){var i=e+"/"+(t||"");return g[i]||(g[i]=c(e,t))},c.escape=function(e){return m.replace.call(e,/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},c.exec=function(e,t,i,s){var r,a=n(t,"g"+(s&&B?"y":""),s===!1?"y":"");return a.lastIndex=i=i||0,r=f.exec.call(a,e),s&&r&&r.index!==i&&(r=null),t.global&&(t.lastIndex=r?a.lastIndex:0),r},c.forEach=function(e,t,i,n){for(var s,r=0,a=-1;s=c.exec(e,t,r);)i.call(n,s,++a,e,t),r=s.index+(s[0].length||1);return n},c.globalize=function(e){return n(e,"g")},c.install=function(e){e=a(e),!p.natives&&e.natives&&d(!0),!p.extensibility&&e.extensibility&&l(!0)},c.isInstalled=function(e){return!!p[e]},c.isRegExp=function(e){return r(e,"regexp")},c.matchChain=function(e,t){return function i(e,n){var s,r=t[n].regex?t[n]:{regex:t[n]},a=[],o=function(e){a.push(r.backref?e[r.backref]||"":e[0])};for(s=0;s<e.length;++s)c.forEach(e[s],r.regex,o);return n!==t.length-1&&a.length?i(a,n+1):a}([e],0)},c.replace=function(t,i,s,r){var a,o=c.isRegExp(i),l=i;return o?(r===e&&i.global&&(r="all"),l=n(i,"all"===r?"g":"","all"===r?"":"g")):"all"===r&&(l=new RegExp(c.escape(String(i)),"g")),
a=f.replace.call(String(t),l,s),o&&i.global&&(i.lastIndex=0),a},c.split=function(e,t,i){return f.split.call(e,t,i)},c.test=function(e,t,i,n){return!!c.exec(e,t,i,n)},c.uninstall=function(e){e=a(e),p.natives&&e.natives&&d(!1),p.extensibility&&e.extensibility&&l(!1)},c.union=function(e,t){var i,n,s,a,o=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,l=0,d=function(e,t,s){var r=n[l-i];if(t){if(++l,r)return"(?<"+r+">"}else if(s)return"\\"+(+s+i);return e},u=[];if(!r(e,"array")||!e.length)throw new TypeError("patterns must be a nonempty array");for(a=0;a<e.length;++a)s=e[a],c.isRegExp(s)?(i=l,n=s.xregexp&&s.xregexp.captureNames||[],u.push(c(s.source).source.replace(o,d))):u.push(c.escape(s));return c(u.join("|"),t)},c.version="2.0.0",f.exec=function(t){var n,r,a,o,l;if(this.global||(o=this.lastIndex),n=m.exec.apply(this,arguments)){if(!b&&n.length>1&&s(n,"")>-1&&(a=new RegExp(this.source,m.replace.call(i(this),"g","")),m.replace.call(String(t).slice(n.index),a,function(){var t;for(t=1;t<arguments.length-2;++t)arguments[t]===e&&(n[t]=e)})),this.xregexp&&this.xregexp.captureNames)for(l=1;l<n.length;++l)r=this.xregexp.captureNames[l-1],r&&(n[r]=n[l]);this.global&&!n[0].length&&this.lastIndex>n.index&&(this.lastIndex=n.index)}return this.global||(this.lastIndex=o),n},f.test=function(e){return!!f.exec.call(this,e)},f.match=function(e){if(c.isRegExp(e)){if(e.global){var t=m.match.apply(this,arguments);return e.lastIndex=0,t}}else e=new RegExp(e);return f.exec.call(e,this)},f.replace=function(e,t){var i,n,a,o,l=c.isRegExp(e);return l?(e.xregexp&&(i=e.xregexp.captureNames),e.global||(o=e.lastIndex)):e+="",r(t,"function")?n=m.replace.call(String(this),e,function(){var n,s=arguments;if(i)for(s[0]=new String(s[0]),n=0;n<i.length;++n)i[n]&&(s[0][i[n]]=s[n+1]);return l&&e.global&&(e.lastIndex=s[s.length-2]+s[0].length),t.apply(null,s)}):(a=String(this),n=m.replace.call(a,e,function(){var e=arguments;return m.replace.call(String(t),E,function(t,n,r){var a;if(n){if(a=+n,a<=e.length-3)return e[a]||"";if(a=i?s(i,n):-1,0>a)throw new SyntaxError("backreference to undefined group "+t);return e[a+1]||""}if("$"===r)return"$";if("&"===r||0===+r)return e[0];if("`"===r)return e[e.length-1].slice(0,e[e.length-2]);if("'"===r)return e[e.length-1].slice(e[e.length-2]+e[0].length);if(r=+r,!isNaN(r)){if(r>e.length-3)throw new SyntaxError("backreference to undefined group "+t);return e[r]||""}throw new SyntaxError("invalid token "+t)})})),l&&(e.global?e.lastIndex=0:e.lastIndex=o),n},f.split=function(t,i){if(!c.isRegExp(t))return m.split.apply(this,arguments);var n,s=String(this),r=t.lastIndex,a=[],o=0;return i=(i===e?-1:i)>>>0,c.forEach(s,t,function(e){e.index+e[0].length>o&&(a.push(s.slice(o,e.index)),e.length>1&&e.index<s.length&&Array.prototype.push.apply(a,e.slice(1)),n=e[0].length,o=e.index+n)}),o===s.length?(!m.test.call(t,"")||n)&&a.push(""):a.push(s.slice(o)),t.lastIndex=r,a.length>i?a.slice(0,i):a},h=u.on,h(/\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\dA-Fa-f]{4})|x(?![\dA-Fa-f]{2}))/,function(e,t){if("B"===e[1]&&t===F)return e[0];throw new SyntaxError("invalid escape "+e[0])},{scope:"all"}),h(/\[(\^?)]/,function(e){return e[1]?"[\\s\\S]":"\\b\\B"}),h(/(?:\(\?#[^)]*\))+/,function(e){return m.test.call(S,e.input.slice(e.index+e[0].length))?"":"(?:)"}),h(/\\k<([\w$]+)>/,function(e){var t=isNaN(e[1])?s(this.captureNames,e[1])+1:+e[1],i=e.index+e[0].length;if(!t||t>this.captureNames.length)throw new SyntaxError("backreference to undefined group "+e[0]);return"\\"+t+(i===e.input.length||isNaN(e.input.charAt(i))?"":"(?:)")}),h(/(?:\s+|#.*)+/,function(e){return m.test.call(S,e.input.slice(e.index+e[0].length))?"":"(?:)"},{trigger:function(){return this.hasFlag("x")},customFlags:"x"}),h(/\./,function(){return"[\\s\\S]"},{trigger:function(){return this.hasFlag("s")},customFlags:"s"}),h(/\(\?P?<([\w$]+)>/,function(e){if(!isNaN(e[1]))throw new SyntaxError("can't use integer as capture name "+e[0]);return this.captureNames.push(e[1]),this.hasNamedCapture=!0,"("}),h(/\\(\d+)/,function(e,t){if(!(t===F&&/^[1-9]/.test(e[1])&&+e[1]<=this.captureNames.length)&&"0"!==e[1])throw new SyntaxError("can't use octal escape or backreference to undefined group "+e[0]);return e[0]},{scope:"all"}),h(/\((?!\?)/,function(){return this.hasFlag("n")?"(?:":(this.captureNames.push(null),"(")},{customFlags:"n"}),"undefined"!=typeof exports&&(exports.XRegExp=c),c}(),function(e){"use strict";function t(e){return e.replace(/[- _]+/g,"").toLowerCase()}function i(e){return e.replace(/\w{4}/g,"\\u$&")}function n(e){for(;e.length<4;)e="0"+e;return e}function s(e){return parseInt(e,16)}function r(e){return parseInt(e,10).toString(16)}function a(t){var i,a=[],o=-1;return e.forEach(t,/\\u(\w{4})(?:-\\u(\w{4}))?/,function(e){i=s(e[1]),i>o+1&&(a.push("\\u"+n(r(o+1))),i>o+2&&a.push("-\\u"+n(r(i-1)))),o=s(e[2]||e[1])}),65535>o&&(a.push("\\u"+n(r(o+1))),65534>o&&a.push("-\\uFFFF")),a.join("")}function o(e){return l["^"+e]||(l["^"+e]=a(l[e]))}var l={};e.install("extensibility"),e.addUnicodePackage=function(n,s){var r;if(!e.isInstalled("extensibility"))throw new Error("extensibility must be installed before adding Unicode packages");if(n)for(r in n)n.hasOwnProperty(r)&&(l[t(r)]=i(n[r]));if(s)for(r in s)s.hasOwnProperty(r)&&(l[t(s[r])]=l[t(r)])},e.addUnicodePackage({L:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05270531-055605590561-058705D0-05EA05F0-05F20620-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280840-085808A008A2-08AC0904-0939093D09500958-09610971-09770979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10CF10CF20D05-0D0C0D0E-0D100D12-0D3A0D3D0D4E0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC-0EDF0F000F40-0F470F49-0F6C0F88-0F8C1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510C710CD10D0-10FA10FC-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1BBA-1BE51C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11CF51CF61D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209C21022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2CF22CF32D00-2D252D272D2D2D30-2D672D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31BA31F0-31FF3400-4DB54E00-9FCCA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78B-A78EA790-A793A7A0-A7AAA7F8-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDAAE0-AAEAAAF2-AAF4AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC"},{L:"Letter"}),e.addToken(/\\([pP]){(\^?)([^}]*)}/,function(e,i){var n="P"===e[1]||e[2]?"^":"",s=t(e[3]);if("P"===e[1]&&e[2])throw new SyntaxError("invalid double negation \\P{^");if(!l.hasOwnProperty(s))throw new SyntaxError("invalid or unknown Unicode property "+e[0]);return"class"===i?n?o(s):l[s]:"["+n+l[s]+"]"},{scope:"all"})}(XRegExp),function(e){"use strict";if(!e.addUnicodePackage)throw new ReferenceError("Unicode Base must be loaded before Unicode Categories");e.install("extensibility"),e.addUnicodePackage({Ll:"0061-007A00B500DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F05210523052505270561-05871D00-1D2B1D6B-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7B2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2CF32D00-2D252D272D2DA641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA661A663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CA78EA791A793A7A1A7A3A7A5A7A7A7A9A7FAFB00-FB06FB13-FB17FF41-FF5A",Lu:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E05200522052405260531-055610A0-10C510C710CD1E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CED2CF2A640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA660A662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BA78DA790A792A7A0A7A2A7A4A7A6A7A8A7AAFF21-FF3A",Lt:"01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",Lm:"02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D6A1D781D9B-1DBF2071207F2090-209C2C7C2C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A7F8A7F9A9CFAA70AADDAAF3AAF4FF70FF9EFF9F",Lo:"00AA00BA01BB01C0-01C3029405D0-05EA05F0-05F20620-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150840-085808A008A2-08AC0904-0939093D09500958-09610972-09770979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10CF10CF20D05-0D0C0D0E-0D100D12-0D3A0D3D0D4E0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC-0EDF0F000F40-0F470F49-0F6C0F88-0F8C1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA10FD-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1BBA-1BE51C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF11CF51CF62135-21382D30-2D672D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31BA31F0-31FF3400-4DB54E00-9FCCA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCAAE0-AAEAAAF2AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",M:"0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065F067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0859-085B08E4-08FE0900-0903093A-093C093E-094F0951-0957096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F8D-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135D-135F1712-17141732-1734175217531772177317B4-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAD1BE6-1BF31C24-1C371CD0-1CD21CD4-1CE81CED1CF2-1CF41DC0-1DE61DFC-1DFF20D0-20F02CEF-2CF12D7F2DE0-2DFF302A-302F3099309AA66F-A672A674-A67DA69FA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1AAEB-AAEFAAF5AAF6ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",Mn:"0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065F067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0859-085B08E4-08FE0900-0902093A093C0941-0948094D0951-095709620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F8D-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135D-135F1712-17141732-1734175217531772177317B417B517B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91BAB1BE61BE81BE91BED1BEF-1BF11C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1CF41DC0-1DE61DFC-1DFF20D0-20DC20E120E5-20F02CEF-2CF12D7F2DE0-2DFF302A-302D3099309AA66FA674-A67DA69FA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1AAECAAEDAAF6ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",Mc:"0903093B093E-09400949-094C094E094F0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1BAC1BAD1BE71BEA-1BEC1BEE1BF21BF31C24-1C2B1C341C351CE11CF21CF3302E302FA823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BAAEBAAEEAAEFAAF5ABE3ABE4ABE6ABE7ABE9ABEAABEC",Me:"0488048920DD-20E020E2-20E4A670-A672",N:"0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0B72-0B770BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293248-324F3251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nd:"0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19D91A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nl:"16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",No:"00B200B300B900BC-00BE09F4-09F90B72-0B770BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F919DA20702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293248-324F3251-325F3280-328932B1-32BFA830-A835",P:"0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100A700AB00B600B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E085E0964096509700AF00DF40E4F0E5A0E5B0F04-0F120F140F3A-0F3D0F850FD0-0FD40FD90FDA104A-104F10FB1360-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A194419451A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601BFC-1BFF1C3B-1C3F1C7E1C7F1CC0-1CC71CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2D702E00-2E2E2E30-2E3B3001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFAAF0AAF1ABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",Pd:"002D058A05BE140018062010-20152E172E1A2E3A2E3B301C303030A0FE31FE32FE58FE63FF0D",Ps:"0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",Pe:"0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",Pi:"00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",Pf:"00BB2019201D203A2E032E052E0A2E0D2E1D2E21",Pc:"005F203F20402054FE33FE34FE4D-FE4FFF3F",Po:"0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100A700B600B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E085E0964096509700AF00DF40E4F0E5A0E5B0F04-0F120F140F850FD0-0FD40FD90FDA104A-104F10FB1360-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A194419451A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601BFC-1BFF1C3B-1C3F1C7E1C7F1CC0-1CC71CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2D702E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E30-2E393001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFAAF0AAF1ABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",S:"0024002B003C-003E005E0060007C007E00A2-00A600A800A900AC00AE-00B100B400B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F60482058F0606-0608060B060E060F06DE06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0D790E3F0F01-0F030F130F15-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F1390-139917DB194019DE-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B9210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23F32400-24262440-244A249C-24E92500-26FF2701-27672794-27C427C7-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-324732503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FBB2-FBC1FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",Sm:"002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C21182140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",Sc:"002400A2-00A5058F060B09F209F309FB0AF10BF90E3F17DB20A0-20B9A838FDFCFE69FF04FFE0FFE1FFE5FFE6",Sk:"005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFBB2-FBC1FF3EFF40FFE3",So:"00A600A900AE00B00482060E060F06DE06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0D790F01-0F030F130F15-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F1390-1399194019DE-19FF1B61-1B6A1B74-1B7C210021012103-210621082109211421162117211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23F32400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26FF2701-27672794-27BF2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-324732503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",Z:"002000A01680180E2000-200A20282029202F205F3000",Zs:"002000A01680180E2000-200A202F205F3000",Zl:"2028",Zp:"2029",C:"0000-001F007F-009F00AD03780379037F-0383038B038D03A20528-05300557055805600588058B-058E059005C8-05CF05EB-05EF05F5-0605061C061D06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F085C085D085F-089F08A108AD-08E308FF097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B78-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D3B0D3C0D450D490D4F-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EE0-0EFF0F480F6D-0F700F980FBD0FCD0FDB-0FFF10C610C8-10CC10CE10CF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B135C137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BF4-1BFB1C38-1C3A1C4A-1C4C1C80-1CBF1CC8-1CCF1CF7-1CFF1DE7-1DFB1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F209D-209F20BA-20CF20F1-20FF218A-218F23F4-23FF2427-243F244B-245F27002B4D-2B4F2B5A-2BFF2C2F2C5F2CF4-2CF82D262D28-2D2C2D2E2D2F2D68-2D6E2D71-2D7E2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E3C-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31BB-31BF31E4-31EF321F32FF4DB6-4DBF9FCD-9FFFA48D-A48FA4C7-A4CFA62C-A63FA698-A69EA6F8-A6FFA78FA794-A79FA7AB-A7F7A82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAF7-AB00AB07AB08AB0FAB10AB17-AB1FAB27AB2F-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBC2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",Cc:"0000-001F007F-009F",Cf:"00AD0600-060406DD070F200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",Co:"E000-F8FF",Cs:"D800-DFFF",Cn:"03780379037F-0383038B038D03A20528-05300557055805600588058B-058E059005C8-05CF05EB-05EF05F5-05FF0605061C061D070E074B074C07B2-07BF07FB-07FF082E082F083F085C085D085F-089F08A108AD-08E308FF097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B78-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D3B0D3C0D450D490D4F-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EE0-0EFF0F480F6D-0F700F980FBD0FCD0FDB-0FFF10C610C8-10CC10CE10CF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B135C137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BF4-1BFB1C38-1C3A1C4A-1C4C1C80-1CBF1CC8-1CCF1CF7-1CFF1DE7-1DFB1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F209D-209F20BA-20CF20F1-20FF218A-218F23F4-23FF2427-243F244B-245F27002B4D-2B4F2B5A-2BFF2C2F2C5F2CF4-2CF82D262D28-2D2C2D2E2D2F2D68-2D6E2D71-2D7E2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E3C-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31BB-31BF31E4-31EF321F32FF4DB6-4DBF9FCD-9FFFA48D-A48FA4C7-A4CFA62C-A63FA698-A69EA6F8-A6FFA78FA794-A79FA7AB-A7F7A82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAF7-AB00AB07AB08AB0FAB10AB17-AB1FAB27AB2F-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBC2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"},{Ll:"Lowercase_Letter",Lu:"Uppercase_Letter",Lt:"Titlecase_Letter",Lm:"Modifier_Letter",Lo:"Other_Letter",M:"Mark",Mn:"Nonspacing_Mark",Mc:"Spacing_Mark",Me:"Enclosing_Mark",N:"Number",Nd:"Decimal_Number",Nl:"Letter_Number",No:"Other_Number",P:"Punctuation",Pd:"Dash_Punctuation",Ps:"Open_Punctuation",Pe:"Close_Punctuation",Pi:"Initial_Punctuation",Pf:"Final_Punctuation",
Pc:"Connector_Punctuation",Po:"Other_Punctuation",S:"Symbol",Sm:"Math_Symbol",Sc:"Currency_Symbol",Sk:"Modifier_Symbol",So:"Other_Symbol",Z:"Separator",Zs:"Space_Separator",Zl:"Line_Separator",Zp:"Paragraph_Separator",C:"Other",Cc:"Control",Cf:"Format",Co:"Private_Use",Cs:"Surrogate",Cn:"Unassigned"})}(XRegExp),function(e){"use strict";if(!e.addUnicodePackage)throw new ReferenceError("Unicode Base must be loaded before Unicode Scripts");e.install("extensibility"),e.addUnicodePackage({Arabic:"0600-06040606-060B060D-061A061E0620-063F0641-064A0656-065E066A-066F0671-06DC06DE-06FF0750-077F08A008A2-08AC08E4-08FEFB50-FBC1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFCFE70-FE74FE76-FEFC",Armenian:"0531-05560559-055F0561-0587058A058FFB13-FB17",Balinese:"1B00-1B4B1B50-1B7C",Bamum:"A6A0-A6F7",Batak:"1BC0-1BF31BFC-1BFF",Bengali:"0981-09830985-098C098F09900993-09A809AA-09B009B209B6-09B909BC-09C409C709C809CB-09CE09D709DC09DD09DF-09E309E6-09FB",Bopomofo:"02EA02EB3105-312D31A0-31BA",Braille:"2800-28FF",Buginese:"1A00-1A1B1A1E1A1F",Buhid:"1740-1753",Canadian_Aboriginal:"1400-167F18B0-18F5",Cham:"AA00-AA36AA40-AA4DAA50-AA59AA5C-AA5F",Cherokee:"13A0-13F4",Common:"0000-0040005B-0060007B-00A900AB-00B900BB-00BF00D700F702B9-02DF02E5-02E902EC-02FF0374037E038503870589060C061B061F06400660-066906DD096409650E3F0FD5-0FD810FB16EB-16ED173517361802180318051CD31CE11CE9-1CEC1CEE-1CF31CF51CF62000-200B200E-2064206A-20702074-207E2080-208E20A0-20B92100-21252127-2129212C-21312133-214D214F-215F21892190-23F32400-24262440-244A2460-26FF2701-27FF2900-2B4C2B50-2B592E00-2E3B2FF0-2FFB3000-300430063008-30203030-3037303C-303F309B309C30A030FB30FC3190-319F31C0-31E33220-325F327F-32CF3358-33FF4DC0-4DFFA700-A721A788-A78AA830-A839FD3EFD3FFDFDFE10-FE19FE30-FE52FE54-FE66FE68-FE6BFEFFFF01-FF20FF3B-FF40FF5B-FF65FF70FF9EFF9FFFE0-FFE6FFE8-FFEEFFF9-FFFD",Coptic:"03E2-03EF2C80-2CF32CF9-2CFF",Cyrillic:"0400-04840487-05271D2B1D782DE0-2DFFA640-A697A69F",Devanagari:"0900-09500953-09630966-09770979-097FA8E0-A8FB",Ethiopic:"1200-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A135D-137C1380-13992D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDEAB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2E",Georgian:"10A0-10C510C710CD10D0-10FA10FC-10FF2D00-2D252D272D2D",Glagolitic:"2C00-2C2E2C30-2C5E",Greek:"0370-03730375-0377037A-037D038403860388-038A038C038E-03A103A3-03E103F0-03FF1D26-1D2A1D5D-1D611D66-1D6A1DBF1F00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FC41FC6-1FD31FD6-1FDB1FDD-1FEF1FF2-1FF41FF6-1FFE2126",Gujarati:"0A81-0A830A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABC-0AC50AC7-0AC90ACB-0ACD0AD00AE0-0AE30AE6-0AF1",Gurmukhi:"0A01-0A030A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A3C0A3E-0A420A470A480A4B-0A4D0A510A59-0A5C0A5E0A66-0A75",Han:"2E80-2E992E9B-2EF32F00-2FD5300530073021-30293038-303B3400-4DB54E00-9FCCF900-FA6DFA70-FAD9",Hangul:"1100-11FF302E302F3131-318E3200-321E3260-327EA960-A97CAC00-D7A3D7B0-D7C6D7CB-D7FBFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",Hanunoo:"1720-1734",Hebrew:"0591-05C705D0-05EA05F0-05F4FB1D-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FB4F",Hiragana:"3041-3096309D-309F",Inherited:"0300-036F04850486064B-0655065F0670095109521CD0-1CD21CD4-1CE01CE2-1CE81CED1CF41DC0-1DE61DFC-1DFF200C200D20D0-20F0302A-302D3099309AFE00-FE0FFE20-FE26",Javanese:"A980-A9CDA9CF-A9D9A9DEA9DF",Kannada:"0C820C830C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBC-0CC40CC6-0CC80CCA-0CCD0CD50CD60CDE0CE0-0CE30CE6-0CEF0CF10CF2",Katakana:"30A1-30FA30FD-30FF31F0-31FF32D0-32FE3300-3357FF66-FF6FFF71-FF9D",Kayah_Li:"A900-A92F",Khmer:"1780-17DD17E0-17E917F0-17F919E0-19FF",Lao:"0E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB90EBB-0EBD0EC0-0EC40EC60EC8-0ECD0ED0-0ED90EDC-0EDF",Latin:"0041-005A0061-007A00AA00BA00C0-00D600D8-00F600F8-02B802E0-02E41D00-1D251D2C-1D5C1D62-1D651D6B-1D771D79-1DBE1E00-1EFF2071207F2090-209C212A212B2132214E2160-21882C60-2C7FA722-A787A78B-A78EA790-A793A7A0-A7AAA7F8-A7FFFB00-FB06FF21-FF3AFF41-FF5A",Lepcha:"1C00-1C371C3B-1C491C4D-1C4F",Limbu:"1900-191C1920-192B1930-193B19401944-194F",Lisu:"A4D0-A4FF",Malayalam:"0D020D030D05-0D0C0D0E-0D100D12-0D3A0D3D-0D440D46-0D480D4A-0D4E0D570D60-0D630D66-0D750D79-0D7F",Mandaic:"0840-085B085E",Meetei_Mayek:"AAE0-AAF6ABC0-ABEDABF0-ABF9",Mongolian:"1800180118041806-180E1810-18191820-18771880-18AA",Myanmar:"1000-109FAA60-AA7B",New_Tai_Lue:"1980-19AB19B0-19C919D0-19DA19DE19DF",Nko:"07C0-07FA",Ogham:"1680-169C",Ol_Chiki:"1C50-1C7F",Oriya:"0B01-0B030B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3C-0B440B470B480B4B-0B4D0B560B570B5C0B5D0B5F-0B630B66-0B77",Phags_Pa:"A840-A877",Rejang:"A930-A953A95F",Runic:"16A0-16EA16EE-16F0",Samaritan:"0800-082D0830-083E",Saurashtra:"A880-A8C4A8CE-A8D9",Sinhala:"0D820D830D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60DCA0DCF-0DD40DD60DD8-0DDF0DF2-0DF4",Sundanese:"1B80-1BBF1CC0-1CC7",Syloti_Nagri:"A800-A82B",Syriac:"0700-070D070F-074A074D-074F",Tagalog:"1700-170C170E-1714",Tagbanwa:"1760-176C176E-177017721773",Tai_Le:"1950-196D1970-1974",Tai_Tham:"1A20-1A5E1A60-1A7C1A7F-1A891A90-1A991AA0-1AAD",Tai_Viet:"AA80-AAC2AADB-AADF",Tamil:"0B820B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BBE-0BC20BC6-0BC80BCA-0BCD0BD00BD70BE6-0BFA",Telugu:"0C01-0C030C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D-0C440C46-0C480C4A-0C4D0C550C560C580C590C60-0C630C66-0C6F0C78-0C7F",Thaana:"0780-07B1",Thai:"0E01-0E3A0E40-0E5B",Tibetan:"0F00-0F470F49-0F6C0F71-0F970F99-0FBC0FBE-0FCC0FCE-0FD40FD90FDA",Tifinagh:"2D30-2D672D6F2D702D7F",Vai:"A500-A62B",Yi:"A000-A48CA490-A4C6"})}(XRegExp),function(e){"use strict";if(!e.addUnicodePackage)throw new ReferenceError("Unicode Base must be loaded before Unicode Blocks");e.install("extensibility"),e.addUnicodePackage({InBasic_Latin:"0000-007F",InLatin_1_Supplement:"0080-00FF",InLatin_Extended_A:"0100-017F",InLatin_Extended_B:"0180-024F",InIPA_Extensions:"0250-02AF",InSpacing_Modifier_Letters:"02B0-02FF",InCombining_Diacritical_Marks:"0300-036F",InGreek_and_Coptic:"0370-03FF",InCyrillic:"0400-04FF",InCyrillic_Supplement:"0500-052F",InArmenian:"0530-058F",InHebrew:"0590-05FF",InArabic:"0600-06FF",InSyriac:"0700-074F",InArabic_Supplement:"0750-077F",InThaana:"0780-07BF",InNKo:"07C0-07FF",InSamaritan:"0800-083F",InMandaic:"0840-085F",InArabic_Extended_A:"08A0-08FF",InDevanagari:"0900-097F",InBengali:"0980-09FF",InGurmukhi:"0A00-0A7F",InGujarati:"0A80-0AFF",InOriya:"0B00-0B7F",InTamil:"0B80-0BFF",InTelugu:"0C00-0C7F",InKannada:"0C80-0CFF",InMalayalam:"0D00-0D7F",InSinhala:"0D80-0DFF",InThai:"0E00-0E7F",InLao:"0E80-0EFF",InTibetan:"0F00-0FFF",InMyanmar:"1000-109F",InGeorgian:"10A0-10FF",InHangul_Jamo:"1100-11FF",InEthiopic:"1200-137F",InEthiopic_Supplement:"1380-139F",InCherokee:"13A0-13FF",InUnified_Canadian_Aboriginal_Syllabics:"1400-167F",InOgham:"1680-169F",InRunic:"16A0-16FF",InTagalog:"1700-171F",InHanunoo:"1720-173F",InBuhid:"1740-175F",InTagbanwa:"1760-177F",InKhmer:"1780-17FF",InMongolian:"1800-18AF",InUnified_Canadian_Aboriginal_Syllabics_Extended:"18B0-18FF",InLimbu:"1900-194F",InTai_Le:"1950-197F",InNew_Tai_Lue:"1980-19DF",InKhmer_Symbols:"19E0-19FF",InBuginese:"1A00-1A1F",InTai_Tham:"1A20-1AAF",InBalinese:"1B00-1B7F",InSundanese:"1B80-1BBF",InBatak:"1BC0-1BFF",InLepcha:"1C00-1C4F",InOl_Chiki:"1C50-1C7F",InSundanese_Supplement:"1CC0-1CCF",InVedic_Extensions:"1CD0-1CFF",InPhonetic_Extensions:"1D00-1D7F",InPhonetic_Extensions_Supplement:"1D80-1DBF",InCombining_Diacritical_Marks_Supplement:"1DC0-1DFF",InLatin_Extended_Additional:"1E00-1EFF",InGreek_Extended:"1F00-1FFF",InGeneral_Punctuation:"2000-206F",InSuperscripts_and_Subscripts:"2070-209F",InCurrency_Symbols:"20A0-20CF",InCombining_Diacritical_Marks_for_Symbols:"20D0-20FF",InLetterlike_Symbols:"2100-214F",InNumber_Forms:"2150-218F",InArrows:"2190-21FF",InMathematical_Operators:"2200-22FF",InMiscellaneous_Technical:"2300-23FF",InControl_Pictures:"2400-243F",InOptical_Character_Recognition:"2440-245F",InEnclosed_Alphanumerics:"2460-24FF",InBox_Drawing:"2500-257F",InBlock_Elements:"2580-259F",InGeometric_Shapes:"25A0-25FF",InMiscellaneous_Symbols:"2600-26FF",InDingbats:"2700-27BF",InMiscellaneous_Mathematical_Symbols_A:"27C0-27EF",InSupplemental_Arrows_A:"27F0-27FF",InBraille_Patterns:"2800-28FF",InSupplemental_Arrows_B:"2900-297F",InMiscellaneous_Mathematical_Symbols_B:"2980-29FF",InSupplemental_Mathematical_Operators:"2A00-2AFF",InMiscellaneous_Symbols_and_Arrows:"2B00-2BFF",InGlagolitic:"2C00-2C5F",InLatin_Extended_C:"2C60-2C7F",InCoptic:"2C80-2CFF",InGeorgian_Supplement:"2D00-2D2F",InTifinagh:"2D30-2D7F",InEthiopic_Extended:"2D80-2DDF",InCyrillic_Extended_A:"2DE0-2DFF",InSupplemental_Punctuation:"2E00-2E7F",InCJK_Radicals_Supplement:"2E80-2EFF",InKangxi_Radicals:"2F00-2FDF",InIdeographic_Description_Characters:"2FF0-2FFF",InCJK_Symbols_and_Punctuation:"3000-303F",InHiragana:"3040-309F",InKatakana:"30A0-30FF",InBopomofo:"3100-312F",InHangul_Compatibility_Jamo:"3130-318F",InKanbun:"3190-319F",InBopomofo_Extended:"31A0-31BF",InCJK_Strokes:"31C0-31EF",InKatakana_Phonetic_Extensions:"31F0-31FF",InEnclosed_CJK_Letters_and_Months:"3200-32FF",InCJK_Compatibility:"3300-33FF",InCJK_Unified_Ideographs_Extension_A:"3400-4DBF",InYijing_Hexagram_Symbols:"4DC0-4DFF",InCJK_Unified_Ideographs:"4E00-9FFF",InYi_Syllables:"A000-A48F",InYi_Radicals:"A490-A4CF",InLisu:"A4D0-A4FF",InVai:"A500-A63F",InCyrillic_Extended_B:"A640-A69F",InBamum:"A6A0-A6FF",InModifier_Tone_Letters:"A700-A71F",InLatin_Extended_D:"A720-A7FF",InSyloti_Nagri:"A800-A82F",InCommon_Indic_Number_Forms:"A830-A83F",InPhags_pa:"A840-A87F",InSaurashtra:"A880-A8DF",InDevanagari_Extended:"A8E0-A8FF",InKayah_Li:"A900-A92F",InRejang:"A930-A95F",InHangul_Jamo_Extended_A:"A960-A97F",InJavanese:"A980-A9DF",InCham:"AA00-AA5F",InMyanmar_Extended_A:"AA60-AA7F",InTai_Viet:"AA80-AADF",InMeetei_Mayek_Extensions:"AAE0-AAFF",InEthiopic_Extended_A:"AB00-AB2F",InMeetei_Mayek:"ABC0-ABFF",InHangul_Syllables:"AC00-D7AF",InHangul_Jamo_Extended_B:"D7B0-D7FF",InHigh_Surrogates:"D800-DB7F",InHigh_Private_Use_Surrogates:"DB80-DBFF",InLow_Surrogates:"DC00-DFFF",InPrivate_Use_Area:"E000-F8FF",InCJK_Compatibility_Ideographs:"F900-FAFF",InAlphabetic_Presentation_Forms:"FB00-FB4F",InArabic_Presentation_Forms_A:"FB50-FDFF",InVariation_Selectors:"FE00-FE0F",InVertical_Forms:"FE10-FE1F",InCombining_Half_Marks:"FE20-FE2F",InCJK_Compatibility_Forms:"FE30-FE4F",InSmall_Form_Variants:"FE50-FE6F",InArabic_Presentation_Forms_B:"FE70-FEFF",InHalfwidth_and_Fullwidth_Forms:"FF00-FFEF",InSpecials:"FFF0-FFFF"})}(XRegExp),function(e){"use strict";if(!e.addUnicodePackage)throw new ReferenceError("Unicode Base must be loaded before Unicode Properties");e.install("extensibility"),e.addUnicodePackage({Alphabetic:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE03450370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05270531-055605590561-058705B0-05BD05BF05C105C205C405C505C705D0-05EA05F0-05F20610-061A0620-06570659-065F066E-06D306D5-06DC06E1-06E806ED-06EF06FA-06FC06FF0710-073F074D-07B107CA-07EA07F407F507FA0800-0817081A-082C0840-085808A008A2-08AC08E4-08E908F0-08FE0900-093B093D-094C094E-09500955-09630971-09770979-097F0981-09830985-098C098F09900993-09A809AA-09B009B209B6-09B909BD-09C409C709C809CB09CC09CE09D709DC09DD09DF-09E309F009F10A01-0A030A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A3E-0A420A470A480A4B0A4C0A510A59-0A5C0A5E0A70-0A750A81-0A830A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD-0AC50AC7-0AC90ACB0ACC0AD00AE0-0AE30B01-0B030B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D-0B440B470B480B4B0B4C0B560B570B5C0B5D0B5F-0B630B710B820B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BBE-0BC20BC6-0BC80BCA-0BCC0BD00BD70C01-0C030C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D-0C440C46-0C480C4A-0C4C0C550C560C580C590C60-0C630C820C830C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD-0CC40CC6-0CC80CCA-0CCC0CD50CD60CDE0CE0-0CE30CF10CF20D020D030D05-0D0C0D0E-0D100D12-0D3A0D3D-0D440D46-0D480D4A-0D4C0D4E0D570D60-0D630D7A-0D7F0D820D830D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60DCF-0DD40DD60DD8-0DDF0DF20DF30E01-0E3A0E40-0E460E4D0E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB90EBB-0EBD0EC0-0EC40EC60ECD0EDC-0EDF0F000F40-0F470F49-0F6C0F71-0F810F88-0F970F99-0FBC1000-10361038103B-103F1050-10621065-1068106E-1086108E109C109D10A0-10C510C710CD10D0-10FA10FC-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A135F1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA16EE-16F01700-170C170E-17131720-17331740-17531760-176C176E-1770177217731780-17B317B6-17C817D717DC1820-18771880-18AA18B0-18F51900-191C1920-192B1930-19381950-196D1970-19741980-19AB19B0-19C91A00-1A1B1A20-1A5E1A61-1A741AA71B00-1B331B35-1B431B45-1B4B1B80-1BA91BAC-1BAF1BBA-1BE51BE7-1BF11C00-1C351C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF31CF51CF61D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209C21022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E2160-218824B6-24E92C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2CF22CF32D00-2D252D272D2D2D30-2D672D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2DE0-2DFF2E2F3005-30073021-30293031-30353038-303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31BA31F0-31FF3400-4DB54E00-9FCCA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A66EA674-A67BA67F-A697A69F-A6EFA717-A71FA722-A788A78B-A78EA790-A793A7A0-A7AAA7F8-A801A803-A805A807-A80AA80C-A827A840-A873A880-A8C3A8F2-A8F7A8FBA90A-A92AA930-A952A960-A97CA980-A9B2A9B4-A9BFA9CFAA00-AA36AA40-AA4DAA60-AA76AA7AAA80-AABEAAC0AAC2AADB-AADDAAE0-AAEFAAF2-AAF5AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABEAAC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1D-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",Uppercase:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E05200522052405260531-055610A0-10C510C710CD1E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F21452160-216F218324B6-24CF2C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CED2CF2A640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA660A662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BA78DA790A792A7A0A7A2A7A4A7A6A7A8A7AAFF21-FF3A",Lowercase:"0061-007A00AA00B500BA00DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02B802C002C102E0-02E40345037103730377037A-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F05210523052505270561-05871D00-1DBF1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF72071207F2090-209C210A210E210F2113212F21342139213C213D2146-2149214E2170-217F218424D0-24E92C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7D2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2CF32D00-2D252D272D2DA641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA661A663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76F-A778A77AA77CA77FA781A783A785A787A78CA78EA791A793A7A1A7A3A7A5A7A7A7A9A7F8-A7FAFB00-FB06FB13-FB17FF41-FF5A",White_Space:"0009-000D0020008500A01680180E2000-200A20282029202F205F3000",Noncharacter_Code_Point:"FDD0-FDEFFFFEFFFF",Default_Ignorable_Code_Point:"00AD034F115F116017B417B5180B-180D200B-200F202A-202E2060-206F3164FE00-FE0FFEFFFFA0FFF0-FFF8",Any:"0000-FFFF",Ascii:"0000-007F",Assigned:"0000-0377037A-037E0384-038A038C038E-03A103A3-05270531-05560559-055F0561-05870589058A058F0591-05C705D0-05EA05F0-05F40600-06040606-061B061E-070D070F-074A074D-07B107C0-07FA0800-082D0830-083E0840-085B085E08A008A2-08AC08E4-08FE0900-09770979-097F0981-09830985-098C098F09900993-09A809AA-09B009B209B6-09B909BC-09C409C709C809CB-09CE09D709DC09DD09DF-09E309E6-09FB0A01-0A030A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A3C0A3E-0A420A470A480A4B-0A4D0A510A59-0A5C0A5E0A66-0A750A81-0A830A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABC-0AC50AC7-0AC90ACB-0ACD0AD00AE0-0AE30AE6-0AF10B01-0B030B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3C-0B440B470B480B4B-0B4D0B560B570B5C0B5D0B5F-0B630B66-0B770B820B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BBE-0BC20BC6-0BC80BCA-0BCD0BD00BD70BE6-0BFA0C01-0C030C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D-0C440C46-0C480C4A-0C4D0C550C560C580C590C60-0C630C66-0C6F0C78-0C7F0C820C830C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBC-0CC40CC6-0CC80CCA-0CCD0CD50CD60CDE0CE0-0CE30CE6-0CEF0CF10CF20D020D030D05-0D0C0D0E-0D100D12-0D3A0D3D-0D440D46-0D480D4A-0D4E0D570D60-0D630D66-0D750D79-0D7F0D820D830D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60DCA0DCF-0DD40DD60DD8-0DDF0DF2-0DF40E01-0E3A0E3F-0E5B0E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB90EBB-0EBD0EC0-0EC40EC60EC8-0ECD0ED0-0ED90EDC-0EDF0F00-0F470F49-0F6C0F71-0F970F99-0FBC0FBE-0FCC0FCE-0FDA1000-10C510C710CD10D0-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A135D-137C1380-139913A0-13F41400-169C16A0-16F01700-170C170E-17141720-17361740-17531760-176C176E-1770177217731780-17DD17E0-17E917F0-17F91800-180E1810-18191820-18771880-18AA18B0-18F51900-191C1920-192B1930-193B19401944-196D1970-19741980-19AB19B0-19C919D0-19DA19DE-1A1B1A1E-1A5E1A60-1A7C1A7F-1A891A90-1A991AA0-1AAD1B00-1B4B1B50-1B7C1B80-1BF31BFC-1C371C3B-1C491C4D-1C7F1CC0-1CC71CD0-1CF61D00-1DE61DFC-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FC41FC6-1FD31FD6-1FDB1FDD-1FEF1FF2-1FF41FF6-1FFE2000-2064206A-20712074-208E2090-209C20A0-20B920D0-20F02100-21892190-23F32400-24262440-244A2460-26FF2701-2B4C2B50-2B592C00-2C2E2C30-2C5E2C60-2CF32CF9-2D252D272D2D2D30-2D672D6F2D702D7F-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2DE0-2E3B2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB3000-303F3041-30963099-30FF3105-312D3131-318E3190-31BA31C0-31E331F0-321E3220-32FE3300-4DB54DC0-9FCCA000-A48CA490-A4C6A4D0-A62BA640-A697A69F-A6F7A700-A78EA790-A793A7A0-A7AAA7F8-A82BA830-A839A840-A877A880-A8C4A8CE-A8D9A8E0-A8FBA900-A953A95F-A97CA980-A9CDA9CF-A9D9A9DEA9DFAA00-AA36AA40-AA4DAA50-AA59AA5C-AA7BAA80-AAC2AADB-AAF6AB01-AB06AB09-AB0EAB11-AB16AB20-AB26AB28-AB2EABC0-ABEDABF0-ABF9AC00-D7A3D7B0-D7C6D7CB-D7FBD800-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1D-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBC1FBD3-FD3FFD50-FD8FFD92-FDC7FDF0-FDFDFE00-FE19FE20-FE26FE30-FE52FE54-FE66FE68-FE6BFE70-FE74FE76-FEFCFEFFFF01-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDCFFE0-FFE6FFE8-FFEEFFF9-FFFD"})}(XRegExp),function(e){"use strict";function t(e,t,i,n){return{value:e,name:t,start:i,end:n}}e.matchRecursive=function(i,n,s,r,a){r=r||"",a=a||{};var o,l,d,c,u,h=r.indexOf("g")>-1,p=r.indexOf("y")>-1,m=r.replace(/y/g,""),f=a.escapeChar,g=a.valueNames,A=[],F=0,C=0,D=0,E=0;if(n=e(n,m),s=e(s,m),f){if(f.length>1)throw new SyntaxError("can't use more than one escape character");f=e.escape(f),u=new RegExp("(?:"+f+"[\\S\\s]|(?:(?!"+e.union([n,s]).source+")[^"+f+"])+)+",r.replace(/[^im]+/g,""))}for(;;){if(f&&(D+=(e.exec(i,u,D,"sticky")||[""])[0].length),d=e.exec(i,n,D),c=e.exec(i,s,D),d&&c&&(d.index<=c.index?c=null:d=null),d||c)C=(d||c).index,D=C+(d||c)[0].length;else if(!F)break;if(p&&!F&&C>E)break;if(d)F||(o=C,l=D),++F;else{if(!c||!F)throw new Error("string contains unbalanced delimiters");if(!--F&&(g?(g[0]&&o>E&&A.push(t(g[0],i.slice(E,o),E,o)),g[1]&&A.push(t(g[1],i.slice(o,l),o,l)),g[2]&&A.push(t(g[2],i.slice(l,C),l,C)),g[3]&&A.push(t(g[3],i.slice(C,D),C,D))):A.push(i.slice(l,C)),E=D,!h))break}C===D&&++D}return h&&!p&&g&&g[0]&&i.length>E&&A.push(t(g[0],i.slice(E),E,i.length)),A}}(XRegExp),function(e){"use strict";function t(e){var t=/^(?:\(\?:\))?\^/,i=/\$(?:\(\?:\))?$/;return i.test(e.replace(/\\[\s\S]/g,""))?e.replace(t,"").replace(i,""):e}function i(t){return e.isRegExp(t)?t.xregexp&&!t.xregexp.isNative?t:e(t.source):e(t)}var n=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,s=e.union([/\({{([\w$]+)}}\)|{{([\w$]+)}}/,n],"g");e.build=function(r,a,o){var l,d,c,u,h=/^\(\?([\w$]+)\)/.exec(r),p={},m=0,f=0,g=[0];h&&(o=o||"",h[1].replace(/./g,function(e){o+=o.indexOf(e)>-1?"":e}));for(u in a)a.hasOwnProperty(u)&&(c=i(a[u]),p[u]={pattern:t(c.source),names:c.xregexp.captureNames||[]});return r=i(r),d=r.xregexp.captureNames||[],r=r.source.replace(s,function(e,t,i,s,r){var a,o,c=t||i;if(c){if(!p.hasOwnProperty(c))throw new ReferenceError("undefined property "+e);return t?(a=d[f],g[++f]=++m,o="(?<"+(a||c)+">"):o="(?:",l=m,o+p[c].pattern.replace(n,function(e,t,i){if(t){if(a=p[c].names[m-l],++m,a)return"(?<"+a+">"}else if(i)return"\\"+(+i+l);return e})+")"}if(s){if(a=d[f],g[++f]=++m,a)return"(?<"+a+">"}else if(r)return"\\"+g[+r];return e}),e(r,o)}}(XRegExp),function(e){"use strict";function t(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}t(e.prototype,{apply:function(e,t){return this.test(t[0])},call:function(e,t){return this.test(t)},forEach:function(t,i,n){return e.forEach(t,this,i,n)},globalize:function(){return e.globalize(this)},xexec:function(t,i,n){return e.exec(t,this,i,n)},xtest:function(t,i,n){return e.test(t,this,i,n)}})}(XRegExp),define("xregexp",function(e){return function(){var t;return t||e.XRegExp}}(this)),define("dataSource/util/settingsUtility",["require","underscore"],function(e){"use strict";var t=e("underscore");return{deepDefaults:function(e,i){return t.reduce(i,function(i,n,s){return i[s]=e[s]?t.defaults(e[s],n):n,i},{})}}}),define("dataSource/model/JdbcDriverModel",["require","backbone","underscore","xregexp","settings!dataSourcePatterns","dataSource/util/settingsUtility"],function(e){"use strict";var t=e("backbone"),i=e("underscore"),n=e("xregexp"),s=e("settings!dataSourcePatterns"),r=e("dataSource/util/settingsUtility"),a=t.Model.extend({idAttribute:"jdbcDriverClass",defaults:{defaultValues:{},jdbcDriverClass:"",label:"",available:!1,isDefault:!1,jdbcUrl:"",uploaded:!1},initialize:function(e,t){var o=r.deepDefaults(t,{dataSourcePatterns:s});a.DYNAMIC_URL_PART_PATTERN=o.dataSourcePatterns.dynamicUrlPartPattern,a.VALIDATION_PATTERNS=i.reduce(o.dataSourcePatterns,function(e,t,i){return e[i]=n(t),e},{})},isOtherDriver:function(){return this.get("jdbcDriverClass")===a.OTHER_DRIVER},isUploadedDriver:function(){return this.get("uploaded")===!0},getCustomAttributes:function(){if(this.isOtherDriver())return[];var e=this._getRegExpFieldGroupsFromConnectionUrlTemplate(),t=[];return i.each(e,function(e){return t.push(e[1])}),t},convertUrlTemplateToRegex:function(){var e,t=this.get("jdbcUrl");t=t.replace(/\?/g,"\\?"),t=t.replace(/\[TMPDIR\/\]/g,"\\[TMPDIR/\\]");for(var i in a.VALIDATION_PATTERNS)e=new RegExp("\\$\\["+i+"\\]","g"),t=t.replace(e,a.DYNAMIC_URL_PART_PATTERN);return"^"+t},parse:function(e){return e.isDefault=e.isDefault?!0:!1,e.defaultValues&&(e.defaultValues=i.reduce(e.defaultValues,function(e,t){return e[t.key]=t.value,e},{})),e},_getRegExpFieldGroupsFromConnectionUrlTemplate:function(){for(var e,t=[],n=[];!i.isNull(e=a.FIELD_TEMPLATE_REGEXP.exec(this.get("jdbcUrl")));)i.isArray(e)&&2===e.length&&-1===n.indexOf(e[0])&&(t.push(e),n.push(e[0]));return t}},{FIELD_TEMPLATE_REGEXP:/\$\[([^\]]+)\]/g,OTHER_DRIVER:"other"});return a}),define("dataSource/collection/JdbcDriverCollection",["require","backbone","underscore","dataSource/model/JdbcDriverModel","jrs.configs"],function(e){"use strict";var t=e("backbone"),i=e("underscore"),n=e("dataSource/model/JdbcDriverModel"),s=e("jrs.configs");return t.Collection.extend({model:n,url:s.contextPath+"/rest_v2/jdbcDrivers",initialize:function(e,t){this.options=t,this.driverUploadEnabled=!1},getDefaultDriver:function(){var e=this.find(function(e){return!i.isUndefined(e.get("isDefault"))&&e.get("isDefault")!==!1});return e?e:this.first()},set:function(e,n){return"undefined"==typeof n&&(n={}),i.extend(n,this.options),t.Collection.prototype.set.call(this,e,n)},getDriverByClass:function(e){var t=this.findWhere({jdbcDriverClass:e});return t?t:this.findWhere({jdbcDriverClass:n.OTHER_DRIVER})},getDriverByName:function(e){return this.findWhere({name:e})},getAllPossibleCustomAttributes:function(){return i.keys(n.VALIDATION_PATTERNS)},fetch:function(e){return i.defaults(e||(e={}),{headers:{Accept:"application/hal+json"}}),t.Collection.prototype.fetch.call(this,e)},parse:function(e){var i=t.Collection.prototype.parse.apply(this,arguments);return i._links&&i._links.create&&i._links.edit&&(this.driverUploadEnabled=!0),i.jdbcDrivers?i.jdbcDrivers:i},markDriverAsAvailable:function(e){var t=this.models.find(function(t){return t.id===e});t.set("available",!0)}})}),define("dataSource/model/JdbcDataSourceModel",["require","dataSource/model/BaseDataSourceModel","dataSource/model/JdbcDriverModel","dataSource/collection/JdbcDriverCollection","settings!dataSourcePatterns","dataSource/enum/connectionTypes","underscore","jquery","xregexp","bundle!jasperserver_messages","bi/repository/enum/repositoryResourceTypes","bundle!jasperserver_config"],function(e){"use strict";var t=e("dataSource/model/BaseDataSourceModel"),i=e("dataSource/model/JdbcDriverModel"),n=e("dataSource/collection/JdbcDriverCollection"),s=e("settings!dataSourcePatterns"),r=e("dataSource/enum/connectionTypes"),a=e("underscore"),o=e("jquery"),l=e("xregexp"),d=l(s.forbidWhitespacesPattern),c=e("bundle!jasperserver_messages"),u=e("bi/repository/enum/repositoryResourceTypes"),h=e("bundle!jasperserver_config"),p=function(){var e={};return a.extend(e,t.prototype.validation,{connectionUrl:[{required:!0,msg:c["ReportDataSourceValidator.error.not.empty.reportDataSource.connectionUrl"]},{fn:function(e,t,i){var n=this.drivers.getDriverByClass(i.selectedDriverClass).get("allowSpacesInDbName");return n||d.test(e)?void 0:c["ReportDataSourceValidator.error.invalid.chars.reportDataSource.connectionUrl"]}}]}),e}();return t.extend({JDBC_BUNDLE_PREFIX:"resource.dataSource.jdbc.",otherDriverIsPresent:!0,type:u.JDBC_DATA_SOURCE,defaults:function(){var e={};return a.extend(e,t.prototype.defaults,{driverClass:"",selectedDriverClass:"",username:"",password:"",timezone:"",connectionUrl:"",isOtherDriver:!1,connectionType:r.JDBC}),e}(),validation:function(){return a.extend({},p)}(),initialize:function(e,i){t.prototype.initialize.apply(this,arguments),this.initialization=o.Deferred(),this.drivers=new n([],this.options);var s=this;this.fetchDrivers().then(function(){s.isNew()?s.setCustomAttributesDefaultValues(s.drivers.getDefaultDriver()):(s.set("selectedDriverClass",s.get("driverClass")),s.set(s.getCustomAttributeValuesFromConnectionUrl()),s.set("password",h["input.password.substitution"]),s.extendValidation());var e=a.map(s.drivers.getAllPossibleCustomAttributes(),function(e){return"change:"+e}).join(" ");s.on(e,s.setConnectionUrlFromCustomAttributes),s.on("change:connectionUrl",s.setCustomAttributesFromConnectionUrl),s.on("change:selectedDriverClass",s.changeSelectedDriver),s.initialization.resolve()})},fetchDrivers:function(){var e=this;return this.drivers.fetch({reset:!0}).done(function(){var t=a.groupBy(e.drivers.models,function(e){return e.attributes.available});a.each(t,function(e,i){t[i]=a.sortBy(e,function(e){return e.attributes.label})});var n=[];t["true"]&&(n=n.concat(t["true"])),t["false"]&&(n=n.concat(t["false"])),e.drivers.models=n,e.drivers.driverUploadEnabled&&e.otherDriverIsPresent&&e.drivers.add({defaultValues:{},jdbcDriverClass:i.OTHER_DRIVER,label:c["resource.dataSource.jdbc.otherDriver"],available:!1,"default":!1,jdbcUrl:"",uploaded:!1})})},getCurrentDriver:function(){return this.drivers.getDriverByClass(this.get("selectedDriverClass"))},changeSelectedDriver:function(){var e=this.drivers.getDriverByClass(this.get("selectedDriverClass"));e&&(this.setCustomAttributesDefaultValues(e),this.setConnectionUrlFromCustomAttributes(),
this.trigger("driverClassChange",this))},setCustomAttributesFromConnectionUrl:function(){var e=this.getCustomAttributeValuesFromConnectionUrl();this.set(e,{silent:!0}),this.trigger("customAttributesUpdate",this)},setConnectionUrlFromCustomAttributes:function(){var e=this.getCurrentDriver(),t=e.getCustomAttributes(),i=this.pick(t),n=this.replaceConnectionUrlTemplatePlaceholdersWithValues(e.get("jdbcUrl"),i);this.set("connectionUrl",n,{silent:!0}),this.trigger("connectionUrlUpdate",this)},getAttributeValueFromUrl:function(e,t){var i=t.exec(e);return[].slice.call(i||[],1)},getCustomAttributeValuesFromConnectionUrl:function(){var e,t=this.getCurrentDriver(),i=this.get("connectionUrl"),n=l(t.convertUrlTemplateToRegex()),s=t.getCustomAttributes(),r={};return e=this.getAttributeValueFromUrl(i,n),a.each(e,function(e,t){r[s[t]]=e}),r},setCustomAttributesDefaultValues:function(e){this.unsetCustomAttributes();var t={};e.isOtherDriver()?(t.selectedDriverClass=e.get("jdbcDriverClass"),t.driverClass="",t.isOtherDriver=!0):(a.extend(t,e.get("defaultValues")),t.selectedDriverClass=e.get("jdbcDriverClass"),t.driverClass=e.get("jdbcDriverClass"),t.isOtherDriver=!1,t.connectionUrl=this.replaceConnectionUrlTemplatePlaceholdersWithValues(e.get("jdbcUrl"),e.get("defaultValues"))),this.set(t,{silent:!0}),this.extendValidation()},unsetCustomAttributes:function(){var e=this;a.each(this.drivers.getAllPossibleCustomAttributes(),function(t){e.unset(t,{silent:!0})})},replaceConnectionUrlTemplatePlaceholdersWithValues:function(e,t){var i=this.getRegExpFieldGroupsFromConnectionUrlTemplate(e);return a.each(i,function(i){e=e.replace(i[0],a.isUndefined(t[i[1]])?"":t[i[1]])}),e},getRegExpFieldGroupsFromConnectionUrlTemplate:function(e){for(var t,n=[];!a.isNull(t=i.FIELD_TEMPLATE_REGEXP.exec(e));)a.isArray(t)&&2===t.length&&n.push(t);return n},extendValidation:function(){var e=this,t={},n=this.getCurrentDriver().getCustomAttributes();a.extend(t,p),a.each(n,function(n){t[n]=[{xRegExpPattern:i.VALIDATION_PATTERNS[n],msg:c[e.JDBC_BUNDLE_PREFIX+"invalidField"].replace("{0}",c[e.JDBC_BUNDLE_PREFIX+n])}]}),this.validation=t},toJSON:function(){var e=t.prototype.toJSON.apply(this,arguments);return this.options.isEditMode&&e.password===h["input.password.substitution"]&&(e.password=null),e}})}),define("text!dataSource/template/dialog/baseDialogTemplate.htm",[],function(){return'<div id="select" class="panel dialog select overlay moveable centered_horz centered_vert hidden">\n    <div class="sizer diagonal"></div>\n    <div class="content hasFooter">\n        <div class="header mover">\n            <div class="title">{{- title }}</div>\n        </div>\n        <div class="body"></div>\n        <div class="footer ">\n            <button class="button action primary up"><span class="wrap">{{- primaryButtonLabel }}</span><span class="icon"></span></button>\n            <button class="button action up"><span class="wrap">{{- secondaryButtonLabel }}</span><span class="icon"></span></button>\n        </div>\n    </div>\n</div>'}),define("dataSource/view/dialog/BaseDialog",["require","backbone","underscore","jquery","components.dialogs","text!dataSource/template/dialog/baseDialogTemplate.htm"],function(e){"use strict";var t=e("backbone"),i=e("underscore"),n=e("jquery"),s=e("components.dialogs"),r=e("text!dataSource/template/dialog/baseDialogTemplate.htm");return t.View.extend({events:{"click button.action.primary":"primaryButtonOnClick","click button.action:not(.primary)":"secondaryButtonOnClick"},isModal:!0,TITLE:"",PRIMARY_BUTTON_LABEL:"",SECONDARY_BUTTON_LABEL:"",el:function(){return i.template(r,{title:this.TITLE,primaryButtonLabel:this.PRIMARY_BUTTON_LABEL,secondaryButtonLabel:this.SECONDARY_BUTTON_LABEL})},initialize:function(){n("body").append(this.render().$el)},show:function(){s.popup.show(this.el,this.isModal)},hide:function(){s.popup.hide(this.el)},render:function(){return this},primaryButtonOnClick:function(){throw new Error("Method not implemented")},secondaryButtonOnClick:function(){this.hide()}})}),define("common/transport/AjaxFormSubmitter",["require","underscore","request","jquery"],function(e){function t(e){var t,n=null;return e.firstChild.innerText&&""!==e.firstChild.innerText&&e.body?(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e.firstChild.innerText.replace("\r\n-","\r\n"))):t=e,t.firstChild&&(n=t.firstChild.nodeName.toLowerCase()),n&&"html"!==n&&"#comment"!==n?i("xml"===t.firstChild.nodeName.toLowerCase()?t.firstChild.nextSibling:t.firstChild):{errorCode:"unexpected.error"}}function i(e){var t,n;if(e.children)t=e.children;else{t=[];for(var s=0,r=e.childNodes.length;r>s;s++)null===e.childNodes[s].nodeValue&&t.push(e.childNodes[s])}if(0===t.length&&1===e.childNodes.length)return e.childNodes[0].nodeValue;if(t.length>1&&t[0].nodeName===t[1].nodeName){n=[];for(var s=0,r=t.length;r>s;s++)n[s]=i(t[s])}else{n={};for(var s=0,r=t.length;r>s;s++)n[t[s].nodeName]=i(t[s])}return n}function n(e){var t=new o.Deferred;return e.submit(function(i){i.preventDefault(),a({url:e.attr("action"),type:e.attr("method"),data:new FormData(e[0]),cache:!1,contentType:!1,processData:!1,headers:{Accept:"application/json"}}).done(function(e){t.resolve(e)}).fail(function(e){e=e.responseJSON||e||{},r.defaults(e,{errorCode:"error.load.error"}),t.reject(e)}),e.unbind("submit")}),e.submit(),t}function s(e,i){var n=o.Deferred(),s=o("<iframe style='display:none' name='"+i+"'></iframe>");return e.append(s).attr("target",i),s.load(function(){try{n.resolve(t(this.contentWindow.document))}catch(e){n.reject({errorCode:"error.invalid.response"})}s.remove()}),s.on("abort",function(){n.reject({errorCode:"error.load.aborted"}),s.remove()}),s.on("error",function(){n.reject({errorCode:"error.load.error"}),s.remove()}),e.submit(),n}var r=e("underscore"),a=e("request"),o=e("jquery"),l=function(e,i,n,s){this.name=r.uniqueId("uploadTarget"),this.form=o(e),i&&this.form.attr("action",i),n&&this.form.attr("method",n),s&&this.form.attr("enctype",s),this.parceXmlDocToObject=t};return l.prototype.submit=function(){return window.FormData?n(this.form):s(this.form,this.name)},l}),define("text!dataSource/template/dialog/uploadJdbcDriverDialogTemplate.htm",[],function(){return'<form method="post" enctype="multipart/form-data" action="rest_v2/jdbcDrivers">\n    <input name="className" type="hidden" value="{{- className }}"/>\n    <div class="control groupBox fillParent">\n        <div class="content">\n            <div class="header">\n                <div class="title"></div>\n            </div>\n            <div class="body">\n                <ul title="Locate local file"></ul>\n                <div class="errorMessageContainer">\n                    <span class="message warning"></span>\n                </div>\n                <div class="hidden warningMessageContainer">\n                    <span class="message textAccent"></span>\n                </div>\n                <br/>\n                <a class="fsection" target="_blank" href="http://community.jaspersoft.com/wiki/downloading-and-installing-database-drivers">{{- i18n["resource.dataSource.jdbc.upload.downloading"]}}</a>\n            </div>\n        </div>\n    </div>\n</form>'}),define("text!dataSource/template/dialog/fileUploadTemplate.htm",[],function(){return'<li class="leaf">\n    <input type="file" name="file_{{- fileIndex}}" size="60" accept="jar/jar" />\n    <span class="message warning"></span>\n</li>'}),define("dataSource/view/dialog/UploadJdbcDriverDialog",["require","dataSource/view/dialog/BaseDialog","underscore","jquery","common/transport/AjaxFormSubmitter","components.dialogs","request","bundle!jasperserver_messages","text!dataSource/template/dialog/uploadJdbcDriverDialogTemplate.htm","text!dataSource/template/dialog/fileUploadTemplate.htm","utils.common"],function(e){"use strict";var t=e("dataSource/view/dialog/BaseDialog"),i=e("underscore"),n=e("jquery"),s=e("common/transport/AjaxFormSubmitter"),r=e("components.dialogs"),a=(e("request"),e("bundle!jasperserver_messages")),o=e("text!dataSource/template/dialog/uploadJdbcDriverDialogTemplate.htm"),l=e("text!dataSource/template/dialog/fileUploadTemplate.htm");return e("utils.common"),t.extend({TITLE:a["resource.dataSource.jdbc.selectDriverTitle"],PRIMARY_BUTTON_LABEL:a["button.upload"],SECONDARY_BUTTON_LABEL:a["button.cancel"],events:function(){return i.extend({},t.prototype.events,{"change input[type='file']":"onFileChange"})},initialize:function(e){this.driverClass=e.driverClass,this.driverAvailable=e.driverAvailable,this.fileIndex=0,t.prototype.initialize.apply(this,arguments)},onFileChange:function(e){var t=n(e.target),s=t.next(".message.warning");if(s.parent().removeClass("error"),t.val().match(/.jar$/)){if(t.is(this.$("input[type='file']:last-of-type"))){var r=0,o=this.$("input[type='file']");i.each(o,function(e,t){r+=t+1}),r>=o.length&&this.addFileInput(),this.$("button.primary").removeClass("disabled").attr("disabled",null)}}else s.text(a["resource.dataSource.jdbc.upload.wrongExtension"]).parent().addClass("error")},render:function(){var e=this;return this.$(".body").html(i.template(o,{className:this.driverClass,i18n:a})),i.defer(function(){e.addFileInput(),e.driverAvailable?e.$(".warningMessageContainer").removeClass("hidden").find(".message").text(a["resource.dataSource.jdbc.upload.overwriteWarning"]):e.$(".warningMessageContainer").addClass("hidden").find(".message").text("")}),this.$("button.primary").addClass("disabled").attr("disabled","disabled"),this},onSuccessCallback:function(e){this.trigger("driverUpload",e),this.hide(),r.systemConfirm.show(a["resource.dataSource.jdbc.upload.driverUploadSuccess"]),i.defer(i.bind(this.remove,this))},onErrorCallback:function(e){var t;e=e.responseJSON?e.responseJSON:e,"illegal.parameter.value.error"===e.errorCode&&e.parameters&&e.parameters.length&&"className"===e.parameters[0]?t=a["resource.dataSource.jdbc.classNotFound"].replace("{0}",this.driverClass):e.message?t=e.message:(t=e.errorCode,"error.invalid.response"===t&&(t="The required driver class ("+this.driverClass+") is not found in uploaded files")),this.$(".errorMessageContainer").addClass("error").find(".message").text(t)},addFileInput:function(){this.$("ul").append(i.template(l,{fileIndex:this.fileIndex})),this.fileIndex++},primaryButtonOnClick:function(){this.$(".errorMessageContainer").removeClass("error").find(".message").text("");var e=this.$("form"),t=this;new s(e[0]).submit().done(function(e){e.errorCode?t.onErrorCallback(e):t.onSuccessCallback(e)}).fail(function(e){t.onErrorCallback(e)})},secondaryButtonOnClick:function(){this.hide(),i.defer(i.bind(this.remove,this))}})}),define("text!dataSource/template/jdbcSpecificTemplate.htm",[],function(){return'<fieldset class="group shortFields">\n    <legend class="offLeft"><span>{{- i18n[\'resource.dataSource.accessProp\']}}</span></legend>\n\n    <label title="{{- i18n[\'resource.dataSource.jdbc.selectDriverTitle\']}}" class="control select">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.driver\']}}:</span>\n        <select name="selectedDriverClass">\n            {{ _.each(drivers, function(driver) { }}\n                <option value="{{- driver.jdbcDriverClass }}"\n                {{ if (modelAttributes.selectedDriverClass === driver.jdbcDriverClass) { }}\n                    selected="selected"\n                {{ } }}>\n                    {{ if (!driver.available && driver.jdbcDriverClass !== otherDriverValue) { }}\n                        {{- i18n["resource.dataSource.jdbc.driverMissing"] }}\n                    {{ } }}\n                    {{- driver.label }}\n                    {{ if (driver.jdbcDriverClass !== otherDriverValue && typeof (driver.label) !== "undefined" && driver.label !== "") { }}\n                        ({{- driver.jdbcDriverClass }})\n                    {{ } else if (driver.jdbcDriverClass !== otherDriverValue && (typeof driver.label === "undefined" || driver.label === "")) { }}\n                        {{- driver.jdbcDriverClass }}\n                    {{ } }}\n                </option>\n            {{ }); }}\n        </select>\n\n        {{ if (driverUploadEnabled) { }}\n		<button class="button action up" id="driverUploadButton">\n			<span class="wrap">{{- i18n[\'resource.dataSource.jdbc.upload.editDriverButton\']}}</span>\n		</button>\n        {{ } }}\n    </label>\n\n    <div name="jdbcSpecificFieldsContainer"></div>\n\n    <label title="{{- i18n[\'resource.analysisConnection.url\']}}" class="control input text">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.url\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.connectionUrl }}" name="connectionUrl">\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n[\'resource.dataSource.jdbc.hint2\']}}</span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.jdbc.username\']}}" class="control input text ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.username\']}}:</span>\n        <input type="text" value="{{- modelAttributes.username }}" name="username">\n        <span class="message warning"></span>\n        <span class="message hint"></span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.jdbc.password\']}}" class="control input password ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.password\']}}:</span>\n        <input type="password" value="{{- modelAttributes.password }}" name="password">\n        <span class="message warning"></span>\n        <span class="message hint"></span>\n    </label>\n\n</fieldset>'}),define("text!dataSource/template/jdbcCustomFieldTemplate.htm",[],function(){return'<label class="control input text" title="{{- title}}">\n    <span class="wrap">{{- label}} ({{- i18n["required.field"] }}):</span>\n    <input name="{{- name}}" type="text" value="{{- value }}"/>\n    <span class="message warning"></span>\n    <span class="message hint">{{- hint }}</span>\n</label>'}),define("dataSource/view/JdbcDataSourceView",["require","underscore","jquery","dataSource/view/BaseDataSourceView","dataSource/model/JdbcDataSourceModel","dataSource/model/JdbcDriverModel","dataSource/view/dialog/UploadJdbcDriverDialog","text!dataSource/template/jdbcSpecificTemplate.htm","text!dataSource/template/jdbcCustomFieldTemplate.htm","core.events.bis","bundle!jasperserver_messages"],function(e){"use strict";var t=e("underscore"),i=(e("jquery"),e("dataSource/view/BaseDataSourceView")),n=e("dataSource/model/JdbcDataSourceModel"),s=e("dataSource/model/JdbcDriverModel"),r=e("dataSource/view/dialog/UploadJdbcDriverDialog"),a=e("text!dataSource/template/jdbcSpecificTemplate.htm"),o=e("text!dataSource/template/jdbcCustomFieldTemplate.htm"),l=e("core.events.bis"),d=e("bundle!jasperserver_messages");return i.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.jdbc.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.jdbc.page.title.edit",modelConstructor:n,events:function(){var e={};return t.extend(e,i.prototype.events,{"keyup input[type='text'][name!='driverClass'], input[type='password'], textarea":"updateModelProperty","change input[type='text'][name!='driverClass'], input[type='password'], textarea, select":"updateModelProperty","keyup input[type='text'][name='driverClass']":"manuallySetDriverClass","change input[type='text'][name='driverClass']":"manuallySetDriverClass","click #driverUploadButton":"uploadDriver"}),e}(),initialize:function(e){i.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"connectionUrlUpdate",this.updateConnectionUrl),this.listenTo(this.model,"customAttributesUpdate",this.updateCustomAttributes),this.listenTo(this.model,"driverClassChange",this.changeDriver),this.listenTo(this.model.drivers,"change",this.updateDriverOption),this.listenTo(this.model.drivers,"add",this.addDriverOption)},updateDriverOption:function(e){var t=this.$("select[name='selectedDriverClass'] option[value='"+e.get("jdbcDriverClass")+"']"),i=e.get("label")+" ("+e.get("jdbcDriverClass")+")";e.get("available")||(i=d["resource.dataSource.jdbc.driverMissing"]+" "+i),t.text(i),this.model.getCurrentDriver()===e&&this.changeUploadDriverButtonState()},addDriverOption:function(e){if(!e.isOtherDriver){var i=this.$("select[name='selectedDriverClass'] option[value='"+s.OTHER_DRIVER+"']"),n=e.get("jdbcDriverClass"),r=this;e.get("available")||(n=d["resource.dataSource.jdbc.driverMissing"]+" "+n),i.before("<option value='"+e.get("jdbcDriverClass")+"'>"+n+"</option>"),t.defer(function(){r.$("select[name='selectedDriverClass']").val(e.get("jdbcDriverClass")),r.model.trigger("change:driverClass")})}},manuallySetDriverClass:function(){var e=this.$("input[type='text'][name='driverClass']").val(),t={driverClass:e};this.model.set(t,{silent:!0}),this.model.validate(t),this.changeUploadDriverButtonState()},updateConnectionUrl:function(){this.$("input[name='connectionUrl']").val(this.model.get("connectionUrl"));var e=this.model.getCurrentDriver();e.isOtherDriver()||e.isUploadedDriver()||this.model.validate({connectionUrl:this.model.get("connectionUrl")})},updateCustomAttributes:function(){var e=this,i=this.model.getCurrentDriver().getCustomAttributes();t.each(i,function(t){e.$("input[name='"+t+"']").val(e.model.get(t))});var n=this.model.pick(i);this.model.validate(n)},changeDriver:function(){this.renderDriverCustomAttributeFields(),this.changeUploadDriverButtonState()},changeUploadDriverButtonState:function(){var e=this.model.getCurrentDriver(),t=this.$("#driverUploadButton");l.enable(t[0]);var i=e.get("available")?d["resource.dataSource.jdbc.upload.editDriverButton"]:d["resource.dataSource.jdbc.upload.addDriverButton"];t.find(".wrap").text(i)},uploadDriver:function(){this.model.drivers.driverUploadEnabled&&this.model.get("driverClass")?(this.fieldIsValid(this,"driverClass","name"),this.driverUploadDialog&&this.stopListening(this.driverUploadDialog),delete this.driverUploadDialog,this.initDriverUploadDialog(),this.driverUploadDialog.show()):this.fieldIsInvalid(this,"driverClass",d["ReportDataSourceValidator.error.not.empty.reportDataSource.driverClass"],"name")},initDriverUploadDialog:function(){this.driverUploadDialog=new r({driverAvailable:this.model.getCurrentDriver().get("available"),driverClass:this.model.get("isOtherDriver")?this.model.get("driverClass"):this.model.getCurrentDriver().get("jdbcDriverClass")}),this.listenTo(this.driverUploadDialog,"driverUpload",this._onDriverUploadFinished)},_onDriverUploadFinished:function(e){var i=this;this.model.fetchDrivers().then(function(){i.model.drivers.markDriverAsAvailable(e.jdbcDriverClass),t.defer(function(){i.model.validate(),i.render()})})},render:function(){return this.$el.empty(),this.renderJdbcSpecificSection(),this.renderTimezoneSection(),this.renderTestConnectionSection(),this},templateData:function(){var e=i.prototype.templateData.apply(this,arguments);return t.extend(e,{drivers:this.model.drivers.toJSON(),otherDriverValue:s.OTHER_DRIVER,driverUploadEnabled:this.model.drivers.driverUploadEnabled}),e},renderJdbcSpecificSection:function(){this.$el.append(t.template(a,this.templateData())),this.renderDriverCustomAttributeFields(),this.changeUploadDriverButtonState()},renderDriverCustomAttributeFields:function(){var e=this,i="";if(this.model.get("isOtherDriver"))i+=t.template(o,{hint:d["resource.dataSource.jdbc.hint1"],label:d["resource.dataSource.jdbc.driver"],name:"driverClass",title:d["resource.analysisConnection.driver"],value:this.model.get("driverClass"),i18n:d});else{var n=this.model.getCurrentDriver().getCustomAttributes();t.each(n,function(n){i+=t.template(o,{hint:"",label:d["resource.dataSource.jdbc."+n],name:n,title:d["resource.dataSource.jdbc.requiredTitle"].replace("{0}",d["resource.dataSource.jdbc."+n].toLowerCase()),value:e.model.get(n),i18n:d})})}this.$("[name=jdbcSpecificFieldsContainer]").html(i)},remove:function(){this.driverUploadDialog&&this.driverUploadDialog.remove(),i.prototype.remove.apply(this,arguments)}})}),define("dataSource/model/JndiDataSourceModel",["require","dataSource/model/BaseDataSourceModel","bi/repository/enum/repositoryResourceTypes","dataSource/enum/connectionTypes","underscore","bundle!jasperserver_messages"],function(e){"use strict";var t=e("dataSource/model/BaseDataSourceModel"),i=e("bi/repository/enum/repositoryResourceTypes"),n=e("dataSource/enum/connectionTypes"),s=e("underscore"),r=e("bundle!jasperserver_messages");return t.extend({type:i.JNDI_DATA_SOURCE,defaults:function(){var e={};return s.extend(e,t.prototype.defaults,{jndiName:"",timezone:"",connectionType:n.JNDI}),e}(),validation:function(){var e={};return s.extend(e,t.prototype.validation,{jndiName:[{required:!0,msg:r["ReportDataSourceValidator.error.not.empty.reportDataSource.jndiName"]}]}),e}()})}),define("text!dataSource/template/jndiSpecificTemplate.htm",[],function(){return'<fieldset class="group mediumFields">\n\n    <legend class="offLeft"><span>{{- i18n[\'resource.dataSource.accessProp\']}}</span></legend>\n\n    <label title="{{- i18n[\'resource.analysisConnection.driver\']}}" class="control input text ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jndi.serviceName\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.jndiName }}" name="jndiName">\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n[\'resource.dataSource.jndi.hint1\']}}</span>\n    </label>\n\n</fieldset>'}),define("dataSource/view/JndiDataSourceView",["require","underscore","dataSource/view/BaseDataSourceView","dataSource/model/JndiDataSourceModel","text!dataSource/template/jndiSpecificTemplate.htm"],function(e){"use strict";var t=e("underscore"),i=e("dataSource/view/BaseDataSourceView"),n=e("dataSource/model/JndiDataSourceModel"),s=e("text!dataSource/template/jndiSpecificTemplate.htm");return i.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.jndi.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.jndi.page.title.edit",modelConstructor:n,render:function(){return this.$el.empty(),this.renderJndiSpecificSection(),this.renderTimezoneSection(),this.renderTestConnectionSection(),this},renderJndiSpecificSection:function(){this.$el.append(t.template(s,this.templateData()))}})}),define("common/component/base/Dimmer",["require","jquery","common/util/classUtil"],function(e){var t,i,n=e("jquery"),s=e("common/util/classUtil");return s.extend({constructor:function(e){t||(i=0,t=n("<div id='dialogDimmer' class='dimmer'></div>").css(e),n(document.body).append(t),t.hide()),i++},css:function(e){return t.css(e),this},show:function(){var e=this.getCount()||0;return this.setCount(++e),t.show(),this},hide:function(){if(this.isVisible()){var e=this.getCount();return this.setCount(--e),!e&&t.hide(),this}},setCount:function(e){t.data({count:e})},getCount:function(){return parseInt(t.data("count"),10)},isVisible:function(){return t.is(":visible")},remove:function(){this._removed||(this._removed=!0,t&&(i--,i||(t.remove(),t=null)))}})}),define("text!common/component/panel/template/panelTemplate.htm",[],function(){return'<div class="panel {{- additionalCssClasses }}">\n    <div class="header">\n        <div class="title">{{- title}}</div>\n    </div>\n    <div class="subcontainer"></div>\n</div>\n'}),define("common/component/panel/Panel",["require","css!panel","underscore","backbone","text!./template/panelTemplate.htm"],function(e){"use strict";e("css!panel");var t=e("underscore"),i=e("backbone"),n=e("text!./template/panelTemplate.htm");return i.View.extend({defaultTemplate:n,el:function(){var e=this.getTemplateArguments();return this.template(e)},getTemplateArguments:function(){return{title:this.title,additionalCssClasses:this.additionalCssClasses}},constructor:function(e){e||(e={}),this.template=t.template(e.template||this.defaultTemplate),this.title=e.title||"",this.additionalCssClasses=e.additionalCssClasses||"",this.content=e.content||"",this.collapsed=!e.collapsed,this.openClass=e.openClass||"open",this.closedClass=e.closedClass||"closed",this.loadingClass=e.loadingClass||"loading",this.fixedHeight=e.fixedHeight||!1,this.contentContainer=e.contentContainer||".subcontainer",this.overflow=e.overflow||"auto",this.traits=e.traits||[],t.each(this.traits,t.bind(function(e){e.extension&&t.extend(this,e.extension)},this)),this.invokeTraits("onConstructor",e),i.View.apply(this,arguments)},invokeTraits:function(e){var i=Array.prototype.slice.call(arguments,1),n=this;t.each(this.traits,function(t){t[e]&&t[e].apply(n,i)})},initialize:function(e){this.invokeTraits("beforeInitialize",e),this.content&&this.setContent(this.content),this.toggleCollapsedState(),this.invokeTraits("afterInitialize",e)},setElement:function(e){this.invokeTraits("beforeSetElement",e);var t=i.View.prototype.setElement.apply(this,arguments);return this.$contentContainer=this.$(this.contentContainer),this.$contentContainer[this.collapsed?"hide":"show"](),this.invokeTraits("afterSetElement",e),t},open:function(e){return this.invokeTraits("beforeOpen",e),this.$contentContainer.show(),this.$el.removeClass(this.closedClass).addClass(this.openClass),this.collapsed=!1,e&&e.renderContent&&this.renderContent(),this.invokeTraits("afterOpen",e),e&&e.silent||this.trigger("open",this),this},close:function(e){return this.invokeTraits("beforeClose",e),this.$contentContainer.hide(),this.$el.removeClass(this.openClass).addClass(this.closedClass),this.collapsed=!0,this.invokeTraits("afterClose",e),e&&e.silent||this.trigger("close",this),this},setContent:function(e,t){this.content=e;var i=this.renderContent();this.$contentContainer[t===!0?"append":"html"](i)},renderContent:function(){return this.content instanceof i.View?this.content.render().$el:this.content},setHeight:function(e){var i=this.$("> .header").outerHeight();this.$contentContainer.css({height:t.isNumber(e)?e-i+"px":"auto",overflow:this.overflow})},toggleCollapsedState:function(){return this.collapsed?this.open():this.close(),this},remove:function(){this.invokeTraits("onRemove"),this.content&&this.content.remove&&this.content.remove(),i.View.prototype.remove.call(this)}})}),define("common/component/base/OptionView",["require","backbone","underscore"],function(e){"use strict";var t=e("backbone"),i=e("underscore");return t.View.extend({events:{click:"select",mouseover:"mouseover",mouseout:"mouseout"},constructor:function(e){if(!e||!e.template)throw new Error("Option should have defined template");if(!(e.model&&e.model instanceof t.Model))throw new Error("Option should have associated Backbone.Model");this.template=i.template(e.template),this.disabledClass=e.disabledClass,this.hiddenClass=e.hiddenClass,this.toggleClass=e.toggleClass,this.overClass=e.overClass||"over",t.View.apply(this,arguments)},initialize:function(){t.View.prototype.initialize.apply(this,arguments);var e=this;this.model.get("disabled")===!0&&this.disable(),this.model.get("hidden")===!0&&this.hide(),this.model.get("selected")===!0&&this.addSelection(),this.listenTo(this.model,"change:over",function(t,i){i?e.$("> p").addClass(e.overClass):e.$("> p").removeClass(e.overClass)})},el:function(){return this.template(this.model.toJSON())},enable:function(){this.$el.removeAttr("disabled").removeClass(this.disabledClass)},disable:function(){this.$el.attr("disabled","disabled").addClass(this.disabledClass)},over:function(){this.model.set({over:!0})},leave:function(){this.model.set({over:!1})},show:function(){this.$el.show().removeClass(this.hiddenClass)},hide:function(){this.$el.hide().addClass(this.hiddenClass)},isVisible:function(){return this.$el.is(":visible")},isDisabled:function(){return this.$el.is(":disabled")},select:function(e){this.model.trigger("select",this,this.model,e),this.trigger("click",this,this.model,e)},addSelection:function(){this.$el.addClass(this.toggleClass),this.model.set("selected",!0)},removeSelection:function(){this.$el.removeClass(this.toggleClass),this.model.unset("selected")},mouseover:function(e){this.trigger("mouseover",this,this.model,e)},mouseout:function(e){this.trigger("mouseout",this,this.model,e)}})}),define("common/component/base/OptionContainer",["require","backbone","underscore","./OptionView"],function(e){"use strict";function t(e){if(!e||n.isEmpty(e))throw new Error("Init options must be specified");if(!e.options||!e.options.length)throw new Error("Option views descriptors must be specified");if(!e.mainTemplate&&!e.el)throw new Error("Option container must have a template");if(!e.optionTemplate)throw new Error("Option container must have an option template")}var i=e("backbone"),n=e("underscore"),s=e("./OptionView");return i.View.extend({el:function(){return n.template(this.template)()},constructor:function(e){t(e),this.contextName=e.contextName||"option",this.contentContainer=e.contentContainer?e.contentContainer:e.el||".content > ul",this.toggle=!!e.toggle,this.toggleClass=e.toggleClass||"active",this.options=[],this.collection=e.collection||new i.Collection,delete e.collection,e.options&&this.collection.reset(e.options),this.hasGroups=this.collection.models[0]&&this.collection.models[0].get("groupId")?!0:!1,this.defalutOptionView=this.hasGroups?this.collection.where({"default":!0}):[this.collection.findWhere({"default":!0})],this.listenTo(this.collection,"select",this._selectOption),this.listenTo(this.collection,"update reset",this.render),this.template=e.mainTemplate,this.optionTemplate=e.optionTemplate,i.View.apply(this,arguments)},setElement:function(e){var t=i.View.prototype.setElement.apply(this,arguments);return this.$contentContainer=this.contentContainer?this.$(this.contentContainer).andSelf().filter(this.contentContainer):this.$el,t},initialize:function(){this.render(),this.toggle&&this.defalutOptionView&&n.each(this.defalutOptionView,function(e){e&&this.getOptionView(e.get("action")).addSelection()},this)},render:function(){var e=this;n.each(this.options,function(t){e.stopListening(t,"mouseover"),e.stopListening(t,"mouseout"),t.remove()}),this.options=[],this.collection.forEach(function(t){var i=new s({template:e.optionTemplate,model:t,toggleClass:e.toggleClass});e.listenTo(i,"mouseover",function(t,i){e.trigger("mouseover",t,e,i)}),e.listenTo(i,"mouseout",function(t,i){e.trigger("mouseout",t,e,i)}),e.options.push(i),e.$contentContainer.append(i.$el)})},_onKeyDown:function(e){var t=this.getOptionView(e.keyCode,"triggerOnKeyCode");t&&!t.isDisabled()&&t.select()},_selectOption:function(e,t){if(this.toggle){var i=t.get("groupId"),s=this.hasGroups?n.where(this.options,function(e){return e.model.get("groupId")===i}):this.options;n.each(s,function(e){e.removeSelection()},this),e.addSelection()}this.trigger("selection",e,t),this.trigger(this.contextName+":"+t.get("action"),e,t)},getOptionView:function(e,t){return n.find(this.options,function(i){return i.model.get(t||"action")===e})},resetSelection:function(e,t){e=e||[],this.toggle&&(this.hasGroups?(e.length<this.defalutOptionView.length&&n.each(this.defalutOptionView,function(t){var i={groupId:t.get("groupId")},s=n.findWhere(e,i);!s&&t&&e.push(n.extend(i,{action:t.get("action")}))}),e=n.pluck(e,"action")):!e.length&&this.defalutOptionView[0]&&e.push(this.defalutOptionView[0].get("action")),n.each(this.options,function(i){e.length&&n.contains(e,i.model.get("action"))?t?this._selectOption(i,i.model):i.addSelection():i.removeSelection()},this))},select:function(){var e=Array.prototype.slice.call(arguments,0);this.toggle&&n.each(this.options,function(t){!e.length||n.contains(e,t.model.get("action"))?t.addSelection():t.removeSelection()},this)},deselect:function(){var e=Array.prototype.slice.call(arguments,0);this.toggle&&n.each(this.options,function(t){(!e.length||n.contains(e,t.model.get("action")))&&t.removeSelection()},this)},getSelection:function(){return n.chain(this.options).filter(function(e){return e.model.get("selected")}).map(function(e){return e.model.get("action")}).value()},show:function(){return n.each(this.options,function(e){
var t=e.model.get("test");t&&!t()?e.hide():e[e.model.get("hidden")?"hide":"show"]()}),this.$el.show(),this.trigger("show",this),this},hide:function(){return this.$el.hide(),this.trigger("hide",this),this},enable:function(e){var t=Array.prototype.slice.call(arguments);n.each(this.options,function(e){(!t.length||n.contains(t,e.model.get("action")))&&e.enable()})},disable:function(e){var t=Array.prototype.slice.call(arguments);n.each(this.options,function(e){(!t.length||n.contains(t,e.model.get("action")))&&e.disable()})},addOptions:function(e,t){this.collection.add(e,n.extend(t||{},{silent:!0})),this.collection.reset(this.collection.toJSON())},removeOptions:function(e){var t=this.collection.filter(function(t){return!n.contains(e,t.get("action"))});t.length<this.collection.length&&this.collection.reset(t)},remove:function(){n.invoke(this.options,"remove"),i.View.prototype.remove.apply(this,arguments)}})}),define("common/component/panel/trait/abstractPanelTrait",[],function(){"use strict";var e={extension:{},onConstructor:function(){},beforeInitialize:function(){},afterInitialize:function(){},beforeSetElement:function(){},afterSetElement:function(){},beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){},onRemove:function(){}};return e}),define("jquery-ui/jquery.ui.resizable",["require","./jquery.ui.core","./jquery.ui.mouse","./jquery.ui.widget"],function(e){function t(e){return parseInt(e,10)||0}function i(e){return!isNaN(parseInt(e,10))}e("./jquery.ui.core"),e("./jquery.ui.mouse");var n=e("./jquery.ui.widget");return n.widget("ui.resizable",n.ui.mouse,{version:"@VERSION",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){function e(e){return o._mouseDown(e)}var t,i,s,r,a,o=this,l=this.options;if(this.element.addClass("ui-resizable"),n.extend(this,{_aspectRatio:!!l.aspectRatio,aspectRatio:l.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:l.helper||l.ghost||l.animate?l.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(n("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=l.handles||(n(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;i<t.length;i++)s=n.trim(t[i]),a="ui-resizable-"+s,r=n("<div class='ui-resizable-handle "+a+"'></div>"),r.css({zIndex:l.zIndex}),"se"===s&&r.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(r);this._renderAxis=function(e){var t,i,s,r;e=e||this.element;for(t in this.handles)this.handles[t].constructor===String&&(this.handles[t]=n(this.handles[t],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(i=n(this.handles[t],this.element),r=/sw|ne|nw|se|n|s/.test(t)?i.outerHeight():i.outerWidth(),s=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join(""),e.css(s,r),this._proportionallyResize()),n(this.handles[t]).length},this._renderAxis(this.element),this._handles=n(".ui-resizable-handle",this.element);for(i in this.handles)this._handles=this._handles.add(this.handles[i]);if(this._handles.disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(r=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=r&&r[1]?r[1]:"se")}),l.autoHide&&(this._handles.hide(),n(this.element).addClass("ui-resizable-autohide").mouseenter(function(){l.disabled||(n(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){l.disabled||o.resizing||(n(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit(),l.handles.constructor!==String)for(i in l.handles)s=l.handles[i],s instanceof n&&s.bind("mousedown."+this.widgetName,e)},_destroy:function(){this._mouseDestroy();var e,t=function(e){n(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(t(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(e){var t,i,s=!1;for(t in this.handles)i=n(this.handles[t])[0],(i===e.target||n.contains(i,e.target))&&(s=!0);return!this.options.disabled&&s},_mouseStart:function(e){var i,s,r,a=this.options,o=this.element.position(),l=this.element;return this.resizing=!0,/absolute/.test(l.css("position"))?l.css({position:"absolute",top:l.css("top"),left:l.css("left")}):l.is(".ui-draggable")&&l.css({position:"absolute",top:o.top,left:o.left}),this._renderProxy(),i=t(this.helper.css("left")),s=t(this.helper.css("top")),a.containment&&(i+=n(a.containment).scrollLeft()||0,s+=n(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:l.width(),height:l.height()},this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()},this.originalPosition={left:i,top:s},this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,r=n(".ui-resizable-"+this.axis).css("cursor"),n("body").css("cursor","auto"===r?this.axis+"-resize":r),l.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var t,i=this.helper,s={},r=this.originalMousePosition,a=this.axis,o=this.position.top,l=this.position.left,d=this.size.width,c=this.size.height,u=e.pageX-r.left||0,h=e.pageY-r.top||0,p=this._change[a];return p?(t=p.apply(this,[e,u,h]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(t=this._updateRatio(t,e)),t=this._respectSize(t,e),this._updateCache(t),this._propagate("resize",e),this.position.top!==o&&(s.top=this.position.top+"px"),this.position.left!==l&&(s.left=this.position.left+"px"),this.size.width!==d&&(s.width=this.size.width+"px"),this.size.height!==c&&(s.height=this.size.height+"px"),i.css(s),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),n.isEmptyObject(s)||this._trigger("resize",e,this.ui()),!1):!1},_mouseStop:function(e){this.resizing=!1;var t,i,s,r,a,o,l,d=this.options,c=this;return this._helper&&(t=this._proportionallyResizeElements,i=t.length&&/textarea/i.test(t[0].nodeName),s=i&&n.ui.hasScroll(t[0],"left")?0:c.sizeDiff.height,r=i?0:c.sizeDiff.width,a={width:c.helper.width()-r,height:c.helper.height()-s},o=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,l=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,d.animate||this.element.css(n.extend(a,{top:l,left:o})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!d.animate&&this._proportionallyResize()),n("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,s,r,a,o=this.options;a={minWidth:i(o.minWidth)?o.minWidth:0,maxWidth:i(o.maxWidth)?o.maxWidth:1/0,minHeight:i(o.minHeight)?o.minHeight:0,maxHeight:i(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,n=a.maxHeight*this.aspectRatio,r=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),s>a.minHeight&&(a.minHeight=s),n<a.maxWidth&&(a.maxWidth=n),r<a.maxHeight&&(a.maxHeight=r)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),i(e.left)&&(this.position.left=e.left),i(e.top)&&(this.position.top=e.top),i(e.height)&&(this.size.height=e.height),i(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,s=this.axis;return i(e.height)?e.width=e.height*this.aspectRatio:i(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,s=i(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=i(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=i(e.width)&&t.minWidth&&t.minWidth>e.width,o=i(e.height)&&t.minHeight&&t.minHeight>e.height,l=this.originalPosition.left+this.originalSize.width,d=this.position.top+this.size.height,c=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);return a&&(e.width=t.minWidth),o&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),r&&(e.height=t.maxHeight),a&&c&&(e.left=l-t.minWidth),s&&c&&(e.left=l-t.maxWidth),o&&u&&(e.top=d-t.minHeight),r&&u&&(e.top=d-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,i,n,s,r=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(s=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],i=[s.css("borderTopWidth"),s.css("borderRightWidth"),s.css("borderBottomWidth"),s.css("borderLeftWidth")],n=[s.css("paddingTop"),s.css("paddingRight"),s.css("paddingBottom"),s.css("paddingLeft")],t=0;t<i.length;t++)this.borderDif[t]=(parseInt(i[t],10)||0)+(parseInt(n[t],10)||0);s.css({height:r.height()-this.borderDif[0]-this.borderDif[2]||0,width:r.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var e=this.element,t=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||n("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++t.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,s=this.originalPosition;return{top:s.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(e,t,i){return n.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},sw:function(e,t,i){return n.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,t,i]))},ne:function(e,t,i){return n.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,t,i]))},nw:function(e,t,i){return n.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,t,i]))}},_propagate:function(e,t){n.ui.plugin.call(this,e,[t,this.ui()]),"resize"!==e&&this._trigger(e,t,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),n.ui.plugin.add("resizable","animate",{stop:function(e){var t=n(this).data("ui-resizable"),i=t.options,s=t._proportionallyResizeElements,r=s.length&&/textarea/i.test(s[0].nodeName),a=r&&n.ui.hasScroll(s[0],"left")?0:t.sizeDiff.height,o=r?0:t.sizeDiff.width,l={width:t.size.width-o,height:t.size.height-a},d=parseInt(t.element.css("left"),10)+(t.position.left-t.originalPosition.left)||null,c=parseInt(t.element.css("top"),10)+(t.position.top-t.originalPosition.top)||null;t.element.animate(n.extend(l,c&&d?{top:c,left:d}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var i={width:parseInt(t.element.css("width"),10),height:parseInt(t.element.css("height"),10),top:parseInt(t.element.css("top"),10),left:parseInt(t.element.css("left"),10)};s&&s.length&&n(s[0]).css({width:i.width,height:i.height}),t._updateCache(i),t._propagate("resize",e)}})}}),n.ui.plugin.add("resizable","containment",{start:function(){var e,i,s,r,a,o,l,d=n(this).data("ui-resizable"),c=d.options,u=d.element,h=c.containment,p=h instanceof n?h.get(0):/parent/.test(h)?u.parent().get(0):h;p&&(d.containerElement=n(p),/document/.test(h)||h===document?(d.containerOffset={left:0,top:0},d.containerPosition={left:0,top:0},d.parentData={element:n(document),left:0,top:0,width:n(document).width(),height:n(document).height()||document.body.parentNode.scrollHeight}):(e=n(p),i=[],n(["Top","Right","Left","Bottom"]).each(function(n,s){i[n]=t(e.css("padding"+s))}),d.containerOffset=e.offset(),d.containerPosition=e.position(),d.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},s=d.containerOffset,r=d.containerSize.height,a=d.containerSize.width,o=n.ui.hasScroll(p,"left")?p.scrollWidth:a,l=n.ui.hasScroll(p)?p.scrollHeight:r,d.parentData={element:p,left:s.left,top:s.top,width:o,height:l}))},resize:function(e){var t,i,s,r,a=n(this).data("ui-resizable"),o=a.options,l=a.containerOffset,d=a.position,c=a._aspectRatio||e.shiftKey,u={top:0,left:0},h=a.containerElement;h[0]!==document&&/static/.test(h.css("position"))&&(u=l),d.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-u.left),c&&(a.size.height=a.size.width/a.aspectRatio),a.position.left=o.helper?l.left:0),d.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),c&&(a.size.width=a.size.height*a.aspectRatio),a.position.top=a._helper?l.top:0),a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top,t=Math.abs((a._helper?a.offset.left-u.left:a.offset.left-u.left)+a.sizeDiff.width),i=Math.abs((a._helper?a.offset.top-u.top:a.offset.top-l.top)+a.sizeDiff.height),s=a.containerElement.get(0)===a.element.parent().get(0),r=/relative|absolute/.test(a.containerElement.css("position")),s&&r&&(t-=Math.abs(a.parentData.left)),t+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-t,c&&(a.size.height=a.size.width/a.aspectRatio)),i+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-i,c&&(a.size.width=a.size.height*a.aspectRatio))},stop:function(){var e=n(this).data("ui-resizable"),t=e.options,i=e.containerOffset,s=e.containerPosition,r=e.containerElement,a=n(e.helper),o=a.offset(),l=a.outerWidth()-e.sizeDiff.width,d=a.outerHeight()-e.sizeDiff.height;e._helper&&!t.animate&&/relative/.test(r.css("position"))&&n(this).css({left:o.left-s.left-i.left,width:l,height:d}),e._helper&&!t.animate&&/static/.test(r.css("position"))&&n(this).css({left:o.left-s.left-i.left,width:l,height:d})}}),n.ui.plugin.add("resizable","alsoResize",{start:function(){var e=n(this).data("ui-resizable"),t=e.options,i=function(e){n(e).each(function(){var e=n(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"!=typeof t.alsoResize||t.alsoResize.parentNode?i(t.alsoResize):t.alsoResize.length?(t.alsoResize=t.alsoResize[0],i(t.alsoResize)):n.each(t.alsoResize,function(e){i(e)})},resize:function(e,t){var i=n(this).data("ui-resizable"),s=i.options,r=i.originalSize,a=i.originalPosition,o={height:i.size.height-r.height||0,width:i.size.width-r.width||0,top:i.position.top-a.top||0,left:i.position.left-a.left||0},l=function(e,i){n(e).each(function(){var e=n(this),s=n(this).data("ui-resizable-alsoresize"),r={},a=i&&i.length?i:e.parents(t.originalElement[0]).length?["width","height"]:["width","height","top","left"];n.each(a,function(e,t){var i=(s[t]||0)+(o[t]||0);i&&i>=0&&(r[t]=i||null)}),e.css(r)})};"object"!=typeof s.alsoResize||s.alsoResize.nodeType?l(s.alsoResize):n.each(s.alsoResize,function(e,t){l(e,t)})},stop:function(){n(this).removeData("resizable-alsoresize")}}),n.ui.plugin.add("resizable","ghost",{start:function(){var e=n(this).data("ui-resizable"),t=e.options,i=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:i.height,width:i.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof t.ghost?t.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=n(this).data("ui-resizable");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=n(this).data("ui-resizable");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),n.ui.plugin.add("resizable","grid",{resize:function(){var e=n(this).data("ui-resizable"),t=e.options,i=e.size,s=e.originalSize,r=e.originalPosition,a=e.axis,o="number"==typeof t.grid?[t.grid,t.grid]:t.grid,l=o[0]||1,d=o[1]||1,c=Math.round((i.width-s.width)/l)*l,u=Math.round((i.height-s.height)/d)*d,h=s.width+c,p=s.height+u,m=t.maxWidth&&t.maxWidth<h,f=t.maxHeight&&t.maxHeight<p,g=t.minWidth&&t.minWidth>h,A=t.minHeight&&t.minHeight>p;t.grid=o,g&&(h+=l),A&&(p+=d),m&&(h-=l),f&&(p-=d),/^(se|s|e)$/.test(a)?(e.size.width=h,e.size.height=p):/^(ne)$/.test(a)?(e.size.width=h,e.size.height=p,e.position.top=r.top-u):/^(sw)$/.test(a)?(e.size.width=h,e.size.height=p,e.position.left=r.left-c):(p-d>0?(e.size.height=p,e.position.top=r.top-u):(e.size.height=d,e.position.top=r.top+s.height-d),h-l>0?(e.size.width=h,e.position.left=r.left-c):(e.size.width=l,e.position.left=r.left+s.width-l))}}),n}),define("common/component/panel/trait/resizablePanelTrait",["require","underscore","./abstractPanelTrait","css!jquery-ui/jquery-ui","jquery-ui/jquery.ui.resizable"],function(e){"use strict";function t(e,t){this.trigger("resize",e,t)}function i(e,t){this.trigger("resizeStart",e,t)}function n(e,t){this.trigger("resizeStop",e,t)}var s=e("underscore"),r=e("./abstractPanelTrait");return e("css!jquery-ui/jquery-ui"),e("jquery-ui/jquery.ui.resizable"),s.extend({},r,{onConstructor:function(e){e||(e={}),this.handles=e.handles||"e, s, se",this.minWidth=e.minWidth||10,this.minHeight=e.minHeight||10,this.maxWidth=e.maxWidth||null,this.maxHeight=e.maxHeight||null,this.alsoResize=e.alsoResize||!1,this.resizableEl=e.resizableEl},afterSetElement:function(){this.$resizableEl=this.$el.find(this.resizableEl).length?this.$el.find(this.resizableEl):this.$el,this.$resizableEl.resizable({handles:this.handles,minHeight:this.minHeight,minWidth:this.minWidth,maxWidth:this.maxWidth,maxHeight:this.maxHeight,alsoResize:this.alsoResize,resize:s.bind(t,this),start:s.bind(i,this),stop:s.bind(n,this)})},onRemove:function(){try{this.$el.resizable("destroy")}catch(e){}}})}),define("text!common/component/dialog/template/dialogTemplate.htm",[],function(){return'<div class="jr-mDialog jr {{- additionalCssClasses }}" tabindex="-1">\n    <div class="jr-mDialog-header mover jr">\n        <h1 class="jr-mDialog-header-title jr">{{- title }}</h1>\n    </div>\n    <div class="jr-mDialog-body jr {{- additionalBodyCssClasses }}">\n        <div class="jr-mDialog-body-wrapper jr subcontainer"></div>\n    </div>\n    <div class="jr-mDialog-footer jr"></div>\n\n</div>\n'}),define("text!common/component/dialog/template/dialogButtonTemplate.htm",[],function(){return"<button class=\"button action up {{- primary ? 'primary' : ''}} {{- (typeof float !== 'undefined' ? 'right' : '') }}\">\n    <span class=\"wrap\">{{- label }}<span class=\"icon\"></span></span>\n</button>\n"}),define("jquery-ui/jquery.ui.draggable",["require","./jquery.ui.core","./jquery.ui.mouse","./jquery.ui.widget"],function(e){e("./jquery.ui.core"),e("./jquery.ui.mouse");var t=e("./jquery.ui.widget");return t.widget("ui.draggable",t.ui.mouse,{version:"@VERSION",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var i=this.options;return this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(t(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",e,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"original"!==this.options.helper||t.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1):!1},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,s=this.options;return s.containment?"window"===s.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===s.containment?void(this.containment=[0,0,t(document).width()-this.helperProportions.width-this.margins.left,(t(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):s.containment.constructor===Array?void(this.containment=s.containment):("parent"===s.containment&&(s.containment=this.helper[0].parentNode),i=t(s.containment),n=i[0],void(n&&(e="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=i))):void(this.containment=null)},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,s="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:s.scrollTop(),left:s.scrollLeft()}),{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*n}},_generatePosition:function(e){var i,n,s,r,a=this.options,o="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=e.pageX,d=e.pageY;return this.offset.scroll||(this.offset.scroll={top:o.scrollTop(),left:o.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(n=this.relative_container.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(d=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(d=i[3]+this.offset.click.top)),a.grid&&(s=a.grid[1]?this.originalPageY+Math.round((d-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,d=i?s-this.offset.click.top>=i[1]||s-this.offset.click.top>i[3]?s:s-this.offset.click.top>=i[1]?s-a.grid[1]:s+a.grid[1]:s,r=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?r-this.offset.click.left>=i[0]||r-this.offset.click.left>i[2]?r:r-this.offset.click.left>=i[0]?r-a.grid[0]:r+a.grid[0]:r)),{top:d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i){var n=t(this).data("ui-draggable"),s=n.options,r=t.extend({},i,{item:n.element});n.sortables=[],t(s.connectToSortable).each(function(){var i=t.data(this,"ui-sortable");i&&!i.options.disabled&&(n.sortables.push({instance:i,shouldRevert:i.options.revert
}),i.refreshPositions(),i._trigger("activate",e,r))})},stop:function(e,i){var n=t(this).data("ui-draggable"),s=t.extend({},i,{item:n.element});t.each(n.sortables,function(){this.instance.isOver?(this.instance.isOver=0,n.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===n.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,s))})},drag:function(e,i){var n=t(this).data("ui-draggable"),s=this;t.each(n.sortables,function(){var r=!1,a=this;this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(r=!0,t.each(n.sortables,function(){return this.instance.positionAbs=n.positionAbs,this.instance.helperProportions=n.helperProportions,this.instance.offset.click=n.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&t.contains(a.instance.element[0],this.instance.element[0])&&(r=!1),r})),r?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(s).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=n.offset.click.top,this.instance.offset.click.left=n.offset.click.left,this.instance.offset.parent.left-=n.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=n.offset.parent.top-this.instance.offset.parent.top,n._trigger("toSortable",e),n.dropped=this.instance.element,n.currentItem=n.element,this.instance.fromOutside=n),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),n._trigger("fromSortable",e),n.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(){var e=t("body"),i=t(this).data("ui-draggable").options;e.css("cursor")&&(i._cursor=e.css("cursor")),e.css("cursor",i.cursor)},stop:function(){var e=t(this).data("ui-draggable").options;e._cursor&&t("body").css("cursor",e._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i){var n=t(i.helper),s=t(this).data("ui-draggable").options;n.css("opacity")&&(s._opacity=n.css("opacity")),n.css("opacity",s.opacity)},stop:function(e,i){var n=t(this).data("ui-draggable").options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(){var e=t(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var i=t(this).data("ui-draggable"),n=i.options,s=!1;i.scrollParent[0]!==document&&"HTML"!==i.scrollParent[0].tagName?(n.axis&&"x"===n.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-e.pageY<n.scrollSensitivity?i.scrollParent[0].scrollTop=s=i.scrollParent[0].scrollTop+n.scrollSpeed:e.pageY-i.overflowOffset.top<n.scrollSensitivity&&(i.scrollParent[0].scrollTop=s=i.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-e.pageX<n.scrollSensitivity?i.scrollParent[0].scrollLeft=s=i.scrollParent[0].scrollLeft+n.scrollSpeed:e.pageX-i.overflowOffset.left<n.scrollSensitivity&&(i.scrollParent[0].scrollLeft=s=i.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(document).scrollTop()<n.scrollSensitivity?s=t(document).scrollTop(t(document).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<n.scrollSensitivity&&(s=t(document).scrollTop(t(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(document).scrollLeft()<n.scrollSensitivity?s=t(document).scrollLeft(t(document).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<n.scrollSensitivity&&(s=t(document).scrollLeft(t(document).scrollLeft()+n.scrollSpeed)))),s!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(i,e)}}),t.ui.plugin.add("draggable","snap",{start:function(){var e=t(this).data("ui-draggable"),i=e.options;e.snapElements=[],t(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=t(this),n=i.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:n.top,left:n.left})})},drag:function(e,i){var n,s,r,a,o,l,d,c,u,h,p=t(this).data("ui-draggable"),m=p.options,f=m.snapTolerance,g=i.offset.left,A=g+p.helperProportions.width,F=i.offset.top,C=F+p.helperProportions.height;for(u=p.snapElements.length-1;u>=0;u--)o=p.snapElements[u].left,l=o+p.snapElements[u].width,d=p.snapElements[u].top,c=d+p.snapElements[u].height,o-f>A||g>l+f||d-f>C||F>c+f||!t.contains(p.snapElements[u].item.ownerDocument,p.snapElements[u].item)?(p.snapElements[u].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=!1):("inner"!==m.snapMode&&(n=Math.abs(d-C)<=f,s=Math.abs(c-F)<=f,r=Math.abs(o-A)<=f,a=Math.abs(l-g)<=f,n&&(i.position.top=p._convertPositionTo("relative",{top:d-p.helperProportions.height,left:0}).top-p.margins.top),s&&(i.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),r&&(i.position.left=p._convertPositionTo("relative",{top:0,left:o-p.helperProportions.width}).left-p.margins.left),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),h=n||s||r||a,"outer"!==m.snapMode&&(n=Math.abs(d-F)<=f,s=Math.abs(c-C)<=f,r=Math.abs(o-g)<=f,a=Math.abs(l-A)<=f,n&&(i.position.top=p._convertPositionTo("relative",{top:d,left:0}).top-p.margins.top),s&&(i.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),r&&(i.position.left=p._convertPositionTo("relative",{top:0,left:o}).left-p.margins.left),a&&(i.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[u].snapping&&(n||s||r||a||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,e,t.extend(p._uiHash(),{snapItem:p.snapElements[u].item})),p.snapElements[u].snapping=n||s||r||a||h)}}),t.ui.plugin.add("draggable","stack",{start:function(){var e,i=this.data("ui-draggable").options,n=t.makeArray(t(i.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});n.length&&(e=parseInt(t(n[0]).css("zIndex"),10)||0,t(n).each(function(i){t(this).css("zIndex",e+i)}),this.css("zIndex",e+n.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i){var n=t(i.helper),s=t(this).data("ui-draggable").options;n.css("zIndex")&&(s._zIndex=n.css("zIndex")),n.css("zIndex",s.zIndex)},stop:function(e,i){var n=t(this).data("ui-draggable").options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}}),t}),define("common/component/dialog/Dialog",["require","underscore","jquery","common/component/base/Dimmer","common/component/panel/Panel","common/component/base/OptionContainer","common/component/panel/trait/resizablePanelTrait","text!./template/dialogTemplate.htm","text!./template/dialogButtonTemplate.htm","jquery-ui/jquery.ui.draggable"],function(e){"use strict";var t=e("underscore"),i=e("jquery"),n=e("common/component/base/Dimmer"),s=e("common/component/panel/Panel"),r=e("common/component/base/OptionContainer"),a=e("common/component/panel/trait/resizablePanelTrait"),o=e("text!./template/dialogTemplate.htm"),l=e("text!./template/dialogButtonTemplate.htm");e("jquery-ui/jquery.ui.draggable");var d={},c=s.extend({defaultTemplate:o,events:{mousedown:"_focus",touchstart:"_focus",keydown:"_onKeyDown"},constructor:function(e){e||(e={}),e.traits||(e.traits=[]),this.resizable=e.resizable||!1,this.modal=e.modal||!1,this.additionalBodyCssClasses=e.additionalBodyCssClasses||"",this.resizable&&-1===t.indexOf(e.traits,a)&&e.traits.push(a),s.call(this,e)},initialize:function(e){d=t.extend({},e),this.collapsed=!this.collapsed,t.isEmpty(e.buttons)||(this.buttons=new r({options:e.buttons,el:this.$(".jr-mDialog-footer")[0]||this.$(".footer")[0],contextName:"button",optionTemplate:l})),s.prototype.initialize.apply(this,arguments),this.buttons&&this.listenTo(this.buttons,t.map(e.buttons,function(e){return"button:"+e.action}).join(" "),t.bind(function(e,t){this.trigger("button:"+t.get("action"),e,t)},this)),this.render()},getTemplateArguments:function(){var e=s.prototype.getTemplateArguments.apply(this,arguments);return t.extend(e,{additionalBodyCssClasses:this.additionalBodyCssClasses})},setElement:function(e){var t=s.prototype.setElement.apply(this,arguments);return this.buttons&&this.buttons.setElement(this.$(".jr-mDialog-footer")[0]||this.$(".footer")[0]),t},setTitle:function(e){this.$(".jr-mDialog-header > .jr-mDialog-header-title").text(e)},render:function(){return this.$el.hide(),this.modal&&(this.dimmer=new n({zIndex:900})),i("body").append(this.$el),this.$el.draggable({handle:".mover",addClasses:!1,containment:"document"}),this},open:function(e){return this.isVisible()?void 0:(s.prototype.open.apply(this,arguments),this.modal&&this.dimmer.css({zIndex:++c.highestIndex}).show(),d.additionalCssClasses&&-1!==d.additionalCssClasses.indexOf("newResizeableDialog")&&this._setMinSize(),this._position(e)._increaseZIndex(),this.buttons&&this.buttons.$(".over").removeClass("over"),this.$el.show(),this.trigger("dialog:visible"),this)},close:function(){return this.isVisible()?(this.$el.css({zIndex:--c.highestIndex}),this.modal&&this.dimmer.css({zIndex:--c.highestIndex}).hide(),this.$el.hide(),s.prototype.close.apply(this,arguments),this):void 0},addCssClasses:function(e){this.$el.addClass(e)},toggleCollapsedState:function(){return this},enableButton:function(e){this.buttons.enable(e)},disableButton:function(e){this.buttons.disable(e)},isVisible:function(){return this.$el.is(":visible")},_setMinSize:function(){d.minWidth&&this.$el.css({width:d.minWidth,minWidth:d.minWidth}),d.minHeight&&this.$el.css({height:d.minHeight,minHeight:d.minHeight})},_position:function(e){var t,n,s=i("body"),r=this.$el.height(),a=this.$el.width();if(e&&"undefined"!=typeof e.top&&"undefined"!=typeof e.left){t=e.top,n=e.left;var o=s.height(),l=s.width(),d=o-e.top,c=l-e.left;r>d&&(t=e.top-r,t=0>t?o/2-r/2:t),a>c&&(n=e.left-a,n=0>n?l/2-a/2:n)}else t=i(window).height()/2-r/2,n=i(window).width()/2-a/2;return this.$el.css({top:t,left:n,position:"absolute"}),this},_focus:function(){!this.modal&&this._increaseZIndex()},_increaseZIndex:function(){this.$el.css({zIndex:++c.highestIndex})},_onKeyDown:function(e){this.buttons._onKeyDown(e)},remove:function(){this.buttons&&this.buttons.remove(),this.dimmer&&this.dimmer.remove();try{this.$el.draggable("destroy")}catch(e){}s.prototype.remove.call(this)}},{highestIndex:1e3,resetHighestIndex:function(e){c.highestIndex=e||1e3}});return c}),define("text!common/component/dialog/template/alertDialogTemplate.htm",[],function(){return"<p class='alertText'>\n    {{- message }}\n</p>"}),define("common/component/dialog/AlertDialog",["require","underscore","./Dialog","common/util/xssUtil","text!./template/alertDialogTemplate.htm","bundle!js-sdk/CommonBundle"],function(e){"use strict";var t=e("underscore"),i=e("./Dialog"),n=e("common/util/xssUtil"),s=e("text!./template/alertDialogTemplate.htm"),r=e("bundle!js-sdk/CommonBundle");return i.extend({contentTemplate:t.template(s),constructor:function(e){e||(e={}),i.prototype.constructor.call(this,{modal:e.modal!==!1,message:e.message,additionalCssClasses:"alertDialog "+(e.additionalCssClasses||""),title:e.title||r["dialog.exception.title"],buttons:[{label:r["button.close"],action:"close",primary:!0}]},e)},initialize:function(e){i.prototype.initialize.apply(this,arguments),this.on("button:close",this.close),this.setMessage(e.message)},setMessage:function(e){e=n.escape(e,{softHTMLEscape:!0,whiteList:["br"]}),this.content=this.contentTemplate({message:e});var t=this.renderContent();this.$contentContainer.html(t)}})}),define("dataSource/model/AwsDataSourceModel",["require","dataSource/model/JdbcDataSourceModel","dataSource/model/BaseDataSourceModel","dataSource/collection/JdbcDriverCollection","settings!dataSourcePatterns","dataSource/enum/connectionTypes","bi/repository/enum/repositoryResourceTypes","underscore","jquery","bundle!jasperserver_messages","settings!awsSettings","bundle!jasperserver_config","dataSource/util/settingsUtility"],function(e){"use strict";var t=e("dataSource/model/JdbcDataSourceModel"),i=e("dataSource/model/BaseDataSourceModel"),n=e("dataSource/collection/JdbcDriverCollection"),s=e("settings!dataSourcePatterns"),r=e("dataSource/enum/connectionTypes"),a=e("bi/repository/enum/repositoryResourceTypes"),o=e("underscore"),l=e("jquery"),d=e("bundle!jasperserver_messages"),c=e("settings!awsSettings"),u=e("bundle!jasperserver_config"),h=e("dataSource/util/settingsUtility"),p=t.extend({otherDriverIsPresent:!1,type:a.AWS_DATA_SOURCE,defaults:function(){var e={};return o.extend(e,t.prototype.defaults,{dbName:"",dbInstanceIdentifier:"",dbService:"",accessKey:"",secretKey:"",roleArn:"",region:"",credentialsType:"",connectionType:r.AWS}),e}(),validation:function(){var e={};return o.extend(e,{connectionUrl:[{required:!0,msg:d["ReportDataSourceValidator.error.not.empty.reportDataSource.connectionUrl"]},{xRegExpPattern:XRegExp(s.forbidWhitespacesPattern),msg:d["ReportDataSourceValidator.error.invalid.chars.reportDataSource.connectionUrl"]}],username:[{required:!0,msg:d["ReportDataSourceValidator.error.not.empty.reportDataSource.username"]}],driverClass:[{required:!0,msg:d["ReportDataSourceValidator.error.not.empty.reportDataSource.driverClass"]},{xRegExpPattern:XRegExp(s.forbidWhitespacesPattern),msg:d["ReportDataSourceValidator.error.invalid.chars.reportDataSource.driverClass"]},{fn:function(e,t,i){var n=new RegExp(s.attributePlaceholderPattern).test(e);if(!n){var r=this.drivers.getDriverByClass(e);if(!r||!r.get("available"))return d["ReportDataSourceValidator.error.not.empty.reportDataSource.driverNotInstalled"]}}}],dbName:[{required:!0,msg:d["ReportDataSourceValidator.error.not.empty.reportDataSource.dbNameIsEmpty"]}],region:[{required:!0}],accessKey:[{fn:function(e,t,i){return i.credentialsType===p.credentialsType.AWS&&(o.isNull(e)||o.isUndefined(e)||o.isString(e)&&""===e)?d["fillParameters.error.mandatoryField"]:void 0}}],secretKey:[{fn:function(e,t,i){return i.credentialsType===p.credentialsType.AWS&&(o.isNull(e)||o.isUndefined(e)||o.isString(e)&&""===e)?d["fillParameters.error.mandatoryField"]:void 0}}]}),e}(),initialize:function(e,t){i.prototype.initialize.apply(this,arguments);var s=h.deepDefaults(t,{awsSettings:c});this.isNew()?this.set("region",o.first(s.awsSettings.awsRegions)):(this.set("password",u["input.password.substitution"]),this.set("secretKey",u["input.password.substitution"])),this.set("credentialsType",!s.awsSettings.isEc2Instance||s.awsSettings.suppressEc2CredentialsWarnings||""!==this.get("accessKey")?p.credentialsType.AWS:p.credentialsType.EC2),this.initialization=l.Deferred(),this.drivers=new n([],this.options);var r=this;this.drivers.fetch({reset:!0}).done(function(){r.initialization.resolve()}),this.on("change:dbName change:dbPort change:dbHost change:sName change:connectionUrlTemplate",this.updateConnectionUrl),this.on("change:credentialsType",this.changeCredentialsType)},updateConnectionUrl:function(){if(this.get("connectionUrlTemplate")){var e=this.pick(["dbName","dbPort","dbHost","sName"]);e.sName||(e.sName=e.dbName);var t=this.replaceConnectionUrlTemplatePlaceholdersWithValues(this.get("connectionUrlTemplate"),e);this.set("connectionUrl",t)}},changeCredentialsType:function(){var e=this.get("credentialsType")===p.credentialsType.EC2;e&&this.set({accessKey:"",secretKey:"",roleArn:""})},toJSON:function(){var e=t.prototype.toJSON.apply(this,arguments);return this.options.isEditMode&&e.secretKey===u["input.password.substitution"]&&(e.secretKey=null),e},getFullDbTreePath:function(){return this.get("dbInstanceIdentifier")&&this.get("dbService")?"/"+this.get("dbService")+"/"+this.get("dbInstanceIdentifier"):null}},{credentialsType:{EC2:"ec2",AWS:"aws"}});return p});var dynamicTree={trees:{},nodes:{},treeNodeEdited:null,editaborted:!1,activeTreeId:null,Tree:function(e,t){this.id=e,t?(this.setRootNode(t.root),this.bShowRoot=!!t.bShowRoot,this.handleNodeOnDblclick=void 0!==t.handleNodeOnDblclick?t.handleNodeOnDblclick:!0,this.multiSelectEnabled=!!t.multiSelectEnabled,this.showAllNodesOnStartup=!!t.showAllNodesOnStartup,this.treeClassName=t.treeClassName?t.treeClassName:"",this.dragPattern=t.dragPattern,this.dragClasses=t.dragClasses,this.dropClasses=t.dropClasses,this.selectOnMousedown=t.selectOnMousedown,this.regionID=t.regionID,this.scroll=t.scroll,this.templateDomId=t.templateDomId?t.templateDomId:this.DEFAULT_TREE_TEMPLATE_ID):(this.templateDomId=this.DEFAULT_TREE_TEMPLATE_ID,this.handleNodeOnDblclick=!0),this.stateObject={},this.sortNodes=!0,this.sorters=[this.sortByOrder,this.sortByName],this.selectedNodes=[],this.TREE_NN_ITEMS_SELECTED="#{count} items selected",dynamicTree.trees[this.id]=this,this._createFromTemplate(),this.refreshStyle(),this._registerEvents(),this._registerCustomScroll()},getNextId:function(){var e=1;return function(){return e++}}(),getActiveTree:function(){return dynamicTree.trees[dynamicTree.activeTreeId]},getTreeNode:function(e){return dynamicTree.nodes[e]},getStorageVal:function(e){var t=JSON.parse(window.localStorage.getItem("dynamicTree"))||{};return t[e]||null},setStorageVal:function(e,t){var i=window.localStorage,n=JSON.parse(i.getItem("dynamicTree"))||{};n[e]=t;try{i.setItem("dynamicTree",JSON.stringify(n))}catch(s){window.console&&console.log(s)}},_templateHash:{}};dynamicTree.Tree.addVar("DEFAULT_TREE_TEMPLATE_ID","list_responsive_collapsible"),dynamicTree.Tree.addVar("HIDE_ROOT_CLASS_NAME","hideRoot"),dynamicTree.Tree.addMethod("getId",function(){return this.id}),dynamicTree.Tree.addMethod("_getElement",function(){return this._element||(this._element=$(this.id)),this._element}),dynamicTree.Tree.addMethod("_createFromTemplate",function(){this._getElement()&&(this._getElement().insert({after:this._getTemplateElement(this._getElement())}),this._getElement().remove(),this._element=null,this._getElement().update())}),dynamicTree.Tree.addMethod("_registerCustomScroll",function(){if(!this.scroll&&this._getElement()){var e=this._getElement().up(layoutModule.SWIPE_SCROLL_PATTERN);if(e){var t=layoutModule.scrolls.get(e.identify());t&&(this.scroll=t)}}}),dynamicTree.Tree.addMethod("setRootNode",function(e){this.rootNode=e,this.rootNode&&(this.rootNode.treeId=this.id)}),dynamicTree.Tree.addMethod("getRootNode",function(){return this.rootNode}),dynamicTree.Tree.addMethod("refreshStyle",function(){var e=this._getElement();e.templateClassName&&(e.className=e.templateClassName),this.treeClassName&&e.addClassName(this.treeClassName),this.bShowRoot?e.removeClassName(this.HIDE_ROOT_CLASS_NAME):e.addClassName(this.HIDE_ROOT_CLASS_NAME)}),dynamicTree.Tree.addMethod("resetSelected",function(){this._prevSelectedNodes=this.selectedNodes.clone(),this.selectedNodes=[]}),dynamicTree.Tree.addMethod("revertSelection",function(e){var t=this._prevSelectedNodes.clone();t=t.concat(this.selectedNodes),this.selectedNodes=this._prevSelectedNodes.clone();for(var i=0;i<t.length;i++)t[i].refreshStyle()}),dynamicTree.Tree.addMethod("getSelectedNode",function(){return 0===this.selectedNodes.length?null:this.selectedNodes[0]}),dynamicTree.Tree.addMethod("addNodeToSelected",function(e){this.selectedNodes.push(e),this._prevSelectedNodes=this.selectedNodes.clone()}),dynamicTree.Tree.addMethod("removeNodeFromSelected",function(e){for(var t=0;t<this.selectedNodes.length;t++)if(this.selectedNodes[t]==e)return this._prevSelectedNodes=this.selectedNodes.clone(),void this.selectedNodes.splice(t,1)}),dynamicTree.Tree.addMethod("isNodeSelected",function(e){var t=this.selectedNodes&&this.selectedNodes.length;if(t)for(var i=0;t>i;i++)if(this.selectedNodes[i]==e)return!0;return!1}),dynamicTree.Tree.addMethod("resortSubtree",function(e){if(e){e.resortChilds();for(var t=0;t<e.childs.length;t++)this.resortSubtree(e.childs[t])}}),dynamicTree.Tree.addMethod("resortTree",function(){this.sortNodes&&this.resortSubtree(this.rootNode)}),dynamicTree.Tree.addMethod("readStates",function(){var e=dynamicTree.getStorageVal("tree"+this.id);if(e)for(var t in e)this.stateObject[t]=e[t]}),dynamicTree.Tree.addMethod("getState",function(e){var t,i=this.stateObject;return i[e]?(t=i[e],(null===t||""===t)&&(t=dynamicTree.TreeNode.State.CLOSED),t):dynamicTree.TreeNode.State.CLOSED}),dynamicTree.Tree.addMethod("writeStates",function(e,t){var i={},n=this.stateObject;for(var s in n)i[s]=n[s];n[e]=t,null!=t&&(i[e]=t),dynamicTree.setStorageVal("tree"+this.id,i)}),dynamicTree.Tree.addMethod("resetStates",function(){this.stateObject={},dynamicTree.setStorageVal("tree"+this.id,"")}),dynamicTree.Tree.addMethod("comparer",function(e,t){var i,n;if(this.sorters&&this.sorters.length)for(i=0;i<this.sorters.length;i++)if(n=this.sorters[i](e,t),0!==n)return n;return 0}),dynamicTree.Tree.addMethod("renderTree",function(){this.readStates(),this.stopWaiting(),this.refreshStyle();var e=this._getElement();this.rootNode&&(this.writeStates(this.rootNode.id,dynamicTree.TreeNode.State.OPEN),this.rootNode.showNode(),this.rootNode.render(e),this.refreshScroll())}),dynamicTree.Tree.addMethod("refreshScroll",function(e){e?setTimeout(function(){this.scroll&&this.scroll.refresh()}.bind(this),e):this.scroll&&this.scroll.refresh()}),dynamicTree.Tree.addMethod("binarySearchOfNode",function(e,t){for(var i=0,n=e.length-1;n>=i;){var s=Math.round((i+n)/2),r=e[s];if(this.comparer(r,t)<0)i=s+1;else{if(!(this.comparer(r,t)>0))return s;n=s-1}}return-(i+1)}),dynamicTree.Tree.addMethod("_deselectAllNodes",function(e){if(this.selectedNodes.length>0){var t=this.selectedNodes.clone();this.resetSelected();for(var i=0;i<t.length;i++)t[i].refreshStyle();if(e){var n=dynamicTree.trees[this.id];n.fireUnSelectAllEvent(e)}}}),dynamicTree.Tree.addMethod("_selectOrEditNode",function(e,t,i,n,s,r){var a,o,l,d=t.isSelected()&&s,c=this.multiSelectEnabled&&t.isSelected()&&i&&!d,u=t.isSelected()&&dynamicTree.treeNodeEdited!==t&&!this.multiSelectEnabled&&!i&&!d,h=null!=dynamicTree.treeNodeEdited&&(f||c),p=this.multiSelectEnabled&&!t.isSelected()&&n&&isNotNullORUndefined(this._lastSelectedNode)&&this._lastSelectedNode.parent===t.parent,m=this.multiSelectEnabled&&t.isSelected()&&n&&isNotNullORUndefined(this._lastSelectedNode)&&this._lastSelectedNode.parent===t.parent,f=!this.multiSelectEnabled&&!t.isSelected()||this.multiSelectEnabled&&!i&&!t.isSelected(),g=!t.isSelected()||f&&this.selectedNodes.length>1;if(n&&this._lastSelectedNode||(this._lastSelectedNode=t),c&&t.deselect(e),f&&this._deselectAllNodes(e),u)return void t.edit(e);if(h&&dynamicTree.treeNodeEdited.doEndEdit(e),p||m){l=t.parent;var A=l.childs.indexOf(this._lastSelectedNode),F=l.childs.indexOf(t);a=Math.min(A,F),o=Math.max(A,F)}if(p)if(a>-1)for(var C=a;o>=C;C++)l.childs[C].select(e);else l.childs[o].select(e);else if(m){for(var C=0;a>C;C++)l.childs[C].deselect(e);for(var C=o+1;C<l.childs.length;C++)l.childs[C].deselect(e)}else g&&t.select(e,t.nofocus,r)}),dynamicTree.Tree.addMethod("_deselectOthers",function(e,t,i,n,s){var r=this.multiSelectEnabled&&this.selectedNodes.length>1&&t.isSelected()&&!(i||n||s);r&&this.selectedNodes.findAll(function(e){return e!=t}.bind(this)).invoke("deselect",e)}),dynamicTree.Tree.addMethod("_selectNextNode",function(e,t){function i(e){return e=e.parent,e?e.nextSibling?e.nextSibling:i(e):null}var n=e.isOpen()&&e.getFirstChild()||e.nextSibling||i(e);n&&e.deselect()&&n.select(t)}),dynamicTree.Tree.addMethod("_selectPreviousNode",function(e,t){function i(e){return!(e.isOpen()&&e.hasChilds())&&e||i(e.getLastChild())}var n=e.prevSibling&&i(e.prevSibling)||e.parent;n&&e.deselect()&&n.select(t)}),dynamicTree.Tree.addMethod("_selectInwards",function(e,t){var i=e.isOpen()&&e.getFirstChild();i?e.deselect()&&i.select(t):e.handleNode(t)}),dynamicTree.Tree.addMethod("_selectOutwards",function(e,t){if(!e.isHiddenRootNode()){var i=e.isOpen()?null:e.parent;i?e.deselect()&&i.select(t):e.handleNode(t)}}),dynamicTree.Tree.addMethod("sortByOrder",function(e,t){var i=e.orderNumber,n=t.orderNumber;return null==i&&null==n?0:null==i?1:null==n?-1:i-n}),dynamicTree.Tree.addMethod("sortByName",function(e,t){var i=e.name.toLowerCase(),n=t.name.toLowerCase();return i>n?1:n>i?-1:0}),dynamicTree.Tree.addVar("TREE_WAIT_TEMPLATE_DOM_ID","list_responsive_collapsible:loading"),dynamicTree.Tree.addMethod("wait",function(){$(this.id).update($(this.TREE_WAIT_TEMPLATE_DOM_ID).cloneNode(!0))}),dynamicTree.Tree.addMethod("stopWaiting",function(){$(this.id).update("")}),dynamicTree.Tree.addMethod("_getTemplateElement",function(e){var t=this.templateDomId,i=$(t).cloneNode(!0);return i.writeAttribute("id",this.getId()),i.templateId=t,i.templateClassName=i.className,cloneCustomAttributes(e,i),i}),define("dynamicTree.tree",["prototype","dragdrop.extra","touchcontroller","utils.common","core.layout"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.TreeNode=function(e){this.id=dynamicTree.getNextId(),this.treeId=null,this.name=null!=e.name?e.name:this.DEFAULT_NAME,this.param=null!=e.param?e.param:{},this.orderNumber=null!=e.orderNumber?e.orderNumber:null,this.childs=[],this.parent=null,this.Types={Folder:new dynamicTree.TreeNode.Type(this.FOLDER_TYPE_NAME)},this.isloaded=!1,this.delayedRendering=!0,this.haschilds=!1,this.editable=!1,this.isWaiting=!1,this.hidden=!1,this.isDropTarget=!1,dynamicTree.nodes[this.id]=this},dynamicTree.TreeNode.Type=function(e,t){this.name=e,t&&(this.cssClassName=t.cssClassName,this.templateDomId=t.templateDomId)},dynamicTree.TreeNode.State={OPEN:"open",CLOSED:"closed"},dynamicTree.TreeNode.addVar("FOLDER_TYPE_NAME","com.jaspersoft.jasperserver.api.metadata.common.domain.Folder"),dynamicTree.TreeNode.addVar("DEFAULT_NAME","unset name"),dynamicTree.TreeNode.addVar("NODE_ID_PREFIX","node"),dynamicTree.TreeNode.addVar("SUB_NODE_ID_SUFFIX","sub"),dynamicTree.TreeNode.addVar("HANDLER_ID_PREFIX","handler"),dynamicTree.TreeNode.addVar("NODE_CLASS_NAME","node").addVar("LEAF_CLASS_NAME","leaf").addVar("OPEN_CLASS_NAME","open").addVar("CLOSED_CLASS_NAME","closed").addVar("SELECTED_CLASS_NAME","selected").addVar("LOADING_CLASS_NAME","loading").addVar("ROOTS_CLASS_NAME","roots"),dynamicTree.TreeNode.addVar("nodeHeaderTemplateDomId","list_responsive_collapsible:leaf"),dynamicTree.TreeNode.addVar("nodeFooterTemplateDomId","list_responsive_collapsible"),dynamicTree.TreeNode.addVar("nodeInputTemplateDomId","list_responsive_collapsible:input"),dynamicTree.TreeNode.addVar("isSelectable",!1),dynamicTree.TreeNode.addMethod("getTreeId",function(){return this.treeId||this.parent&&this.parent.getTreeId()}),dynamicTree.TreeNode.addMethod("getState",function(){return dynamicTree.trees[this.getTreeId()].getState(this.id)}),dynamicTree.TreeNode.addMethod("isParent",function(){return this.param.type==this.Types.Folder.name}),dynamicTree.TreeNode.addMethod("addChild",function(e){if(this.isParent()){var t=this.childs[this.childs.length-1];t&&(t.nextSibling=e,e.prevSibling=t),this.childs.push(e),e.parent=this,this.resortChilds(),this.delayedRendering||(e.showNode(),e.render(this._getChildrenElement(),e.nextSibling))}}),dynamicTree.TreeNode.addMethod("removeChild",function(e){for(var t=0;t<this.childs.length;t++)if(this.childs[t]==e){this.childs.splice(t,1);break}if(e.deselect(),!this.delayedRendering){var i=e._getElement();i&&i.remove()}}),dynamicTree.TreeNode.addMethod("resortChilds",function(){var e=this.getTreeId(),t=dynamicTree.trees[e];if(t&&t.sortNodes&&isArray(this.childs)){this.childs.sort(function(e,i){return t.comparer(e,i)});for(var i=this.childs.length;i--;){var n=this.childs[i];n.prevSibling=this.childs[i-1],n.nextSibling=this.childs[i+1]}}}),dynamicTree.TreeNode.addMethod("resetChilds",function(){this.childs=[]}),dynamicTree.TreeNode.addMethod("setHasChilds",function(e){this.haschilds=e}),dynamicTree.TreeNode.addMethod("hasChilds",function(){return this.haschilds?!0:this.getChildCount()>0}),dynamicTree.TreeNode.addMethod("getChildCount",function(){return this.childs.length}),dynamicTree.TreeNode.addMethod("getFirstChild",function(){return this.hasChilds()?this.childs[0]:null}),dynamicTree.TreeNode.addMethod("getLastChild",function(){return this.hasChilds()?this.childs[this.childs.length-1]:null}),dynamicTree.TreeNode.addMethod("_getElement",function(e){return this._element||(this._element=$(this.NODE_ID_PREFIX+this.id)),this._element}),dynamicTree.TreeNode.addMethod("_getTitle",function(){var e=this._getElement().childElements()[0];e.cleanWhitespace();var t=e.childNodes[e.childNodes.length-1];return"#text"!==t.nodeName&&(t=document.createTextNode(""),e.appendChild(t)),t}),dynamicTree.TreeNode.addMethod("_getTitleInputElement",function(){return $(this._getElement().getElementsByTagName("input")[0])}),dynamicTree.TreeNode.addMethod("_getChildrenElement",function(){return this._childrenElement||(this._childrenElement=$(this.NODE_ID_PREFIX+this.id+this.SUB_NODE_ID_SUFFIX)),this._childrenElement}),dynamicTree.TreeNode.addMethod("isOpen",function(){return this.getState()===dynamicTree.TreeNode.State.OPEN}),dynamicTree.TreeNode.addMethod("changeName",function(e){this.name=e,this._getTitle().data=this.name}),dynamicTree.TreeNode.addMethod("getType",function(){for(var e in this.Types)if(this.param.type===this.Types[e].name)return this.Types[e]}),dynamicTree.TreeNode.addMethod("refreshStyle",function(e){if(e=$(e)||this._getElement()){e.templateClassName&&(e.className=e.templateClassName),this.isParent()?(e.addClassName(this.NODE_CLASS_NAME).removeClassName(this.LEAF_CLASS_NAME),this.isWaiting||(this.isOpen()?e.addClassName(this.OPEN_CLASS_NAME).removeClassName(this.CLOSED_CLASS_NAME):e.addClassName(this.CLOSED_CLASS_NAME).removeClassName(this.OPEN_CLASS_NAME))):e.addClassName(this.LEAF_CLASS_NAME).removeClassName(this.NODE_CLASS_NAME),this.isWaiting?e.addClassName(this.LOADING_CLASS_NAME):e.removeClassName(this.LOADING_CLASS_NAME),this.isSelected()?e.addClassName(this.SELECTED_CLASS_NAME):e.removeClassName(this.SELECTED_CLASS_NAME),this.hidden?e.addClassName(layoutModule.HIDDEN_CLASS):e.removeClassName(layoutModule.HIDDEN_CLASS),this.param.cssClass&&e.addClassName(this.param.cssClass);var t=this.getType();t&&t.cssClassName&&e.addClassName(t.cssClassName);var i=e.down();this.isDropTarget&&i&&i.addClassName(layoutModule.DROP_TARGET_CLASS),!this.isDropTarget&&i&&i.removeClassName(layoutModule.DROP_TARGET_CLASS)}}),dynamicTree.TreeNode.addMethod("_createNode",function(){var e=this.id,t=dynamicTree.trees[this.getTreeId()],i=this._getHeaderTemplateElement();i.id=this.NODE_ID_PREFIX+e,i.tabIndex=-1,this.refreshStyle(i),this.treeId=t.id,i.treeNode=this;var n=i.childElements()[0];n.insert(xssUtil.escape(this.name,{softHTMLEscape:!0,whiteList:["a"]})),null!=this.tooltip&&this.tooltip.length>0&&(n.title=this.tooltip),n.childElements().each(function(t,i){0===i&&(t.id=this.HANDLER_ID_PREFIX+e);var n=this.iconTooltip;n&&(t.title=isArray(n)?n[i]:n)}.bind(this)),this._element=i}),dynamicTree.TreeNode.addMethod("_createNodeChildren",function(){var e=this._getFooterTemplateElement();e.id=this.NODE_ID_PREFIX+this.id+this.SUB_NODE_ID_SUFFIX,
this._childrenElement=e}),dynamicTree.TreeNode.addMethod("showNode",function(e){var t=dynamicTree.trees[this.getTreeId()];if(this._createNode(),this.isParent()){var i=this.isOpen()||t.showAllNodesOnStartup;if(i){this._createNodeChildren();for(var n=0;n<this.getChildCount();n++)this.childs[n].showNode(this._getChildrenElement());this.delayedRendering=!1,t.fireOpenEvent(this)}}this.render(e)}),dynamicTree.TreeNode.addMethod("render",function(e,t){if(!Object.isUndefined(e)){var i=$(e);i&&(this._getChildrenElement()&&this._getElement().insert(this._getChildrenElement()),t?i.insert(this._getElement(),{before:t._getElement()}):i.insert(this._getElement()))}}),dynamicTree.TreeNode.addMethod("_renderChildren",function(){var e=this._getElement();e&&this._getChildrenElement()&&e.insert(this._getChildrenElement())}),dynamicTree.TreeNode.addMethod("refreshNode",function(){if(this.refreshStyle(),this.isParent()&&this.isOpen()&&this.isloaded){this.delayedRendering?(this._createNodeChildren(),this._renderChildren()):this._getChildrenElement().update("");for(var e=0;e<this.getChildCount();e++)this.childs[e].showNode(this._getChildrenElement());this.delayedRendering=!1}var t=dynamicTree.trees[this.getTreeId()];t.refreshScroll()}),dynamicTree.TreeNode.addMethod("wait",function(){this.isWaiting=!0,this.refreshStyle()}),dynamicTree.TreeNode.addMethod("stopWaiting",function(){this.isWaiting=!1,this.refreshStyle()}),dynamicTree.TreeNode.addMethod("isHiddenRootNode",function(){var e=dynamicTree.trees[this.getTreeId()];return e.rootNode==this&&!e.bShowRoot}),dynamicTree.TreeNode.addMethod("deselect",function(e){var t=dynamicTree.trees[this.getTreeId()];return t&&this.isSelected()?(t.removeNodeFromSelected(this),this.refreshStyle(),e&&t.fireUnSelectEvent(this,e),!0):!1}),dynamicTree.TreeNode.addMethod("select",function(e,t,i){if(i=i||{},!t&&this.focus(),this.isSelected())return!1;var n=dynamicTree.trees[this.getTreeId()];return n.addNodeToSelected(this),this.refreshStyle(),!i.silent&&n.fireSelectEvent(this,e),!0}),dynamicTree.TreeNode.addMethod("focus",function(){var e=this;!isIPad()&&this._getElement()&&setTimeout(function(){e._getElement().focus()},100)}),dynamicTree.TreeNode.addMethod("isSelected",function(){var e=dynamicTree.trees[this.getTreeId()];return e&&e.isNodeSelected(this)}),dynamicTree.TreeNode.addMethod("_removeTitle",function(){var e=this._getTitle();e.data="",$(e.parentNode).cleanWhitespace()}),dynamicTree.TreeNode.addMethod("edit",function(e){if(this.editable){if(dynamicTree.treeNodeEdited==this)return;dynamicTree.treeNodeEdited=this;var t=this.name,i=$(this._getTitle().parentNode),n=this._getInputTemplateElement();this._getTitle().data="",i.cleanWhitespace(),i.insert(n),n.value=xssUtil.unescape(this.name),n.focus(),n.select(e),n.onclick=function(e){cancelEventBubbling(e)},n.ondblclick=function(e){cancelEventBubbling(e)},n.onmousedown=function(e){cancelEventBubbling(e)},n.onmouseup=function(e){cancelEventBubbling(e)},n.onkeydown=function(e){var i=window.event?window.event:e;13==i.keyCode?(n.onblur=null,this.doEndEdit(i)):27==i.keyCode&&(n.onblur=null,n.value=t,this.doEndEdit(i))}.bindAsEventListener(this),n.onblur=function(e){this.doEndEdit(e)}.bindAsEventListener(this),dynamicTree.trees[this.getTreeId()].fireStartEditEvent(this,n)}}),dynamicTree.TreeNode.addMethod("doEndEdit",function(e){this.editEnded(),dynamicTree.trees[this.getTreeId()].fireEndEditEvent(this)}),dynamicTree.TreeNode.addMethod("editEnded",function(){var e=dynamicTree.trees[this.getTreeId()];if(null!=dynamicTree.treeNodeEdited){var t=this._getTitleInputElement(),i=($(t.parentNode),t.value);if(i==dynamicTree.treeNodeEdited.name)return t.remove(),this._getTitle().data=dynamicTree.treeNodeEdited.name,void(dynamicTree.treeNodeEdited=null);e.fireEditEvent(dynamicTree.treeNodeEdited,i),dynamicTree.editaborted||(dynamicTree.treeNodeEdited.name=i,t.remove(),this._getTitle().data=i),dynamicTree.treeNodeEdited=null}}),dynamicTree.TreeNode.addMethod("scroll",function(e){var t=dynamicTree.trees[this.getTreeId()].rootNode._getElement(),i=e?$(e):$(t.parentNode),n=this._getElement();if(i){var s=i.clientHeight,r=i.clientWidth,a=i.scrollTop,o=i.scrollLeft,l=n.cumulativeOffset().top-i.cumulativeOffset().top,d=n.offsetLeft,c=n.clientHeight,u=n.clientWidth;l>a+s?i.scrollTop=l-(s/2-c/2):a>l+c&&(i.scrollTop=l-(s/2-c/2)),d>o+r?i.scrollLeft=d-(r/2-u/2):o>d+u&&(i.scrollTop=d-(r/2-u/2))}}),dynamicTree.TreeNode.addMethod("handleNode",function(e){if(this.isParent()){var t=dynamicTree.trees[this.getTreeId()];this.isOpen()?t.writeStates(this.id,dynamicTree.TreeNode.State.CLOSED):(t.writeStates(this.id,dynamicTree.TreeNode.State.OPEN),t.fireOpenEvent(this,e)),this.refreshNode()}}),dynamicTree.TreeNode.addMethod("openNode",function(e){if(this.isParent()){var t=dynamicTree.trees[this.getTreeId()];this.isOpen()||(t.writeStates(this.id,dynamicTree.TreeNode.State.OPEN),t.fireOpenEvent(this,e)),this.refreshNode()}}),dynamicTree.TreeNode.addMethod("_getHeaderTemplateElement",function(){var e=this.getType(),t=e&&e.templateDomId?e.templateDomId:this.nodeHeaderTemplateDomId,i=$(t).cloneNode(!0);return i.templateId=t,i.templateClassName=i.className,i}),dynamicTree.TreeNode.addMethod("_getFooterTemplateElement",function(){var e=this.nodeFooterTemplateDomId,t=$(e).cloneNode(!0);return t.templateId=e,t.update(""),t}),dynamicTree.TreeNode.addMethod("_getInputTemplateElement",function(){var e=this.nodeInputTemplateDomId,t=$(e).cloneNode(!0);return t.templateId=e,t}),define("dynamicTree.treenode",["prototype","underscore","dynamicTree.tree"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.Tree.addVar("NODE_PATTERN",".node").addVar("NODE_WRAPPER_PATTERN",".node > .wrap").addVar("NODE_ICON_PATTERN",".node > .wrap .icon").addVar("NODE_CUSTOM_PATTERNS",[]),dynamicTree.Tree.addVar("LEAF_PATTERN",".leaf").addVar("LEAF_WRAPPER_PATTERN",".leaf > .wrap").addVar("LEAF_ICON_PATTERN",".leaf > .wrap .icon").addVar("LEAF_CUSTOM_PATTERNS",[]),dynamicTree.Tree.addVar("EXPANDING_TIME",1e3),dynamicTree.Tree.addVar("draggables",[]),dynamicTree.Tree.addMethod("getTreeNodeByEvent",function(e){var t=Event.element(e);return this.getTreeNodeByElement(t)}),dynamicTree.Tree.addMethod("getTreeNodeByElement",function(e){for(;e&&e.readAttribute&&e.readAttribute("id")!==this.id;){var t=e.treeNode;if(t&&t.getTreeId()===this.getId())return t;e=$(e.parentNode)}return null}),dynamicTree.Tree.addMethod("isNodeEvent",function(e){var t=matchMeOrUp(e.element().parentNode,"LI");return t&&t.hasClassName(layoutModule.NODE_CLASS)}),dynamicTree.Tree.addMethod("isLeafEvent",function(e){var t=matchMeOrUp(e.element().parentNode,"LI");return t&&t.hasClassName(layoutModule.LEAF_CLASS)}),dynamicTree.Tree.addMethod("isIconEvent",function(e){return e.element().hasClassName(layoutModule.ICON_CLASS)}),dynamicTree.Tree.addMethod("_registerEvents",function(){this._cleanUpListeners(),this._registerClickEvents(),this._registerCustomEvents(),this._registerKeyEvents(),this._registerMouseEvents()}),dynamicTree.Tree.addMethod("_cleanUpListeners",function(){var e=this._getElement();e.stopObserving("click"),e.stopObserving("dblclick"),isSupportsTouch()?(e.stopObserving("touchstart"),e.stopObserving("drag:touchstart"),e.stopObserving("touchend")):(e.stopObserving("mousedown"),e.stopObserving("drag:mousedown"),e.stopObserving("mouseup")),e.stopObserving("mouseover"),e.stopObserving("mouseout")}),dynamicTree.Tree.addMethod("_registerClickEvents",function(){var e=this._getElement();e.observe("click",function(t){var i=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(i){var n=this.isIconEvent(t),s=this.isNodeEvent(t),r=this.isLeafEvent(t);s?(n&&e.fire("nodeIcon:click",{targetEvent:t,node:i}),e.fire("node:click",{targetEvent:t,node:i})):r&&(n&&e.fire("nodeIcon:click",{targetEvent:t,node:i}),e.fire("leaf:click",{targetEvent:t,node:i})),!isIPad()&&s&&n&&i.handleNode(t)}}.bindAsEventListener(this)),e.observe("dblclick",function(t){var i=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(i){var n=this.isIconEvent(t),s=this.isNodeEvent(t),r=this.isLeafEvent(t);s?(n&&e.fire("nodeIcon:dblclick",{targetEvent:t,node:i}),e.fire("node:dblclick",{targetEvent:t,node:i})):r&&(n&&e.fire("leafIcon:dblclick",{targetEvent:t,node:i}),e.fire("leaf:dblclick",{targetEvent:t,node:i})),this.handleNodeOnDblclick&&(s||r)&&!n&&i.handleNode(t)}}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("_registerMouseEvents",function(){var e=this._getElement();e.observe(isSupportsTouch()?"touchstart":"mousedown",function(t){var i=t.element(),n=matchMeOrUp(i,layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(n){t.treeEvent=!0;var s=this.isIconEvent(t),r=this.isNodeEvent(t),a=this.isLeafEvent(t);if(isSupportsTouch())if(JRS.vars.ajax_in_progress)alert("please wait");else if(this.twofingers=!1,2==t.touches.length&&(this.twofingers=!0,this._selectOrEditNode(t,n,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),n.isSelected()||designerBase&&designerBase.isInSelection(n))){var o=jQuery(i).parents("li:first");return void(o.hasClass("selected")&&document.fire(layoutModule.ELEMENT_CONTEXTMENU,{targetEvent:t,node:i}))}isSupportsTouch()&&JRS.vars.ajax_in_progress||(!this.selectOnMousedown||isSupportsTouch()&&1!=t.touches.length||this._selectOrEditNode(t,n,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),r?(s&&e.fire("nodeIcon:mousedown",{targetEvent:t,node:n}),e.fire("node:mousedown",{targetEvent:t,node:n})):a&&(s&&e.fire("leafIcon:mousedown",{targetEvent:t,node:n}),e.fire("leaf:mousedown",{targetEvent:t,node:n})))}}.bindAsEventListener(this)),e.observe(isSupportsTouch()?"drag:touchstart":"drag:mousedown",function(t){var i=t.memo.targetEvent,n=matchMeOrUp(i.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(i);if(n){i.treeEvent=!0;var s=this.isIconEvent(i),r=this.isNodeEvent(i),a=this.isLeafEvent(i);this.selectOnMousedown&&!isRightClick(i)&&this._selectOrEditNode(i,n,isMetaHeld(i),isShiftHeld(i),isRightClick(i)),r?(s&&e.fire("nodeIcon.drag:mousedown",{targetEvent:i,node:n}),e.fire("node.drag:mousedown",{targetEvent:i,node:n})):a&&(s&&e.fire("leafIcon.drag:mousedown",{targetEvent:i,node:n}),e.fire("leaf.drag:mousedown",{targetEvent:i,node:n}))}}.bindAsEventListener(this)),e.observe(isSupportsTouch()?"touchend":"mouseup",function(t){var i=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);if(i){t.treeEvent=!0;var n=this.isIconEvent(t),s=this.isNodeEvent(t),r=this.isLeafEvent(t);if(this.twofingers&&(t.isEmulatedRightClick=!0),isSupportsTouch()&&!this.twofingers&&(this.clickid==i.id&&!JRS.vars.ajax_in_progress&&t.timeStamp-this.clicktime<700&&(s?(n&&e.fire("nodeIcon:dblclick",{targetEvent:t,node:i}),e.fire("node:dblclick",{targetEvent:t,node:i})):r&&(n&&e.fire("leafIcon:dblclick",{targetEvent:t,node:i}),e.fire("leaf:dblclick",{targetEvent:t,node:i})),this.handleNodeOnDblclick&&(s||r)&&!n&&i.handleNode(t)),this.clicktime=t.timeStamp,this.clickid=i.id),!isSupportsTouch()||!JRS.vars.ajax_in_progress){this.selectOnMousedown||TouchController.element_scrolled||isSupportsTouch()&&1!=t.changedTouches.length||this._selectOrEditNode(t,i,isMetaHeld(t),isShiftHeld(t),isRightClick(t)),this._deselectOthers(t,i,isMetaHeld(t),isShiftHeld(t),isRightClick(t));s?(n&&e.fire("nodeIcon:mouseup",{targetEvent:t,node:i}),e.fire("node:mouseup",{targetEvent:t,node:i})):r&&(n&&e.fire("leafIcon:mouseup",{targetEvent:t,node:i}),e.fire("leaf:mouseup",{targetEvent:t,node:i})),isSupportsTouch()&&s&&n&&!TouchController.element_scrolled&&i.handleNode(t)}}}.bindAsEventListener(this)),"createTouch"in document||(e.observe("mouseover",function(t){var i=t.element(),n=matchMeOrUp(i,layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);n&&(Draggables.dragging&&(clearTimeout(this.timeout_id),this.timeout_id=setTimeout(function(e){n.openNode(e)},this.EXPANDING_TIME)),this.createDraggableIfNeeded(t,n),!isIE7()&&e.fire("tree:mouseover",{targetEvent:t,node:n}))}.bindAsEventListener(this)),isIE7()||e.observe("mouseout",function(t){var i=matchMeOrUp(t.element(),layoutModule.BUTTON_PATTERN)&&this.getTreeNodeByEvent(t);i&&e.fire("tree:mouseout",{targetEvent:t,node:i})}.bindAsEventListener(this))),Droppables.add(e,{accept:this.dropClasses,onDrop:function(e){this.elementDropped=e}.bind(this)})}),dynamicTree.Tree.addMethod("_registerKeyEvents",function(){var e=this._getElement();e.observe("key:down",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectNextNode(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:up",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectPreviousNode(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:right",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectInwards(t,e.memo.targetEvent)}.bindAsEventListener(this)),e.observe("key:left",function(e){var t=this.getTreeNodeByEvent(e);dynamicTree.treeNodeEdited!==t&&t&&this._selectOutwards(t,e.memo.targetEvent)}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("_registerCustomEvents",function(){var e=this._getElement();e.observe("mousedown",function(t){dynamicTree.activeTreeId&&dynamicTree.activeTreeId===this.getId()||(e.fire("tree:blur",{targetEvent:t,tree:dynamicTree.getActiveTree()}),dynamicTree.activeTreeId=this.getId(),e.fire("tree:focus",{targetEvent:t,tree:dynamicTree.getActiveTree()}))}.bindAsEventListener(this)),e.observe("mouseover",function(t){var i=this.getTreeNodeByEvent(t);i||e.fire("tree:mouseover",{targetEvent:t,tree:this})}.bindAsEventListener(this)),e.observe("mouseout",function(t){var i=this.getTreeNodeByEvent(t);i||e.fire("tree:mouseout",{targetEvent:t,tree:this})}.bindAsEventListener(this))}),dynamicTree.Tree.addMethod("fireOpenEvent",function(e,t){var i=this._getElement();i.fire("node:open",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireSelectEvent",function(e,t){var i=this._getElement();i.fire(e.isParent()?"node:selected":"leaf:selected",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireUnSelectEvent",function(e,t){var i=this._getElement();i.fire(e.isParent()?"node:unselected":"leaf:unselected",{node:e,targetEvent:t})}),dynamicTree.Tree.addMethod("fireUnSelectAllEvent",function(e){var t=this._getElement();t.fire("items:unselected",{targetEvent:e})}),dynamicTree.Tree.addMethod("fireEditEvent",function(e,t){var i=this._getElement();i.fire(e.isParent()?"node:edit":"leaf:edit",{node:e,newValue:t})}),dynamicTree.Tree.addMethod("fireStartEditEvent",function(e,t){var i=this._getElement();i.fire(e.isParent()?"node:startEdit":"leaf:startEdit",{node:e,input:t})}),dynamicTree.Tree.addMethod("fireEndEditEvent",function(e){var t=this._getElement();t.fire(e.isParent()?"node:endEdit":"leaf:endEdit",{node:e})}),dynamicTree.Tree.addMethod("observe",function(e,t){this._getElement().observe(e,t)}),dynamicTree.Tree.addMethod("stopObserving",function(e,t){this._getElement().stopObserving(e,t)}),dynamicTree.Tree.addMethod("createDraggableIfNeeded",function(e,t){var i=e?e.element():t._getElement().down(this.dragPattern),n=this.draggables[i.identify()];if(this.dragPattern&&!n){var s=matchAny(i,[this.dragPattern],!0);if(s&&i.className.toLowerCase().indexOf("icon")<0&&!this.draggables[s.identify()])return this.draggables[s.identify()]=new Draggable(i,{superghosting:!0,mouseOffset:!0,delay:isIE()||isSupportsTouch()?200:0,onStart:this.setDragStartState.bind(this,t),onEnd:this.setDragEndState.bind(this,t)}),this.draggables[s.identify()]}return null}),dynamicTree.Tree.addMethod("setDragStartState",function(e,t,i){var n=e._getElement().templateClassName;n&&t.element.addClassName(n),t.element.setStyle({width:null,height:null}),t.element.addClassName(layoutModule.DRAGGING_CLASS).addClassName(this.getId()),this.dragClasses&&t.element.addClassName(this.dragClasses),this.selectedNodes.length>1&&t.element.update(new Template(this.TREE_NN_ITEMS_SELECTED).evaluate({count:this.selectedNodes.length})),t.element.node=e,t.element.nodes=this.selectedNodes,t.options.scroll=this._getElement(),t.options.scrollSensitivity=layoutModule.SCROLL_SENSITIVITY,Draggables.dragging=this.regionID||!0}),dynamicTree.Tree.addMethod("setDragEndState",function(e,t,i){delete Draggables.dragging}),define("dynamicTree.events",["prototype","dynamicTree.tree"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.TreeSupport=function(e,t){if(dynamicTree.Tree.call(this,e,t),this.providerId=t.providerId,this.hideLoader=t.hideLoader,this.rootUri=Object.isUndefined(t.rootUri)?"/":t.rootUri,this.nodeClass=t.nodeClass&&Object.isFunction(t.nodeClass)?t.nodeClass:dynamicTree.TreeNode,t.rootObjectModifier&&(this.modifyRootObject=t.rootObjectModifier),this.resetStatesOnShow=Object.isUndefined(t.resetStatesOnShow)||t.resetStatesOnShow,this.inInit=!0,this.ajaxBufferId="ajaxbuffer",this.nodeTextId="treeNodeText",this.urlGetNode=t.urlGetNode?t.urlGetNode:this._getFlowUrl("getNode"),this.urlGetChildren=t.urlGetChildren?t.urlGetChildren:this._getFlowUrl("getChildren"),this.urlGetMultipleChildren=t.urlGetMultipleChildren?t.urlGetMultipleChildren:this._getFlowUrl("getMultipleChildren"),this.urlGetMessage=t.urlGetMessage?t.urlGetMessage:this._getFlowUrl("getMessage"),this.additionalParams=t.additionalParams?t.additionalParams:{},null==this.TREE_NN_ITEMS_SELECTED){var i=function(e){this.TREE_NN_ITEMS_SELECTED=e}.bind(this);this.getMessage("TREE_NN_ITEMS_SELECTED",i,null)}this._initOpenListener()},dynamicTree.TreeSupport.prototype=deepClone(dynamicTree.Tree.prototype),dynamicTree.TreeSupport.addMethod("_initOpenListener",function(){this.observe("node:open",function(e){var t=e.memo.node;t&&!t.isloaded&&this.getTreeNodeChildren(t)}.bindAsEventListener(this))}),dynamicTree.TreeSupport.addMethod("stopObserving",function(e,t){this._getElement().stopObserving(e,t),"node:open"!==e||t||this._initOpenListener()}),dynamicTree.TreeSupport.addMethod("_getFlowUrl",function(e){return __jrsConfigs__.contextPath+"/flow.html?_flowId=treeFlow&method="+e}),dynamicTree.TreeSupport.addMethod("showTree",function(e,t,i,n){var s=this.urlGetNode+"&provider="+this.providerId+"&uri="+this.rootUri+"&depth="+e;n&&(s+="&forceHtmlEscape=true"),s+="&"+this._evaluateAdditionalParams(),this._showTree(s,t,i)}),dynamicTree.TreeSupport.addMethod("_evaluateAdditionalParams",function(){var e=this.additionalParams;return _.isFunction(e)&&(e=e.call(null)),_.isObject(e)?Object.toQueryString(e):null}),dynamicTree.TreeSupport.addMethod("showTreePrefetchNodes",function(e,t,i){var n=this.urlGetNode+"&provider="+this.providerId+"&uri="+this.rootUri;e&&(n+="&prefetch="+encodeURIComponent(e)),n+="&"+this._evaluateAdditionalParams(),this._showTree(n,t,i)}),dynamicTree.TreeSupport.addMethod("_showTree",function(e,t,i){var n=this;this.inInit=!0,this.wait();var s=function(e,t,i){return function(){return e.showTreeCallback(t,i)}}(this,t,i),r=function(){var e=!1;return n.httpErrorHandler&&(e=n.httpErrorHandler.apply(window,arguments)),e===!1&&(e=baseErrorHandler.apply(window,arguments)),e};ajaxTargettedUpdate(e,{fillLocation:this.ajaxBufferId,callback:s,errorHandler:r,hideLoader:this.hideLoader})}),dynamicTree.TreeSupport.addMethod("showTreeCallback",function(e,t){var i=document.getElementById(this.nodeTextId);if(null==i)return void(t?t():this.fireServerErrorEvent());var n=xssUtil.unescape(jQuery(i).text()),s=n.evalJSON();this.modifyRootObject&&(s=this.modifyRootObject(s,!1)),i=document.getElementById(this.ajaxBufferId),i.innerHTML="",this.setRootNode(this.processNode(s)),this.resortTree(),this.resetStatesOnShow&&this.resetStates(),this.renderTree(),this.inInit=!1,e?e():this.fireTreeLoadedEvent({tree:this})}),dynamicTree.TreeSupport.addMethod("processNode",function(e){var t={};t.id=e.id,t.type=e.type,t.uri=e.uri,t.extra=deepClone(e.extra),e.cssClass&&(t.cssClass=e.cssClass);var i=this.nodeClass,n=new i({name:unescapeBackslash(e.label),param:t,orderNumber:e.order});e.tooltip&&(n.tooltip=e.tooltip);var s=e.children;if(null!=s){var r=s.length;if(0===r)n.setHasChilds(!1);else for(var a=0;r>a;a++){var o=s[a];if(o){var l=this.processNode(o);n.addChild(l)}}n.isloaded=!0}return n}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildren",function(e,t,i){var n=e.param.uri,s=function(e,t,i,n){return function(){return e.getTreeNodeChildrenCallback(t,i,n)}}(this,e.id,t,i),r=function(t){(500==t.status||t.getResponseHeader("JasperServerError"))&&e.stopWaiting(),baseErrorHandler(t)};ajaxTargettedUpdate(this.urlGetChildren+"&provider="+this.providerId+"&uri="+encodeURIComponent(encodeURIComponent(n))+"&"+this._evaluateAdditionalParams(),{fillLocation:this.ajaxBufferId,callback:s,errorHandler:r,hideLoader:this.hideLoader}),this.inInit||e.wait()}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenCallback",function(e,t,i){var n=document.getElementById(this.nodeTextId);if(null==n)return void(i?i():this.fireServerErrorEvent());var s=xssUtil.unescape(jQuery(n).text()).evalJSON(),r=dynamicTree.nodes[e];this.modifyRootObject&&(s=this.modifyRootObject(s,!0,r)),n=document.getElementById(this.ajaxBufferId),n.innerHTML="",r.resetChilds(),r.stopWaiting();var a=s.length;if(0===a)r.setHasChilds(!1);else{var o=r.getTreeId(),l=o?dynamicTree.trees[o]:null,d=l?l.sortNodes:null;l&&(l.sortNodes=!1);for(var c=0;a>c;c++){var u=this.processNode(s[c]);r.addChild(u)}l&&(l.sortNodes=d,r.resortChilds())}r.isloaded=!0,r.refreshNode(),t?t(r.childs):this.fireChildrenLoadedEvent(r.childs)}),dynamicTree.TreeSupport.addMethod("getTreeMultipleNodesChildren",function(e,t,i){var n,s="",r=[];if(e&&e.length)for(n=0;n<e.length;n++)n>0&&(s+=","),s+=encodeURIComponent(encodeURIComponent(e[n].param.uri)),r[n]=e[n].id;if(s.length){var a=function(e,t,i,n){return function(){return e.getTreeMultipleNodesChildrenCallback(t,i,n)}}(this,r,t,i);if(ajaxTargettedUpdate(this.urlGetMultipleChildren+"&provider="+this.providerId,{fillLocation:this.ajaxBufferId,callback:a,postData:"uris="+s,errorHandler:baseErrorHandler,hideLoader:this.hideLoader}),!this.inInit)for(n=0;n<e.length;n++)e[n].wait()}}),dynamicTree.TreeSupport.addMethod("getTreeMultipleNodesChildrenCallback",function(e,t,i){var n=document.getElementById(this.nodeTextId);if(null==n)return void(i?i():this.fireServerErrorEvent());var s=xssUtil.unescape(jQuery(n).text()).evalJSON();n=document.getElementById(this.ajaxBufferId),n.innerHTML="",t?t(e,s):(this.setMultipleNodesChilden(e,s),this.fireMultipleChildrenLoadedEvent(e,s))}),dynamicTree.TreeSupport.addMethod("setMultipleNodesChilden",function(e,t,i){if(e&&t)for(var n=0;n<t.length;n++){for(var s=t[n],r=s.children,a=null,o=0;o<e.length;o++){var l=dynamicTree.nodes[e[o]];if(l.param.uri==s.parentUri){a=l;break}}if(a){a.resetChilds(),a.stopWaiting();var d=r.length;if(0===d)a.setHasChilds(!1);else{var c=a.getTreeId(),u=c?dynamicTree.trees[c]:null,h=u?u.sortNodes:null;u&&(u.sortNodes=!1);for(var p=0;d>p;p++){var m=this.processNode(r[p]);a.addChild(m)}u&&(u.sortNodes=h,a.resortChilds())}a.isloaded=!0,i||a.refreshNode()}}}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenPrefetched",function(e,t,i,n,s,r,a){var o=e.param.uri,l=this.urlGetNode+"&provider="+this.providerId+"&uri="+o,d="";t&&(d="&prefetch="+t),s&&(l+="&depth="+s);var c=function(e,t,i,n,s,r){return function(){return e.getTreeNodeChildrenPrefetchedCallback(t,i,n,s,r)}}(this,e.id,i,n,r,a);ajaxTargettedUpdate(l,{fillLocation:this.ajaxBufferId,callback:c,postData:d,errorHandler:baseErrorHandler,hideLoader:this.hideLoader}),this.inInit||e.wait()}),dynamicTree.TreeSupport.addMethod("getTreeNodeChildrenPrefetchedCallback",function(e,t,i,n,s){var r=document.getElementById(this.nodeTextId);if(null==r)return void(i?i():this.fireServerErrorEvent());var a=xssUtil.unescape(jQuery(r).text()).evalJSON();r=document.getElementById(this.ajaxBufferId),r.innerHTML="";var o=dynamicTree.nodes[e];if(o.resetChilds(),o.stopWaiting(),a.children){var l=o.getTreeId(),d=l?dynamicTree.trees[l]:null,c=d?d.sortNodes:null;d&&(d.sortNodes=!1);for(var u=0;u<a.children.length;u++){var h=this.processNode(a.children[u]);o.addChild(h)}d&&(d.sortNodes=c,n||o.resortChilds())}o.isloaded=!0,s||o.refreshNode(),t?t():this.fireChildredPrefetchedLoadedEvent(o.childs)}),dynamicTree.TreeSupport.addMethod("openAndSelectNode",function(e,t,i,n){var s=function(e){var t=dynamicTree.trees[e.getTreeId()];e.parent&&t&&t.rootNode!=e.parent&&t.getState(e.parent.id)==dynamicTree.TreeNode.State.CLOSED&&e.parent.handleNode(),e&&jQuery("#dataChooserSource").length&&(e.nofocus=!0),t._selectOrEditNode(void 0,e,!1,!1,!1,n)};this.processNodePath(e,s,i);var r=this.getSelectedNode();r&&r.scroll(),t&&t()}),dynamicTree.TreeSupport.addMethod("processNodePath",function(e,t,i){var n=this.getRootNode();if("/"===e)t(n);else{var s,r=e.split("/");for(s=0;s<r.length;s++)if(r[s]){var a=n;if(n=this.findNodeChildByMetaName(n,r[s]),!n){if(!i)return;if(n=this.findNodeFirstNodeChildByAlphabeticalOrder(a),!n)return}t(n)}}}),dynamicTree.TreeSupport.addMethod("findLastLoadedNode",function(e){var t={node:null},i=function(e){return function(t){e.node=t}}(t);return this.processNodePath(e,i),t.node}),dynamicTree.TreeSupport.addMethod("findNodeChildByMetaName",function(e,t){if(e.hasChilds())for(var i=0;i<e.childs.length;i++)if(e.childs[i].param.id==t)return e.childs[i];return null}),dynamicTree.TreeSupport.addMethod("findNodeFirstNodeChildByAlphabeticalOrder",function(e){var t=null,i=null;if(e.childs.length>0){t=e.childs[0].param.id,i=0;for(var n=null,s=null,r=1;r<e.childs.length;r++){n=e.childs[r].param.id,s=r;for(var a=n.length<t.length?n.length:t.length,o=0;a>o;o++){if(n.charCodeAt(o)<t.charCodeAt(o)){t=n,i=s;break}if(n.charCodeAt(o)>t.charCodeAt(o))break}}return e.childs[i]}return null}),dynamicTree.TreeSupport.addMethod("findNodeById",function(e,t){return function i(e,t){if(!t||!e)return null;if(t.param.id===e)return t;if(t.hasChilds())for(var n=0;n<t.childs.length;++n){var s=i(e,t.childs[n]);if(s)return s}return null}(e,t?t:this.getRootNode())}),dynamicTree.TreeSupport.addMethod("hasVisibleFolders",function(e){if(this.bShowRoot)return!0;var t=e.children;if(t)for(var i=0;i<t.length;i++){var n=e.children[i].children;if(n&&n.length>0)return!0}return!1}),dynamicTree.TreeSupport.addMethod("getMessage",function(e,t,i){var n=this.urlGetMessage+"&messageId="+e,s=function(e,t,i){return function(){return e.getMessageCallback(t,i)}}(this,t,i);ajaxTargettedUpdate(n,{fillLocation:this.ajaxBufferId,callback:s,errorHandler:baseErrorHandler,hideLoader:this.hideLoader})}),dynamicTree.TreeSupport.addMethod("getMessageCallback",function(e,t){var i=document.getElementById(this.ajaxBufferId);if(null==i)return void(t&&t());var n=trim(i.innerHTML);i.innerHTML="",e&&e(n)}),dynamicTree.TreeSupport.addMethod("fireServerErrorEvent",function(){this._getElement().fire("server:error",{})}),dynamicTree.TreeSupport.addMethod("fireTreeLoadedEvent",function(e){this._getElement().fire("tree:loaded",{tree:e})}),dynamicTree.TreeSupport.addMethod("fireChildrenLoadedEvent",function(e){this._getElement().fire("children:loaded",{nodes:e})}),dynamicTree.TreeSupport.addMethod("fireMultipleChildrenLoadedEvent",function(e,t){this._getElement().fire("multipleChildren:loaded",{parentNodeIds:e,metaNodes:t})}),dynamicTree.TreeSupport.addMethod("fireChildredPrefetchedLoadedEvent",function(e){this._getElement().fire("childredPrefetched:loaded",{nodes:e})}),define("components.dynamicTree",["prototype","dynamicTree.tree","dynamicTree.treenode","dynamicTree.events","core.ajax"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),dynamicTree.RepositoryFolder=function(e){dynamicTree.TreeNode.call(this,e),this.Types={Folder:new dynamicTree.TreeNode.Type("com.jaspersoft.jasperserver.api.metadata.common.domain.Folder"),SuperRoot:new dynamicTree.TreeNode.Type("superroot"),Root:new dynamicTree.TreeNode.Type("root")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_folders:folders",this.param.extra&&this.param.extra.isActiveThemeFolder&&(this.param.cssClass=this.ACTIVE_THEME_CLASS)},dynamicTree.TreeNode&&(dynamicTree.RepositoryFolder.prototype=deepClone(dynamicTree.TreeNode.prototype)),dynamicTree.RepositoryFolder.addVar("ACTIVE_THEME_CLASS","activeTheme"),dynamicTree.RepositoryFolder.addMethod("isParent",function(){return this.param.type==this.Types.Folder.name||this.param.type==this.Types.SuperRoot.name||this.param.type==this.Types.Root.name}),dynamicTree.RepositoryFolder.addMethod("isSuperRoot",function(){return this.param.type==this.Types.SuperRoot.name}),dynamicTree.RepositoryFolder.addMethod("isPublic",function(){return"public"===this.param.id}),dynamicTree.createRepositoryTree=function(e,t){var i=null!=t.organizationId&&""!==t.organizationId;null==t.bShowRoot&&(t.bShowRoot=!i),t.nodeClass||(t.nodeClass=dynamicTree.RepositoryFolder),t.templateDomId="list_responsive_collapsible_folders";var n=new dynamicTree.TreeSupport(e,t);if(n.organizationId=t.organizationId,n.publicFolderUri=t.publicFolderUri,n.orgMode=i,n.modifyRootObject=function(e,t,i){var n;if(t){n=[];for(var s=0;s<e.length;s++)e[s].uri==this.publicFolderUri&&i&&"/"!=i.param.uri||n.push(e[s])}else if(this.orgMode&&null!=e.children){for(var r,a=e.children,o=[],s=0;s<a.length;s++)a[s].uri==this.publicFolderUri?r=a[s]:o.push(a[s]);e.children=o,n={type:"superroot",label:"",extra:{}},n.children=[e,r]}else n=e;return n},n.getRootNode=function(){var e=this.rootNode;return e.isSuperRoot()?e.childs[0].isPublic()?e.childs[1]:e.childs[0]:e},n.findNodeChildByMetaName=function(e,t){if(e.isSuperRoot()){var i,s;if(e.childs[0].isPublic()?(i=e.childs[0],s=e.childs[1]):(i=e.childs[1],s=e.childs[0]),"public"===t)return i;e=s}if(e.hasChilds())for(var r=0;r<e.childs.length;r++)if(e.childs[r].param.id==t)return e.childs[r];return"public"==t&&e.parent&&e.parent.isSuperRoot()?n.findNodeChildByMetaName(e.parent,t):null},isIPad()){var s=$(e);n.touchController=new TouchController(s,s.up(1),{absolute:!0})}return n},define("dynamicTree.utils",["components.dynamicTree","touchcontroller","dynamicTree.treenode"],function(e){return function(){var t;return t||e.dynamicTree}}(this)),define("text!dataSource/template/awsSpecificTemplate.htm",[],function(){return'<fieldset class="group">\n\n    <legend><span>{{- i18n[\'resource.dataSource.aws.settings.title\']}}</span></legend>\n\n    <ul class="list inputSet">\n        <li class="leaf">\n            <div class="control radio">\n                <label title="{{- i18n[\'resource.dataSource.aws.option.useDefault.title\']}}" class="wrap">\n                    {{- i18n[\'resource.dataSource.aws.option.useDefault\']}}\n                </label>\n                <input type="radio" value="{{- credentialsType.EC2 }}" name="credentialsType" {{ if(modelAttributes.credentialsType === credentialsType.EC2) { }}checked{{ } }} {{ if (disableAwsDefaults) { }}disabled="disabled"{{ } }}>\n            </div>\n        </li>\n        <li class="leaf">\n            <div class="control radio">\n                <label title="{{- i18n[\'resource.dataSource.aws.option.userDefined.title\']}}" class="wrap">\n                   {{= i18n[\'resource.dataSource.aws.option.userDefined\'].replace(\'{0}\',i18n[\'resource.dataSource.aws.option.url\']) }}\n                </label>\n                <input type="radio" value="{{- credentialsType.AWS }}" name="credentialsType" {{ if(modelAttributes.credentialsType === credentialsType.AWS ) { }}checked{{ } }}>\n            </div>\n        </li>\n    </ul>\n\n    <fieldset class="group shortFields" id="aws_settings" {{ if (modelAttributes.credentialsType === credentialsType.EC2) { }}style="display: none;"{{ } }}>\n\n        <label title="{{- i18n[\'resource.dataSource.aws.setting.accessKey.title\']}}" class="control input text ">\n            <span class="wrap">{{- i18n[\'resource.dataSource.aws.setting.accessKey\']}}:</span>\n            <input type="text" value="{{- modelAttributes.accessKey }}" name="accessKey">\n            <span class="message warning"></span>\n            <span class="message hint"></span>\n        </label>\n\n        <label title="{{- i18n[\'resource.dataSource.aws.setting.secretKey.title\']}}" class="control input password ">\n            <span class="wrap">{{- i18n[\'resource.dataSource.aws.setting.secretKey\']}}:</span>\n            <input type="password" autocomplete="off" value="{{- modelAttributes.secretKey }}" name="secretKey">\n            <span class="message warning"></span>\n            <span class="message hint"></span>\n        </label>\n\n        <label title="{{- i18n[\'resource.dataSource.aws.setting.arn.title\']}}" class="control input text ">\n            <span disabled="disabled" class="wrap">{{- i18n[\'resource.dataSource.aws.setting.arn\']}}:</span>\n            <input type="text" value="{{- modelAttributes.roleArn }}" name="roleArn">\n            <span class="message warning"></span>\n            <span class="message hint">{{- i18n[\'resource.dataSource.aws.optional.arn\']}}</span>\n        </label>\n\n    </fieldset>\n\n</fieldset>\n\n<fieldset class="group">\n\n    <legend><span>{{- i18n[\'resource.dataSource.aws.tree\']}}</span></legend>\n\n    <label title="{{- i18n[\'resource.dataSource.aws.setting.region.title\']}}" class="control select " style="display: inline-block; margin-right: 6px; margin-top: 6px; width: 350px;">\n        <span class="wrap">{{- i18n[\'resource.dataSource.aws.setting.region\']}}:</span>\n        <select class="fnormal" name="region">\n            {{ _.each(awsRegions, function(region) { }}\n            <option value="{{- region }}" {{ if (region === modelAttributes.region) { }}selected="selected"{{ } }}>{{- i18n[region] }}</option>\n            {{ }); }}\n        </select>\n        <span class="message warning"></span>\n    </label>\n\n    <button class="button action" id="findAwsDataSources">\n        <span class="wrap">{{- i18n[\'resource.dataSource.aws.updateTree\']}}<span class="icon"></span></span>\n    </button>\n\n</fieldset>\n\n<fieldset class="group">\n\n    <div class="control groupBox" style="height: 150px; margin: 0; width: 538px;">\n        <div class="content">\n            <div class="header">\n                <div class="title"></div>\n            </div>\n            <div class="body" style="height: 137px; overflow: auto; padding: 6px;">\n                <ul class="list collapsible folders hideRoot" id="awsDataSourceTree" style="position: relative; height: 137px; overflow: auto; padding: 6px;"></ul>\n            </div>\n        </div>\n    </div>\n\n</fieldset>\n\n<fieldset class="group shortFields">\n\n    <label title="{{- i18n[\'resource.dataSource.jdbc.username\']}}" class="control input text ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.username\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.username }}" name="username">\n        <span class="message warning"></span>\n        <span class="message hint"></span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.jdbc.password\']}}" class="control input password ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.password\']}}:</span>\n        <input type="password" value="{{- modelAttributes.password }}" name="password">\n        <span class="message warning"></span>\n        <span class="message hint"></span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.aws.database.name.title\']}}" class="control input text">\n        <span class="wrap">{{- i18n[\'resource.dataSource.aws.database.name\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.dbName }}" name="dbName">\n        <span class="message warning"></span>\n        <span class="message hint"></span>\n    </label>\n\n</fieldset>\n\n<fieldset class="group mediumFields">\n\n    <label title="{{- i18n[\'resource.analysisConnection.driver\']}}" class="control input text">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.driver\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input class="control inline" type="text" value="{{- modelAttributes.driverClass }}" name="driverClass">\n        {{ if (driverUploadEnabled) { }}\n        <button class="button action up" id="driverUploadButton">\n            <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.upload.addDriverButton\']}}</span>\n        </button>\n        {{ } }}\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n[\'resource.dataSource.jdbc.hint1\']}}</span>\n    </label>\n\n    <label title="{{- i18n[\'resource.analysisConnection.requiredURL\']}}" class="control input text">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.url\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.connectionUrl }}" name="connectionUrl">\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n[\'resource.dataSource.jdbc.hint2\']}}</span>\n    </label>\n\n</fieldset>';
}),define("dataSource/view/AwsDataSourceView",["require","underscore","common/component/dialog/AlertDialog","dataSource/view/JdbcDataSourceView","dataSource/view/BaseDataSourceView","dataSource/model/AwsDataSourceModel","dataSource/view/dialog/UploadJdbcDriverDialog","dynamicTree.utils","core.events.bis","bundle!jasperserver_messages","text!dataSource/template/awsSpecificTemplate.htm","settings!awsSettings","dataSource/util/settingsUtility"],function(e){"use strict";var t=e("underscore"),i=e("common/component/dialog/AlertDialog"),n=e("dataSource/view/JdbcDataSourceView"),s=e("dataSource/view/BaseDataSourceView"),r=e("dataSource/model/AwsDataSourceModel"),a=e("dataSource/view/dialog/UploadJdbcDriverDialog"),o=e("dynamicTree.utils"),l=e("core.events.bis"),d=e("bundle!jasperserver_messages"),c=e("text!dataSource/template/awsSpecificTemplate.htm"),u=e("settings!awsSettings"),h=e("dataSource/util/settingsUtility");return n.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.aws.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.aws.page.title.edit",modelConstructor:r,events:function(){var e={};return t.extend(e,n.prototype.events),e["change input[name='credentialsType']"]="changeCredentialsType",e["click #findAwsDataSources"]="refreshAwsDataSourceTree",e},initialize:function(e){s.prototype.initialize.apply(this,arguments),this.deepDefaults=h.deepDefaults(e,{awsSettings:u}),this.listenTo(this.model,"change:credentialsType",this.onCredentialsTypeChange),this.listenTo(this.model,"change:driverClass",this.changeUploadDriverButtonState),this.listenTo(this.model,"change",this.updateInput),this.listenTo(this.model.drivers,"change add",this.recheckDriver)},changeCredentialsType:function(){var e=this.$("input[name='credentialsType']:checked").val();this.model.set("credentialsType",e)},recheckDriver:function(){this.model.validate({driverClass:this.model.get("driverClass")}),this.changeUploadDriverButtonState()},changeUploadDriverButtonState:function(){var e=this.$("#driverUploadButton");if(""===this.model.get("driverClass"))l.disable(e[0]);else{l.enable(e[0]);var t=this.model.drivers.getDriverByClass(this.model.get("driverClass"));e.find(".wrap").text(d[t&&t.get("available")?"resource.dataSource.jdbc.upload.editDriverButton":"resource.dataSource.jdbc.upload.addDriverButton"])}},initDriverUploadDialog:function(){var e=this,i=this.model.drivers.getDriverByClass(this.model.get("driverClass"));this.driverUploadDialog=new a({driverAvailable:!(!i||!i.get("available")),driverClass:this.model.get("driverClass")}),this.driverUploadDialog.on("driverUpload",function(i){e.model.drivers.markDriverAsAvailable(i.jdbcDriverClass),t.defer(t.bind(e.model.validate,e.model))})},updateInput:function(){var e=t.keys(this.model.changedAttributes()),i=["accessKey","secretKey","roleArn","connectionUrl","driverClass","dbName"],n=this;t.each(t.intersection(e,i),function(e){var t=n.model.get(e),i=n.$("[name='"+e+"']").val();i!==t&&n.$("[name='"+e+"']").val(t)})},onCredentialsTypeChange:function(){var e=this.model.get("credentialsType")===r.credentialsType.EC2;this.$("#aws_settings")[e?"hide":"show"](),e&&this.showAwsDsTree(this.model.getFullDbTreePath())},refreshAwsDataSourceTree:function(e){e.preventDefault(),this.showAwsDsTree("/")},render:function(){return this.$el.empty(),this.renderTimezoneSection(),this.renderAwsSpecificSection(),this.renderTestConnectionSection(),this.initDataSourceTree(),(this.options.isEditMode||this.model.get("credentialsType")===r.credentialsType.EC2)&&this.showAwsDsTree(this.model.getFullDbTreePath()),this},showAwsDsTree:function(e){this.model.validate({accessKey:this.model.get("accessKey"),secretKey:this.model.get("secretKey")}),this.model.isValid("secretKey")&&this.model.isValid("accessKey")&&this.awsDataSourceTree.showTreePrefetchNodes(e||"/")},templateData:function(){var e=n.prototype.templateData.apply(this,arguments);return t.extend(e,{credentialsType:r.credentialsType,awsRegions:this.deepDefaults.awsSettings.awsRegions,disableAwsDefaults:!this.deepDefaults.awsSettings.isEc2Instance||this.deepDefaults.awsSettings.suppressEc2CredentialsWarnings}),e},renderAwsSpecificSection:function(){this.$el.append(t.template(c,this.templateData())),this.changeUploadDriverButtonState()},initDataSourceTree:function(){var e=this.options.isEditMode,t=this,n={hideLoader:!0,bShowRoot:!1,treeId:"awsDataSourceTree",providerId:"awsDataSourceTreeDataProvider",selectLeavesOnly:!0,additionalParams:function(){return{arn:t.model.get("roleArn"),awsAccessKey:t.model.get("accessKey"),awsSecretKey:t.model.get("secretKey"),region:t.model.get("region"),datasourceUri:t.model.get("uri")}}};this.awsDataSourceTree=o.createRepositoryTree("awsDataSourceTree",n),this.awsDataSourceTree.httpErrorHandler=function(e){var t,n=!1;return(-1!==e.responseText.indexOf("AWS Access Key is invalid")||-1!==e.responseText.indexOf("The security token included in the request is invalid"))&&(n=d["error.aws.key.is.invalid"]),n!==!1||-1===e.responseText.indexOf("AWS Secret Key is invalid")&&-1===e.responseText.indexOf("The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method")||(n=d["error.aws.secret.key.is.invalid"]),n===!1&&-1!==e.responseText.indexOf("is not authorized to perform")&&(n=d["error.aws.arn.is.invalid"]),n===!1&&-1!==e.responseText.indexOf("The security token included in the request is invalid")&&(n=d["error.security.token.is.invalid"]),n?(t=new i({modal:!0}),t.setMessage(n),t.open(),!0):!1},this.awsDataSourceTree.observe("leaf:selected",function(i){var n=i.memo.node.param;if("awsDb"===n.type&&!e){var s=n.extra,r=s.dbUri.split("/");t.model.set({connectionUrlTemplate:s.jdbcTemplate,driverClass:s.jdbcDriverClass,dbName:s.dBName,dbHost:s.dnsAddress,dbPort:s.dbPort,sName:s.dBName,dbService:r[1],dbInstanceIdentifier:r[2]}),t.model.validate({driverClass:t.model.get("driverClass")})}}),this.awsDataSourceTree.observe("tree:loaded",function(){t.model.getFullDbTreePath()&&t.awsDataSourceTree.openAndSelectNode(t.model.getFullDbTreePath(),function(){e=!1})})},remove:function(){this.awsDataSourceTree&&this.awsDataSourceTree.stopObserving(),n.prototype.remove.apply(this,arguments)}})}),define("dataSource/model/AzureSqlDataSourceModel",["require","dataSource/model/JdbcDataSourceModel","dataSource/model/BaseDataSourceModel","dataSource/collection/JdbcDriverCollection","settings!dataSourcePatterns","dataSource/enum/connectionTypes","bi/repository/enum/repositoryResourceTypes","underscore","jquery","bundle!jasperserver_messages","settings!awsSettings","bundle!jasperserver_config","dataSource/util/settingsUtility"],function(e){"use strict";var t=e("dataSource/model/JdbcDataSourceModel"),i=e("dataSource/model/BaseDataSourceModel"),n=e("dataSource/collection/JdbcDriverCollection"),s=(e("settings!dataSourcePatterns"),e("dataSource/enum/connectionTypes")),r=e("bi/repository/enum/repositoryResourceTypes"),a=e("underscore"),o=e("jquery"),l=e("bundle!jasperserver_messages"),d=e("settings!awsSettings"),c=e("bundle!jasperserver_config"),u=e("dataSource/util/settingsUtility"),h=t.extend({otherDriverIsPresent:!1,type:r.AZURE_SQL_DATA_SOURCE,defaults:function(){var e={};return a.extend(e,t.prototype.defaults,{subscriptionId:"",keyStorePassword:"",keyStoreUri:"",serverName:"",dbName:"",selectedDriverClass:"",useMicrosoftDriver:!1,microsoftDriverAvailable:!1,connectionType:s.AZURE_SQL}),e}(),validation:function(){var e={};return a.extend(e,t.prototype.validation,{subscriptionId:[{required:!0,msg:l["ReportDataSourceValidator.error.azureSqlDataSource.subscriptionId"]}],keyStorePassword:[{required:!0,msg:l["ReportDataSourceValidator.error.azureSqlDataSource.keyStorePassword"]}],keyStoreUri:[{required:!0,msg:l["ReportDataSourceValidator.error.azureSqlDataSource.keyStoreUri"]}],serverName:[{required:!0,msg:l["ReportDataSourceValidator.error.azureSqlDataSource.serverName"]}],dbName:[{required:!0,msg:l["ReportDataSourceValidator.error.not.empty.reportDataSource.dbNameIsEmpty"]}],username:[{required:!0,msg:l["ReportDataSourceValidator.error.not.empty.reportDataSource.username"]}]}),e}(),initialize:function(e,t){i.prototype.initialize.apply(this,arguments);u.deepDefaults(t,{awsSettings:d});this.isNew()||(this.set("password",c["input.password.substitution"]),this.set("keyStorePassword",c["input.password.substitution"])),this.initialization=o.Deferred(),this.drivers=new n([],this.options);var s=this;this.drivers.fetch({reset:!0}).done(function(){s.isNew()?s.set("selectedDriverClass",s.drivers.getDriverByName("sqlserver").get("jdbcDriverClass")):s.set("selectedDriverClass",s.get("driverClass"));var e=s.drivers.getDriverByName("sqlserver_standard");null!=e&&(s.set("microsoftDriverAvailable",e.get("available")),s.set("useMicrosoftDriver",s.get("selectedDriverClass")===e.get("jdbcDriverClass"))),s.initialization.resolve()}),this.on("change:dbName change:serverName change:connectionUrlTemplate change:useMicrosoftDriver",this.updateConnectionUrl),this.on("change:useMicrosoftDriver",this.updateDriverClass)},updateConnectionUrl:function(){if(this.get("connectionUrlTemplate")){var e=this.pick(["dbName","serverName","dbPort"]);e.dbPort=1433;var t=this.drivers.getDriverByName("sqlserver_standard"),i=this.get("connectionUrlTemplate");this.get("useMicrosoftDriver")&&null!=t&&(e.serverName+=".database.windows.net",i=t.get("jdbcUrl")),e.dbHost=e.serverName;var n=this.replaceConnectionUrlTemplatePlaceholdersWithValues(i,e);this.set("connectionUrl",n)}},updateDriverClass:function(){var e=this.drivers.getDriverByName("sqlserver_standard"),t=this.get("useMicrosoftDriver")&&null!=e?"sqlserver_standard":"sqlserver",i=this.drivers.getDriverByName(t).get("jdbcDriverClass");this.set("selectedDriverClass",i),this.set("driverClass",i)},toJSON:function(){var e=t.prototype.toJSON.apply(this,arguments);return this.options.isEditMode&&e.keyStorePassword===c["input.password.substitution"]&&(e.keyStorePassword=null),e},getFullDbTreePath:function(){return this.get("serverName")&&this.get("dbName")?"/"+this.get("serverName")+"/"+this.get("dbName"):null}});return h}),define("text!dataSource/template/azureSqlSpecificTemplate.htm",[],function(){return'<fieldset class="group">\n\n    <legend><span>{{- i18n[\'resource.dataSource.azureSql.settings.title\']}}</span></legend>\n\n    <fieldset class="group shortFields" id="aws_settings">\n\n        <label title="{{- i18n[\'resource.dataSource.azureSql.setting.subscriptionId.title\']}}" class="control input text ">\n            <span class="wrap">{{- i18n[\'resource.dataSource.azureSql.setting.subscriptionId\']}} ({{- i18n[\'required.field\']}}):</span>\n            <input type="text" value="{{- modelAttributes.subscriptionId }}" name="subscriptionId">\n            <span class="message warning"></span>\n            <span class="message hint"></span>\n        </label>\n\n        <label title="{{- i18n[\'resource.dataSource.azureSql.setting.keyStoreUri.title\']}}" class="control input text">\n            <span class="wrap">{{- i18n[\'resource.dataSource.azureSql.setting.keyStoreUri\']}} ({{- i18n[\'required.field\']}}):</span>\n            <input type="text" value="{{- modelAttributes.keyStoreUri }}" name="keyStoreUri">\n            <button class="button action" type="button" name="repositoryBrowserButton">\n                <span class="wrap">{{- i18n[\'dialog.file.browse\'] }}...<span class="icon"></span></span>\n            </button>\n            <span class="message warning"></span>\n            <span class="message hint">{{- i18n[\'resource.dataSource.azureSql.optional.keyStoreUri\']}}</span>\n        </label>\n\n        <label title="{{- i18n[\'resource.dataSource.azureSql.setting.keyStorePassword.title\']}}" class="control input password ">\n            <span class="wrap">{{- i18n[\'resource.dataSource.azureSql.setting.keyStorePassword\']}} ({{- i18n[\'required.field\']}}):</span>\n            <input type="password" autocomplete="off" value="{{- modelAttributes.keyStorePassword }}" name="keyStorePassword">\n            <span class="message warning"></span>\n            <span class="message hint"></span>\n        </label>\n\n    </fieldset>\n\n</fieldset>\n\n<fieldset class="group">\n\n    <legend><span>{{- i18n[\'resource.dataSource.azureSql.tree\']}}</span></legend>\n\n    <button class="button action" id="updateDatabaseTree">\n        <span class="wrap">{{- i18n[\'resource.dataSource.azureSql.updateTree\']}}<span class="icon"></span></span>\n    </button>\n\n</fieldset>\n\n<fieldset class="group">\n\n    <div class="control groupBox" style="height: 150px; margin: 0; width: 538px;">\n        <div class="content">\n            <div class="header">\n                <div class="title"></div>\n            </div>\n            <div class="body" style="height: 137px; overflow: auto; padding: 6px;">\n                <ul class="list collapsible folders hideRoot" id="azureSqlDataSourceTree" style="position: relative; height: 137px; overflow: auto; padding: 6px;"></ul>\n            </div>\n        </div>\n    </div>\n\n</fieldset>\n\n<fieldset class="group shortFields">\n\n    <label title="{{- i18n[\'resource.dataSource.azureSql.server.name.title\']}}" class="control input text">\n        <span class="wrap">{{- i18n[\'resource.dataSource.azureSql.server.name\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.serverName }}" name="serverName">\n        <span class="message warning"></span>\n        <span class="message hint"></span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.azureSql.database.name.title\']}}" class="control input text">\n        <span class="wrap">{{- i18n[\'resource.dataSource.azureSql.database.name\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.dbName }}" name="dbName">\n        <span class="message warning"></span>\n        <span class="message hint"></span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.jdbc.username\']}}" class="control input text ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.username\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.username }}" name="username">\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n[\'resource.dataSource.azureSql.database.username.hint\']}}</span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.jdbc.password\']}}" class="control input password ">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.password\']}}:</span>\n        <input type="password" value="{{- modelAttributes.password }}" name="password">\n        <span class="message warning"></span>\n        <span class="message hint"></span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.azureSql.useMicrosoftDriver\']}}" class="control input checkBox">\n        <span class="wrap">{{- i18n[\'resource.dataSource.azureSql.useMicrosoftDriver\']}}\n            {{ if (!modelAttributes.microsoftDriverAvailable) { }}\n                ({{- i18n["resource.dataSource.azureSql.microsoftDriverMissing"] }})\n            {{ } }}\n            </span>\n        <input type="checkbox" name="useMicrosoftDriver" value="{{- modelAttributes.useMicrosoftDriver }}"\n            {{ if (modelAttributes.useMicrosoftDriver) { }}checked="checked"{{ } }} \n            {{ if (!modelAttributes.microsoftDriverAvailable) { }}disabled="disabled"{{ } }}>\n    </label>\n\n\n</fieldset>\n\n<fieldset class="group mediumFields">\n\n    <label title="{{- i18n[\'resource.analysisConnection.requiredURL\']}}" class="control input text">\n        <span class="wrap">{{- i18n[\'resource.dataSource.jdbc.url\']}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.connectionUrl }}" name="connectionUrl">\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n[\'resource.dataSource.azureSql.connectionUrl.hint\']}}</span>\n    </label>\n\n</fieldset>'}),define("text!common/templates/components.pickers.htm",[],function(){return'<div class="panel dialog selectFromRepository overlay moveable sizeable centered_horz centered_vert hidden">\n	<div class="sizer diagonal"></div>\n	<div class="content hasFooter">\n		<div class="header mover">\n			<div class="title">\n			</div>\n		</div>\n		<div class="body">\n			<div class="control groupBox fillParent">\n				<div class="content">\n					<div class="header">\n						<div class="title">\n						</div>\n					</div>\n					<div class="body">\n						<ul id="selectFromRepoTree"></ul>\n					</div>\n				</div>\n			</div>\n		</div>\n		<div class="footer">\n			<button id="selectFromRepoBtnSelect" class="button action primary up"><span class="wrap">{{- i18n["button.select"] }}</span><span class="icon"></span></button>\n			<button id="selectFromRepoBtnCancel" class="button action up"><span class="wrap">{{- i18n["button.cancel"] }}</span><span class="icon"></span></button>\n		</div>\n	</div>\n</div>\n'});var resource={messages:{},resourceLabelMaxLength:100,resourceIdMaxLength:100,resourceDescriptionMaxLength:250,PROPAGATE_EVENT:"propagateEvent",STEP_DISPLAY_ID:"stepDisplay",FLOW_CONTROLS_ID:"flowControls",initSwipeScroll:function(){var e=$(resource.STEP_DISPLAY_ID);e&&new TouchController(e.up(),e.up(1),{})},submitForm:function(e,t,i){if(t){var n=buildActionUrl(t);i&&i(),$(e).writeAttribute("method","post").writeAttribute("action",n),$(e).submit()}},registerClickHandlers:function(e,t,i){if(resource._bodyClickEventHandlers)return void(i?Array.prototype.unshift:Array.prototype.push).apply(resource._bodyClickEventHandlers,e);resource._bodyClickEventHandlers=e;var n=t||"body";$$(n)[0].observe("click",function(e){resource._bodyClickEventHandlers&&resource._bodyClickEventHandlers.each(function(t){var i=t(e);if(i)throw i!==resource.PROPAGATE_EVENT&&Event.stop(e),$break})})},TreeWrapper:function(e){var t=this;if(this._treeId=e.treeId,this._resourceUriInput=$(e.resourceUriInput||"resourceUri"),this._uri=this._resourceUriInput&&this._resourceUriInput.getValue()||e.uri||"/",!e.providerId)throw"There is no tree provider set for tree #{id}".interpolate({id:this._treeId});var i=["providerId","rootUri","organizationId","publicFolderUri","urlGetNode","urlGetChildren"].inject({},function(t,i){return null!==e[i]&&(t[i]=e[i]),t});return this._tree=new dynamicTree.createRepositoryTree(this._treeId,i),this._tree.observe("tree:loaded",function(){t._tree.openAndSelectNode($(t._resourceUriInput).getValue())}),this._tree.observe("leaf:selected",function(e){t._uri=e.memo.node.param.uri,t._resourceUriInput.setValue(t._uri)}),this._tree.observe("node:selected",function(){t._resourceUriInput.setValue(t._uri="")}),{getTreeId:function(){return t._treeId},getTree:function(){return t._tree},selectFolder:function(e){t._tree.openAndSelectNode(e)},getSelectedFolderUri:function(){return t._uri}}},switchButtonState:function(e,t){buttonManager[t?"enable":"disable"].call(buttonManager,e)},switchDisableState:function(e,t){(e=$(e))&&e[t?"disable":"enable"].call(e)},generateResourceId:function(e){if(localContext&&localContext.initOptions&&localContext.initOptions.resourceIdNotSupportedSymbols)return e.replace(new RegExp(localContext.initOptions.resourceIdNotSupportedSymbols,"g"),"_");throw"There is no resourceIdNotSupportedSymbols property in init options."},testResourceId:function(e){if(localContext&&localContext.initOptions&&localContext.initOptions.resourceIdNotSupportedSymbols)return new RegExp(localContext.initOptions.resourceIdNotSupportedSymbols,"g").test(e);throw"There is no resourceIdNotSupportedSymbols property in init options."},labelValidator:function(e){var t=!0,i="";return e.blank()?(i=resource.messages.labelIsEmpty,t=!1):e.length>resource.resourceLabelMaxLength&&(i=resource.messages.labelToLong,t=!1),{isValid:t,errorMessage:i}},getLabelValidationEntry:function(e){return{element:e,validators:[{method:"mandatory",messages:{mandatory:resource.messages.labelIsEmpty}},{method:"minMaxLength",messages:{tooLong:resource.messages.labelToLong},options:{maxLength:resource.resourceLabelMaxLength}}]}},getIdValidationEntry:function(e){return{element:e,validators:[{method:"resourceIdChars",messages:resource.messages},{method:"mandatory",messages:{mandatory:resource.messages.resourceIdIsEmpty}},{method:"minMaxLength",messages:{tooLong:resource.messages.resourceIdToLong},options:{maxLength:resource.resourceIdMaxLength}}]}},resourceIdValidator:function(e){var t=!0,i="";return this._isEditMode||(e.blank()?(i=resource.messages.resourceIdIsEmpty,t=!1):e.length>resource.resourceIdMaxLength?(i=resource.messages.resourceIdToLong,t=!1):resource.testResourceId(e)&&(i=resource.messages.resourceIdInvalidChars,t=!1)),{isValid:t,errorMessage:i}},getDescriptionValidationEntry:function(e){return{element:e,validators:[{method:"minMaxLength",messages:{tooLong:resource.messages.descriptionToLong},options:{maxLength:resource.resourceDescriptionMaxLength}}]}},descriptionValidator:function(e){var t=!0,i="";return e.length>resource.resourceDescriptionMaxLength&&(i=resource.messages.descriptionToLong,t=!1),{isValid:t,errorMessage:i}},dataSourceValidator:function(e){var t=!0,i="";return""===e.trim()&&(i=resource.messages.dataSourceInvalid,t=!1),{isValid:t,errorMessage:i}},queryValidator:function(e){var t=!0,i="";return""===e.trim()&&(i=resource.messages.queryInvalid,t=!1),{isValid:t,errorMessage:i}},getValidationEntries:function(e){return e.collect(function(e){return e.validationEntry?e.validationEntry:{validator:e.validator,element:e}})}};"undefined"==typeof require&&isIPad()&&document.observe("dom:loaded",resource.initSwipeScroll.bind(resource)),define("resource.base",["prototype","utils.common","core.layout"],function(e){return function(){var t;return t||e.resource}}(this));var picker={};picker.FileSelector=function(e){this._disabled=void 0!==e.disabled?e.disabled:!1,this._uriTextbox=$(e.uriTextboxId),this._browseButtonId=$(e.browseButtonId),this._onChange=e.onChange||!1,this._options=e,this._disabled?(buttonManager.disable(this._uriTextbox),buttonManager.disable(this._browseButtonId)):(this._id=e.id,this._suffix=e.suffix?e.suffix:(new Date).getTime(),this._treeDomId=e.treeId,this._selectLeavesOnly=void 0!==e.selectLeavesOnly?e.selectLeavesOnly:!1,this._selectedUri=$F(this._uriTextbox),this._process(e),this._assignHandlers(),this._refreshButtonsState())},picker.FileSelector.addVar("DEFAULT_TEMPLATE_DOM_ID","selectFromRepository"),picker.FileSelector.addVar("DEFAULT_TREE_ID","selectFromRepoTree"),picker.FileSelector.addVar("OK_BUTTON_ID","selectFromRepoBtnSelect"),picker.FileSelector.addVar("CANCEL_BUTTON_ID","selectFromRepoBtnCancel"),picker.FileSelector.addVar("TITLE_PATTERN","div.title"),picker.FileSelector.addMethod("_process",function(e){!this._id&&(this._id=this.DEFAULT_TEMPLATE_DOM_ID),!$(this._id)&&this._options.template&&this._options.i18n?(this._dom=jQuery(_.template(this._options.template,{i18n:this._options.i18n})),this._dom=this._dom[0]):this._dom=$(this._id).cloneNode(!0),this._dom.writeAttribute("id",this._id+this._suffix),this._okButton=this._dom.select("#"+this.OK_BUTTON_ID)[0],this._okButton.writeAttribute("id",this.OK_BUTTON_ID+this._suffix),this._cancelButton=this._dom.select("#"+this.CANCEL_BUTTON_ID)[0],this._cancelButton.writeAttribute("id",this.CANCEL_BUTTON_ID+this._suffix),!this._treeDomId&&(this._treeDomId=this.DEFAULT_TREE_ID),this._treeDom=this._dom.select("#"+this._treeDomId)[0],this._treeDom.writeAttribute("id",this._treeDomId+this._suffix),this._visible=!1,e.title&&this._dom.select(this.TITLE_PATTERN)[0].update(e.title),this._onOk=e.onOk,this._onCancel=e.onCancel,jQuery(document.body).append(this._dom);var t,i=this._dom.down(layoutModule.SWIPE_SCROLL_PATTERN);i&&(t=layoutModule.createScroller(i));var n=Object.extend({providerId:e.providerId,scroll:t},e.treeOptions);this._tree=dynamicTree.createRepositoryTree(this._treeDomId+this._suffix,n),this._selectedUri&&this._selectedUri.length>0?this._tree.showTreePrefetchNodes(this._selectedUri):this._tree.showTree(1)}),picker.FileSelector.addMethod("_assignHandlers",function(){this._dom.observe("click",this._dialogClickHandler.bindAsEventListener(this)),["node:dblclick","leaf:dblclick"].each(function(e){this._tree.observe(e,this._treeClickHandler.bindAsEventListener(this))},this),["node:click","leaf:click","node:selected","leaf:selected"].each(function(e){this._tree.observe(e,this._refreshButtonsState.bindAsEventListener(this))},this),["childredPrefetched:loaded","tree:loaded"].each(function(e){this._tree.observe(e,this._treeLoadHandler.bindAsEventListener(this))},this),this._browseButtonId.observe("click",this._browseClickHandler.bindAsEventListener(this))}),picker.FileSelector.addMethod("_canClickOk",function(e){return this._tree.getSelectedNode()&&(this._selectLeavesOnly?this._tree.getSelectedNode().param.type!==this._tree.getSelectedNode().FOLDER_TYPE_NAME:!0)}),picker.FileSelector.addMethod("_dialogClickHandler",function(e){var t=e.element();if(matchAny(t,["#"+this.OK_BUTTON_ID+this._suffix],!0)){e.stop();var i=this._tree.getSelectedNode().param.uri;this._uriTextbox.setValue(i),this._onChange&&this._onChange(i),this._hide(),this._onOk&&this._onOk()}else matchAny(t,["#"+this.CANCEL_BUTTON_ID+this._suffix],!0)&&(e.stop(),this._hide(),this._onCancel&&this._onCancel())}),picker.FileSelector.addMethod("_treeClickHandler",function(e){if(this._canClickOk()){var t=this._tree.getSelectedNode().param.uri;this._uriTextbox.setValue(t),this._onChange&&this._onChange(t),this._hide(),this._onOk&&this._onOk()}}),picker.FileSelector.addMethod("_treeLoadHandler",function(e){this._visible&&this._selectedUri&&this._tree.openAndSelectNode(this._selectedUri)}),picker.FileSelector.addMethod("_browseClickHandler",function(e){e.stop(),this._show()}),picker.FileSelector.addMethod("_refreshButtonsState",function(){this._canClickOk()?buttonManager.enable(this._okButton):buttonManager.disable(this._okButton)}),picker.FileSelector.addMethod("_hide",function(){dialogs.popup.hide(this._dom),this._visible=!1}),picker.FileSelector.addMethod("_show",function(){this._selectedUri=$F(this._uriTextbox),this._selectedUri&&this._selectedUri.length>0?this._tree.showTreePrefetchNodes(this._selectedUri):this._tree.showTree(1),dialogs.popup.show(this._dom,!0),this._visible=!0,this._selectedUri&&this._tree.openAndSelectNode(this._selectedUri),this._refreshButtonsState()}),picker.FileSelector.addMethod("remove",function(){jQuery(this._dom).remove()}),define("components.pickers",["utils.common","components.dialogs","core.layout","core.events.bis","prototype","jquery","dynamicTree.utils"],function(e){return function(){var t;return t||e.picker}}(this));var resourceLocator={CONTENT_REPOSITORY:"CONTENT_REPOSITORY",LOCAL:"LOCAL",NONE:"NONE",FILE_SYSTEM:"FILE_SYSTEM",LOCATE_EVENT:"resource:locate",ALLOWED_FILE_RESOURCE_EXTENSIONS:["css","ttf","jpg","jpeg","gif","bmp","png","jar","jrxml","properties","jrtx","xml","agxml","docx","doc","ppt","pptx","xls","xlsx","ods","odt","odp","pdf","rtf","html"],initialize:function(e){var t=function(e){return _.isObject(e)?e:$(e)};this.resourceUri=t(e.resourceInput),this.browseButton=t(e.browseButton),this.filePath=t(e.fileUploadInput),this.fakeFilePath=t(e.fakeFileUploadInput),this.fakeFileInput=t(e.fakeFileUploadInputText),this.newResourceLink=t(e.newResourceLink);try{this._initFileSelector(e)}catch(i){}finally{this._initEvents(e)}return this},_initEvents:function(e){jQuery(document).on("click","#CONTENT_REPOSITORY, #FILE_SYSTEM, #NONE, #LOCAL",this._clickHandler),"fileResourceTreeDataProvider"===e.providerId&&(jQuery("#next").on("click",resourceLocator._nextClickHandler),jQuery("#filePath").on("change",resourceLocator._uploadChangeHandler))},_nextClickHandler:function(e){jQuery("#fileUpload").hasClass("error")&&e.preventDefault()},_uploadChangeHandler:function(e){jQuery("#fileUpload").removeClass("error");var t=!0,i=jQuery("#filePath")[0].value;if(i){var n=jQuery("#filePath")[0].value.match(/.*\.([^\.]+)$/);if(n){var s=n[1];_.indexOf(resourceLocator.ALLOWED_FILE_RESOURCE_EXTENSIONS,s)<0&&(t=!1)}else t=!1}else t=!1;if(!t){var r=resource.messages["resource.report.unsupportedFileType.error"]+" "+resourceLocator.ALLOWED_FILE_RESOURCE_EXTENSIONS.join(", ");jQuery("#fileUpload").addClass("error").find("span.warning").html(r)}},_clickHandler:function(e){resourceLocator._updateResourceSelectorState(e.target.id)},_updateResourceSelectorState:function(e){resource.switchButtonState(this.filePath,e===this.FILE_SYSTEM),resource.switchButtonState(this.fakeFilePath,e===this.FILE_SYSTEM),resource.switchButtonState(this.fakeFileInput,e===this.FILE_SYSTEM),resource.switchButtonState(this.browseButton,e===this.CONTENT_REPOSITORY),resource.switchDisableState(this.resourceUri,e!==this.CONTENT_REPOSITORY);var t=e===this.LOCAL?["disabled","launcher"]:["launcher","disabled"];this._switchElementClasses(this.newResourceLink,t)},_initFileSelector:function(e){this.fileSelector=new picker.FileSelector(_.extend({},e,{uriTextboxId:this.resourceUri,browseButtonId:this.browseButton,title:e.dialogTitle}))},remove:function(e){this.fileSelector.remove()},_switchElementClasses:function(e,t){e&&t&&e.removeClassName(t[0]).addClassName(t[1])}};define("resource.locate",["resource.base","jquery","components.pickers"],function(e){return function(){var t;return t||e.resourceLocator}}(this)),define("dataSource/view/AzureSqlDataSourceView",["require","underscore","common/component/dialog/AlertDialog","dataSource/view/JdbcDataSourceView","dataSource/view/BaseDataSourceView","dataSource/model/AzureSqlDataSourceModel","dataSource/view/dialog/UploadJdbcDriverDialog","dynamicTree.utils","core.events.bis","bundle!jasperserver_messages","bundle!jsexceptions_messages","text!dataSource/template/azureSqlSpecificTemplate.htm","text!common/templates/components.pickers.htm","settings!awsSettings","resource.locate","dataSource/util/settingsUtility"],function(e){"use strict";var t=e("underscore"),i=e("common/component/dialog/AlertDialog"),n=e("dataSource/view/JdbcDataSourceView"),s=e("dataSource/view/BaseDataSourceView"),r=e("dataSource/model/AzureSqlDataSourceModel"),a=(e("dataSource/view/dialog/UploadJdbcDriverDialog"),e("dynamicTree.utils")),o=(e("core.events.bis"),e("bundle!jasperserver_messages")),l=e("bundle!jsexceptions_messages"),d=e("text!dataSource/template/azureSqlSpecificTemplate.htm"),c=e("text!common/templates/components.pickers.htm"),u=(e("settings!awsSettings"),e("resource.locate"));e("dataSource/util/settingsUtility");return n.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.aws.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.aws.page.title.edit",modelConstructor:r,events:function(){var e={};return t.extend(e,n.prototype.events),e["click #updateDatabaseTree"]="updateDatabaseTree",e},initialize:function(e){s.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change",this.onModelChange)},onModelChange:function(){var e=t.keys(this.model.changedAttributes()),i=["serverName","dbName","connectionUrl"],n=this;t.each(t.intersection(e,i),function(e){n.$("[name='"+e+"']").val(n.model.get(e))})},updateDatabaseTree:function(e){e.preventDefault(),this.showAzureSqlDsTree("/")},render:function(){return this.$el.empty(),this.renderTimezoneSection(),this.renderAzureSqlSpecificSection(),this.renderTestConnectionSection(),this.initDataSourceTree(),this.options.isEditMode&&this.showAzureSqlDsTree(this.model.getFullDbTreePath()),this},showAzureSqlDsTree:function(e){this.model.validate({subscriptionId:this.model.get("subscriptionId"),keyStorePassword:this.model.get("keyStorePassword"),keyStoreUri:this.model.get("keyStoreUri")}),this.model.isValid("keyStorePassword")&&this.model.isValid("subscriptionId")&&this.azureSqlDataSourceTree.showTreePrefetchNodes(e||"/")},renderAzureSqlSpecificSection:function(){this.$el.append(t.template(d,this.templateData())),
this.browseButton=u.initialize({i18n:o,template:c,resourceInput:this.$el.find("[name=keyStoreUri]")[0],browseButton:this.$el.find("[name=repositoryBrowserButton]")[0],providerId:"fileResourceBaseTreeDataProvider",dialogTitle:o["resource.Add.Files.Title"],selectLeavesOnly:!0,onChange:t.bind(function(e){this.model.set("keyStoreUri",e),this.model.validate({keyStoreUri:e})},this)})},initDataSourceTree:function(){var e=this.options.isEditMode,t=this,n={hideLoader:!0,bShowRoot:!1,treeId:"azureSqlDataSourceTree",providerId:"azureSqlDataSourceTreeDataProvider",selectLeavesOnly:!0,additionalParams:function(){return{subscriptionId:t.model.get("subscriptionId"),keyStorePassword:t.model.get("keyStorePassword"),keyStoreUri:t.model.get("keyStoreUri"),datasourceUri:t.model.get("uri")}}};this.azureSqlDataSourceTree=a.createRepositoryTree("azureSqlDataSourceTree",n),this.azureSqlDataSourceTree.httpErrorHandler=function(e){var t,n,s=!1,r=["azure.exception.datasource.recovery.public.ip.not.provided","azure.exception.datasource.recovery.firewall.rule.name.not.provided","azure.exception.datasource.recovery.server.name.not.provided","azure.exception.datasource.recovery.subscription.id.not.provided","azure.exception.datasource.recovery.key.store.file.not.provided","azure.exception.datasource.recovery.key.store.type.not.provided","azure.exception.datasource.key.error","azure.exception.datasource.auth.error","azure.exception.datasource.cannot.retrieve.database.list","azure.exception.datasource.cannot.ensure.firewall.rule","azure.exception.datasource.cannot.recover.datasource"];for(n=0;n<r.length;n++){var a=r[n];if(-1!==e.responseText.indexOf(a)){s=l[a];break}}return s?(t=new i({modal:!0}),t.setMessage(s),t.open(),!0):!1},this.azureSqlDataSourceTree.observe("leaf:selected",function(i){var n=i.memo.node.param;if("leaf"===n.type&&!e){var s=n.extra;t.model.set({serverName:s.serverName,dbName:s.dBName,connectionUrlTemplate:s.jdbcTemplate,driverClass:s.jdbcDriver})}}),this.azureSqlDataSourceTree.observe("tree:loaded",function(){t.model.getFullDbTreePath()&&t.azureSqlDataSourceTree.openAndSelectNode(t.model.getFullDbTreePath(),function(){e=!1;var i=t.azureSqlDataSourceTree.getSelectedNode();i&&i.param&&i.param.extra&&t.model.set({connectionUrlTemplate:i.param.extra.jdbcTemplate,dbHost:i.param.extra.dnsAddress,dbPort:i.param.extra.dbPort})})})},remove:function(){this.azureSqlDataSourceTree&&this.azureSqlDataSourceTree.stopObserving(),n.prototype.remove.apply(this,arguments)}})}),define("dataSource/model/SubDataSourceModel",["require","backbone","underscore","bi/repository/model/RepositoryResourceModel","bundle!jasperserver_messages"],function(e){"use strict";var t=e("backbone"),i=(e("underscore"),e("bi/repository/model/RepositoryResourceModel")),n=e("bundle!jasperserver_messages");return t.Model.extend({defaults:{id:void 0,uri:"",name:"",readOnly:!1},idAttribute:"uri",validation:{id:[{required:!0,msg:n["ReportDataSourceValidator.error.not.empty.reportDataSource.name"]},{maxLength:i.settings.NAME_MAX_LENGTH,msg:n["ReportDataSourceValidator.error.too.long.reportDataSource.name"]},{startsWithLetter:!0,msg:n["ReportDataSourceValidator.error.invalid.chars.shouldStartWithLetter"]},{containsOnlyWordCharacters:!0,msg:n["ReportDataSourceValidator.error.invalid.chars.wordCharsOnly"]}]},initialize:function(e){this.set("name",/.*\/(.+)$/.exec(e.uri)[1])}})}),define("dataSource/collection/SubDataSourceCollection",["require","backbone","dataSource/model/SubDataSourceModel"],function(e){"use strict";var t=e("backbone"),i=e("dataSource/model/SubDataSourceModel");return t.Collection.extend({model:i,hasNonReadOnlyItems:function(){return this.some(function(e){return!e.get("readOnly")})}})}),define("dataSource/model/VirtualDataSourceModel",["require","dataSource/model/BaseDataSourceModel","dataSource/collection/SubDataSourceCollection","bi/repository/enum/repositoryResourceTypes","underscore","bundle!jasperserver_messages"],function(e){"use strict";var t=e("dataSource/model/BaseDataSourceModel"),i=e("dataSource/collection/SubDataSourceCollection"),n=e("bi/repository/enum/repositoryResourceTypes"),s=e("underscore"),r=e("bundle!jasperserver_messages");return t.extend({type:n.VIRTUAL_DATA_SOURCE,defaults:function(){var e={};return s.extend(e,t.prototype.defaults,{subDataSources:[]}),e}(),validation:function(){var e={};return s.extend(e,t.prototype.validation,{subDataSources:[{arrayMinLength:1,msg:r["ReportDataSourceValidator.error.sub.datasources.needed"]},{fn:function(e,t,i){var n=s.map(e,function(e){return e.id.toLowerCase()}),a={},o=[];s.each(n,function(e){e in a?a[e]++:a[e]=1});for(var l in a)a[l]>1&&o.push(l);return o.length>0?r["ReportDataSourceValidator.error.sub.datasources.id.duplicates"].replace("{0}",o.join(", ")):void 0}},{fn:function(){for(var e=null,t=0;t<this.subDataSources.models.length;t++)this.subDataSources.models[t].isValid(!0)||(e=!0);return e}}]}),e}(),initialize:function(e,n){t.prototype.initialize.apply(this,arguments),this.subDataSources=new i(this.get("subDataSources")),this.listenTo(this.subDataSources,"change reset",this.updateSubDataSourcesArray),n.dependentResources&&n.dependentResources.length>0&&this.subDataSources.forEach(function(e){e.set("readOnly",!0)})},updateSubDataSourcesArray:function(){this.set("subDataSources",this.subDataSources.toJSON())}})}),dialogs.dependentResources={dependenciesPanel:null,show:function(e,t,i){this.dependenciesPanel=jQuery("#dependencies"),this._$title=this.dependenciesPanel.find(".content .header .title"),i.dialogTitle&&(this._titleBackup=this._$title.html(),this._$title.html(i.dialogTitle)),dialogs.popup.show(this.dependenciesPanel[0]),this._changeMessage(i),this._switchButtons(i);var n=this._initList(e);this.dependenciesPanel.on("click",function(e){var i=jQuery(e.target).closest("button").attr("id"),s=t&&t[i];_.include(["dependenciesBtnSave","dependenciesBtnSaveAs","dependenciesBtnOk","dependenciesBtnCancel"],i)&&(dialogs.dependentResources.hide(),n.setItems([]),e.stopPropagation(),s&&s())})},hide:function(){this.dependenciesPanel&&(this.dependenciesPanel.off("click"),dialogs.popup.hide(this.dependenciesPanel[0]),this.dependenciesPanel=null),this._titleBackup&&this._$title&&(this._$title.html(this._titleBackup),this._titleBackup=null)},_changeMessage:function(e){jQuery("#topMessage").html(e.topMessage),jQuery("#bottomMessage").html(e.bottomMessage)},_initList:function(e){var t=new dynamicList.List("dependenciesList",{listTemplateDomId:"tabular_oneColumn",itemTemplateDomId:"tabular_oneColumn:leaf"}),i=[];return e&&(i=e.collect(function(e){var t=new dynamicList.ListItem({cssClassName:layoutModule.LEAF_CLASS,value:e});return t.processTemplate=function(e){var t,i=e.select(".uri")[0];return t="string"==typeof this.getValue()?this.getValue():this.getValue().uristring?this.getValue().uristring:this.getValue().URIString,i.update(xssUtil.escape(t)),e},t})),t.setItems(i),t.show(),t},_switchButtons:function(e){var t,i={save:jQuery("#dependenciesBtnSave"),saveAs:jQuery("#dependenciesBtnSaveAs"),ok:jQuery("#dependenciesBtnOk"),cancel:jQuery("#dependenciesBtnCancel")};t=e.buttons?e.buttons:e.okOnly?["ok"]:e.canSave?["save","saveAs","cancel"]:["ok","cancel"],_.each(i,function(e,i){t.indexOf(i)<0?e.addClass("hidden"):e.removeClass("hidden")})}},define("components.dependent.dialog",["prototype","components.dialogs","jquery","components.list"],function(e){return function(){var t;return t||e.dialogs.dependentResources}}(this)),define("text!dataSource/template/virtualSpecificTemplate.htm",[],function(){return'<fieldset class="group">\n    <input type="hidden" name="subDataSources" value=""/>\n    <span class="message warning"></span>\n</fieldset>\n<fieldset class="group">\n    <div style="position:relative" class="content" id="dataSourcesSelector">\n        <div class="body twoColumn_equal pickWells" id="subDsSelectionContainer">\n            <div class="moveButtons" id="moveButtons">\n                <button title="{{- i18n[\'resource.moveRight\'] }}" class="button action square move right up"\n                        disabled="disabled" name="toRight"><span class="wrap">{{- i18n["resource.moveRight"] }}<span\n                        class="icon"></span></span></button>\n                <button title="{{- i18n[\'resource.moveLeft\'] }}" class="button action square move left up"\n                        disabled="disabled" name="toLeft"><span class="wrap">{{- i18n["resource.moveLeft"] }}<span\n                        class="icon"></span></span></button>\n                <button title="{{- i18n[\'resource.moveAllLeft\'] }}" class="button action square move toLeft up"\n                        disabled="disabled" name="allToLeft"><span class="wrap">{{- i18n["resource.moveAllLeft"] }}<span\n                        class="icon"></span></span></button>\n            </div>\n\n            <div class="column secondary" id="availableDataSources">\n                <label for="subDataSourcesTree" class="control">\n                    <span class="wrap">{{- i18n["resource.dataSource.virtual.availableDataSources"] }}</span>\n                    <br>\n\n                    <div class="control groupBox">\n                        <div class="content ">\n                            <div class="header ">\n                                <div class="title"></div>\n                            </div>\n                            <div class="body  ">\n                                <ul class="list collapsible folders" id="subDataSourcesTree"></ul>\n                            </div>\n                        </div>\n                    </div>\n                </label>\n            </div>\n\n            <div class="column primary" id="selectedDataSources">\n                <label for="selectedSubDataSourcesList" class="control">\n                    <span class="wrap">{{- i18n["resource.dataSource.virtual.selectedDataSources"] }}</span>\n                    <br>\n\n                    <div class="content">\n                        <ul class="list tabular twoColumn header" id="selectedDataSourcesHeader">\n                            <li>\n                                <div class="wrap">\n                                    <div class="column one">\n                                        <p class="dataSourceName">{{- i18n["resource.dataSource.name"] }}</p>\n                                    </div>\n                                    <div class="column two">\n                                        <p class="dataSourceID">{{- i18n["resource.dataSource.virtual.subDsId"] }}</p>\n                                    </div>\n                                </div>\n                            </li>\n                        </ul>\n                        <div id="selectedSubDataSourcesListContainer">\n                            <ol class="list tabular twoColumn" id="selectedSubDataSourcesList"></ol>\n                        </div>\n                    </div>\n                </label>\n            </div>\n        </div>\n    </div>\n</fieldset>'}),define("text!dataSource/template/dialog/dependenciesTemplate.htm",[],function(){return'<div id="dependencies" class="panel dialog overlay dependencies sizeable moveable hidden centered_vert centered_horz">\r\n    <div class="sizer diagonal"></div>\r\n    <div class="content hasFooter ">\r\n        <div class="header mover">\r\n            <div class="title">{{- i18n["dialog.dependencies.title"] }}</div>\r\n        </div>\r\n        <div class="body">\r\n            <p id="topMessage"></p>\r\n\r\n            <div class="control groupBox">\r\n                <ul id="dependenciesList"></ul>\r\n            </div>\r\n            <p id="bottomMessage" class="saveMessage"></p>\r\n        </div>\r\n        <div class="footer ">\r\n            <button id="dependenciesBtnSave" class="button action primary up">\r\n                <span class="wrap">{{- i18n["button.save"] }}</span>\r\n                <span class="icon"></span>\r\n            </button>\r\n            <button id="dependenciesBtnSaveAs" class="button action primary up">\r\n                <span class="wrap">{{- i18n["button.saveAs"] }}</span>\r\n                <span class="icon"></span>\r\n            </button>\r\n            <button id="dependenciesBtnOk" class="button action primary up">\r\n                <span class="wrap">{{- i18n["button.ok"] }}</span>\r\n                <span class="icon"></span>\r\n            </button>\r\n            <button id="dependenciesBtnCancel" class="button action up">\r\n                <span class="wrap">{{- i18n["button.cancel"] }}</span>\r\n                <span class="icon"></span>\r\n            </button>\r\n        </div>\r\n    </div>\r\n</div>'}),define("text!dataSource/template/subDataSourceItemTemplate.htm",[],function(){return'<li class="leaf">\n    <div class="wrap button {{ if (readOnly) { }}disabled{{ } }}">\n        <div class="column one">\n            <p class="dataSourceName">{{- name }}</p>\n        </div>\n        <div class="column two">\n            <input type="text" size="30" class="dataSourceID" value="{{- id }}" {{ if (readOnly) { }}readonly="true"{{ } }}>\n            <div class="wrap validatorMessageContainer">\n                <span class="message warning"></span>\n            </div>\n        </div>\n    </div>\n</li>'}),define("dataSource/view/SubDataSourceItemView",["require","backbone","jquery","underscore","core.layout","components.list","common/util/featureDetection","text!dataSource/template/subDataSourceItemTemplate.htm","backbone.validation"],function(e){"use strict";var t=e("backbone"),i=e("jquery"),n=(e("underscore"),e("core.layout")),s=e("components.list"),r=(e("common/util/featureDetection"),e("text!dataSource/template/subDataSourceItemTemplate.htm")),a=e("backbone.validation");return t.View.extend({events:{"keyup input[type='text']":"updateDataSourceId","change input[type='text']":"updateDataSourceId"},initialize:function(e){var t=this.model.toJSON();this._listItem=new s.UnderscoreTemplatedListItem({template:r,cssClassName:n.LEAF_CLASS,value:t,tooltipText:this.model.get("uri")}),a.bind(this,{valid:this.fieldIsValid,invalid:this.fieldIsInvalid,forceUpdate:!0})},updateDataSourceId:function(e){var t=this.$("input[type='text']"),n={};n.id=i.trim(t.val()),this.model.set(n),this.model.validate(n),this._listItem.setValue(this.model.toJSON())},getListItem:function(){return this._listItem},setRootElement:function(){this.setElement(this._listItem._getElement())},fieldIsValid:function(e,t,i){var n=e.$("input[type='text']").parent();n.removeClass("error"),n.find(".validatorMessageContainer").removeClass("error"),n.find(".message.warning").text("")},fieldIsInvalid:function(e,t,i,n){var s=e.$("input[type='text']").parent();s.addClass("error"),s.find(".validatorMessageContainer").addClass("error"),s.find(".message.warning").text(i)}})}),define("text!dataSource/template/subDataSourcesListTemplate.htm",[],function(){return'<ul id="selectedDataSourcesTemplate" class="list tabular twoColumn"></ul>'}),define("dataSource/view/SubDataSourcesListView",["require","backbone","underscore","components.list","dataSource/view/SubDataSourceItemView","common/util/featureDetection","text!dataSource/template/subDataSourcesListTemplate.htm","utils.common"],function(e){"use strict";var t=e("backbone"),i=e("underscore"),n=e("components.list"),s=e("dataSource/view/SubDataSourceItemView"),r=e("common/util/featureDetection"),a=e("text!dataSource/template/subDataSourcesListTemplate.htm");return e("utils.common"),t.View.extend({events:{"blur input.dataSourceID":"disableSelection","focus input.dataSourceID":"enableSelection"},initialize:function(e){this.options=e,this.subviews=[],this._list=new n.UnderscoreTemplatedList("selectedSubDataSourcesList",{template:a,dragPattern:"",multiSelect:!0,selectOnMousedown:!r.supportsTouch}),this._list.observe("item:unselected",i.bind(this._itemUnselected,this)),this._list.observe("item:selected",i.bind(this._itemSelected,this)),this.setElement("#selectedSubDataSourcesList",!1),this.listenTo(this.collection,"reset",this.render)},disableSelection:function(){disableSelectionWithoutCursorStyle(this._list._getElement())},enableSelection:function(){enableSelection(this._list._getElement())},_itemUnselected:function(e){var t=this.getSubviewByListItem(e.memo.item),i=t?t.model:null;this.trigger("item:unselected",i)},_itemSelected:function(e){var t=this.getSubviewByListItem(e.memo.item),i=t?t.model:null;this.trigger("item:selected",i)},render:function(e,t){this._list.resetSelected();var n=[],r=[],a=[],o=!1,l=this.collection.map(function(e){return e.get("uri")}),d=this;if(t&&t.previousModels&&(a=i.map(t.previousModels,function(e){return e.get("uri")}),i.each(t.previousModels,function(e){i.include(l,e.get("uri"))||r.push(e)}),o=!0),this.collection.forEach(function(e){i.include(a,e.get("uri"))||n.push(e)}),n.length){if(i.each(n,function(e){var t=new s({model:e});d.subviews.push(t),d._list.addItems([t.getListItem()]),d._list.show()}),this._list.show(),o){var c=i.compact(i.map(n,i.bind(d.getSubviewByModel,d)));i.each(c,function(e){d._list.selectItem(e.getListItem(),!0)})}i.each(this.subviews,function(e){i.defer(i.bind(e.setRootElement,e))})}return r.length&&(i.each(r,function(e){d.removeSubview(e)}),this._list.show()),this},getSubviewByModel:function(e){return i.find(this.subviews,function(t){return t.model===e})},getList:function(){return this._list},getListLength:function(){return this._list._items.length},getSelectedModels:function(){var e=this._list.getSelectedItems(),t=i.compact(i.map(e,i.bind(this.getSubviewByListItem,this)));return i.map(t,function(e){return e.model})},getSubviewByListItem:function(e){return i.find(this.subviews,function(t){return t.getListItem()===e})},removeSubview:function(e){var t=this.getSubviewByModel(e);t&&(this._list.removeItems([t.getListItem()]),t.remove(),this._list.show())},removeSubviews:function(){var e=i.map(this.subviews,function(e){return e.getListItem()});this._list.removeItems(e),i.invoke(this.subviews,"remove")},remove:function(){this.removeSubviews(),t.View.prototype.remove.apply(this,arguments)}})}),define("dataSource/view/VirtualDataSourceView",["require","underscore","dataSource/view/BaseDataSourceView","dataSource/model/VirtualDataSourceModel","dataSource/model/SubDataSourceModel","dynamicTree.utils","components.dependent.dialog","common/util/featureDetection","bundle!jasperserver_messages","text!dataSource/template/virtualSpecificTemplate.htm","text!dataSource/template/dialog/dependenciesTemplate.htm","dataSource/view/SubDataSourcesListView"],function(e){"use strict";var t=e("underscore"),i=e("dataSource/view/BaseDataSourceView"),n=e("dataSource/model/VirtualDataSourceModel"),s=e("dataSource/model/SubDataSourceModel"),r=e("dynamicTree.utils"),a=e("components.dependent.dialog"),o=(e("common/util/featureDetection"),e("bundle!jasperserver_messages")),l=e("text!dataSource/template/virtualSpecificTemplate.htm"),d=e("text!dataSource/template/dialog/dependenciesTemplate.htm"),c=e("dataSource/view/SubDataSourcesListView");return i.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.virtual.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.virtual.page.title.edit",hasDependedResources:!1,modelConstructor:n,events:{"keyup input[type='text'][class!='dataSourceID'], textarea":"updateModelProperty","change input[type='text'][class!='dataSourceID'], textarea, select":"updateModelProperty","click [name=toRight]":"chooseTreeNodes","click [name=toLeft]":"removeSelectedSubDataSources","click [name=allToLeft]":"removeAllSubDataSources"},initialize:function(e){this.dependentResources=e.dependentResources,this._subDataSourcesHiddenNodes={},this.dependentResources&&this.dependentResources.length>0&&(this.hasDependedResources=!0),i.prototype.initialize.apply(this,arguments),this.showDependentResources(),this.listenTo(this.model.subDataSources,"reset",this.updateAllToLeftButtonState)},chooseTreeNodes:function(e){e.preventDefault(),this.$("[name=toRight]").attr("disabled","disabled").removeClass("over");var i=this.subDataSourcesTree.selectedNodes,n=t.compact(t.map(i,function(e){return e?new s({name:e.name,id:e.param.id,uri:e.param.uri,readOnly:!1}):null}));this.model.subDataSources.reset(this.model.subDataSources.models.concat(n));var r=t.map(i,function(e){return e.param.uri});this._hideAvailableSubDataSources(r)},removeAllSubDataSources:function(e){if(e.preventDefault(),!this.hasDependedResources){this.subDataSourcesTree._deselectAllNodes();var t=this;this.model.subDataSources.forEach(function(e){t._unhideAvailableSubDataSources(e.get("uri"))}),this.model.subDataSources.reset([]),this.updateRightButtonState()}},removeSelectedSubDataSources:function(e){e.preventDefault(),this.subDataSourcesTree._deselectAllNodes();var i=this.selectedSubDataSourcesList.getSelectedModels(),n=this,s=[];t.each(i,function(e){n._unhideAvailableSubDataSources(e.get("uri"))}),this.model.subDataSources.forEach(function(e){t.include(i,e)||s.push(e)}),this.model.subDataSources.reset(s),this.updateRightButtonState()},updateAllToLeftButtonState:function(){this.hasDependedResources||0===this.selectedSubDataSourcesList.getListLength()?this.$("[name=allToLeft]").attr("disabled","disabled").removeClass("over"):this.$("[name=allToLeft]").removeAttr("disabled")},updateRightButtonState:function(){for(var e=this.$("[name=toRight]"),t=this.subDataSourcesTree.selectedNodes,i=!1,n=!1,s=0;s<t.length;s++){if(t[s].isParent()||this.model.subDataSources.where({uri:t[s].param.uri}).length){n=!0;break}i=!0}i&&!n?e.removeAttr("disabled"):e.attr("disabled","disabled").removeClass("over")},updateLeftButtonState:function(){var e=this.selectedSubDataSourcesList.getSelectedModels(),t=this.$("[name=toLeft]");e.length>0?t.removeAttr("disabled"):t.attr("disabled","disabled").removeClass("over")},render:function(){return this.$el.empty(),this.renderVirtualSpecificSection(),this.updateAllToLeftButtonState(),this},showDependentResources:function(){this.hasDependedResources&&a.show(this.dependentResources,{},{canSave:!1,okOnly:!0,topMessage:o["resource.dataSource.virtual.dependencies.top.message"],bottomMessage:o["resource.dataSource.virtual.dependencies.bottom.message"]})},renderVirtualSpecificSection:function(){var e=this;this.$el.append(t.template(l,this.templateData())),this.$el.append(t.template(d,this.templateData())),this.selectedSubDataSourcesList=new c({collection:this.model.subDataSources}),this.listenTo(this.selectedSubDataSourcesList,"item:unselected item:selected",t.bind(this.updateLeftButtonState,this)),this.selectedSubDataSourcesList.render(),this.subDataSourcesTree=r.createRepositoryTree("subDataSourcesTree",{treeId:"subDataSourcesTree",providerId:"joinableDsTreeDataProvider",selectLeavesOnly:!0,multiSelectEnabled:!0}),this.subDataSourcesTree.observe("leaf:dblclick",t.bind(this.chooseTreeNodes,this)),this.subDataSourcesTree.observe("node:selected",t.bind(this.updateRightButtonState,this)),this.subDataSourcesTree.observe("node:unselected",t.bind(this.updateRightButtonState,this)),this.subDataSourcesTree.observe("leaf:selected",t.bind(this.updateRightButtonState,this)),this.subDataSourcesTree.observe("leaf:unselected",t.bind(this.updateRightButtonState,this));var i=[];this.model.subDataSources.length&&(i=this.model.subDataSources.map(function(e){return e.get("uri")})),this.subDataSourcesTree.showTreePrefetchNodes(i.join(","),function(t){e._hideAvailableSubDataSources(i)})},_hideAvailableSubDataSources:function(e){var i=this;if(t.isArray(e))t.each(e,function(e){i._hideAvailableSubDataSources(e)});else{var n=this.subDataSourcesTree.findLastLoadedNode(e);this._subDataSourcesHiddenNodes[e]={parent:n.parent,child:n};var s=n.parent;s.removeChild(n),s.resortChilds()}},_unhideAvailableSubDataSources:function(e){function i(e,t){e.processNodePath(t,function(t){t.parent&&e.rootNode!=t.parent&&e.getState(t.parent.id)==r.TreeNode.State.CLOSED&&t.parent.handleNode()})}var n=this;if(t.isArray(e))t.each(e,function(e){n._unhideAvailableSubDataSources(e)});else{var s=this._subDataSourcesHiddenNodes[e];s&&(s.parent.addChild(s.child),s.parent.resortChilds(),s.parent.refreshNode(),i(this.subDataSourcesTree,e),s.child.select())}},remove:function(){this.selectedSubDataSourcesList&&this.selectedSubDataSourcesList.remove(),i.prototype.remove.apply(this,arguments)}})}),define("dataSource/model/BeanDataSourceModel",["require","dataSource/model/BaseDataSourceModel","dataSource/enum/connectionTypes","bi/repository/enum/repositoryResourceTypes","underscore","bundle!jasperserver_messages"],function(e){"use strict";var t=e("dataSource/model/BaseDataSourceModel"),i=e("dataSource/enum/connectionTypes"),n=e("bi/repository/enum/repositoryResourceTypes"),s=e("underscore"),r=e("bundle!jasperserver_messages");return t.extend({type:n.BEAN_DATA_SOURCE,defaults:function(){var e={};return s.extend(e,t.prototype.defaults,{beanName:"",beanMethod:"",connectionType:i.BEAN}),e}(),validation:function(){var e={};return s.extend(e,t.prototype.validation,{beanName:[{required:!0,msg:r["ReportDataSourceValidator.error.not.empty.reportDataSource.beanName"]}],beanMethod:[{required:!0,msg:r["ReportDataSourceValidator.error.not.empty.reportDataSource.beanMethod"]}]}),e}()})}),define("text!dataSource/template/beanSpecificTemplate.htm",[],function(){return'<fieldset class="group shortFields">\n\n    <legend class="offLeft"><span></span></legend>\n\n    <label title="{{- i18n[\'resource.dataSource.bean.name\'] }}" class="control input text">\n        <span class="wrap">{{- i18n["resource.dataSource.bean.name"]}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.beanName }}" name="beanName">\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n["resource.dataSource.bean.hint1"]}}</span>\n    </label>\n\n    <label title="{{- i18n[\'resource.dataSource.bean.method\'] }}" class="control input text">\n        <span class="wrap">{{- i18n["resource.dataSource.bean.method"]}} ({{- i18n[\'required.field\']}}):</span>\n        <input type="text" value="{{- modelAttributes.beanMethod }}" name="beanMethod">\n        <span class="message warning"></span>\n        <span class="message hint">{{- i18n["resource.dataSource.bean.hint2"]}}</span>\n    </label>\n\n</fieldset>'}),define("dataSource/view/BeanDataSourceView",["require","underscore","dataSource/view/BaseDataSourceView","dataSource/model/BeanDataSourceModel","text!dataSource/template/beanSpecificTemplate.htm"],function(e){"use strict";var t=e("underscore"),i=e("dataSource/view/BaseDataSourceView"),n=e("dataSource/model/BeanDataSourceModel"),s=e("text!dataSource/template/beanSpecificTemplate.htm");return i.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.bean.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.bean.page.title.edit",modelConstructor:n,render:function(){return this.$el.empty(),this.renderBeanSpecificSection(),this.renderTestConnectionSection(),this},renderBeanSpecificSection:function(){this.$el.append(t.template(s,this.templateData()))}})}),define("text!dataSource/template/mongoDbSpecificTemplate.htm",[],function(){return'<fieldset name="customFieldsContainer" class="group shortFields">\n\n	<legend class="offLeft"><span>Access Properties</span></legend>\n\n\n\n\n	<label title="MongoDB URI (required)" class="control input text">\n		<span class="wrap">{{- i18n[\'MongoDbDataSource.properties.mongoURI\'] }} ({{- i18n[\'required.field\']}}):</span>\n		<input name="mongoURI" type="text" size="40" class="fnormal" value="{{- modelAttributes.mongoURI }}">\n		<span class="message hint"></span>\n		<span class="message warning"></span>\n	</label>\n\n\n	<label title="User Name (optional)" class="control input text">\n		<span class="wrap">{{- i18n[\'MongoDbDataSource.properties.username\'] }} ({{- i18n[\'optional.field\']}}):</span>\n		<input name="username" type="text" size="40" class="fnormal" value="{{- modelAttributes.username }}">\n		<span class="message hint"></span>\n		<span class="message warning"></span>\n	</label>\n\n	<label title="Password (optional)" class="control input text">\n		<span class="wrap">{{- i18n[\'MongoDbDataSource.properties.password\'] }} ({{- i18n[\'optional.field\']}}):</span>\n		<input name="password" type="password" size="40" class="fnormal" value="{{- modelAttributes.password }}">\n		<span class="message hint"></span>\n		<span class="message warning"></span>\n	</label>\n\n</fieldset>'}),define("dataSource/view/MongoDbDataSourceView",["require","underscore","dataSource/view/CustomDataSourceView","text!dataSource/template/mongoDbSpecificTemplate.htm"],function(e){"use strict";var t=e("underscore"),i=e("dataSource/view/CustomDataSourceView"),n=e("text!dataSource/template/mongoDbSpecificTemplate.htm");return i.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.mongo.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.mongo.page.title.edit",render:function(){return this.$el.empty(),this.renderMongoDbSpecificSection(),this.renderTestConnectionSection(),this},renderMongoDbSpecificSection:function(){this.$el.append(t.template(n,this.templateData()))}})}),define("dataSource/enum/mongoJdbcFileSourceTypes",{REPOSITORY:{name:"repository",label:"resource.datasource.text.fileLocation.options.repository"},SERVER_FILE_SYSTEM:{name:"serverFileSystem",label:"resource.datasource.text.fileLocation.options.serverFileSystem"}}),define("restResource",["require","request","requestSettings","underscore","jrs.configs"],function(e){"use strict";var t=e("request"),i=e("requestSettings"),n=e("underscore"),s=e("jrs.configs"),r=s.contextPath+"/rest_v2/",a=function(e,s){var a=n.extend({},i,{type:"GET",dataType:"json",url:r+e});t(a).fail(function(){s(null)}).then(function(e){s(e)})};return a.load=function(e,t,i,n){return n.isBuild?void i():void a(e,i)},a}),define("dataSource/model/MongoDbJdbcDataSourceModel",["require","dataSource/model/CustomDataSourceModel","dataSource/enum/connectionTypes","dataSource/enum/mongoJdbcFileSourceTypes","bi/repository/enum/repositoryResourceTypes","restResource!hypermedia/workflows?parentName=admin","underscore","bundle!jasperserver_messages"],function(e){"use strict";var t=e("dataSource/model/CustomDataSourceModel"),i=(e("dataSource/enum/connectionTypes"),e("dataSource/enum/mongoJdbcFileSourceTypes")),n=(e("bi/repository/enum/repositoryResourceTypes"),e("restResource!hypermedia/workflows?parentName=admin")),s=e("underscore"),r=e("bundle!jasperserver_messages"),a=t.extend({fileTypes:["pdf","config"],defaults:function(){var e={};return s.extend(e,t.prototype.defaults,{dataSourceName:"mongoDbJDBCDataSource",fileSourceType:"repository",timeZone:""}),e}(),validation:function(){var e={};return s.extend(e,t.prototype.validation,{serverAddress:[{required:!0,msg:r["ReportDataSourceValidator.error.not.empty.host"]}],portNumber:[{required:!0,msg:r["ReportDataSourceValidator.error.not.empty.server.port"]}],repositoryFileName:[{fn:function(e,t,i){return!i.autoSchemaDefinition&&"repository"===i.fileSourceType&&(s.isNull(e)||s.isUndefined(e)||s.isString(e)&&""===e)?r["fillParameters.error.mandatoryField"]:null}},{fn:function(e,t,i){return i.autoSchemaDefinition||"repository"!==i.fileSourceType||s.isString(e)&&""!==e&&0===e.indexOf("/")?null:r["resource.file.invalid.path"]}}],serverFileName:[{fn:function(e,t,i){return!i.autoSchemaDefinition&&"serverFileSystem"===i.fileSourceType&&(s.isNull(e)||s.isUndefined(e)||s.isString(e)&&""===e)?r["fillParameters.error.mandatoryField"]:null}}]}),e}(),isLocalFileSystemAccessAllowed:function(){return n&&n._embedded&&n._embedded.workflow&&s.find(n._embedded.workflow,function(e){return"serverSettings"===e.name})},parse:function(){var e=t.prototype.parse.apply(this,arguments);if(s.isString(e.fileName)){if(-1!==e.fileName.indexOf("repo:")){var n=e.fileName.split(":");e.fileSourceType=i.REPOSITORY.name,e.repositoryFileName=n[1]}else e.fileSourceType=i.SERVER_FILE_SYSTEM.name,e.serverFileName=e.fileName;delete e.fileName,
e.autoSchemaDefinition=!1}else e.autoSchemaDefinition=!0;return e.timezone=e.timeZone,delete e.timeZone,e},toJSON:function(){var e=t.prototype.toJSON.apply(this,arguments);return e.fileName=e.serverFileName,e},customFieldsToJSON:function(e,n){return e.fileSourceType===i.REPOSITORY.name?e.fileName="repo:"+e.repositoryFileName:e.fileSourceType===i.SERVER_FILE_SYSTEM.name&&(e.fileName=e.serverFileName),delete e.repositoryFileName,delete e.serverFileName,e.autoSchemaDefinition&&(delete e.fileName,delete e.fileSourceType),delete e.autoSchemaDefinition,e.timeZone=e.timezone,delete e.timezone,e=t.prototype.customFieldsToJSON.call(this,e,n)},resetValidation:function(){this.validation=s.clone(a.prototype.validation)}});return a}),define("text!dataSource/template/mongoDbJdbcSpecificTemplate.htm",[],function(){return'<fieldset class="group shortFields mongoDbJdbcSpecificFields">\n\n	<legend class="offLeft"><span></span></legend>\n\n	<label title="{{- i18n[\'resource.datasource.mongoJdbc.host\'] }}" class="control input text">\n		<span class="wrap">{{- i18n["resource.datasource.mongoJdbc.host"]}} ({{- i18n[\'required.field\']}}):</span>\n		<input type="text" value="{{- modelAttributes.serverAddress }}" name="serverAddress">\n		<span class="message warning"></span>\n		<span class="message hint"></span>\n	</label>\n\n	<label title="{{- i18n[\'resource.datasource.mongoJdbc.port.number\'] }}" class="control input text">\n		<span class="wrap">{{- i18n["resource.datasource.mongoJdbc.port.number"]}} ({{- i18n[\'required.field\']}}):</span>\n		<input type="text" value="{{- modelAttributes.portNumber }}" name="portNumber">\n		<span class="message warning"></span>\n		<span class="message hint"></span>\n	</label>\n\n	<label title="{{- i18n[\'resource.datasource.mongoJdbc.database.name\'] }}" class="control input text">\n		<span class="wrap">{{- i18n["resource.datasource.mongoJdbc.database.name"]}}:</span>\n		<input type="text" value="{{- modelAttributes.database }}" name="database">\n		<span class="message warning"></span>\n		<span class="message hint"></span>\n	</label>\n\n	<label title="{{- i18n[\'resource.datasource.mongoJdbc.user.name\'] }}" class="control input text">\n		<span class="wrap">{{- i18n["resource.datasource.mongoJdbc.user.name"]}}:</span>\n		<input type="text" value="{{- modelAttributes.username }}" name="username">\n		<span class="message warning"></span>\n		<span class="message hint"></span>\n	</label>\n\n	<label title="{{- i18n[\'resource.datasource.mongoJdbc.password\'] }}" class="control input text">\n		<span class="wrap">{{- i18n["resource.datasource.mongoJdbc.password"]}}:</span>\n		<input type="password" value="{{- modelAttributes.password }}" name="password">\n		<span class="message warning"></span>\n		<span class="message hint"></span>\n	</label>\n\n	<label title="{{- i18n[\'resource.datasource.mongoJdbc.connection.options\'] }}" class="control input text">\n		<span class="wrap">{{- i18n["resource.datasource.mongoJdbc.connection.options"]}}:</span>\n		<input type="text" value="{{- modelAttributes.connectionOptions }}" name="connectionOptions">\n		<span class="message warning"></span>\n		<span class="message hint"></span>\n	</label>\n\n	<div class="control checkBox">\n		<label for="__jrs_autoSchemaDefinitionCheckbox" title="{{- i18n[\'resource.datasource.mongoJdbc.schema.auto.generate\']}}" class="wrap">\n			{{- i18n[\'resource.datasource.mongoJdbc.schema.auto.generate\']}}\n		</label>\n		<input type="checkbox" id="__jrs_autoSchemaDefinitionCheckbox" name="autoSchemaDefinition" {{ if (modelAttributes.autoSchemaDefinition) { }}checked{{ } }} {{- isEditMode ? \'disabled="disabled"\' : \'\'}} >\n	</div>\n\n	<div name="fileLocationContainer" class="section"></div>\n</fieldset>'}),define("text!dataSource/template/mongoDbJdbcFileLocationSectionTemplate.htm",[],function(){return'<div name="fileLocationContainer" class="">\n\n	{{ if (_.keys(fileSourceTypeOptions).length > 1) { }}\n	<div class="">\n		<label title="{{- i18n[\'resource.datasource.mongoJdbc.fileLocation.source\'] }}" class="control select">\n			<span class="wrap">{{- i18n[\'resource.datasource.mongoJdbc.fileLocation.source\'] }}:</span>\n			<select id="fileSourceSelect" name="fileSourceType" {{- (isEditMode || modelAttributes.autoSchemaDefinition) ? \'disabled="disabled"\' : \'\'}}>\n			{{ _.each(fileSourceTypeOptions, function(item) { }}\n				<option value="{{- item.name }}" {{- (item.name == modelAttributes.fileSourceType) ? "selected=\'selected\'" : "" }} > {{- i18n[item.label] }}</option>\n			{{ }); }}\n			</select>\n			<span class="message warning"></span>\n		</label>\n	</div>\n    {{ } }}\n\n	{{ if (modelAttributes.fileSourceType === "repository") { }}\n\n	<div id="repositoryInput" class="">\n		<label title="{{- i18n[\'resource.datasource.mongoJdbc.fileLocation.repository.fileLocation\']}}" class="control input text">\n			<span class="wrap">{{- i18n[\'resource.datasource.mongoJdbc.fileLocation.repository.fileLocation\']}}{{ if (!modelAttributes.autoSchemaDefinition) { }} ({{- i18n[\'required.field\']}}){{ } }}:</span>\n			<input type="text" value="{{- modelAttributes.repositoryFileName }}" name="repositoryFileName" {{- (isEditMode || modelAttributes.autoSchemaDefinition) ? \'disabled="disabled"\' : \'\'}}>\n			<button class="button action" type="button" name="repositoryBrowserButton"  {{- isEditMode || modelAttributes.autoSchemaDefinition ? \'disabled="disabled"\' : \'\'}}>\n			       <span class="wrap">{{- i18n[\'dialog.file.browse\'] }}...<span class="icon"></span></span>\n			</button>\n			<span class="message warning"></span>\n		</label>\n	</div>\n\n	{{ } else { }}\n\n	<div id="serverInput" class="">\n		<label title="{{- i18n[\'resource.datasource.mongoJdbc.fileLocation.serverFileSystem.fileLocation\']}}" class="control browser">\n			<span class="wrap">{{- i18n[\'resource.datasource.mongoJdbc.fileLocation.serverFileSystem.fileLocation\']}}{{ if (!modelAttributes.autoSchemaDefinition) { }} ({{- i18n[\'required.field\']}}){{ } }}:</span>\n			<input type="text" value="{{- modelAttributes.serverFileName }}" name="serverFileName" {{- (isEditMode || modelAttributes.autoSchemaDefinition) ? \'disabled="disabled"\' : \'\'}}>\n			<span class="message warning"></span>\n		</label>\n	</div>\n\n	{{ } }}\n</div>'}),define("dataSource/view/MongoDbJdbcDataSourceView",["require","underscore","jquery","bundle!all","resource.locate","dataSource/enum/mongoJdbcFileSourceTypes","dataSource/view/CustomDataSourceView","dataSource/model/MongoDbJdbcDataSourceModel","text!dataSource/template/mongoDbJdbcSpecificTemplate.htm","text!dataSource/template/mongoDbJdbcFileLocationSectionTemplate.htm","text!common/templates/components.pickers.htm"],function(e){"use strict";var t=e("underscore"),i=e("jquery"),n=e("bundle!all"),s=e("resource.locate"),r=e("dataSource/enum/mongoJdbcFileSourceTypes"),a=e("dataSource/view/CustomDataSourceView"),o=e("dataSource/model/MongoDbJdbcDataSourceModel"),l=e("text!dataSource/template/mongoDbJdbcSpecificTemplate.htm"),d=e("text!dataSource/template/mongoDbJdbcFileLocationSectionTemplate.htm"),c=e("text!common/templates/components.pickers.htm");return a.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.mongoJdbc.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.mongoJdbc.page.title.edit",modelConstructor:o,browseButton:!1,events:function(){var e=t.extend({},a.prototype.events);return e["change [name=fileSourceType]"]="changeFileSourceType",e["change [name=autoSchemaDefinition]"]="changeAutoSchemaDefinition",e},initialize:function(e){a.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:serverFileName",this.adjustFileSystemConnectButton)},changeFileSourceType:function(){t.defer(t.bind(function(){this.renderFileLocationSection()},this))},changeAutoSchemaDefinition:function(){t.defer(t.bind(function(){this.renderFileLocationSection()},this))},render:function(){return this.$el.empty(),this.renderMongoDbSpecificSection(),this.renderFileLocationSection(),this.renderTimezoneSection(),this.renderTestConnectionSection(),this.$el.find("[name=serverAddress]").focus(),this},validationMethodOnSaveClick:function(e){!this.model.get("parentFolderUri")&&this.model.set("parentFolderUri","/"),!this.model.get("label")&&this.model.set("label",i("[name=dataSourceType] option:selected").text());var s=this;this.model.save({},{dryRun:!0}).fail(function(e){var i=!1;try{i=JSON.parse(e.responseText)}catch(r){}var a=t.isArray(i)?i:[i];t.each(a,function(e){e&&e.errorCode&&e.parameters&&("illegal.parameter.value.error"===e.errorCode&&"resourceReference.uri"===e.parameters[0]?s.fieldIsInvalid(s,"repositoryFileName",n["resource.file.invalid.path"],"name"):"invalid.server.file.system.path"===e.errorCode&&"textDataSource.propertyMap[fileName]"===e.parameters[0]&&s.fieldIsInvalid(s,"serverFileName",n["resource.file.invalid.path"],"name"))})}).done(e)},templateData:function(){var e=t.extend({},r);return this.model.isLocalFileSystemAccessAllowed()||delete e.SERVER_FILE_SYSTEM,t.extend(a.prototype.templateData.apply(this,arguments),{fileSourceTypeOptions:e})},renderMongoDbSpecificSection:function(){this.$el.append(t.template(l,this.templateData()))},renderFileLocationSection:function(){this.renderOrAddAnyBlock(this.$el.find("[name=fileLocationContainer]"),t.template(d,this.templateData())),this.browseButton&&(this.browseButton.remove(),this.browseButton=!1),"repository"!==this.model.get("fileSourceType")||this.model.get("autoSchemaDefinition")||(this.browseButton=s.initialize({i18n:n,template:c,resourceInput:this.$el.find("[name=repositoryFileName]")[0],browseButton:this.$el.find("[name=repositoryBrowserButton]")[0],providerId:"fileResourceBaseTreeDataProvider",dialogTitle:n["resource.Add.Files.Title"],selectLeavesOnly:!0,onChange:t.bind(function(e){this.model.set("repositoryFileName",e),this.model.validate({repositoryFileName:e})},this)}))}})}),define("text!dataSource/template/InternalDiagnosticTemplate.htm",[],function(){return'<fieldset name="customFieldsContainer" class="group shortFields">\n	{{- i18n["resource.datasource.internalDiagnostic.line1"] }}\n	<br/>\n	{{- i18n["resource.datasource.internalDiagnostic.line2"] }}\n	<br/>\n	{{- i18n["resource.datasource.internalDiagnostic.line3"] }}\n	<br/>\n	<br/>\n	<strong>{{- i18n["resource.datasource.internalDiagnostic.line4"] }}</strong>\n</fieldset>'}),define("dataSource/view/DiagnosticCustomDataSourceView",["require","dataSource/view/BaseDataSourceView","underscore","bundle!all","dataSource/model/CustomDataSourceModel","text!dataSource/template/InternalDiagnosticTemplate.htm"],function(e){"use strict";var t=e("dataSource/view/BaseDataSourceView"),i=e("underscore"),n=e("bundle!all"),s=e("dataSource/model/CustomDataSourceModel"),r=e("text!dataSource/template/InternalDiagnosticTemplate.htm");return t.extend({PAGE_TITLE_NEW_MESSAGE_CODE:"resource.datasource.jndi.page.title.new",PAGE_TITLE_EDIT_MESSAGE_CODE:"resource.datasource.jndi.page.title.edit",modelConstructor:s,render:function(){return this.$el.empty(),this.renderBlankBody(),this},renderBlankBody:function(){this.$el.append(i.template(r,{i18n:n}))}})}),define("dataSource/factory/dataSourceViewFactory",["require","dataSource/view/CustomDataSourceView","dataSource/enum/dataSourceResourceTypes","dataSource/enum/customDataSourceTypes","dataSource/view/JdbcDataSourceView","dataSource/view/JndiDataSourceView","dataSource/view/AwsDataSourceView","dataSource/view/AzureSqlDataSourceView","dataSource/view/VirtualDataSourceView","dataSource/view/BeanDataSourceView","dataSource/view/MongoDbDataSourceView","dataSource/view/MongoDbJdbcDataSourceView","dataSource/view/DiagnosticCustomDataSourceView"],function(e){"use strict";var t=e("dataSource/view/CustomDataSourceView"),i=e("dataSource/enum/dataSourceResourceTypes"),n=e("dataSource/enum/customDataSourceTypes"),s=e("dataSource/view/JdbcDataSourceView"),r=e("dataSource/view/JndiDataSourceView"),a=e("dataSource/view/AwsDataSourceView"),o=e("dataSource/view/AzureSqlDataSourceView"),l=e("dataSource/view/VirtualDataSourceView"),d=e("dataSource/view/BeanDataSourceView"),c=e("dataSource/view/MongoDbDataSourceView"),u=e("dataSource/view/MongoDbJdbcDataSourceView"),h=e("dataSource/view/DiagnosticCustomDataSourceView"),p={};return p[i.JDBC.toLowerCase()]=s,p[i.JNDI.toLowerCase()]=r,p[i.AWS.toLowerCase()]=a,p[i.AZURE_SQL.toLowerCase()]=o,p[i.VIRTUAL.toLowerCase()]=l,p[i.BEAN.toLowerCase()]=d,p[i.MONGODB]=c,p[i.MONGODBJDBC]=u,p[n.DIAGNOSTIC]=h,{getView:function(e){var i;return e.dataSourceType?(i=p[e.dataSourceType],i||(i=t)):i=s,new i(e)},getViewType:function(e,t){var n=/application\/repository\.([^+]+)\+json/.exec(e),s=n&&n[1]?n[1].toLowerCase():e.toLowerCase();return i.CUSTOM.toLowerCase()===s&&(s=t.dataSourceName),s}}}),define("common/component/dialog/DialogWithModelInputValidation",["require","jquery","underscore","./Dialog","backbone.validation"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),n=e("./Dialog"),s=e("backbone.validation");return n.extend({events:i.extend({"keyup input[type=text], textarea, select":"updateModelProperty","change input[type=text], input:checkbox, textarea, select":"updateModelProperty"},n.prototype.events),initialize:function(){this._bindEvents(),n.prototype.initialize.apply(this,arguments)},_bindEvents:function(){this.on("resize",this._getBaseHeight)},_unbindEvents:function(){this.off("resize",this._getBaseHeight)},updateModelProperty:function(e){var i={},n=t(e.target);"input"===n[0].tagName.toLowerCase()&&"text"===n.attr("type")||"select"===n[0].tagName.toLowerCase()&&"true"!==n.attr("multiple")||"textarea"===n[0].tagName.toLowerCase()?i[n.attr("name")]=t.trim(n.val()):"input"===n[0].tagName.toLowerCase()&&"checkbox"===n.attr("type")&&(i[n.attr("name")]=n.is(":checked")),this.beforeModelPropertySet&&this.beforeModelPropertySet(i),this.model.set(i),this.model.validate(i)},bindValidation:function(){s.bind(this,{valid:this.fieldIsValid,invalid:this.fieldIsInvalid,forceUpdate:!0,selector:"name"})},unbindValidation:function(){s.unbind(this)},fieldIsValid:function(e,t,i){var n=e.$("["+i+'="'+t+'"]').parent();n.removeClass("error"),n.find(".message.warning").text(""),e._updateHeight()},fieldIsInvalid:function(e,t,i,n){var s=e.$("["+n+'="'+t+'"]').parent();s.addClass("error"),s.find(".message.warning").text(i.toString()),e._updateHeight()},validField:function(e){var t=this.$(e).parent();t.removeClass("error"),t.find(".message.warning").text("")},invalidField:function(e,t){var i=this.$(e).parent();i.addClass("error"),i.find(".message.warning").text(t.toString())},clearValidationErrors:function(){this.$("label").removeClass("error"),this.$(".message.warning").text(""),this._updateHeight()},remove:function(){this.unbindValidation(),this._unbindEvents(),n.prototype.remove.apply(this,arguments)},_updateHeight:function(){var e=this._getBaseHeight(this.$el.height()),t=this._getAllErrorsHeight();0!==t?this.$el.height(t+e):this.$el.height(e)},_getBaseHeight:function(e){var t=this._getAllErrorsHeight();return i.isNumber(e)&&i.isUndefined(this._previousHeight)?this._previousHeight=e:i.isObject(e)&&e.timeStamp&&(this._previousHeight=t?this.$el.height()-t:this.$el.height()),this._previousHeight},_getAllErrorsHeight:function(){var e=0;return this.$(".message.warning").each(function(){e+=t(this).height()}),e}})}),define("common/component/panel/trait/collapsiblePanelTrait",["require","underscore","jquery","./abstractPanelTrait"],function(e){"use strict";function t(e,t){!t&&e.stopPropagation(),this.onCollapseControlPressed?this.onCollapseControlPressed(e):this.toggleCollapsedState()}function i(){this.$collapser&&this.$collapser.off("mousedown"),this.$el&&this.$el.find(this.expandOnDblClickSelector).off("dblclick")}var n=e("underscore"),s=e("jquery"),r=e("./abstractPanelTrait");return n.extend({},r,{onConstructor:function(e){this.collapserClass=e.collapserClass||"buttonIconToggle",this.collapserSelector=e.collapserSelector||".buttonIconToggle",this.collapsiblePanelClass=e.collapsiblePanelClass||"collapsiblePanel",this.expandOnDblClickSelector=e.expandOnDblClickSelector||"> p:first",this.allowEventPropagation=!!e.allowMouseDownEventPropagation,this.onCollapseControlPressed=e.onCollapseControlPressed},beforeSetElement:function(){i.call(this)},afterSetElement:function(){this.$el.addClass(this.collapsiblePanelClass),this.$collapser=this.$(this.collapserSelector),this.$collapser.length||(this.$collapser=s("<button></button>").addClass(this.collapserClass),this.$("> .header").prepend(this.$collapser)),this.$collapser.on("mousedown",n.bind(t,this,this.allowEventPropagation)),this.$el.find(this.expandOnDblClickSelector).on("dblclick",n.bind(t,this))},onRemove:function(){i.call(this)}})}),define("common/component/list/model/ScalableListModel",["require","backbone","underscore"],function(e){"use strict";var t=e("backbone"),i=e("underscore"),n=100,s=.95,r=t.Model.extend({initialize:function(e){i.bindAll(this,"_fetchComplete","fetchFailed","afterFetchComplete","fetch"),this.set({items:[]},{silent:!0}),this.getData=e.getData,this.bufferSize=e.bufferSize||n,this.loadFactor=e.loadFactor||s},_fetchComplete:function(e){this.attributes.total=e.total,this.set({items:e.data},{silent:!0}),this.attributes.bufferEndIndex=Math.max(0,Math.min(this.attributes.bufferStartIndex+this.bufferSize-1,this.attributes.bufferStartIndex+e.data.length-1)),this.attributes.bufferEndIndex<this.attributes.bufferStartIndex+this.bufferSize-1&&(this.attributes.total=Math.min(e.total,this.attributes.bufferEndIndex+1)),this.afterFetchComplete&&this.afterFetchComplete(e.data,this.attributes.total),this.trigger("change",this)},_isBufferReloadNecessary:function(e,t){if("undefined"==typeof this.get("bufferStartIndex")||"undefined"==typeof this.get("bufferEndIndex"))return!0;if(e>=0&&e<this.get("bufferStartIndex")||t<this.get("total")&&t>this.get("bufferEndIndex"))return!0;if(e===this.get("bufferStartIndex")&&t===this.get("bufferEndIndex"))return!1;var i=1-(e-this.get("bufferStartIndex"))/this.bufferSize,n=1-(this.get("bufferEndIndex")-t)/this.bufferSize;return this.get("bufferStartIndex")>0&&i>=this.loadFactor||this.get("bufferEndIndex")<this.get("total")&&n>=this.loadFactor},afterFetchComplete:function(e,t){},fetchFailed:function(e,t){this.trigger("fetchFailed",e,t)},fetch:function(e){if(e=i.extend({top:this.get("bufferStartIndex")||0,bottom:this.get("bufferEndIndex")||this.bufferSize-1},e),e.force||this._isBufferReloadNecessary(e.top,e.bottom)){if(e.top!==this.attributes.bufferStartIndex||e.bottom!==this.attributes.bufferEndIndex||e.force){var t=e.top+Math.floor((e.bottom-e.top)/2),n=Math.floor(this.bufferSize/2);this.attributes.bufferStartIndex=Math.max(0,t-n),this.get("total")&&!e.force?this.attributes.bufferEndIndex=Math.min(this.get("total"),this.attributes.bufferStartIndex+this.bufferSize)-1:this.attributes.bufferEndIndex=this.attributes.bufferStartIndex+this.bufferSize-1}this.getData({offset:this.get("bufferStartIndex"),limit:this.get("bufferEndIndex")-this.get("bufferStartIndex")+1}).done(this._fetchComplete).fail(this.fetchFailed)}else this._fetchComplete({data:this.get("items"),total:this.get("total")})},reset:function(e){this.attributes={},this.set({items:[]},{silent:!0}),e&&e.silent||this.trigger("change",this)}});return r}),define("common/component/list/model/BaseListWithSelectionModel",["require","underscore","common/component/list/model/ScalableListModel"],function(e){"use strict";var t=e("underscore"),i=e("common/component/list/model/ScalableListModel"),n=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.select(e.value,{silent:!0})},_addToSelection:function(e,t){throw"Not implemented"},_removeFromSelection:function(e,t){throw"Not implemented"},_clearSelection:function(){throw"Not implemented"},_selectionContains:function(e,t){throw"Not implemented"},_getSelection:function(){throw"Not implemented"},_triggerSelectionChange:function(e){e&&e.silent||this.trigger("change"),this.trigger("selection:change")},_addRangeToSelection:function(e,t,i){for(var n=0;n<e.length;n++)this._addToSelection(e[n].value,n+t);this.trigger("selection:addRange",{start:t,end:i,selection:this.getSelection()})},_fetchAllDataAndModifySelection:function(e,t){return this.getData().done(function(i){for(var n=0;n<i.data.length;n++)e(i.data[n].value,n);t&&t()}).fail(this.fetchFailed),this},addValueToSelection:function(e,t){return this.selectionStartIndex=t,this._addToSelection(e,t),this.trigger("selection:add",{value:e,index:t})},addRangeToSelection:function(e,t){if("undefined"==typeof this.selectionStartIndex)return void this.addValueToSelection(e,t);if(this.selectionStartIndex!==t){var i=Math.min(this.selectionStartIndex,t),n=Math.max(this.selectionStartIndex,t);if(this.selectionStartIndex=t,i>=this.get("bufferStartIndex")&&n<=this.get("bufferEndIndex")){var s=Array.prototype.slice.call(this.get("items"),i-this.get("bufferStartIndex"),n-this.get("bufferStartIndex")+1);this._addRangeToSelection(s,i,n)}else{var r=this;this.getData({offset:i,limit:n-i+1}).done(function(e){r._addRangeToSelection(e.data,i,n)}).fail(this.fetchFailed)}}},removeValueFromSelection:function(e,t){this._removeFromSelection(e,t),this.trigger("selection:remove",{value:e,index:t})},toggleSelection:function(e,t){this.selectionContains(e,t)?this.removeValueFromSelection(e,t):this.addValueToSelection(e,t)},selectionContains:function(e,t){return this._selectionContains(e,t)},clearSelection:function(){return this._clearSelection(),this.trigger("selection:clear")},getSelection:function(){return this._getSelection()},select:function(e,t){throw"Not implemented"},selectAll:function(){var e=this,i=!0;this._fetchAllDataAndModifySelection(function(t,n){i&&(e._clearSelection(),i=!1),e._addToSelection(t,n)},t.bind(this._triggerSelectionChange,this))},invertSelection:function(){var e=this;this._fetchAllDataAndModifySelection(function(t,i){e._selectionContains(t,i)?e._removeFromSelection(t,i):e._addToSelection(t,i)},t.bind(this._triggerSelectionChange,this))}});return n}),define("common/component/list/model/ListWithSelectionModel",["require","underscore","common/component/list/model/BaseListWithSelectionModel"],function(e){"use strict";var t=e("underscore"),i=e("common/component/list/model/BaseListWithSelectionModel"),n=i.extend({_addToSelection:function(e,t){this.selection[t]=e},_removeFromSelection:function(e,t){this.selection[t]=void 0},_clearSelection:function(){this.selection=[]},_selectionContains:function(e,t){return this.selection[t]===e},_getSelection:function(){return this.selection},_isSelectionEmpty:function(e){if(!e)return!0;if(t.isArray(e)&&0===e.length)return!0;if(t.isArray(e)||"string"==typeof e)return!1;for(var i in e)if(e.hasOwnProperty(i)&&void 0!==e[i])return!1;return!0},_selectPendingSelection:function(e,t){if(0===this.get("bufferStartIndex")&&this.get("bufferEndIndex")==this.get("total")-1)this._convertInitialArrayToSelection(this.get("items"),e,t);else{var i=this;this.getData().done(function(n){i._convertInitialArrayToSelection(n.data,e,t)}).fail(this.fetchFailed)}},_convertInitialArrayToSelection:function(e,t,i){for(var n=0;n<e.length;n++)t[e[n].value]&&this._addToSelection(e[n].value,n);this._triggerSelectionChange(i)},_triggerSelectionChange:function(e){this._calcSelectionStartIndex&&this._calcSelectionStartIndex(),i.prototype._triggerSelectionChange.call(this,e)},_calcSelectionStartIndex:function(){if("undefined"==typeof this.selectionStartIndex)for(var e in this.selection)if(this.selection.hasOwnProperty(e)&&void 0!==this.selection[e]){this.selectionStartIndex=parseInt(e,10);break}},select:function(e,i){if(this._clearSelection(),this._isSelectionEmpty(e))return void this._triggerSelectionChange(i);if(t.isArray(e)||"string"==typeof e){var n={};if("string"==typeof e)n[e]=!0;else for(var s=0;s<e.length;s++)n[e[s]]=!0;this._selectPendingSelection(n,i)}else{for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];void 0!==a&&this._addToSelection(a,r)}this._triggerSelectionChange(i)}}});return n}),define("text!common/component/list/templates/viewPortChunksTemplate.htm",[],function(){return'{{_.each(chunks, function(chunk) { }}\r\n<div class="j-view-port-chunk" style="height: {{- chunk.height}}px"></div>\r\n{{ }); }}\r\n'}),define("text!common/component/list/templates/itemsTemplate.htm",[],function(){return'<ul class="jr-mSelectlist jr" style="top: {{- top}}px; position: relative;">\r\n    {{_.each(items, function(item) { }}\r\n    <li class="jr-mSelectlist-item {{ if (item.selected) print(\'jr-isSelected\'); }} jr" title="{{ print(item.label && item.label.trim() ? _.xssEscape(item.label) : \'&nbsp;\')}}" data-index="{{- item.index}}">\r\n        <div class="jr-mSelectlist-item-wrapper jr">\r\n            <a class="jr-mSelectlist-item-text jr">{{ print(item.label && item.label.trim() ? _.xssEscape(item.label) : \'&nbsp;\')}}</a>\r\n        </div>\r\n    </li>\r\n    {{ }); }}\r\n</ul>'}),define("common/component/list/view/ScalableList",["require","jquery","backbone","underscore","common/component/list/model/ScalableListModel","text!common/component/list/templates/viewPortChunksTemplate.htm","text!common/component/list/templates/itemsTemplate.htm"],function(e){"use strict";var t=e("jquery"),i=e("backbone"),n=e("underscore"),s=e("common/component/list/model/ScalableListModel"),r=e("text!common/component/list/templates/viewPortChunksTemplate.htm"),a=e("text!common/component/list/templates/itemsTemplate.htm"),o=1e6,l=50,d=50,c=21,u=2,h=i.View.extend({ListModel:s,listItemSelector:"li",events:{scroll:"onScroll",touchmove:"onScroll"},attributes:{style:"overflow-y: auto; height: 100px"},initialize:function(e){return n.bindAll(this,"_fetchVisibleData"),this.model=e.model||new this.ListModel(e),this.chunksTemplate=n.template(e.chunksTemplate||r),this.itemsTemplate=n.template(e.itemsTemplate||a),this.defaultChunkHeight=this.chunkHeight=e.chunkHeight||o,this.scrollTimeout="undefined"!=typeof e.scrollTimeout?e.scrollTimeout:l,this.manualScrollInterval=e.manualScrollInterval||d,this.lazy=e.lazy,this.defaultItemHeight=e.listItemHeight||c,this.listItemSelector=e.listItemSelector||this.listItemSelector,this.render(),this.initListeners(),this.lazy||this.model.fetch(),this},initListeners:function(){this.listenTo(this.model,"change",this.onModelChange,this),this.listenTo(this.model,"fetchFailed",this.onFetchFailed,this)},render:function(){return this},onScroll:function(e){this.scrollTimeout>0?(clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(this._fetchVisibleData,this.scrollTimeout)):this._fetchVisibleData()},onModelChange:function(){this.renderData()},onFetchFailed:function(e,t){this.trigger("listRenderError",e,t)},postProcessChunkModelItem:function(e,i){e.index=this.model.get("bufferStartIndex")+i,void 0===e.label&&(e.label=e.value),e.label=t.trim(e.label)},_renderItems:function(){var e=this.model.get("bufferStartIndex"),i=this.model.get("bufferEndIndex"),n=this.itemsPerChunk?Math.ceil((e+1)/this.itemsPerChunk):1,s=this.itemsPerChunk?Math.ceil((i+1)/this.itemsPerChunk):1,r=this;this.$el.find(".j-view-port-chunk").each(function(a,o){var l=r._getChunkModel({index:a+1,firstChunkWithData:n,lastChunkWithData:s,bufferStart:e,bufferEnd:i,total:r.totalItems,itemsPerChunk:r.itemsPerChunk,itemHeight:r.itemHeight,chunkHeight:r.chunkHeight,model:r.model}),d=l?r.itemsTemplate(l):"";t(o).html(d)})},_renderViewChunks:function(e){(this.totalItems!==this.model.get("total")||e)&&(this.totalItems=this.model.get("total"),this.$el.html(this.chunksTemplate({_:n,chunks:this._getViewChunksModel()})),this.$firstViewChunk=this.$el.find(".j-view-port-chunk:first"))},_getViewChunksModel:function(){for(var e=this.itemsPerChunk?Math.ceil(this.totalItems/this.itemsPerChunk):1,t=e>0?this.itemHeight?this.totalItems*this.itemHeight-(e-1)*this.chunkHeight:this.chunkHeight:1,i=[],n=1;e>n;n++)i.push({height:this.chunkHeight});return i.push({height:t}),i},_calcViewPortConstants:function(){this.viewPortConstantsInitialized||(this.itemHeight=this.defaultItemHeight,this.$firstViewChunk&&(this.itemHeight=this.$el.find(this.listItemSelector+":first").outerHeight(!0),!this.itemHeight||this.itemHeight<=u?(this.itemHeight=this.defaultItemHeight,this.viewPortConstantsInitialized=!1):this.viewPortConstantsInitialized=!0),this._calcViewPortHeight(),this.itemsPerChunk=Math.floor(this.defaultChunkHeight/this.itemHeight),this.chunkHeight=this.itemsPerChunk*this.itemHeight,this._renderViewChunks(!0),this._renderItems())},_calcViewPortHeight:function(){this.viewPortHeight=this.$el.height(),this.itemsPerView=Math.floor(this.viewPortHeight/this.itemHeight)-1},_getItemsPerView:function(){return this._calcViewPortConstants(),this.itemsPerView},_getChunkModel:function(e){var t=e.index;if(t<e.firstChunkWithData||t>e.lastChunkWithData)return null;var i=e.itemsPerChunk?Math.max(e.bufferStart,e.itemsPerChunk*(t-1)):e.bufferStart,s=e.itemsPerChunk?Math.min(e.bufferEnd,e.itemsPerChunk*t-1):e.bufferEnd,r=e.itemHeight?i*e.itemHeight-(t-1)*e.chunkHeight:0,a=Array.prototype.slice.call(e.model.get("items"),i-e.bufferStart,s-e.bufferStart+1);return n.each(a,function(t,n){this.postProcessChunkModelItem(t,n+(i-e.bufferStart))},this),{top:r,items:a}},_fetchVisibleData:function(){var e=this._getVisibleItems();this.model.fetch({top:e.top,bottom:e.bottom})},_getVisibleItems:function(){var e=this._getScrollPos(),t=this.model.get("total"),i=Math.min(t-this.itemsPerView,Math.floor(e/this.itemHeight)),n=Math.min(t-1,i+this.itemsPerView+1);return{top:i,bottom:n}},_getScrollPos:function(){this._calcViewPortConstants();var e=0;if(this.$firstViewChunk){var t=this.$el.offset(),i=this.$firstViewChunk.offset();t&&i&&(e=t.top-i.top)}return e},renderData:function(){return!this.lazy&&this.model.has("bufferStartIndex")&&this.model.has("bufferEndIndex")?(this.trigger("before:render:data"),this._renderViewChunks(),this._renderItems(),this._calcViewPortConstants(),this.trigger("render:data")):(this.lazy=null,this.model.fetch()),this},resize:function(){if(this.$el.is(":visible")){var e=this.$el.outerHeight();e!==this._componentHeight&&(this._componentHeight=e,this.viewPortConstantsInitialized=!1,this._calcViewPortConstants())}},fetch:function(e,t){this.lazy=!1,t=t||{};var i;t.keepPosition?i=this.$el.get(0).scrollTop:this.reset({silent:!0,lazy:!1}),this.model.once("change",function(){t.keepPosition&&this.$el.scrollTop(i),e&&e.apply(this,arguments)},this).fetch({force:!0})},reset:function(e){e=n.defaults(e||{},{lazy:!0}),this.$el.scrollTop(0),this.lazy=e.lazy,this.model.reset(e)},scrollTo:function(e){if("number"==typeof e){var t=this._getScrollPos();if(this.viewPortConstantsInitialized){this._calcViewPortHeight();var i=null,n=e*this.itemHeight;t>n?i=n:n+this.itemHeight>t+this.viewPortHeight&&(i=n+this.itemHeight-this.viewPortHeight),null!==i&&this.$el.scrollTop(i)}}}});return h}),define("common/component/list/view/ListWithSelection",["require","jquery","underscore","common/component/list/model/ListWithSelectionModel","common/component/list/view/ScalableList"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),n=e("common/component/list/model/ListWithSelectionModel"),s=e("common/component/list/view/ScalableList"),r=1,a={LEFT:"left",RIGHT:"right"},o=s.extend({ListModel:n,globalEvents:!0,initialize:function(e){return i.bindAll(this,"onGlobalMouseup","onGlobalMousemove","_autoScroll","fetch"),this.eventListenerPattern=e.eventListenerPattern||"li",this.markerClass=e.markerClass?e.markerClass:"",this.selectedClass=e.selectedClass?e.selectedClass:"selected",this._initSelection(e.selection),s.prototype.initialize.call(this,e)},delegateEvents:function(){var e=s.prototype.delegateEvents.apply(this,arguments);return this.$el.on("mousedown",this.eventListenerPattern,i.bind(this.onMousedown,this)).on("mousemove",this.eventListenerPattern,i.bind(this.onMousemove,this)).on("dblclick",this.eventListenerPattern,i.bind(this.onMousedblclick,this)).on("contextmenu",this.eventListenerPattern,i.bind(this.onItemEvent,this,this.$el)).on("mouseout",this.eventListenerPattern,i.bind(this.onItemEvent,this,this.$el)).on("mouseover",this.eventListenerPattern,i.bind(this.onItemEvent,this,this.$el)),
!this.globalEvents&&this.$el.on("mouseup",this.eventListenerPattern,this.onGlobalMouseup),e},undelegateEvents:function(){var e=s.prototype.undelegateEvents.apply(this,arguments);return this.$el.off("mouseup").off("mousedown").off("mousemove").off("dblclick").off("contextmenu").off("mouseout").off("mouseover"),e},_initSelection:function(e){e=i.extend({allowed:{}},e);var t=e.allowed,n=i.isObject(t)?t.left:t;this.selection={allowed:{left:"undefined"!=typeof n?n:!0,right:"undefined"!=typeof t.right?t.right:!1},multiple:"undefined"!=typeof e.multiple?e.multiple:!0}},initListeners:function(){s.prototype.initListeners.call(this),this.listenTo(this.model,"selection:clear",this.clearSelection,this),this.listenTo(this.model,"selection:add",this.selectValue,this),this.listenTo(this.model,"selection:addRange",this.selectRange,this),this.listenTo(this.model,"selection:remove",this.deselectValue,this),this.globalEvents&&t("body").on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},postProcessChunkModelItem:function(e,t){s.prototype.postProcessChunkModelItem.call(this,e,t),e.selected=this.model.selectionContains&&this.model.selectionContains(e.value,e.index)},onMousedblclick:function(e){if(!this.selection.multiple&&(this.selection.allowed.left||this.selection.allowed.right)&&!this.getDisabled()){var t=this._getDomItemData(e.currentTarget);this._singleSelect(e,t.value,t.index),this.selectionChanged&&(this._triggerSelectionChanged(),this._triggerDblclicked(),this.selectionChanged=!1)}},getItemByEvent:function(e){return this._getDomItemData(e.currentTarget).item},onItemEvent:function(e,t){var i=t.type,n=this.getItemByEvent(t);this.trigger("list:item:"+i,n,t)},onMousedown:function(e){if(!this.getDisabled()&&(this.selection.allowed.left&&1===e.which||this.selection.allowed.right&&3===e.which)){var t=1===e.which?a.LEFT:a.RIGHT;this.selection.multiple&&(this[t+"MouseButtonPressed"]=!0,this.mouseDownPos=this._getMousePos(e));var i=this._getDomItemData(e.currentTarget);this.selection.multiple?this._multiSelect(e,i.value,i.index):this._singleSelect(e,i.value,i.index)}},onMousemove:function(e){if(this._allowMouseMoveSelection()&&(this._stopAutoScroll(),this._mouseMoved(e,this.mouseDownPos))){this.mouseDownPos=this._getMousePos(e);var t=this._getDomItemData(e.currentTarget);this.model.selectionContains(t.value,t.index)||this.model.addRangeToSelection(t.value,t.index)}},onGlobalMouseup:function(e){var t=this;(this.leftMouseButtonPressed||this.rightMouseButtonPressed)&&(i.each(a,function(e){t[e+"MouseButtonPressed"]=!1}),delete this.mouseDownPos,this._stopAutoScroll(),this.selectionChanged&&(this._triggerSelectionChanged(),this.selectionChanged=!1))},onGlobalMousemove:function(e){this._allowMouseMoveSelection()&&(this.mousePosY=e.clientY,this.scrollInterval||(this.scrollInterval=setInterval(this._autoScroll,this.manualScrollInterval)))},clearSelection:function(){this.$el.find("li."+this.selectedClass+this.markerClass).removeClass(this.selectedClass),this.selectionChanged=!0},selectValue:function(e){this.$el.find("li"+this.markerClass+"[data-index='"+e.index+"']:not(."+this.selectedClass+")").addClass(this.selectedClass),this.selection.multiple?this.selectionChanged=!0:this._triggerSelectionChanged()},selectRange:function(e){var i=this,n=Math.max(this.model.get("bufferStartIndex"),e.start),s=Math.min(this.model.get("bufferEndIndex"),e.end);this.$el.find("li"+this.markerClass+":not(."+this.selectedClass+")").each(function(){var e=t(this),r=parseInt(e.attr("data-index"),10);if(r>=n&&s>=r){var a=i.model.get("items")[r-i.model.get("bufferStartIndex")];i.model.selectionContains(a.value,r)&&e.addClass(i.selectedClass)}}),this.selectionChanged=!0},deselectValue:function(e){this.$el.find("li[data-index='"+e.index+"']."+this.selectedClass+this.markerClass).removeClass(this.selectedClass),this.selection.multiple?this.selectionChanged=!0:this._triggerSelectionChanged()},_autoScroll:function(){var e,t=this.$el.offset().top,i=this.$el.scrollTop(),n="undefined"!=typeof this.scrollTop?this.scrollTop:i,s=!1;this.mousePosY<t?(e=n-3*this.itemHeight,s=i>e):this.mousePosY>t+this.viewPortHeight&&(e=n+3*this.itemHeight,s=e>i),s&&(this.$el.scrollTop(e),this.scrollTop=this.$el.scrollTop(),this._fetchVisibleData()),this._selectRangeOnAutoScroll(n,e)},_selectRangeOnAutoScroll:function(e,t){var i;if(t>e?i=this._getVisibleItems().bottom:e>t&&(i=this._getVisibleItems().top),i){var n=this.model.get("items")[i-this.model.get("bufferStartIndex")];n&&(this.model.selectionContains(n.value,i)||this.model.addRangeToSelection(n.value,i))}},_stopAutoScroll:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=void 0,this.scrollTop=void 0)},_multiSelect:function(e,t,i){e.shiftKey?this.model.addRangeToSelection(t,i):e.ctrlKey||e.metaKey?this._singleSelect(e,t,i):this.model.toggleSelection(t,i)},_singleSelect:function(e,t,i){this.model.clearSelection().addValueToSelection(t,i)},_triggerSelectionChanged:function(){this.trigger("selection:change",this.getValue())},_triggerDblclicked:function(){this.trigger("item:dblclick",this.getValue())},_getDomItemData:function(e){for(var i=t(e),n=i.attr("data-index");void 0===n;)i=i.parent(),n=i.attr("data-index");n=parseInt(n,10);var s=this.model.get("items")[n-this.model.get("bufferStartIndex")];return{item:s,value:s.value,index:n}},_mouseMoved:function(e,t){return Math.abs(t.x-e.clientX)+Math.abs(t.y-e.clientY)>=r},_getMousePos:function(e){return{x:e.clientX,y:e.clientY}},_allowMouseMoveSelection:function(){return(this.selection.allowed.left&&this.leftMouseButtonPressed||this.selection.allowed.right&&this.rightMouseButtonPressed)&&this.selection.multiple&&!this.getDisabled()},getValue:function(){return this.model.getSelection()},setValue:function(e,t){return t=t||{},t&&t.silent||t.modelOptions&&t.modelOptions.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),t=t.modelOptions,this.model.select(e,t),this},selectAll:function(e){return e&&e.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),this.model.selectAll(),this},selectNone:function(e){return this.setValue({},e)},invertSelection:function(e){return e&&e.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),this.model.invertSelection(),this},setDisabled:function(e){return this.disabled=e,this.disabled?this.$el.addClass("disabled"):this.$el.removeClass("disabled"),this},getDisabled:function(){return this.disabled},remove:function(){return t("body").off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove),s.prototype.remove.call(this)}});return o}),define("common/component/tree/trait/addToSelectionModelTrait",["require","underscore","common/component/list/model/ScalableListModel"],function(e){"use strict";var t=e("underscore"),i=e("common/component/list/model/ScalableListModel");return{afterFetchComplete:function(e,n){i.prototype.afterFetchComplete.apply(this,arguments);var s,r;t.each(e,function(e,t){e.addToSelection&&(e.selected=!0,s=e.value,r=this.get("bufferStartIndex")+t,this.selectionContains&&!this.selectionContains(s,r)&&this.addValueToSelection(s,r),delete e.addToSelection)},this)}}}),define("common/component/tree/plugin/TreePlugin",["require","backbone"],function(e){"use strict";var t=e("backbone");return t.View.extend({dataLayerObtained:function(){},itemsRendered:function(){}},{processors:null,treeInitialized:function(){},treeRemoved:function(){}})}),define("text!common/component/tooltip/template/tooltipTemplate.htm",[],function(){return'<div class="{{- cssClasses }}" style="position: absolute; z-index: 100000;">\n    <div class="content">\n        <div class="body"></div>\n    </div>\n</div>\n'}),define("common/component/tooltip/Tooltip",["require","jquery","underscore","backbone","text!./template/tooltipTemplate.htm"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),n=e("backbone"),s=e("text!./template/tooltipTemplate.htm");return n.View.extend({template:i.template(s),delay:500,offset:{x:10,y:10},attribute:"data-tooltip",cssClasses:"panel info tooltip",contentSelector:".body",triggerEvents:!1,el:function(){return this.template({cssClasses:this.cssClasses})},constructor:function(e){if(e||(e={}),!e.attachTo||0===t(e.attachTo).length)throw new Error("Tooltip should be attached to an element");if(!e.contentTemplate)throw new Error("Tooltip should have contentTemplate");this._shown=!1,this.$attachTo=t(e.attachTo),this.$attachTo[0].tooltip=this,e.delay&&(this.delay=e.delay),e.offset&&(this.offset=e.offset),e.attribute&&(this.attribute=e.attribute),e.cssClasses&&(this.cssClasses=e.cssClasses),this.contentTemplate=e.contentTemplate,this.i18n=e.i18n||{},!i.isUndefined(e.triggerEvents)&&(this.triggerEvents=e.triggerEvents),this.selector="["+this.attribute+"]",i.bindAll(this,"show","_onMouseMove","_onMouseLeave"),this.$attachTo.on("mousemove touchmove",this.selector,this._onMouseMove),this.$attachTo.on("mouseleave touchend",this.selector,this._onMouseLeave),n.View.prototype.constructor.apply(this,arguments)},_render:function(e,t,s){if(this._event){e=e instanceof n.Model?e.toJSON():e;var r=i.template(this.contentTemplate)({model:e,i18n:this.i18n,options:t||{}});this.$el.find(".body").empty().append(r),this._showTooltip()}s.resolve()},show:function(e,n){var s=new t.Deferred;return this._timer=setTimeout(i.bind(this._render,this,e,n,s),this.delay),s},_showTooltip:function(){t("body").append(this.$el),this._updatePosition(),this._shown=!0,this.triggerEvents&&this.trigger("show",this)},hide:function(){this.contentTemplate&&this._timer&&clearTimeout(this._timer),this.$el.detach(),this._shown=!1,this.triggerEvents&&this.trigger("hide",this)},_updatePosition:function(){var e=this.$el.innerHeight(),i=this.$el.innerWidth(),n=t(window).height(),s=t(window).width(),r=this.offset.y,a=this.offset.x;e+this._event.pageY+this.offset.y+3>=n&&(r=-this.offset.y-e),i+this._event.pageX+this.offset.x+3>=s&&(a=-this.offset.x-i),this.$el.css({top:this._event.pageY+r,left:this._event.pageX+a})},_onMouseMove:function(e){this._event=e},_onMouseLeave:function(){this._shown&&this.hide(),this._timer&&clearTimeout(this._timer),this._event=null},remove:function(){this._shown&&this.hide(),this._timer&&clearTimeout(this._timer),this.$attachTo.off("mousemove touchmove",this.selector,this._onMouseMove),this.$attachTo.off("mouseleave touchend",this.selector,this._onMouseLeave),n.View.prototype.remove.apply(this,arguments)}},{attachTo:function(e,t){var i=this;return t||(t={}),t.attachTo=e||"body",new i(t)},detachFrom:function(e){e=t(e)[0],e.tooltip&&e.tooltip.remove()}})}),define("common/component/tree/plugin/TooltipPlugin",["require","./TreePlugin","underscore","common/component/tooltip/Tooltip"],function(e){"use strict";var t=e("./TreePlugin"),i=e("underscore"),n=e("common/component/tooltip/Tooltip");return t.extend({initialize:function(e){this.tooltip=n.attachTo(e.attachTo,i.omit(e,"el")),this.listensToList=!1,t.prototype.initialize.apply(this,arguments)},itemsRendered:function(e,t){var i=this;this.listensToList||(this.listensToList=!0,this.listenTo(t,"list:item:mouseover",function(e,t){i.tooltip.show(e)}),this.listenTo(t,"list:item:mouseout",function(){i.tooltip.hide()}))},remove:function(){n.detachFrom(this.$el),this.tooltip.remove(),t.prototype.remove.apply(this,arguments)}})}),define("common/component/tree/dataprovider/DataProviderWithSearchCache",["require","underscore","jquery"],function(e){"use strict";var t=e("underscore"),i=e("jquery"),n=999,s=50,r=50,a="criteria",o=2147483647,l=function(e){t.bindAll(this,"getData"),e=e||{},this.dataCache=[],this.dataCacheTotal=null,this.dataCachePages=[],this.pageSize=e.pageSize||n,this.criteriaKey=e.searchKey||a,this.maxSearchCacheSize=e.maxSearchCacheSize||s,this.getDataByCriteriaHolder={},this.controlGetTotal="undefined"!=typeof e.controlGetTotal?e.controlGetTotal:!1,this.dataConverter=e.dataConverter,this.saveLastCriteria="undefined"!=typeof e.saveLastCriteria?e.saveLastCriteria:!1,this.lastCriteria=null,this.serialRequestsDelay="undefined"!=typeof e.serialRequestsDelay?e.serialRequestsDelay:r,this.serialRequestsDelayedPromise=null,this.request=e.request};return t.extend(l.prototype,{getData:function(e){if(e=e||{},e[this.criteriaKey])return this._getDataByCriteria(e[this.criteriaKey])(e);if("undefined"==typeof e[this.criteriaKey]&&this.saveLastCriteria&&this.lastCriteria)return this._getDataByCriteria(this.lastCriteria)(e);this.lastCriteria=null;var t=i.Deferred(),n=this._getPagesToLoad(e);return n?this._requestData(e,n,t):this._resolveDeferredUsingDataFromCache(t,e),t.promise()},clear:function(){this.dataCache=[],this.dataCacheTotal=null,this.dataCachePages=[],this.getDataByCriteriaHolder={},this.lastCriteria=null},_requestData:function(e,i,n){var s=(i[i.length-1]-i[0]+1)*this.pageSize,r=t.extend({},e,{offset:i[0]*this.pageSize,limit:s});this.controlGetTotal&&(r.skipGetTotal=!0),s>=o/this.pageSize*this.pageSize&&delete r.limit,this.controlGetTotal&&"number"!=typeof this.dataCacheTotal&&delete r.skipGetTotal,this.serialRequestsDelay>0?(clearTimeout(this.deferredTimeout),this.deferredTimeout=setTimeout(t.bind(this._requestDataDeferred,this,e,r,n),this.serialRequestsDelay)):this._requestDataDeferred(e,r,n)},_requestDataDeferred:function(e,i,n){var s=this._getPagesToLoad(e);s?this.serialRequestsDelayedPromise&&t.isEqual(i,this.serialRequestsDelayedPromise.query)?this.serialRequestsDelayedPromise.promise.done(n.resolve).fail(n.reject):(this.serialRequestsDelayedPromise={promise:n.promise(),query:i},this.request(i).done(t.bind(this._requestDone,this,e,i,n)).fail(n.reject)):this._resolveDeferredUsingDataFromCache(n,e)},_requestDone:function(e,t,i,n){this._putDataToCache(t,n),this.serialRequestsDelayedPromise=null,this._resolveDeferredUsingDataFromCache(i,e)},_resolveDeferredUsingDataFromCache:function(e,t){var i=this._getDataFromCache(t);e.resolve({total:this.dataCacheTotal,data:i})},_getPagesToLoad:function(e){var t,i=this._convertLimitOffsetToFirstLast(e),n=this._findPageIndex(i.first),s=this._findPageIndex(i.last),r=[];for(t=n;s>=t;t++)if(!this.dataCachePages[t]){r.push(t);break}for(t=s;t>=n;t--)if(!this.dataCachePages[t]){r.push(t);break}return r.length>0?r:null},_findPageIndex:function(e){return Math.floor(e/this.pageSize)},_convertLimitOffsetToFirstLast:function(e){var t=e&&e.offset?e.offset:0,i=e&&e.limit?t+e.limit-1:this.dataCacheTotal?this.dataCacheTotal-1:o;return this.dataCacheTotal&&i>this.dataCacheTotal-1&&(i=this.dataCacheTotal-1),{first:t,last:i}},_getDataFromCache:function(e){e=t.defaults(e,{offset:0,limit:o});var i=Math.max(0,e.offset),n=Math.min(i+e.limit,this.dataCacheTotal);return this.dataCache.slice(i,n)},_putDataToCache:function(e,t){var i;for("undefined"!=typeof t.total&&(this.dataCacheTotal=t.total),e.limit=e.limit||o,i=0;i<t.data.length;i++)this.dataCache[i+e.offset]=this.dataConverter?this.dataConverter(t.data[i]):t.data[i];var n=e.offset/this.pageSize,s=Math.floor((Math.min(e.limit,t.data.length)+e.offset-1)/this.pageSize);for(i=n;s>=i;i++)this.dataCachePages[i]=!0},_getDataByCriteria:function(e){if(!this.getDataByCriteriaHolder[e]){var t,i=Number.MAX_VALUE,n=0,s=0;for(var r in this.getDataByCriteriaHolder)if(this.getDataByCriteriaHolder.hasOwnProperty(r)){s+=1;var a=this.getDataByCriteriaHolder[r];a.index<i&&(i=a.index,t=r),a.index>n&&(n=a.index)}s>=this.maxSearchCacheSize&&delete this.getDataByCriteriaHolder[t],this.getDataByCriteriaHolder[e]={getData:this._createDataProviderForCriteria(e),index:n+1}}return this.lastCriteria=e,this.getDataByCriteriaHolder[e].getData},_createDataProviderForCriteria:function(e){var i=this.request,n=this,s=new l({pageSize:this.pageSize,dataConverter:this.dataConverter,serialRequestsDelay:this.serialRequestsDelay,searchKey:this.criteriaKey,controlGetTotal:this.controlGetTotal,request:function(s){var r=t.extend({},s);return r[n.criteriaKey]=e,i(r)}}),r=s.getData;return s.getData=function(e){var i=t.extend({},e);return delete i[n.criteriaKey],r.call(s,i)},s.getData}}),l}),define("common/component/tree/TreeLevel",["require","underscore","common/component/panel/Panel","common/component/panel/trait/collapsiblePanelTrait","common/component/list/view/ListWithSelection","common/component/tree/trait/addToSelectionModelTrait","common/component/list/model/ListWithSelectionModel","common/component/tree/plugin/TooltipPlugin","./dataprovider/DataProviderWithSearchCache"],function(e){"use strict";function t(){this.$el.removeClass(this.loadingClass).addClass(this.openClass),l.invoke(this.plugins,"itemsRendered",this.list.model,this.list);var e=this.list.$("> .j-view-port-chunk > ul > li").addClass(this.cid).length,t=l.isFunction(this.levelHeight)?this.levelHeight():this.levelHeight;t&&e*this.listItemHeight>t?this.list.$el.css({height:t+"px","overflow-y":"auto"}):this.list.$el.css({height:"auto",overflow:"auto"}),this.list._calcViewPortHeight(),this._isReady=!0,this.trigger("ready",this)}function i(e,t){this.listRenderError=!0,this.trigger("listRenderError",e,t,this)}function n(e){var t=[];l.chain(e).keys(e).each(function(i){t.push(e[i])}),this.selection.multiple||o(this),this.trigger("selection:change",t,this,[])}function s(e){var t=[];l.chain(e).keys(e).each(function(i){t.push(e[i])}),this.selection.multiple||o(this),this.trigger("item:dblclick",t)}function r(e,t){for(var i=0;i<t.length;i++)if(t[i]===e)return!0}function a(e,t,i,n){i&&i.exclude&&l.isArray(i.exclude)&&r(e,i.exclude)||(void 0===n||n>0)&&l.chain(e.items).keys().each(function(s){i&&i.exclude&&l.isArray(i.exclude)&&r(e.items[s],i.exclude)||t.call(e.items[s],i),a(e.items[s],t,i,void 0===n?n:--n)})}function o(e,t){t=t&&{exclude:t.exclude},a(e,function(e){this.list.clearSelection(),this.list.model.selection=[]},t)}var l=e("underscore"),d=e("common/component/panel/Panel"),c=e("common/component/panel/trait/collapsiblePanelTrait"),u=e("common/component/list/view/ListWithSelection"),h=e("common/component/tree/trait/addToSelectionModelTrait"),p=e("common/component/list/model/ListWithSelectionModel").extend(h),m=(e("common/component/tree/plugin/TooltipPlugin"),e("./dataprovider/DataProviderWithSearchCache"));return d.extend({constructor:function(e){e||(e={}),l.extend(e,{traits:[c]}),d.prototype.constructor.call(this,e)},initialize:function(e){e||(e={}),this._isReady=!1,this.item=e.item||{},this.id=this.item.id,this.owner=e.owner,this.parent=e.parent,this.itemsTemplate=e.itemsTemplate,this.listItemHeight=e.listItemHeight,this.levelHeight=e.levelHeight,this.lazyLoad=!!e.lazyLoad,this.selection=e.selection||{allowed:!1,multiple:!1},this.resource=this.item.value,this.bufferSize=e.bufferSize,this.cache="undefined"!=typeof e.cache?e.cache:!1,this.allowMouseDownEventPropagation=e.allowMouseDownEventPropagation,this.items={},this.plugins=[];for(var t={el:this.el,model:this.model},i=0,n=e.plugins.length;n>i;i++){var s=e.plugins[i].constr;this.plugins.push(new s(l.extend({},t,e.plugins[i].options)))}this.dataLayer=this.owner.getDataLayer(this),l.invoke(this.plugins,"dataLayerObtained",this.dataLayer),d.prototype.initialize.apply(this,arguments)},render:function(){var e=new p({bufferSize:this.bufferSize,getData:this._getDataProvider(this.cache)});return this.list=new u({markerClass:"."+this.cid,eventListenerPattern:"."+this.cid+":not(.readonly) > p",el:this.$contentContainer,itemsTemplate:this.itemsTemplate,listItemHeight:this.listItemHeight,lazy:!0,selection:this.selection,allowMouseDownEventPropagation:this.allowMouseDownEventPropagation,model:e}),this.list.on("render:data",l.bind(t,this)),this.list.on("listRenderError",l.bind(i,this)),this.list.on("selection:change",l.bind(n,this)),this.list.on("item:dblclick",l.bind(s,this)),this.lazyLoad?this.on("open",this._onOpen,this):this.list.renderData(),this},_getDataProvider:function(e){var t=this,i=l.bind(function(e){return this.obtainData(e,t)},this.dataLayer),n={};return e&&("object"==typeof e&&(n=l.extend(n,e)),n.request=n.request||i,this.dataProvider=new m(n),i=this.dataProvider.getData),function(e){return e||(e={offset:0,limit:100}),e.id=t.id,i(l.extend({},t.owner.context,e),t)}},_onOpen:function(){this.$el.removeClass(this.openClass).addClass(this.loadingClass),this.list.renderData()},setElement:function(e){var t=d.prototype.setElement.apply(this,arguments);return this.list&&(this.list.setElement(this.$contentContainer),this.list.totalItems=-1),l.each(this.plugins,function(t){t.setElement(e)}),this.lazyLoad||this.list&&this.list.renderData(),this.collapsed||(this.open({silent:!0,depth:0}),this.lazyLoad&&this.list.renderData()),t},open:function(e){a(this,d.prototype.open,e,e?e.depth:0),d.prototype.open.call(this,e)},close:function(e){d.prototype.close.call(this,e),a(this,d.prototype.close,e,e?e.depth:void 0),o(this)},getLevel:function(e){return l(this.items).reduce(function(t,i){return t||(i.id===e?i:i.getLevel(e))},!1)},refresh:function(e){this.listRenderError||(this.lazyLoad&&!this.collapsed||!this.lazyLoad?(this.once("ready",l.bind(a,this,this,this.refresh,e,1)),this.list.model.fetch({top:0,bottom:this.list.model.bufferSize,force:!0}),this.list.scrollTo(0)):(this.list.model.set("bufferStartIndex",void 0,{silent:!0}),this.list.model.set("bufferEndIndex",void 0,{silent:!0}),this.list.model.set("total",void 0,{silent:!0}),a(this,this.refresh,e)))},fetch:function(e,t){this.list.fetch(t,e)},recalcConstraints:function(){this.list.resize()},fetchVisibleData:function(){this.list._fetchVisibleData()},resetSelection:function(e){o(this,e),e&&e.silent||this.trigger("selection:change",[])},hasItems:function(){return!!this.$("> .subcontainer > .j-view-port-chunk > ul > li").length},clearCache:function(){l.each(this.items,function(e){e.clearCache()}),this.dataProvider&&this.dataProvider.clear()},remove:function(){var e=this,t=-1;if(l.forEach(l.keys(this.items),function(t){e.items[t].remove()}),this.dataProvider&&this.dataProvider.clear(),this.list.remove(),this.parent){var i=this.parent.id,n=this.owner.getDataLayer(i);if(n&&n.predefinedData&&n.predefinedData[i]&&l.isArray(n.predefinedData[i])){for(var s=0;s<n.predefinedData[i].length;s++)if(n.predefinedData[i][s].id===this.id){t=s;break}t>-1&&(n.predefinedData[i].splice(t,1),delete n.predefinedData[this.id])}delete this.parent.items[this.id]}d.prototype.remove.apply(this,arguments)},isReady:function(){return this._isReady}})}),define("common/component/tree/TreeDataLayer",["require","underscore","jquery","common/util/classUtil","./TreeLevel","common/util/xssUtil","request"],function(e){"use strict";function t(e,t){return n.call(this,i.call(this,e),t)}function i(e){for(var t=0,i=e.length;i>t;t++)e[t]={id:this.extractId(e[t]),value:e[t]};return e}function n(e,t){var i,n;if(this.processors&&this.processors.length)for(var s=0,r=this.processors.length;r>s;s++){i=[];for(var a=0,o=e.length;o>a;a++)n=this.processors[s].processItem(e[a],t,this),n&&i.push(n);e=i}return e}var s=e("underscore"),r=e("jquery"),a=e("common/util/classUtil"),o=(e("./TreeLevel"),e("common/util/xssUtil")),l=e("request");return a.extend({constructor:function(e){this.requestType=e.requestType?e.requestType:"GET",e.getDataUri&&(this.getDataUri=e.getDataUri),this.getDataUri||(this.getDataUri=s.template(e.dataUriTemplate)),e.getDataArray&&(this.getDataArray=e.getDataArray),e.getDataSize&&(this.getDataSize=e.getDataSize),e.extractId&&(this.extractId=e.extractId),this.levelDataId=e.levelDataId?e.levelDataId:"id",this.processors=e.processors||[],this.initialize(e)},initialize:function(e){},extractId:function(e){return e[this.levelDataId]},getDataSize:function(e,t,i){return this.getDataArray(e,t,i).length},getDataArray:function(e,t,i){return e},obtainData:function(e,i){var n=new r.Deferred,s=this;return this.predefinedData&&this.predefinedData[e.id]?n.resolve({total:this.predefinedData[e.id].length,data:this.predefinedData[e.id]}):l({type:this.requestType,dataType:this.dataType||"json",headers:{Accept:this.accept||"application/json","Content-Type":this.contentType||void 0},cache:!1,data:this.data||void 0,url:this.getDataUri(e)}).done(function(){var i=o.escape(arguments[0],{softHTMLEscape:!0});s.dataSize=s.getDataSize.call(s,i,e,arguments[2]),n.resolve({total:s.dataSize,data:t.call(s,s.getDataArray.call(s,i,e,arguments[2]),e)})}).fail(function(e){n.reject(e.status,e.responseText)}),n},_process:t})}),define("text!common/component/tree/template/treeLevelListTemplate.htm",[],function(){return'<ul class="list collapsible folders" style="top: {{- top}}px; position: relative;">\n    {{ _.each(items, function(item){ }}\n    <li class="{{- item._node ? \'node closed\' : \'leaf\'}} {{- item.selected ? \'selected\' : \'\'}}" data-index="{{- item.index }}" tabindex="-1">\n        <p class="wrap button draggable" data-tooltip="{{- item.value.label }}"><b class="icon"/> {{- item.value.label }} </p>\n        <div class="subcontainer" />\n    </li>\n    {{ }) }}\n</ul>\n'}),define("text!common/component/tree/template/treeLevelTemplate.htm",[],function(){return'<div>\n    <ul class="list collapsible folders">\n        <li class="node">\n            <p class="wrap button">\n                <b class="icon" id="handler2" title=""></b>root\n            </p>\n            <div class="subcontainer"/>\n        </li>\n    </ul>\n</div>'}),define("common/component/tree/Tree",["require","css!lists","jquery","underscore","backbone","./TreeLevel","./TreeDataLayer","text!./template/treeLevelListTemplate.htm","text!./template/treeLevelTemplate.htm"],function(e){"use strict";function t(e){var i=e.list.model.get("items"),s=this;i=n.where(i,{_node:!0}),e.$(".node").each(function(a,o){var l=i[a].id;e.items[l]?e.items[l].setElement(o):(e.items[l]=new r(n.extend({},s._options,{el:o,item:i[a],parent:e})),s.listenTo(e.items[l],"listRenderError",n.bind(function(e,t,i){this.trigger("levelRenderError",e,t,i)},s)),e.listenTo(e.items[l],"ready",n.bind(t,s)),e.listenTo(e.items[l],"selection:change",function(t,i,n){i&&n.push(i),e.list.model.clearSelection(),e.trigger("selection:change",t,e,n)}),e.listenTo(e.items[l],"item:dblclick",function(t){e.list.model.clearSelection(),e.trigger("item:dblclick",t)}),e.items[l].render())}).length&&e.$(".j-view-port-chunk").css({height:"auto"})}e("css!lists");var i=e("jquery"),n=e("underscore"),s=e("backbone"),r=e("./TreeLevel"),a=e("./TreeDataLayer"),o=e("text!./template/treeLevelListTemplate.htm"),l=e("text!./template/treeLevelTemplate.htm"),d={ADD:"add",UPDATE:"update"},c=s.View.extend({template:n.template(l),_plugins:[],el:function(){return this.template()},constructor:function(e){e||(e={}),this.defaultDataLayer=new a(e),this.customDataLayers=e.customDataLayers,e.type?(this._type=e.type,e.type=void 0):this._type="tree",e.collapserSelector||(e.collapserSelector="b.icon:eq(0)"),e.predefinedData?(this.defaultDataLayer.predefinedData=e.predefinedData,e.predefinedData=void 0):this.defaultDataLayer.predefinedData={},e.rootless&&(this.rootless=e.rootless,e.rootless=void 0),e.additionalCssClasses&&(this.additionalCssClasses=e.additionalCssClasses,e.additionalCssClasses=void 0),e.getDataLayer&&(this.getDataLayer=e.getDataLayer,e.getDataLayer=void 0),this._options=n.extend({itemsTemplate:o,plugins:this._plugins,owner:this},e),this.context=e.context||{};for(var t=0,i=this._plugins.length;i>t;t++)this._plugins[t].processors&&(this.processors=this.processors.concat(this._plugins[t].processors));s.View.apply(this,arguments)},initialize:function(e){this.rootLevel=new r(n.extend({},this._options,{levelHeight:e.rootLevelHeight},{el:this.$("li")[0]},{item:{id:"/",value:{id:"/",resourceType:"folder"}}})),this.rootless&&this.$el.find("ul:first").addClass("hideRoot"),this.additionalCssClasses&&this.$el.find("ul:first").addClass(this.additionalCssClasses),this.listenTo(this.rootLevel,"ready",n.bind(t,this)),this.listenTo(this.rootLevel,"selection:change",n.bind(function(e,t,i){t&&i&&n.isArray(i)&&(this.rootLevel.selection.multiple||this.rootLevel.resetSelection({silent:!0,exclude:[i[0]]})),this.trigger("selection:change",e)},this)),this.listenTo(this.rootLevel,"item:dblclick",n.bind(function(e){this.trigger("item:dblclick",e)},this));for(var i=0,s=this._plugins.length;s>i;i++)this._plugins[i].constr.treeInitialized.call(this,this._plugins[i].options);this.rootLevel.render(),e.collapsed&&e.lazyLoad&&this.rootless&&this.expand("/")},remove:function(){for(var e=0,t=this._plugins.length;t>e;e++)this._plugins[e].constr.treeRemoved.call(this);this.rootLevel.remove(),s.View.prototype.remove.apply(this,arguments)},expand:function(e,t){var i=this.getLevel(e);return i&&i.open(t),this},collapse:function(e,t){var i=this.getLevel(e);return i&&i.close(t),this},_getNodeById:function(e){var t,i,s=this.getLevel(e);if(s)return s.parent?(t=s.parent.list,{node:s.item,nodeElement:s.$el,itsList:t}):null;var r=!1;if("list"===this._type)r=this.rootLevel;else if("tree"===this._type){var a=e.split("/");if(a=a.slice(0,a.length-1).join("/"),""===a&&(a="@fakeRoot"),r=this.getLevel(a),!r)return null}return r?(t=r.list,i=n.find(t.model.get("items"),function(t){return t.id===e}),i?{node:i,nodeElement:t.$el.find("li.leaf.selected"),itsList:t}:null):null},select:function(e){var t=this._getNodeById(e);t&&(t.itsList.model.clearSelection().addValueToSelection(t.node.value,t.node.index),this.trigger("selection:change",t.itsList.getValue()))},deselect:function(e){},addItem:function(e,t){var i=this.getLevel(e),n=d.ADD;return i&&this._getNodeItems(e,i,t,n),this},updateItem:function(e,t){var i=t?this.getLevel(t):this.rootLevel;return i&&this._getNodeItems(i.id,i,e),this},resetSelection:function(e){return this.rootLevel.list.clearSelection(),this.rootLevel.list.model.selection=[],this.rootLevel.resetSelection(e),this},refresh:function(e){e&&(this.context=e),this.rootLevel.refresh()},recalcConstraints:function(){this.rootLevel.recalcConstraints()},fetchVisibleData:function(){this.rootLevel.fetchVisibleData()},clearCache:function(){this.rootLevel.clearCache()},getLevel:function(e){return this.rootLevel.id===e?this.rootLevel:this.rootLevel.getLevel(e)},getDataLayer:function(e){return this.customDataLayers&&this.customDataLayers[e.id]?this.customDataLayers[e.id]:this.defaultDataLayer},_addItem:function(e,t,i){return!n.findWhere(e,{id:i.id})&&e.push(i),e},_updateItem:function(e,t){return n.each(e,function(e){e.id===t.id&&n.extend(e,t)},this),e},_getNodeItems:function(e,t,i,s){var r,a=this.getDataLayer(t),o=t.list.model.get("items")?t.list.model.get("items"):[];a.predefinedData=a.predefinedData||{},r=s===d.ADD?this._addItem(o,e,i):this._updateItem(o,i),a.predefinedData[e]=n.sortBy(r,"label"),t.fetch({force:!0,keepPosition:!0})},_selectTreeNode:function(e,t){if(n.isString(e)&&""!==e){var s=n.bind(function(){var r=n.bind(function(){var i=e;if("/"===i&&(i="@fakeRoot"),this.expand(i),this.select(i),"list"===this._type)this.rootLevel.on("ready",s);else if("tree"===this._type&&t&&t.length){var n=this.$el,r=this._getNodeById(i);if(!r)return;var a=r.nodeElement;if(!a)return;var o=a.offset().top-n.offset().top-t.height()/2+a.height()/2;t.scrollTop(o)}},this);if("/"===e||"/public"===e||"list"===this._type)r();else{var a=e.replace(/\/$/,""),o=a.substr(0,a.lastIndexOf("/"));o=o||"/";var l=new i.Deferred;this._openPath(o,l,0),l.done(r)}},this);this.rootLevel.isReady()?s():this.rootLevel.on("ready",s)}},_openPath:function(e,t,i){if(!e)return t.resolve();var s,r,a,o=this;return"/"===e?r=["/"]:(r=e.split("/"),r[0]="/"),"/"===r[0]&&"public"===r[1]&&(r=n.union(["/public"],n.rest(r,2))),i=i||0,i===r.length?t.resolve():(s=n.first(r,i+1).join("/"),"/"===s&&(s="@fakeRoot"),s=s.replace(/\/\//g,"/"),a=this.getLevel(s),void(a&&(a.collapsed?(a.once("ready",function(){o._openPath(e,t,i+1)}),a.open()):this._openPath(e,t,i+1))))}},{instance:function(e){return new this(e)}});return{use:function(e,t){return function(e){return{use:function(t,i){return e.prototype._plugins.push({constr:t,options:i}),this},create:function(){return e}}}(c.extend({_plugins:[{constr:e,options:t}]}))},create:function(){return c}}}),define("common/component/tree/plugin/ContextMenuTreePlugin",["require","./TreePlugin","underscore","jquery"],function(e){
"use strict";var t=e("./TreePlugin"),i=e("underscore"),n=(e("jquery"),i.memoize(function(e){var t=i.map(e.options,function(e){return e.model.get("action")});return t},function(e){return e.cid}));return t.extend({initialize:function(e){if(!e)throw new Error("Initialization error. Options required.");if(this.contextMenus=e.contextMenus,this.contextMenu=e.contextMenu,this.defaultSelectedItems=e.defaultSelectedItems||function(){},!this.contextMenus&&!this.contextMenu)throw new Error("contextMenu or contextMenus must be specified.");if(this.showContextMenuCondition=e.showContextMenuCondition,!this.showContextMenuCondition&&!this.contextMenu)throw new Error("contextMenu must be specified for default behaviour");!this.showContextMenuCondition&&(this.showContextMenuCondition=function(){return this.contextMenu}),this.model=e.model,t.prototype.initialize.apply(this,arguments)},itemAction:function(e){var t=e.get("action");this.treeItem.action=t},itemsRendered:function(e,t){var i=this;this.listenTo(t,"list:item:contextmenu",function(e,t){if(this.currentContextMenu=i.showContextMenuCondition(e),this.lastContextMenu&&this.lastContextMenu.hide(),this.lastContextMenu=this.currentContextMenu,this.currentContextMenu){this.currentContextMenu.treeItem=e;var s=this.currentContextMenu.treeItem.action;s||(s=i.defaultSelectedItems.call(this.currentContextMenu,e,n(this.currentContextMenu)))?this.currentContextMenu.resetSelection([s]):this.currentContextMenu.resetSelection(),this.currentContextMenu.show({left:t.pageX,top:t.pageY}),this.listenTo(this.currentContextMenu.collection,"select",function(e,t){this.itemAction.call(this.currentContextMenu,t)},this)}},this)},remove:function(){this.stopListening(),this.contextMenu&&this.contextMenu.remove()}})}),define("text!bi/repository/repositoryFolderTree/template/repositoryFolderChooserDialogTooltipTemplate.htm",[],function(){return'<p class="message label">{{- model.i18n[\'tooltip.name\'] }}</p>\n<p class="message">{{- model.value.label }}</p>\n<p class="message label">{{- model.i18n[\'tooltip.path\'] }}</p>\n<p class="message">{{- model.value.uri }}</p>'}),define("text!bi/repository/repositoryFolderTree/template/repositoryFoldersTreeLevelTemplate.htm",[],function(){return'<ul class="list collapsible" style="top: {{- top}}px; position: relative;">\n	{{ _.each(items, function(item){ }}\n	<li class="{{- item._node ? \'node closed\' : \'leaf\'}} {{- item.selected ? \'selected\' : \'\'}} {{- item._readonly ? \'readonly\' : \'\'}}" data-index="{{- item.index }}" tabindex="-1">\n		<p class="wrap button draggable" data-tooltip=\'true\'><b class="icon"/> {{- item.value.label }} </p>\n		<div class="subcontainer" />\n	</li>\n	{{ }) }}\n</ul>\n'}),define("bi/repository/repositoryFolderTree/RepositoryFolderTree",["require","common/component/tree/Tree","jquery","underscore","jrs.configs","common/component/tree/TreeDataLayer","common/component/tree/plugin/TooltipPlugin","common/component/tree/plugin/ContextMenuTreePlugin","bi/repository/enum/repositoryResourceTypes","text!./template/repositoryFolderChooserDialogTooltipTemplate.htm","text!./template/repositoryFoldersTreeLevelTemplate.htm","bundle!all","settings/generalSettings"],function(e){"use strict";function t(e){var t=2;return e.isWritable&&(t=4|t),e.isRemovable&&(t=16|t),e.isAdministrable&&(t=1),t}var i=e("common/component/tree/Tree"),n=e("jquery"),s=e("underscore"),r=e("jrs.configs"),a=e("common/component/tree/TreeDataLayer"),o=e("common/component/tree/plugin/TooltipPlugin"),l=(e("common/component/tree/plugin/ContextMenuTreePlugin"),e("bi/repository/enum/repositoryResourceTypes")),d=e("text!./template/repositoryFolderChooserDialogTooltipTemplate.htm"),c=e("text!./template/repositoryFoldersTreeLevelTemplate.htm"),u=e("bundle!all"),h=e("settings/generalSettings"),p={folderTreeProcessor:{processItem:function(e){return e._node=!0,e._readonly=!(1==e.value.permissionMask||4&e.value.permissionMask),e}},filterPublicFolderProcessor:{processItem:function(e){return e.value.uri!==m.settings.publicFolderUri&&e.value.uri!==m.settings.tempFolderUri?e:void 0}},i18n:{processItem:function(e){return e.i18n=u,e}},tenantProcessor:{processItem:function(e){return e._node=!0,e.value.label=e.value.tenantName,e.value.uri=e.value.tenantUri,e}}},m=function(e){var h=e&&e.contextPath||r.contextPath,m=e&&e.tooltipTemplate||d,f=i.use(o,{i18n:u,contentTemplate:m}).create().instance({additionalCssClasses:"folders",dataUriTemplate:h+"/rest_v2/resources?{{= id != '@fakeRoot' ? 'folderUri=' + id : ''}}&recursive=false&type="+l.FOLDER+"&offset={{= offset }}&limit={{= limit }}",levelDataId:"uri",itemsTemplate:c,collapsed:!0,lazyLoad:!0,rootless:!0,selection:{allowed:!0,multiple:!1},customDataLayers:{"/":s.extend(new a({dataUriTemplate:h+"/flow.html?_flowId=searchFlow&method=getNode&provider=repositoryExplorerTreeFoldersProvider&uri=/&depth=1",processors:s.chain(p).omit("filterPublicFolderProcessor","tenantProcessor").values().value(),getDataArray:function(e){e=JSON.parse(n(e).text());var i=s.find(e.children,function(e){return"/public"===e.uri}),r=[{id:"@fakeRoot",label:e.label,uri:"/",resourceType:"folder",permissionMask:t(e.extra),_links:{content:"@fakeContentLink"}}];return i&&r.push({id:"/public",label:i.label,uri:"/public",resourceType:"folder",permissionMask:t(i.extra),_links:{content:"@fakeContentLink"}}),r}}),{accept:"text/html",dataType:"text"})},processors:[p.i18n,p.folderTreeProcessor,p.filterPublicFolderProcessor],getDataArray:function(e,t,i){return e?e[l.RESOURCE_LOOKUP]:[]}});return f};return m.settings=h,m}),define("text!dataSource/saveDialog/template/baseSaveDialogTemplate.htm",[],function(){return'<label title="{{- i18n[\'resource.datasource.saveDialog.dataSourceNameTitle\']}}" class="control input text ">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDialog.dataSourceName\']}} ({{- i18n[\'required.field\']}}):</span>\n	<input type="text" value="{{- model.label }}" name="label">\n	<span class="message warning"></span>\n</label>\n\n\n<label title="{{- i18n[\'resource.datasource.saveDialog.resourceIDTitle\']}}" class="control input text ">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDialog.resourceID\']}} ({{- i18n[\'required.field\']}}):</span>\n	<input type="text" {{ if (isEditMode) { }}readonly="readonly"{{ } }} value="{{- model.name }}" name="name">\n	<span class="message warning"></span>\n</label>\n\n\n<label title="{{- i18n[\'resource.datasource.saveDialog.descriptionTitle\']}}" class="control textArea">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDialog.description\']}}</span>\n	<textarea type="text" name="description">{{- model.description }}</textarea>\n	<span class="message warning"></span>\n</label>\n\n{{ if (skipLocation === false) { }}\n<div class="control groupBox treeBox">\n	<div class="content">\n		<div class="header ">\n			<div class="title"></div>\n		</div>\n        <ul class="list collapsible folders"></ul>\n	</div>\n</div>\n\n<label class="control textArea">\n	<textarea type="text" class="hidden" name="parentFolderUri"></textarea>\n	<span class="message warning"></span>\n</label>\n{{ } }}\n'}),define("dataSource/saveDialog/BaseSaveDialogView",["require","underscore","bundle!all","common/util/browserDetection","bi/repository/model/RepositoryResourceModel","common/component/dialog/DialogWithModelInputValidation","bi/repository/repositoryFolderTree/RepositoryFolderTree","text!dataSource/saveDialog/template/baseSaveDialogTemplate.htm"],function(e){"use strict";var t=e("underscore"),i=e("bundle!all"),n=e("common/util/browserDetection"),s=e("bi/repository/model/RepositoryResourceModel"),r=e("common/component/dialog/DialogWithModelInputValidation"),a=e("bi/repository/repositoryFolderTree/RepositoryFolderTree"),o=e("text!dataSource/saveDialog/template/baseSaveDialogTemplate.htm");return r.extend({theDialogIsOpen:!1,autoUpdateResourceID:!0,saveDialogTemplate:o,events:t.extend({resize:"_onDialogResize"},r.prototype.events),constructor:function(e){e||(e={}),this.options=e;var n=this.extendModel(this.options.model),s=this._getLabelForSaveButton(n),a="resource.datasource.saveDialog.cancel";this.autoUpdateResourceID=!this.options.isEditMode,this.preSelectedFolder=e.parentFolderUri,r.prototype.constructor.call(this,{skipLocation:!!e.skipLocation,modal:!0,model:n,resizable:!e.skipLocation,additionalCssClasses:"dataSourceSaveDialog"+(e.skipLocation?" no-minheight":""),title:i["resource.datasource.saveDialog.save"],content:t.template(this.saveDialogTemplate,{i18n:i,model:t.extend({},n.attributes),skipLocation:!!this.options.skipLocation,isEmbedded:this.options.isEmbedded,isEditMode:this.options.isEditMode}),buttons:[{label:i[s],action:"save",primary:!0},{label:i[a],action:"cancel",primary:!1}]}),this.on("button:save",t.bind(this._onSaveDialogSaveButtonClick,this)),this.on("button:cancel",t.bind(this._onSaveDialogCancelButtonClick,this))},initialize:function(e){r.prototype.initialize.apply(this,arguments),(t.isUndefined(this.preSelectedFolder)||!this.preSelectedFolder)&&(this.preSelectedFolder="/"),e.skipLocation||this.initializeTree(),this.listenTo(this.model,"change:label",this._onDataSourceNameChange),this.$contentContainer.find("[name=name]").change(t.bind(this._onResourceIDInputChange,this))},restoreModel:function(){this.originalModelValidation&&(this.model.validation=this.originalModelValidation)},extendModel:function(e){return this.originalModelValidation=e.validation,e.validation=t.extend({},s.prototype.validation,{label:[{required:!0,msg:i["resource.datasource.saveDialog.validation.not.empty.label"]},{maxLength:s.settings.LABEL_MAX_LENGTH,msg:i["resource.datasource.saveDialog.validation.too.long.label"]}],name:[{required:!0,msg:i["resource.datasource.saveDialog.validation.not.empty.name"]},{maxLength:s.settings.NAME_MAX_LENGTH,msg:i["resource.datasource.saveDialog.validation.too.long.name"]},{doesNotContainSymbols:s.settings.NAME_NOT_SUPPORTED_SYMBOLS,msg:i["resource.datasource.saveDialog.validation.invalid.chars.name"]}],description:[{required:!1},{maxLength:s.settings.DESCRIPTION_MAX_LENGTH,msg:i["resource.datasource.saveDialog.validation.too.long.description"]}],parentFolderUri:[{fn:function(e){if(!this.options.skipLocation){if(t.isNull(e)||t.isUndefined(e)||t.isString(e)&&""===e)return i["resource.datasource.saveDialog.validation.not.empty.parentFolderIsEmpty"];if("/"!==e.slice(0,1))return i["resource.datasource.saveDialog.validation.folder.not.found"].replace("{0}",e)}}}]}),e},initializeTree:function(){this.foldersTree=a(),this.listenTo(this.foldersTree,"selection:change",function(e){var i;e&&t.isArray(e)&&e[0]&&e[0].uri&&(i=e[0].uri),i&&this.model.set("parentFolderUri",i)}),this.$el.find(".treeBox .folders").append(this.foldersTree.render().el);var e=this.foldersTree.$el.parent().parent().parent();this.foldersTree._selectTreeNode(this.preSelectedFolder,e)},startSaveDialog:function(){this._openDialog()},_openDialog:function(){if(!this.theDialogIsOpen){this.bindValidation(),r.prototype.open.apply(this,arguments),this.$contentContainer.find("[name=label]").focus(),this.theDialogIsOpen=!0;var e=t.bind(this._onDialogResize,this);n.isIE8()||n.isIE9()?setTimeout(e,1):e()}},_closeDialog:function(){this.theDialogIsOpen&&(this.unbindValidation(),this.clearValidationErrors(),r.prototype.close.apply(this,arguments),this.theDialogIsOpen=!1)},_getLabelForSaveButton:function(){return"resource.datasource.saveDialog.save"},_onDialogResize:function(){var e=this,t=73,i=this.$contentContainer.find(".control.groupBox.treeBox"),n=this.$contentContainer.closest(".jr-mDialog");this.$contentContainer.children().not(".control.groupBox.treeBox").each(function(){t+=e.$(this).outerHeight(!0)}),t+=this.$contentContainer.innerHeight()-this.$contentContainer.height(),i.height(n.outerHeight(!0)-t)},_onDataSourceNameChange:function(){if(this.autoUpdateResourceID){var e=s.generateResourceName(this.model.get("label"));this.model.set("name",e),this.$("input[name='name']").val(e)}},_onResourceIDInputChange:function(){this.autoUpdateResourceID=!1},_onSaveDialogCancelButtonClick:function(){this.restoreModel(),this._closeDialog()},_onSaveDialogSaveButtonClick:function(){this._onDialogResize(),this.model.isValid(!0)&&this.performSave()},performSave:function(){return this.options.saveFn?void this.options.saveFn(this.model.attributes,this.model):void this.model.save({},{success:t.bind(this._saveSuccessCallback,this),error:t.bind(this._saveErrorCallback,this)})},_saveSuccessCallback:function(e,i){this._closeDialog(),t.isFunction(this.options.success)&&this.options.success()},_saveErrorCallback:function(e,n,s){var r=this,a=!1,o=!1;try{a=JSON.parse(n.responseText)}catch(l){}t.isArray(a)||(a=[a]),t.each(a,function(e){var t=!1,n=!1;e&&(r.theDialogIsOpen&&("version.not.match"===e.errorCode?(t="name",n=i["resource.dataSource.resource.alreadyInUse"]):"mandatory.parameter.error"===e.errorCode?e.parameters&&e.parameters[0]&&(n=i["resource.datasource.saveDialog.parameterIsMissing"],t=e.parameters[0].substr(e.parameters[0].indexOf(".")+1)):"illegal.parameter.value.error"===e.errorCode?e.parameters&&e.parameters[0]&&(t=e.parameters[0].substr(e.parameters[0].indexOf(".")+1),n=i["resource.datasource.saveDialog.parameterIsWrong"]):"folder.not.found"===e.errorCode?(t="parentFolderUri",n=i["ReportDataSourceValidator.error.folder.not.found"].replace("{0}",e.parameters[0])):"access.denied"===e.errorCode&&(t="parentFolderUri",n=i["jsp.accessDenied.errorMsg"])),n&&t&&-1!==["label","name","description","parentFolderUri"].indexOf(t)&&(r.invalidField("[name="+t+"]",n),o=!0))}),o===!1&&t.isFunction(this.options.error)&&this.options.error(e,n,s)}})}),define("common/enum/javaTypeMapper",[],function(){return{"java.lang.Date":"javaTypes.java.lang.Date","java.lang.String":"javaTypes.java.lang.String","java.lang.Integer":"javaTypes.java.lang.Integer","java.lang.Boolean":"javaTypes.java.lang.Boolean","java.lang.Double":"javaTypes.java.lang.Double","java.sql.Timestamp":"javaTypes.java.sql.Timestamp","java.lang.Short":"javaTypes.java.lang.Short","java.math.BigDecimal":"javaTypes.java.math.BigDecimal","java.lang.Long":"javaTypes.java.lang.Long","java.sql.Time":"javaTypes.java.sql.Time"}}),define("dataSource/fileDataSource/enum/javaTypes",[],function(){return["java.lang.Date","java.lang.String","java.lang.Integer","java.lang.Boolean","java.lang.Double","java.sql.Timestamp","java.lang.Short","java.math.BigDecimal","java.lang.Long","java.sql.Time"]}),define("dataSource/fileDataSource/SimpleDomainModel",["require","jquery","underscore","request","jrs.configs","bi/repository/model/RepositoryResourceModel"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),n=e("request"),s=e("jrs.configs"),r=e("bi/repository/model/RepositoryResourceModel");return r.extend({defaults:{uri:void 0,label:void 0,columns:[],dataSourceUri:void 0},validation:{columns:function(e){var t=[];return i.each(e,function(e,i){e.label||t.push({rowId:i,name:"label"})}),0!==t.length?this.trigger("validationFailed",t):this.trigger("validationPassed"),null}},type:"simpleDomain",url:function(){return s.contextPath+"/rest_v2/domains"},isNew:function(){return!0},constructor:function(e,t){r.prototype.constructor.apply(this,arguments),this.dataSource=t.dataSource,t.dataSource&&t.dataSource.uri&&this.set("dataSourceUri",t.dataSource.uri)},save:function(e,t){return i.defaults(t||(t={}),{headers:{Accept:"application/json","Content-Type":"application/simpleDomain+json; charset=UTF-8"}}),r.prototype.save.call(this,e,t)},parseMetadata:function(e){return i.each(e.columns,function(e){e.show=!0}),e},parse:function(e){var t=r.prototype.parse.apply(this,arguments);return t.dataSource&&(t.dataSourceUri=t.dataSource.dataSourceReference,delete t.dataSource),t.metadata&&(t.columns=t.metadata.columns,delete t.metadata),t},toJSON:function(){var e=r.prototype.toJSON.apply(this,arguments);return e.dataSource={dataSourceReference:e.dataSourceUri},e.metadata={columns:i.reduce(e.columns,function(e,t){return t.show&&e.push(t),e},[]),queryLanguage:"csv"},delete e.dataSourceUri,delete e.columns,e},fetchMetadata:function(){var e=this,i=t.Deferred();return n({type:"POST",url:s.contextPath+"/rest_v2/connections",dataType:"json",data:JSON.stringify(this.dataSource),headers:{"Content-Type":"application/repository.customDataSource+json",Accept:"application/table.metadata+json"}}).done(function(t){t=e.parseMetadata(t),e.set("columns",t.columns),i.resolve(t)}).fail(function(e){i.reject(e)}),i}})}),define("text!common/templates/standardConfirm.htm",[],function(){return'<div class="panel dialog overlay standardConfirm moveable centered_horz centered_vert">\n    <div class="content hasFooter ">\n        <div class="header mover">\n            <div class="title">\n                Confirm\n            </div>\n        </div>\n\n        <div class="body  ">\n        </div>\n\n        <div class="footer ">\n\n            <button class="button action primary up ok" name="buttonOK">\n                <span class="wrap">OK</span>\n                <span class="icon"></span>\n            </button>\n            <button class="button action up cancel" name="buttonCancel">\n                <span class="wrap">Cancel</span>\n                <span class="icon"></span>\n            </button>\n\n        </div>\n\n    </div>\n</div>'}),define("text!dataSource/saveDialog/template/domainSaveDialogTemplate.htm",[],function(){return'<label title="{{- i18n[\'resource.datasource.saveDomainDialog.domainNameTitle\']}}" class="control input text ">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDomainDialog.domainName\']}} ({{- i18n[\'required.field\']}}):</span>\n	<input type="text" value="{{- model.label }}" name="label">\n	<span class="message warning"></span>\n</label>\n\n\n<label title="{{- i18n[\'resource.datasource.saveDomainDialog.resourceIDTitle\']}}" class="control input text ">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDomainDialog.resourceID\']}} ({{- i18n[\'required.field\']}}):</span>\n	<input type="text" {{ if (model.isEditMode) { }}readonly="readonly"{{ } }} value="{{- model.name }}" name="name">\n	<span class="message warning"></span>\n</label>\n\n\n<label title="{{- i18n[\'resource.datasource.saveDomainDialog.descriptionTitle\']}}" class="control textArea">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDomainDialog.description\']}}</span>\n	<textarea type="text" name="description">{{- model.description }}</textarea>\n	<span class="message warning"></span>\n</label>\n\n{{ if (skipLocation === false) { }}\n<div class="control groupBox treeBox">\n	<div class="content">\n		<div class="header ">\n			<div class="title"></div>\n		</div>\n        <ul class="list collapsible folders"></ul>\n	</div>\n</div>\n\n<label class="control textArea">\n	<textarea type="text" class="hidden" name="parentFolderUri"></textarea>\n	<span class="message warning"></span>\n</label>\n{{ } }}\n\n<!--\n<div class="control checkBox toggle">\n    <label for="__jrs_openInAdHocDesigner" class="wrap">{{- i18n[\'resource.datasource.saveDomainDialog.openInAdhoc\']}}</label>\n    <input type="checkbox" name="openInAdHocDesigner" id="__jrs_openInAdHocDesigner" {{ if (model.openInAdHocDesigner) { }}checked="checked"{{ } }} />\n</div>\n-->'}),define("dataSource/saveDialog/DomainSaveDialogView",["require","underscore","jquery","bundle!all","request","bi/repository/model/RepositoryResourceModel","dataSource/saveDialog/BaseSaveDialogView","text!common/templates/standardConfirm.htm","text!dataSource/saveDialog/template/domainSaveDialogTemplate.htm"],function(e){"use strict";var t=e("underscore"),i=e("jquery"),n=e("bundle!all"),s=(e("request"),e("bi/repository/model/RepositoryResourceModel")),r=e("dataSource/saveDialog/BaseSaveDialogView"),a=e("text!common/templates/standardConfirm.htm"),o=e("text!dataSource/saveDialog/template/domainSaveDialogTemplate.htm");return r.extend({saveDialogTemplate:o,constructor:function(e){e||(e={}),this.options=e,r.prototype.constructor.call(this,e)},initialize:function(){this.preSelectedFolder=s.getParentFolderFromUri(this.options.dataSource.uri)||"/",r.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:openInAdHocDesigner",this._onOpenInAdHocDesignerChange)},extendModel:function(e){var i,a,o,l=r.prototype.extendModel.call(this,e),d=this;return l.set("openInAdHocDesigner",!1),i=e.dataSource.label,a=i+" Domain",o=s.generateResourceName(a),l.set("label",a),l.set("name",o),l.validation=t.extend({},s.prototype.validation,{label:[{required:!0,msg:n["resource.datasource.saveDomainDialog.validation.not.empty.label"]},{maxLength:s.settings.LABEL_MAX_LENGTH,msg:n["resource.datasource.saveDomainDialog.validation.too.long.label"]}],name:[{required:!0,msg:n["resource.datasource.saveDomainDialog.validation.not.empty.name"]},{maxLength:s.settings.NAME_MAX_LENGTH,msg:n["resource.datasource.saveDomainDialog.validation.too.long.name"]},{doesNotContainCharacters:s.settings.NAME_NOT_SUPPORTED_SYMBOLS,msg:n["resource.datasource.saveDomainDialog.validation.invalid.chars.name"]}],description:[{required:!1},{maxLength:s.settings.DESCRIPTION_MAX_LENGTH,msg:n["resource.datasource.saveDomainDialog.validation.too.long.description"]}],parentFolderUri:[{fn:function(e){if(!d.options.skipLocation){if(t.isNull(e)||t.isUndefined(e)||t.isString(e)&&""===e)return n["resource.datasource.saveDomainDialog.validation.not.empty.parentFolderIsEmpty"];if("/"!==e.slice(0,1))return n["resource.datasource.saveDomainDialog.validation.folder.not.found"].replace("{0}",e)}}}]}),l},_onOpenInAdHocDesignerChange:function(){var e=this._getLabelForSaveButton();this.changeButtonLabel("save",n[e])},_getLabelForSaveButton:function(e){e=e||this.model;var t="resource.datasource.saveDialog.save";return e.get("openInAdHocDesigner")&&(t="resource.datasource.saveDomainDialog.saveAndOpenDesigner"),t},_onSaveDialogCancelButtonClick:function(){var e=this,n="You are about to cancel the creation of a new domain.<br/>If You wish to create a domain in the future,<br/>You will need to go through the regular Domain Designer.<br/>The data source, however, has successfully been saved.",s=i(a);s.find(".body").html(n),dialogs.popupConfirm.show(s.get(0),!0,{okButtonSelector:"[name=buttonOK]",cancelButtonSelector:"[name=buttonCancel]"}).done(function(){e._closeDialog(),t.isFunction(e.options.success)&&e.options.success()})},performSave:function(){var e=this;this.model.save().done(function(){e._closeDialog(),t.isFunction(e.options.success)&&e.options.success()})}})}),define("text!dataSource/fileDataSource/template/simpleDomainDialogTemplate.htm",[],function(){return'<div class="usageTooltip">{{- i18n[\'resource.datasource.createDomain.useTooltip\']}}.</div>\n\n<div class="tableHolder">\n    <table class="table" unselectable="on" onselectstart="return false">\n        <tbody>\n\n        <tr class="header">\n            <td class="jrs-grid-cell"><div class="jrs-grid-cell-content">{{- i18n[\'resource.datasource.createDomain.table.fields.show\']}}</div></td>\n            <td class="jrs-grid-cell"><div class="jrs-grid-cell-content">{{- i18n[\'resource.datasource.createDomain.table.fields.fieldName\']}}</div></td>\n            <td class="jrs-grid-cell"><div class="jrs-grid-cell-content">{{- i18n[\'resource.datasource.createDomain.table.fields.displayLabel\']}}</div></td>\n            <td class="jrs-grid-cell"><div class="jrs-grid-cell-content">{{- i18n[\'resource.datasource.createDomain.table.fields.type\']}}</div></td>\n        </tr>\n\n        {{_.each(columns, function(field, y) { }}\n        <tr class="bodyCell" data-fieldId="{{- y }}">\n            <td class="jrs-grid-cell cell_1">\n                <div class="jrs-grid-cell-content">\n                    <input type="checkbox" name="show" {{- field.show ? "checked" : "" }} />\n                </div>\n            </td>\n            <td class="jrs-grid-cell cell_2">\n                <div class="jrs-grid-cell-content">\n                    {{- field.name }}\n                </div>\n            </td>\n            <td class="jrs-grid-cell cell_3">\n                <div class="jrs-grid-cell-content">\n                    <input type="text" name="label" value="{{- field.label }}" />\n                    <span class="message warning"></span>\n                </div>\n            </td>\n            <td class="jrs-grid-cell cell_4">\n                <div class="jrs-grid-cell-content">\n                    <select name="javaType">\n                    {{ _.each(javaTypes, function(javaType) { }}\n                        <option value="{{- javaType }}" {{- javaType === field.javaType ? "selected" : ""}}>{{- i18n[javaTypeMapper[javaType]]}}</option>\n                    {{ }); }}\n                    </select>\n                </div>\n            </td>\n        </tr>\n        {{ }); }}\n        </tbody>\n    </table>\n</div>\n\n<div class="usageDescription">{{- i18n[\'resource.datasource.createDomain.useTooptip.firstPart\']}}.</div>\n\n<div class="usageDescription2">{{- i18n[\'resource.datasource.createDomain.useTooptip.secondPart\']}}.</div>\n'}),define("dataSource/fileDataSource/SimpleDomainView",["require","jquery","underscore","bundle!all","common/enum/javaTypeMapper","dataSource/fileDataSource/enum/javaTypes","jrs.configs","dataSource/fileDataSource/SimpleDomainModel","common/component/dialog/DialogWithModelInputValidation","dataSource/saveDialog/DomainSaveDialogView","text!common/templates/standardConfirm.htm","text!dataSource/fileDataSource/template/simpleDomainDialogTemplate.htm"],function(e){"use strict";var t=e("jquery"),i=e("underscore"),n=e("bundle!all"),s=e("common/enum/javaTypeMapper"),r=e("dataSource/fileDataSource/enum/javaTypes"),a=e("jrs.configs"),o=e("dataSource/fileDataSource/SimpleDomainModel"),l=e("common/component/dialog/DialogWithModelInputValidation"),d=e("dataSource/saveDialog/DomainSaveDialogView"),c=e("text!common/templates/standardConfirm.htm"),u=e("text!dataSource/fileDataSource/template/simpleDomainDialogTemplate.htm");return l.extend({hasChanges:!1,modelIsValid:!0,theDialogIsOpen:!1,constructor:function(e){e||(e={}),this.options=e,this.dataSource=e.dataSource?e.dataSource:{};var t="resource.datasource.createDomain.save",s="resource.datasource.createDomain.cancel";this.model=new o({},e),l.prototype.constructor.call(this,{modal:!0,model:this.model,width:400,additionalCssClasses:"dataSourceCreateNewDomainDialog",title:n["resource.datasource.createDomain.dialogTitle"],content:"",buttons:[{label:n[t],action:"save",primary:!0},{label:n[s],action:"cancel",primary:!1}]}),this.on("button:save",i.bind(this._onSaveButtonClick,this)),this.on("button:cancel",i.bind(this._onCancelButtonClick,this)),this.model.on("validationPassed",i.bind(this.clearValidationErrors,this)),this.model.on("validationFailed",i.bind(this.validationFailed,this))},initialize:function(e){l.prototype.initialize.apply(this,arguments)},updateModelProperty:function(e){var i,s,r=t(e.target),a=r.attr("type"),o=r.attr("name"),l=r.parents("tr").attr("data-fieldId");s="checkbox"===a||"radio"===a?r.is(":checked"):t.trim(r.val()),i=this.model.get("columns"),i[l][o]=s,this.model.set("columns",i),this.model.validate("columns"),this.hasChanges===!1&&this.changeButtonLabel("save",n["resource.datasource.createDomain.applyAndSave"]),this.hasChanges=!0},startDialog:function(){var e=this;this.theDialogIsOpen||(this.bindValidation(),this.model.fetchMetadata(this.dataSource).done(function(){l.prototype.open.apply(e,arguments);var t=i.template(u,{i18n:n,javaTypes:r,columns:e.model.get("columns"),javaTypeMapper:s});e.setContent(t),e._center()}),this.theDialogIsOpen=!0)},fieldIsValid:function(){},fieldIsInvalid:function(e){},clearValidationErrors:function(){this.$el.find(".error").removeClass("error"),this.modelIsValid=!0},validationFailed:function(e){var s=this;this.clearValidationErrors(),this.modelIsValid=!1,i.each(e,function(e){var i=t(s.$el.find("table tr").get(e.rowId+1));i.find("[name="+e.name+"]").parent().addClass("error"),i.find(".message").text(n["resource.datasource.createDomain.validation.missing.label"])})},_closeDialog:function(){this.theDialogIsOpen&&(this.unbindValidation(),this.clearValidationErrors(),l.prototype.close.apply(this,arguments),this.theDialogIsOpen=!1)},_onCancelButtonClick:function(){var e=this,i=n["resource.datasource.createDomain.cancelMessage"],s=t(c);s.find(".body").html(i),dialogs.popupConfirm.show(s.get(0),!0,{okButtonSelector:"[name=buttonOK]",cancelButtonSelector:"[name=buttonCancel]"}).done(function(){e._closeDialog(),e.options.cancel&&e.options.cancel()})},_onSaveButtonClick:function(){this.modelIsValid&&(this._closeDialog(),this.saveDialog=new d(i.extend({},this.options,{model:this.model,success:function(){redirectToUrl(a.contextPath+"/flow.html?_flowId=repositoryConfirmFlow&resourceType=dataSource&resourceType=domain")}})),this.saveDialog.startSaveDialog())}})}),define("text!dataSource/saveDialog/template/textDataSourceSaveDialogTemplate.htm",[],function(){return'<label title="{{- i18n[\'resource.datasource.saveDialog.dataSourceNameTitle\']}}" class="control input text ">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDialog.dataSourceName\']}} ({{- i18n[\'required.field\']}}):</span>\n	<input type="text" value="{{- model.label }}" name="label">\n	<span class="message warning"></span>\n</label>\n\n\n<label title="{{- i18n[\'resource.datasource.saveDialog.resourceIDTitle\']}}" class="control input text ">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDialog.resourceID\']}} ({{- i18n[\'required.field\']}}):</span>\n	<input type="text" {{ if (isEditMode) { }}readonly="readonly"{{ } }} value="{{- model.name }}" name="name">\n	<span class="message warning"></span>\n</label>\n\n\n<label title="{{- i18n[\'resource.datasource.saveDialog.descriptionTitle\']}}" class="control textArea">\n	<span class="wrap">{{- i18n[\'resource.datasource.saveDialog.description\']}}</span>\n	<textarea type="text" name="description">{{- model.description }}</textarea>\n	<span class="message warning"></span>\n</label>\n\n{{ if (skipLocation === false) { }}\n<div class="control groupBox treeBox">\n	<div class="content">\n		<div class="header ">\n			<div class="title"></div>\n		</div>\n        <ul class="list collapsible folders"></ul>\n	</div>\n</div>\n\n<label class="control textArea">\n	<textarea type="text" class="hidden" name="parentFolderUri"></textarea>\n	<span class="message warning"></span>\n</label>\n{{ } }}\n\n{{ if (!(isEmbedded || isEditMode)) { }}\n<div class="control checkBox toggle">\n    <label for="__jrs_prepareDataForReporting" class="wrap">{{- i18n[\'resource.datasource.saveDialog.prepareData\']}}</label>\n    <input type="checkbox" name="prepareDataForReporting" id="__jrs_prepareDataForReporting" {{ if (model.prepareDataForReporting) { }}checked="checked"{{ } }} />\n</div>\n{{ } }}\n'}),define("dataSource/saveDialog/TextDataSourceSaveDialogView",["require","underscore","bundle!all","dataSource/fileDataSource/SimpleDomainView","dataSource/saveDialog/BaseSaveDialogView","text!dataSource/saveDialog/template/textDataSourceSaveDialogTemplate.htm"],function(e){"use strict";var t=e("underscore"),i=e("bundle!all"),n=e("dataSource/fileDataSource/SimpleDomainView"),s=e("dataSource/saveDialog/BaseSaveDialogView"),r=e("text!dataSource/saveDialog/template/textDataSourceSaveDialogTemplate.htm");return s.extend({saveDialogTemplate:r,constructor:function(e){e||(e={}),this.options=t.extend({},e),this.options.isEmbedded=!!this.options.saveFn,s.prototype.constructor.call(this,e)},initialize:function(){this.preSelectedFolder=this.options.model.options.parentFolderUri,s.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:prepareDataForReporting",this._onPrepareDataForReportingChange)},extendModel:function(e){var t=s.prototype.extendModel.call(this,e);return t.set("prepareDataForReporting",!(this.options.isEmbedded||this.options.isEditMode)),t},_onPrepareDataForReportingChange:function(){var e=this._getLabelForSaveButton();this.changeButtonLabel("save",i[e]);
},_getLabelForSaveButton:function(e){e=e||this.model;var t="resource.datasource.saveDialog.save";return"textDataSource"===e.get("dataSourceName")&&e.get("prepareDataForReporting")&&(t="resource.datasource.saveDialog.saveAndCreateDomain"),t},_saveSuccessCallback:function(e,i){if(this.model.get("prepareDataForReporting")){var s=new n({cancel:this.options.success,dataSource:this.model.toJSON()});s.startDialog()}else t.isFunction(this.options.success)&&this.options.success();this._closeDialog()}})}),define("dataSource/factory/saveDialogViewFactory",["require","dataSource/saveDialog/BaseSaveDialogView","dataSource/saveDialog/TextDataSourceSaveDialogView","dataSource/saveDialog/DomainSaveDialogView"],function(e){"use strict";var t=e("dataSource/saveDialog/BaseSaveDialogView"),i=e("dataSource/saveDialog/TextDataSourceSaveDialogView"),n=e("dataSource/saveDialog/DomainSaveDialogView"),s={};return s.textDataSource=i,s.domain=n,{getView:function(e){var i;return i=t,s[e]&&(i=s[e]),i}}}),define("text!dataSource/template/dataSourceMainTemplate.htm",[],function(){return'<div class="column decorated primary showingToolBar">\n    <div class="content hasFooter">\n        <div class="header">\n            <div class="title">\n                {{ if (isEditMode) { }}\n                    {{- i18n[\'resource.dataSource.title.edit\'] }}\n                {{ } else { }}\n                    {{- i18n[\'resource.dataSource.title.new\'] }}\n                {{ } }}\n            </div>\n        </div>\n        <div class="body {{ if (supportsTouch) { }}swipeScroll{{ } }}">\n            <div id="flowControls"></div>\n\n            <div id="stepDisplay">\n\n                <fieldset class="row instructions">\n                    <legend class="offLeft"><span>{{- i18n["resource.dataSource.instructions"] }}</span></legend>\n                    <h2 class="textAccent02">{{- i18n["resource.dataSource.instructions1"] }}</h2>\n                    <h4>{{- i18n["resource.dataSource.instructions2"] }}</h4>\n                </fieldset>\n\n                <fieldset class="row inputs oneColumn">\n                    <legend class="offLeft"><span>{{- i18n["resource.dataSource.inputs"] }}</span></legend>\n                    <div class="column primary">\n                        <div class="content">\n                            <div class="header">\n                                <div class="title">{{- i18n["resource.dataSource.type"] }}</div>\n                                <label class="control select inline" title="{{- i18n[\'resource.dataSource.dsType\'] }}">\n                                    <span class="wrap offLeft">{{- i18n[\'resource.dataSource.dsType\'] }}</span>\n                                    <select name="dataSourceType" {{ if (isEditMode) { }}disabled="disabled"{{ } }}>\n                                        {{ _.each(dataSourceTypeOptions, function(option) { }}\n                                        <option value="{{- option.value }}">{{- option.label }}</option>\n                                        {{ }); }}\n                                    </select>\n                                    <span class="message warning"></span>\n                                </label>\n                            </div>\n                            <div class="body dataSourceBody"></div>\n                        </div>\n                    </div>\n                </fieldset>\n            </div>\n        </div>\n        <div class="footer ">\n            <fieldset id="wizardNav">\n                <button class="button primary action up" id="saveBtn"><span class="wrap">{{- i18n[\'resource.datasource.saveDialog.save\'] }}</span><span class="icon"></span></button>\n                <button class="button up action" id="cancelBtn"><span class="wrap">{{- i18n[\'resource.datasource.saveDialog.cancel\'] }}</span><span class="icon"></span></button>\n            </fieldset>\n        </div>\n    </div>\n</div>'}),define("dataSource/collection/CustomDataSourceCollection",["require","backbone","underscore","jrs.configs"],function(e){"use strict";var t=e("backbone"),i=e("underscore"),n=e("jrs.configs");return t.Collection.extend({url:n.contextPath+"/rest_v2/customDataSources",parse:function(e){var t=[];return e.definition&&i.each(e.definition,function(e){t.push({id:e})}),t}})}),define("dataSource/DataSourceController",["require","backbone","underscore","jquery","bundle!all","dataSource/model/BaseDataSourceModel","touchcontroller","common/util/featureDetection","util/historyHelper","dataSource/factory/dataSourceViewFactory","dataSource/enum/dataSourceResourceTypes","dataSource/factory/saveDialogViewFactory","text!dataSource/template/dataSourceMainTemplate.htm","jrs.configs","dataSource/collection/CustomDataSourceCollection","settings!awsSettings","dataSource/util/settingsUtility"],function(e){"use strict";var t=e("backbone"),i=e("underscore"),n=e("jquery"),s=e("bundle!all"),r=e("dataSource/model/BaseDataSourceModel"),a=e("touchcontroller"),o=e("common/util/featureDetection"),l=e("util/historyHelper"),d=e("dataSource/factory/dataSourceViewFactory"),c=e("dataSource/enum/dataSourceResourceTypes"),u=e("dataSource/factory/saveDialogViewFactory"),h=e("text!dataSource/template/dataSourceMainTemplate.htm"),p=e("jrs.configs"),m=e("dataSource/collection/CustomDataSourceCollection"),f=e("settings!awsSettings"),g=e("dataSource/util/settingsUtility");return t.View.extend({dataSourceType:!1,dataSourceView:!1,saveDialog:!1,events:{"change select[name='dataSourceType']":"onDataSourceTypeChange","click #saveBtn":"onSaveClick","click #cancelBtn":"onCancelClick"},historyBackToken:"DataSourceControllerHistory",constructor:function(e){e=n.extend(!0,{},e),arguments[0]=e,this.isEditMode=e.isEditMode,t.View.apply(this,arguments)},initialize:function(e){this.options=e,this.dataSourceType=void 0,o.supportsTouch&&this.initSwipeScroll(),l.saveReferrer(this.historyBackToken),this.fetchingCustomDataSourcesDeferred=n.Deferred(),this.fetchingTheModelDeferred=n.Deferred(),this.customDataSourceCollection=new m,this.customDataSourceCollection.fetch().done(i.bind(function(){this.renderDataSourceContainer()},this));var t=g.deepDefaults(e,{awsSettings:f});if(this.options.resourceUri){var s=this,a=new r({uri:this.options.resourceUri});a.fetch().then(function(e,t,i){s.dataSource=a.attributes,s.dataSourceType=d.getViewType(i.getResponseHeader("Content-Type"),s.dataSource),s.fetchingTheModelDeferred.resolve()})}else this.options.dataSource&&this.options.dataSourceClientType?(this.dataSource=this.options.dataSource,this.dataSourceType=d.getViewType(this.options.dataSourceClientType,this.options.dataSource),this.fetchingTheModelDeferred.resolve()):(t.awsSettings.productTypeIsEc2&&(this.dataSourceType=d.getViewType(c.AWS,null)),this.fetchingTheModelDeferred.resolve())},renderDataSourceContainer:function(){var e={AZURE_SQL:"AzureSql",AWS:"Aws",BEAN:"Bean",JDBC:"JDBC",JNDI:"JNDI",VIRTUAL:"Virtual"},t=i.chain(e).map(function(e,t){return{value:c[t].toLowerCase(),label:s["resource.dataSource.dstype"+e]}}).value();this.customDataSourceCollection.forEach(function(e){var i=e.get("id");t.push({value:i,label:s[i+".name"]?s[i+".name"]:i})}),t=i.sortBy(t,function(e){return e.label.toLowerCase()}),this.$el.append(i.template(h,{dataSourceTypeOptions:t,i18n:s,supportsTouch:o.supportsTouch,isEditMode:this.isEditMode})),this.fetchingCustomDataSourcesDeferred.resolve()},initSwipeScroll:function(){var e=this.$("#stepDisplay");e.length&&new a(e.parent()[0],e.parent().parent()[0],{})},render:function(){n.when(this.fetchingCustomDataSourcesDeferred,this.fetchingTheModelDeferred).done(i.bind(function(){this._render()},this))},_render:function(){var e={};return this.dataSourceView&&(e={label:this.dataSourceView.model.get("label"),name:this.dataSourceView.model.get("name"),description:this.dataSourceView.model.get("description")}),this.dataSourceView&&this.dataSourceView.remove(),delete this.dataSourceView,0===this.$(".row.inputs .body:eq(0)").length&&this.$(".row.inputs > .column > .content").append("<div class='body dataSourceBody'></div>"),this.dataSourceType||(this.dataSourceType=c.JDBC.toLowerCase()),this.dataSourceView=d.getView(i.extend(this.options,{dataSourceType:this.dataSourceType,dataSource:i.extend({},this.dataSource,e),el:this.$(".row.inputs .body:eq(0)")})),this.$(".dataSourceBody").attr("dstype",this.dataSourceType.toLowerCase()),this.$("select[name='dataSourceType']").val(this.dataSourceType),this},onDataSourceTypeChange:function(e){var t=n(e.target).val();this.dataSourceType!=t&&(this.dataSourceType=t,this.render())},_prepareSaveDialog:function(){this.saveDialog&&this.saveDialog.remove();var e=u.getView(this.dataSourceType);this.saveDialog=new e(i.extend({},this.options,{model:this.dataSourceView.model,saveFn:this.options.saveFn,success:i.bind(this._onSaveDone,this),error:i.bind(this._onSaveFail,this)}))},onSaveClick:function(){if(this.dataSourceView.model.isValid(!0)){var e=this,t=function(){e._prepareSaveDialog(),e.saveDialog.startSaveDialog()};return i.isUndefined(this.dataSourceView.model.validationMethodOnSaveClick)?i.isUndefined(this.dataSourceView.validationMethodOnSaveClick)?void t():void this.dataSourceView.validationMethodOnSaveClick(t):void this.dataSourceView.model.validationMethodOnSaveClick(t)}},_onSaveDone:function(){redirectToUrl(p.contextPath+"/flow.html?_flowId=repositoryConfirmFlow&resourceType=dataSource")},_onSaveFail:function(e,t){this.saveDialog&&(this.saveDialog.close(),this.saveDialog.remove());var n,r=this,a=!1,o=!1;try{a=JSON.parse(t.responseText)}catch(l){}i.isArray(a)||(a=[a]),i.each(a,function(e){var t=!1,i=!1;e&&("mandatory.parameter.error"===e.errorCode?e.parameters&&e.parameters[0]&&(i=s["resource.datasource.saveDialog.parameterIsMissing"],t=e.parameters[0].substr(e.parameters[0].indexOf(".")+1)):"illegal.parameter.value.error"===e.errorCode&&e.parameters&&e.parameters[0]&&(t=e.parameters[0].substr(e.parameters[0].indexOf(".")+1),i=s["resource.datasource.saveDialog.parameterIsWrong"]),"ConnectionUrl"===t&&(t="connectionUrl"),i&&t&&(r.dataSourceView.invalidField("[name="+t+"]",i),o=!0))}),o===!1&&(n="Failed to save data source.",a[0]&&a[0].errorCode?n+="<br/>The reason is: "+a[0].errorCode:a.message&&(n+="<br/>The reason is: "+a.message),n+="<br/><br/>The full response from the server is: "+t.responseText,dialogs.errorPopup.show(n))},onCancelClick:function(){this.options.cancelFn?this.options.cancelFn():l.restore(this.historyBackToken)}})}),define("dataSource/dataSourceMain",["require","commons.main","!domReady","jquery","jrs.configs","bi/repository/model/RepositoryResourceModel","bi/repository/enum/repositoryResourceTypes","dataSource/DataSourceController"],function(e){"use strict";e("commons.main");var t=e("!domReady"),i=e("jquery"),n=e("jrs.configs"),s=e("bi/repository/model/RepositoryResourceModel"),r=e("bi/repository/enum/repositoryResourceTypes"),a=e("dataSource/DataSourceController");t(function(){var e=n.addDataSource.initOptions,t=/ParentFolderUri=([^&]+)/.exec(location.href),o=i.Deferred().done(function(){var t=new a(e);i("#display").append(t.$el),t.render()});if(t&&t[1]){var l=decodeURIComponent(t[1]);if("/"===l)e.parentFolderUri=l,o.resolve();else{var d=new s({uri:l},{contextPath:n.contextPath});d.fetch().always(function(){d.type&&r.FOLDER.toLowerCase()===d.type.toLowerCase()&&(e.parentFolderUri=l),o.resolve()})}}else o.resolve()})});