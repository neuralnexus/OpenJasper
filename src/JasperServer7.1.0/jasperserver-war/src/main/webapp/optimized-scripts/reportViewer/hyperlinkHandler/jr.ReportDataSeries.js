define(["jquery","bi/report/Report","jrs.configs","adhoc/chart/palette/defaultPalette","bundle!CommonBundle"],function(e,t,i,s,r){var n=function(e){this.hyperlinks=e,this.reportInstance=null,this.reportContainer=null,this.selectedLinkIds=[],this.selectedLinks={}};return n.prototype={register:function(){var t=this;e(t.hyperlinks[0].selector).on("click",function(i){var s=t._getHyperlinkData(e(this).attr("data-id"));s&&t._handleHyperlinkClick(s)}).css("cursor","pointer")},handleInteraction:function(e){if("hyperlinkClicked"==e.type){var t=this._getHyperlinkData(e.data.hyperlink.id);t&&this._handleHyperlinkClick(t)}},_getHyperlinkData:function(t){var i=null;return e.each(this.hyperlinks,function(e,s){return t===s.id?(i=s,!1):void 0}),i},_handleHyperlinkClick:function(n){var o=e("span[data-id='"+n.id+"'] span"),l=this.selectedLinkIds.indexOf(n.id);if(l>=0){var a=this.selectedLinks[n.id];o.css("color",a.origColor),o.css("background-color",a.origBackcolor),this.selectedLinkIds.splice(l,1),delete this.selectedLinks[n.id]}else{var c=0===this.selectedLinkIds.length?0:(this.selectedLinks[this.selectedLinkIds[this.selectedLinkIds.length-1]].paletteIdx+1)%s.colors.length,a={hyperlink:n,origColor:o.css("color"),origBackcolor:o.css("background-color"),paletteIdx:c};o.css("color","#ffffff"),o.css("background-color",s.colors[c]),this.selectedLinkIds.push(n.id),this.selectedLinks[n.id]=a}var d=this,h=[];if(e.each(this.selectedLinkIds,function(t,i){var r=d.selectedLinks[i],n={};e.each(r.hyperlink.params,function(e,t){0===e.indexOf("param_")&&(n[e.substring(6)]=t)});var o={params:n,color:s.colors[r.paletteIdx]};h.push(o)}),0===e("#seriesReport").length){var p=e('<div id="seriesReport"><div id="seriesReportContainer" style="width:100%;height:100%;"></div></div>');p.insertAfter("#reportContainer");var k=n.params._width||500,u=n.params._height;e("#seriesReport").css("width",k),u&&e("#seriesReport").css("height",u),p.dialog({autoOpen:!1,width:k,height:u||"auto",closeText:r["button.close"]})}0===h.length?e("#seriesReport").dialog("close"):(e("#seriesReport").dialog("open"),this.report||(this.report=new t({resource:n.params._report,container:"#seriesReportContainer",server:i.contextPath})),this.report.params({selectedEntries:[JSON.stringify(h)]}),this.report.refresh())}},n});