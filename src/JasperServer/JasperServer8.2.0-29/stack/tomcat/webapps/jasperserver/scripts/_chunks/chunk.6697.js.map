{"version":3,"sources":["webpack://jrs-ui/./src/resource/resource.query.js","webpack://jrs-ui/./src/addResource/query/addQuery.common.js","webpack://jrs-ui/./src/resource/resource.locate.js"],"names":["STEP1_PAGE_ID","STEP2_PAGE_ID","STEP3_PAGE_ID","LABEL_ID","RESOURCE_ID_ID","DESCRIPTION_ID","JUMP_TO_PAGE_ID","DONE_BUTTON_ID","NEXT_BUTTON_ID","JUMP_TO_BUTTON_ID","NEW_DATA_SOURCE_LINK_ID","LOCAL_DATA_SOURCE_ID","RESOURCE_URI_INPUT_ID","QUERY_SQL","_canGenerateId","initialize","options","this","_step1Page","jQuery","_step2Page","_step3Page","_form","layoutModule","find","_label","document","getElementById","_resourceId","_description","validator","resource","_dataSourceUri","_query","_nextButton","_doneButton","_jumpToPage","_jumpButton","_newDataSourceLink","_localDataSource","_isEditMode","isEditMode","resourceLocator","resourceInput","browseButton","newResourceLink","treeId","providerId","dialogTitle","selectLeavesOnly","_initEvents","on","e","_isDataValid","stopPropagation","checked","preventDefault","click","bind","element","target","getValue","setValue","ValidationModule","self","observe","jrsConfigs","_","saveFn","dataSource","model","type","input","createElement","name","value","JSON","stringify","toJSON","appendChild","submit","cancelFn","skipLocation","window","localContext","initOptions","dataSourceJson","dataSourceClientType","dataSourceUri","resourceUri","dataSourceController","DataSourceController","append","$el","remove","render","bindAsEventListener","res","disabled","jumpTo","pageTo","resourceQuery","isIPad","CONTENT_REPOSITORY","LOCAL","NONE","FILE_SYSTEM","LOCATE_EVENT","ALLOWED_FILE_RESOURCE_EXTENSIONS","get","filePath","fileUploadInput","fakeFilePath","fakeFileUploadInput","fakeFileInput","fakeFileUploadInputText","_initFileSelector","_clickHandler","_nextClickHandler","_uploadChangeHandler","event","hasClass","removeClass","validFileName","match","extension","message","join","addClass","html","_updateResourceSelectorState","id","classes","_switchElementClasses","fileSelector","picker","uriTextboxId","browseButtonId","title"],"mappings":"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","file":"_chunks/chunk.6697.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n\nimport resource from './resource.base';\nimport resourceLocator from './resource.locate';\nimport {ValidationModule} from \"../util/utils.common\";\nimport DataSourceController from '../dataSource/DataSourceController';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport jQuery from 'jquery';\nimport _ from 'underscore';\nimport layoutModule from \"../core/core.layout\";\n\nvar resourceQuery = {\n    STEP1_PAGE_ID: 'addResource_query_step1',\n    STEP2_PAGE_ID: 'addResource_locateDataSource',\n    STEP3_PAGE_ID: 'addResource_query_step3',\n    LABEL_ID: 'query.label',\n    RESOURCE_ID_ID: 'query.name',\n    DESCRIPTION_ID: 'query.description',\n    JUMP_TO_PAGE_ID: 'jumpToPage',\n    // PREVIOUS_BUTTON_ID: \"previous\",\n    DONE_BUTTON_ID: 'done',\n    NEXT_BUTTON_ID: 'next',\n    JUMP_TO_BUTTON_ID: 'jumpButton',\n    NEW_DATA_SOURCE_LINK_ID: 'newDataSourceLink',\n    LOCAL_DATA_SOURCE_ID: 'LOCAL',\n    RESOURCE_URI_INPUT_ID: 'resourceUri',\n    QUERY_SQL: 'query.sql',\n    _canGenerateId: true,\n    initialize: function (options) {\n        this._step1Page = jQuery('#' +this.STEP1_PAGE_ID)[0];\n        this._step2Page = jQuery('#' +this.STEP2_PAGE_ID)[0];\n        this._step3Page = jQuery('#' +this.STEP3_PAGE_ID)[0];\n        if (this._step1Page) {\n            this._form = jQuery('#' + layoutModule.PAGE_BODY_ID).find('form')[0];\n            this._label = document.getElementById(this.LABEL_ID);\n            this._resourceId = document.getElementById(this.RESOURCE_ID_ID);\n            this._description = document.getElementById(this.DESCRIPTION_ID);\n            this._label.validator = resource.labelValidator.bind(this);\n            this._resourceId.validator = resource.resourceIdValidator.bind(this);\n            this._description.validator = resource.descriptionValidator.bind(this);\n        }\n        if (this._step2Page) {\n            this._form = jQuery('#' + layoutModule.PAGE_BODY_ID).find('form')[0];\n            this._dataSourceUri = document.getElementById(this.RESOURCE_URI_INPUT_ID);\n            this._dataSourceUri.validator = resource.dataSourceValidator.bind(this);\n        }\n        if (this._step3Page) {\n            this._form = jQuery('#' + layoutModule.PAGE_BODY_ID).find('form')[0];\n            this._query = document.getElementById(this.QUERY_SQL);\n            this._query.validator = resource.queryValidator.bind(this);\n        }\n        this._nextButton = jQuery('#' +this.NEXT_BUTTON_ID);\n        this._doneButton = jQuery('#' +this.DONE_BUTTON_ID);\n        this._jumpToPage = jQuery('#' +this.JUMP_TO_PAGE_ID)[0];\n        this._jumpButton = jQuery('#' +this.JUMP_TO_BUTTON_ID)[0];\n        this._newDataSourceLink = jQuery('#' +this.NEW_DATA_SOURCE_LINK_ID)[0];\n        this._localDataSource = jQuery('#' +this.LOCAL_DATA_SOURCE_ID)[0];\n        this._isEditMode = options ? options.isEditMode : false;\n        resourceLocator.initialize({\n            resourceInput: 'resourceUri',\n            browseButton: 'browser_button',\n            newResourceLink: 'newDataSourceLink',\n            treeId: 'queryTreeRepoLocation',\n            providerId: 'dsTreeDataProvider',\n            dialogTitle: resource.messages['resource.Query.Title'],\n            selectLeavesOnly: true\n        });\n        this._initEvents();\n    },\n    _initEvents: function () {\n        this._nextButton.on('click', function (e) {\n            if (!this._isDataValid()) {\n                e.stopPropagation();\n            }\n            if (this._localDataSource && this._localDataSource.checked) {\n                e.preventDefault();\n                e.stopPropagation();\n                this._newDataSourceLink.click();\n            }\n        }.bind(this));\n        this._doneButton.on('click', function (e) {\n            if (!this._isDataValid()) {\n                e.preventDefault();\n            }\n        }.bind(this));\n        jQuery(this._form).on('keyup', function (e) {\n            var element = e.target;\n            if (element == this._resourceId && this._resourceId.getValue() != resource.generateResourceId(this._label.getValue())) {\n                this._canGenerateId = false;\n            }\n            if (element == this._label && !this._isEditMode && this._canGenerateId) {\n                this._resourceId.setValue(resource.generateResourceId(this._label.getValue()));\n                ValidationModule.validate(resource.getValidationEntries([this._resourceId]));\n            }\n        }.bind(this));\n        if (this._newDataSourceLink) {\n            var self = this;\n            this._newDataSourceLink.observe('click', function (e) {\n                if (self._localDataSource.checked) {\n                    var options = jrsConfigs.addDataSource ? _.clone(jrsConfigs.addDataSource.initOptions) : {};\n                    options.saveFn = function (dataSource, model) {\n                        dataSource.type = model.type;\n                        var input = document.createElement('input');\n                        input.type = 'hidden';\n                        input.name = 'dataSourceJson';\n                        input.value = JSON.stringify(_.extend(model.toJSON(), {name: dataSource.name}));\n                        self._form.appendChild(input);\n                        input = document.createElement('input');\n                        input.type = 'hidden';\n                        input.name = 'dataSourceType';\n                        input.value = model.type;\n                        self._form.appendChild(input);\n                        input = document.createElement('input');\n                        input.type = 'hidden';\n                        input.name = '_eventId_saveDatasource';\n                        self._form.appendChild(input);\n                        self._form.submit();\n                    };\n                    options.cancelFn = function () {\n                        self._form.submit();\n                    };\n                    options.skipLocation = true;\n                    if (window.localContext && window.localContext.initOptions && window.localContext.initOptions) {\n                        if (window.localContext.initOptions.dataSourceJson) {\n                            // data source page has been opened. Here are previously edited attributes and client type\n                            options.isEditMode = true;\n                            options.dataSource = window.localContext.initOptions.dataSourceJson;\n                            options.dataSourceClientType = window.localContext.initOptions.dataSourceJson.type;\n                        } else if (window.localContext.initOptions.dataSourceUri) {\n                            // first edit. No model yet.\n                            options.isEditMode = true;\n                            options.resourceUri = window.localContext.initOptions.dataSourceUri;\n                        }\n                    }\n                    var dataSourceController = new DataSourceController(options);\n                    jQuery('#display').append(dataSourceController.$el);    // remove conflicting dom elements\n                    // remove conflicting dom elements\n                    jQuery('#selectFromRepository').remove();\n                    dataSourceController.render();\n                }\n            }.bindAsEventListener(this));\n        }\n    },\n    _isDataValid: function () {\n        var res = true;\n        if (this._label)\n            res = res && ValidationModule.validate(resource.getValidationEntries([this._label]));\n        if (this._resourceId) {\n            if (this._resourceId.getValue() != resource.generateResourceId(this._label.getValue())) {\n                this._canGenerateId = false;\n            }\n            if (!this._isEditMode && this._canGenerateId) {\n                this._resourceId.setValue(resource.generateResourceId(this._label.getValue()));\n                res = res && ValidationModule.validate(resource.getValidationEntries([this._resourceId]));\n            }\n        }\n        if (this._description)\n            res = res && ValidationModule.validate(resource.getValidationEntries([this._description]));    // When using Prototype JS to disable element its sets disabled property to appropriate state.\n        // So, we should check its state using this property to handle states correctly.\n        // When using Prototype JS to disable element its sets disabled property to appropriate state.\n        // So, we should check its state using this property to handle states correctly.\n        if (this._dataSourceUri && !this._dataSourceUri.disabled)\n            res = res && ValidationModule.validate(resource.getValidationEntries([this._dataSourceUri]));\n        if (this._query)\n            res = res && ValidationModule.validate(resource.getValidationEntries([this._query]));\n        return res;\n    },\n    jumpTo: function (pageTo) {\n        this._jumpToPage.setValue(pageTo);\n        this._jumpButton.click();\n        return false;\n    }\n};\n\nexport default resourceQuery;","/*\n * Copyright (C) 2005 - 2019 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport resource from '../../resource/resource.base';\nimport resourceQuery from '../../resource/resource.query';\nimport jQuery from 'jquery';\nimport {isIPad} from \"../../util/utils.common\";\n\nvar options = jrsConfigs.addQuery.localContext.initOptions;\n_.extend(window.localContext, jrsConfigs.addQuery.localContext);\n_.extend(resource.messages, jrsConfigs.addQuery.resource.messages);\nresourceQuery.initialize(options);\nif (jrsConfigs.addQuery.buttonFlowControls) {\n    jQuery('#steps1_2').on('click', function () {\n        return resourceQuery.jumpTo('reportNaming');\n    });\n    jQuery('#step3').on('click', function () {\n        return resourceQuery.jumpTo('resources');\n    });\n    jQuery('#step4').on('click', function () {\n        return resourceQuery.jumpTo('dataSource');\n    });\n    jQuery('#step5').on('click', function () {\n        return resourceQuery.jumpTo('query');\n    });\n    jQuery('#step6').on('click', function () {\n        return resourceQuery.jumpTo('customization');\n    });\n}\nisIPad() && resource.initSwipeScroll();\n","/*\r\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\r\n * http://www.jaspersoft.com.\r\n *\r\n * Unless you have purchased a commercial license agreement from Jaspersoft,\r\n * the following license terms apply:\r\n *\r\n * This program is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Affero General Public License as\r\n * published by the Free Software Foundation, either version 3 of the\r\n * License, or (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\r\n * GNU Affero General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU Affero General Public License\r\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\r\n */\r\n\r\n\r\n/**\r\n * @version: $Id$\r\n */\r\n\r\nimport jQuery from 'jquery';\r\nimport _ from 'underscore';\r\nimport resource from './resource.base';\r\nimport picker from '../components/components.pickers';\r\n\r\nvar resourceLocator = {\r\n    CONTENT_REPOSITORY : 'CONTENT_REPOSITORY',\r\n    LOCAL : 'LOCAL',\r\n    NONE : 'NONE',\r\n    FILE_SYSTEM : 'FILE_SYSTEM',\r\n    LOCATE_EVENT : 'resource:locate',\r\n    ALLOWED_FILE_RESOURCE_EXTENSIONS: [\r\n        \"css\", //css\r\n        \"ttf\", //font\r\n        \"jpg\", \"jpeg\", \"gif\", \"bmp\", \"png\", //img\r\n        \"jar\", //jar\r\n        \"jrxml\", //jrxml\r\n        \"properties\", //properties\r\n        \"jrtx\", //jrtx\r\n        \"xml\", \"agxml\", //xml\r\n        \"docx\", \"doc\", \"ppt\", \"pptx\", \"xls\", \"xlsx\", \"ods\", \"odt\", \"odp\", \"pdf\", \"rtf\", \"html\" //contentResource\r\n    ],\r\n\r\n    /*\r\n     * Initializes Resource Locator common logic.\r\n     * @param options Object with following properties:\r\n     *     options = {\r\n     *          fileUploadInput : 'filePath',\r\n     *          resourceInput : 'resourceUri',\r\n     *          browseButton : 'browser_button',\r\n     *          newResourceLink : 'link_id',\r\n     *          treeId : 'resourceBrowserTreeId',\r\n     *          providerId : 'treeProviderId',\r\n     *          dialogTitle : 'Select Resource From Repository'\r\n     *      }\r\n     *\r\n     */\r\n    initialize: function(options) {\r\n        var get = function(element) {\r\n            return _.isObject(element) ? element : jQuery('#' + element)[0];\r\n        };\r\n\r\n        this.resourceUri = get(options.resourceInput);\r\n        this.browseButton = get(options.browseButton);\r\n        this.filePath = get(options.fileUploadInput);\r\n        this.fakeFilePath = get(options.fakeFileUploadInput);\r\n        this.fakeFileInput = get(options.fakeFileUploadInputText);\r\n        this.newResourceLink = get(options.newResourceLink);\r\n\r\n        try {\r\n            this._initFileSelector(options);\r\n        } catch(e) {\r\n            /* bypass logging to console */\r\n        } finally {\r\n            this._initEvents(options);\r\n        }\r\n\r\n        return this;\r\n    },\r\n\r\n    _initEvents: function(options) {\r\n        jQuery(document).on(\"click\", \"#CONTENT_REPOSITORY, #FILE_SYSTEM, #NONE, #LOCAL\", this._clickHandler);\r\n        if (options.providerId === \"fileResourceTreeDataProvider\") {\r\n            jQuery(\"#next\").on(\"click\", resourceLocator._nextClickHandler);\r\n            jQuery(\"#filePath\").on(\"change\", resourceLocator._uploadChangeHandler);\r\n        }\r\n    },\r\n\r\n    _nextClickHandler: function(event) {\r\n        if (jQuery(\"#fileUpload\").hasClass(\"error\")) {\r\n            event.preventDefault();\r\n        }\r\n    },\r\n\r\n    _uploadChangeHandler: function(event) {\r\n        jQuery(\"#fileUpload\").removeClass(\"error\");\r\n\r\n        var validFileName = true;\r\n\r\n        var fileName = jQuery(\"#filePath\")[0].value;\r\n        if (fileName) {\r\n            var match = jQuery(\"#filePath\")[0].value.match(/.*\\.([^\\.]+)$/);\r\n            if (match) {\r\n                var extension = match[1];\r\n                if (_.indexOf(resourceLocator.ALLOWED_FILE_RESOURCE_EXTENSIONS, extension) < 0) {\r\n                    validFileName = false;\r\n                }\r\n            } else {\r\n                validFileName = false;\r\n            }\r\n        } else {\r\n            validFileName = false;\r\n        }\r\n\r\n        if (!validFileName) {\r\n            var message =\r\n                resource.messages['resource.report.unsupportedFileType.error'] +\r\n                    \" \" +resourceLocator.ALLOWED_FILE_RESOURCE_EXTENSIONS.join(\", \");\r\n\r\n            jQuery(\"#fileUpload\").addClass(\"error\").find(\"span.warning\")\r\n                .html(message);\r\n        }\r\n    },\r\n\r\n    _clickHandler : function(event) {\r\n        resourceLocator._updateResourceSelectorState(event.target.id);\r\n    },\r\n\r\n    _updateResourceSelectorState : function(id) {\r\n        // Update File upload component state.\r\n        resource.switchButtonState(this.filePath, id === this.FILE_SYSTEM);\r\n        resource.switchButtonState(this.fakeFilePath, id === this.FILE_SYSTEM);\r\n        resource.switchButtonState(this.fakeFileInput, id === this.FILE_SYSTEM);\r\n        // Update Resource selector component state: button + text input.\r\n        resource.switchButtonState(this.browseButton, id === this.CONTENT_REPOSITORY);\r\n        resource.switchDisableState(this.resourceUri, id !== this.CONTENT_REPOSITORY);\r\n        // Update Create new resource link state.\r\n        var classes = id === this.LOCAL ? ['disabled', 'launcher'] : [];\r\n        this._switchElementClasses(this.newResourceLink, classes);\r\n    },\r\n\r\n    _initFileSelector : function(options) {\r\n        this.fileSelector = new picker.FileSelector(_.extend({}, options, {\r\n            uriTextboxId: this.resourceUri,\r\n            browseButtonId: this.browseButton,\r\n            title: options.dialogTitle\r\n        }));\r\n    },\r\n\r\n    remove : function(options) {\r\n        this.fileSelector.remove();\r\n    },\r\n\r\n    ///////////////////////////\r\n    // Utility methods.\r\n    ///////////////////////////\r\n    _switchElementClasses : function(element, classes) {\r\n        element && classes && jQuery(element).removeClass(classes[0]).addClass(classes[1]);\r\n    }\r\n};\r\n\r\nexport default resourceLocator;\r\n"],"sourceRoot":""}