(self.webpackChunkjrs_ui=self.webpackChunkjrs_ui||[]).push([[3739],{67e3:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var i,n,l=s(72157),o=s.n(l),r=s(97836),a=s.n(r),c=s(94277);c.MP.components.templateEngine=(i=o(),n=a(),{render:function(e,t,s){if(!s)return n.template(e)(t);if(s==this.STD_PLACEHOLDERS){var i=String(e);return n.each(t,(function(e,t){var s=new RegExp("\\{"+t+"\\}");i=i.replace(s,e)})),i}},renderUrl:function(e,t,s){var i=n.template(e)(t);return s&&(i=encodeURI(i)),i},getTemplateText:function(e){return i("#"+e).html()},createTemplate:function(e){var t=i("#"+e).html();if(t&&t.length>0)return function(e){return n.template(t)(e)}},createTemplateFromText:function(e){if(e&&e.length>0)return function(t){return n.template(e)(t)}},createTemplateSection:function(e,t){var s="\x3c!--#val--\x3e(\\s|\\S)*\x3c!--/val--\x3e".replace(/val/g,e),i=new RegExp(s,"g"),l=this.getTemplateText(t).match(i)[0];return function(e){return n.template(l)(e)}},STD_PLACEHOLDERS:"std_placeholder"});const d=c.MP.components.templateEngine},63739:(e,t,s)=>{"use strict";s.d(t,{Z:()=>ie});var i=s(72157),n=s.n(i),l=s(97836),o=s.n(l),r=s(15892),a=s.n(r),c=s(59772),d=s(71914),u=s(29562);let h;"ImportExportValidationBundle"!==u.t?(u.h.ImportExportValidationBundle=u.h.ImportExportValidationBundle||{},h=u.h.ImportExportValidationBundle):h=Object.keys(u.h).reduce(((e,t)=>({...e,...u.h[t]})),{});const p=h;var g=s(81180),b=s(12473);const v=a().Model.extend({url:"rest_v2/settings/exportResourceOptions",fetch:function(){return(0,b.Z)({url:this.url,type:"GET"})}});var m=s(31371),f={},y={roles:null,users:null,everything:!0,userForRoles:!1,rolesForUser:!1,includeReports:!0,includeOtherResourceFiles:!0,includeDataSources:!0,includeDependentObjects:!0,includeAttributes:!0,includeAttributeValues:!0},x={includeAccessEvents:!1,includeAuditEvents:!1,includeMonitoringEvents:!1},R={includeDomains:!0,includeAdHocViews:!0,includeDashboards:!0},S={includeSubOrganizations:!0},k={includeServerSettings:!0};f[m.Z.ROOT_TENANT]=o().extend({},y,x,R,S,k),f[m.Z.TENANT]=o().extend({},y,R,S),f[m.Z.SERVER_PRO]=o().extend({},y,x,R,S,k),f[m.Z.SERVER_CE]=o().extend({},y,k,{includeAccessEvents:!0});var E=s(34052),T=s(12264),w=E.Z.extend({bundle:p}),C={includeReports:"report",includeDomains:"domain",includeAdHocViews:"adhocDataView",includeDataSources:"dataSource",includeDashboards:"dashboard",includeOtherResourceFiles:"others"},O=g.Z.extend({defaults:{uris:["/"],fileName:"export.zip",encryptFile:!1,includeRepositoryPermissions:!0,includeScheduledReportJobs:!0,includeDependencies:!0,includeFullResourcePath:!0,keyType:"",keyAlias:"",invalidKeyError:"",invalidSecureFileContentError:"",customKeyElements:"",showCustomKey:!0,"key-Alias":""},validation:{fileName:[{required:!0,msg:new w("export.file.name.empty")},{maxLength:256,msg:new w("export.file.name.too.long",256)},{fn:function(e){return/[\\/?*%:|"<>]/g.test(e)?new w("export.file.name.contains.not.supported.characters"):/^[\.]{1,2}$/g.test(e)?new w("export.file.name.not.valid"):void 0}}],uris:[{fn:function(){var e=this.toExportTask();return!(e.uris||e.roles||e.users||o().filter(e.parameters,(function(e){return"role-users"!==e&&"users-roles"!==e})).length)}}]},initialize:function(){g.Z.prototype.initialize.call(this),o().bindAll(this,"url","save","cancel","toExportTask","reset"),this.resources=new v},url:function(){return"rest_v2/export"},save:function(){var e=new(n().Deferred),t=new(a().Model),s=this;t.url=this.url;var i={};return function(e){var t=[],s=new(n().Deferred);return!e.get("everything")&&Z(e)?e.resources.fetch().done((function(i){for(var n in C)e.get(n)&&t.push(i[C[n]]);s.resolve(o().flatten(t))})):s.resolve(null),s}(this).done((function(n){n&&(i.resourceTypes=n),t.save(o().extend(s.toExportTask(),i)).done((function(t){e.resolve(t)})).fail((function(t){e.reject(t),s.trigger("error",s,t)}))})),e},cancel:function(){var e=this.url()+"/"+this.id;this.destroy({url:e})},toExportTask:function(){var e=this.get("everything"),t=this.get("roles"),s=this.get("users"),i=o().clone(this.get("uris")),n=e||this.get("includeReports")&&this.get("includeScheduledReportJobs"),l={uris:i,scheduledJobs:this.get("includeScheduledReportJobs")?i:null,parameters:[]};o().extend(l,this.ExportOptions()),this.get("includeRepositoryPermissions")&&l.parameters.push("repository-permissions"),!this.get("includeDependencies")&&l.parameters.push("skip-dependent-resources");var r,a,c,u=(r=i&&i[0],a=d.Z.organizationsFolderUri||"/organizations",c=d.Z.orgTemplateFolderUri||"/org_template",new RegExp("^("+a+"(?!"+c+")/([^/]+))+").exec(r));u&&!this.get("includeFullResourcePath")&&(l.organization=u.last(),l.parameters.push("skip-suborganizations","skip-attribute-values"),l.uris=o().map(i,(function(e){return e.replace(u.first(),"")})),l.scheduledJobs=this.get("includeScheduledReportJobs")?l.uris:null);var h={uris:Z(this)?i:null,roles:o().isEmpty(t)?null:t,users:o().isEmpty(s)?null:s,scheduledJobs:n?i:null,organization:this.get("organization"),parameters:A(this)};return o().extend(h,this.ExportOptions()),this.type!==m.Z.REPOSITORY?h:l},ExportOptions:function(){return this.get("keyType")===T.Z.CUSTOMKEY?{keyAlias:this.get("keyAlias")}:this.get("keyType")===T.Z.UNIVERSALKEY?{keyAlias:this.get("keyType")}:{keyAlias:T.Z.DEFAULTKEY}},reset:function(e,t){this.type=t;var s=o().extend({},this.defaults,function(e){return f[e]}(t));this.clear().set(o().extend({},s,e))}});function A(e){var t,s,i=[];return e.get("everything")?(i.push("everything"),e.get("includeAccessEvents")&&i.push("include-access-events")):(t=Z(e)&&e.get("includeRepositoryPermissions")&&!o().isEmpty(e.get("uris")),s=!e.get("includeAttributeValues")||!e.get("includeAttributes"),e.get("userForRoles")&&i.push("role-users"),e.get("rolesForUser")&&i.push("users-roles"),t&&i.push("repository-permissions"),!e.get("includeSubOrganizations")&&i.push("skip-suborganizations"),e.get("includeAttributes")&&i.push("include-attributes"),s&&i.push("skip-attribute-values"),e.get("includeServerSettings")&&i.push("include-server-settings"),(!Z(e)||!e.get("includeDependentObjects"))&&i.push("skip-dependent-resources")),e.get("includeAuditEvents")&&i.push("include-audit-events"),e.get("includeMonitoringEvents")&&i.push("include-monitoring-events"),e.get("encryptFile")&&i.push("encrypted"),i}function Z(e){var t=o().keys(C);return o().filter(t,(function(t){return e.get(t)})).length}o().extend(O.prototype,c.Z.mixin);const D=O;var U=s(33890),_=s(67e3);const N=a().Model.extend({defaults:{items:[]},url:function(){return _.Z.renderUrl(this.urlTemplate,this.context,!0)},parse:function(e){return{items:e?e.role?e.role:e.user:[]}},defaultErrorHandler:function(e,t){var s;try{s=JSON.parse(t.responseText)}catch(e){s=null}this.trigger("error:server",t.status,s,e)},setContext:function(e){this.context=o().extend(this.context||{searchString:"",excludeSubOrgs:!1},e),this.fetch({error:o().bind(this.defaultErrorHandler,this)})}},{instance:function(e,t){var s=new this;return s.urlTemplate=e,t&&s.setContext(t),s}});function L(e,t,s){return s<=Math.max(e,t)&&s>=Math.min(e,t)}const j=a().View.extend({events:{"click .button.search":"search","click .button.searchClear":"clear","click .button-select-all":"_selectAllHandler","keydown input[type=text]":"keyHandler","mousedown li":"selectionStarted","mouseenter li":"mouseEntered","mouseleave li":"mouseLeave","mouseup ul":"selectionFinished","mouseenter ul":"stopScroll","mouseleave ul":"startScroll"},cursor:-1,baseCursor:-1,selecting:!1,scrollSpeed:30,initialize:function(e){this.model.on("change",o().bind(this.renderList,this)),this.model.on("error:server",o().bind((function(){this.trigger("error:server",arguments)}),this)),this.upHandler=o().bind((function(e){this.stopScroll(e),this.selecting=!1}),this),this.el=!1,this.initOptions=e},render:function(){return this.mainTemplate||(this.mainTemplate=o().template('<div class="control combo {{- customClass}} " title="{{- title}}">\n\n    <js-templateNonce></js-templateNonce>\n    <span class="wrap">{{- title}}</span>\n        <span class="control searchLockup ">\n            <div class="wrap">\n                <input type="text" tabindex="">\n            </div>\n            <b class="right">\n                <a class="button searchClear"></a>\n            </b>\n            <a class="button search up"></a>\n        </span>\n\n    <div class="authorityPicker" onselectstart="return false">\n        <div class="selectBorder upper"></div>\n        <ul class="list"></ul>\n        <div class="selectBorder lower"></div>\n    </div>\n\n    <div class="button-select-all" title="{{- selectLabel }}">\n        <i class="icon"></i>\n        <a class="label">\n            <span class="text">{{- selectLabel }}</span>\n        </a>\n    </div>\n</div>')),this.optionsTemplate||(this.optionsTemplate=o().template('{{ for (var i = 0, l = items.length; i<l; i++){ }}\n<li class="leaf">\n\n    <js-templateNonce></js-templateNonce>\n    <div class=""><span class="leftColumn">{{- items[i].name}}{{- items[i].username}}</span>\n        {{ if (items[i].tenantId){ }}\n            <span class="rightColumn">{{- items[i].tenantId }}</span>\n        {{ } }}\n    </div>\n</li>\n{{ } }}\n')),this.el||(this.$el=n()("<div></div>").html(this.mainTemplate(this.initOptions)).children(),this.el=this.$el[0],this.subEl=this.$el.find(".authorityPicker ul"),this.delegateEvents()),this.model.context||this.model.setContext(),this},renderList:function(){return this.subEl.html(this.optionsTemplate(this.model.attributes)).find("li").each((function(e,t){n()(t).attr("index",e)})),this.cursor=-1,this.baseCursor=-1,this.scrollSpeed=this.subEl.find("li:eq(0)").height(),this.subEl.scrollTop(0),this.trigger("change:selection",[]),this},getSelected:function(){return o().reduce(this.subEl.find(".selected"),(function(e,t){var s=o().map(n()(t).find("span"),(function(e){return n()(e).html()}));return e.push(s.join("|")),e}),[])},search:function(){var e=this.$el.find("input[type=text]").val();this.model.setContext({searchString:e}),e?this.$el.find(".button.searchClear").addClass("up"):this.$el.find(".button.searchClear").removeClass("up")},_selectAllHandler:function(){this.selectAll()},clear:function(){this.$el.find("input[type=text]").val(""),this.search()},keyHandler:function(e){13===e.which&&this.search()},setDisabled:function(e){var t=this.$el.find(".button-select-all").children();e?(this.subEl.addClass("disabled"),t.addClass("disabled"),this.undelegateEvents()):(this.subEl.removeClass("disabled"),t.removeClass("disabled"),this.delegateEvents()),this.$el.find("input[type=text]").attr("disabled",e)},highlightSet:function(e){this.subEl.find("li").each((function(t,s){s=n()(s);var i=o().map(s.find("span"),(function(e){return n()(e).html()}));s.toggleClass("highlighted",o().contains(e,i.join("|")))}))},selectAll:function(e){this.subEl.find("li").each((function(e,t){n()(t).addClass("selected")})),e||this.trigger("change:selection",this.getSelected())},selectNone:function(e){this.subEl.find("li").each((function(e,t){n()(t).removeClass("selected")})),e||this.trigger("change:selection",this.getSelected())},selectInverse:function(e){this.subEl.find("li").each((function(e,t){n()(t).toggleClass("selected")})),e||this.trigger("change:selection",this.getSelected())},selectItem:function(e,t){this.subEl.find("li[index="+e+"]").addClass("selected"),t||this.trigger("change:selection",this.getSelected())},unSelectItem:function(e,t){this.subEl.find("li[index="+e+"]").removeClass("selected"),t||this.trigger("change:selection",this.getSelected())},selectRange:function(e,t,s){var i=Math.min(e,t),l=Math.max(e,t);this.subEl.find("li:lt("+(l+1)+")").each((function(e,t){e>=i&&n()(t).addClass("selected")})),s||this.trigger("change:selection",this.getSelected())},selectionStarted:function(e){this.selecting=!0,e.ctrlKey||e.metaKey||this.selectNone(!0);var t=+n()(e.target).parents("li").toggleClass("selected").attr("index");e.shiftKey?-1!=this.cursor&&this.selectRange(this.cursor,t,!0):(this.cursor=t,this.baseCursor=this.cursor)},mouseEntered:function(e){this.selecting&&(this.cursor=+n()(e.target).parents("li").addClass("selected").attr("index"))},mouseLeave:function(e){if(this.selecting){var t=n()(e.target).parents("li"),s=n()(e.relatedTarget).parents("li");L(this.cursor,this.baseCursor,+s.attr("index"))&&t.removeClass("selected")}},selectionFinished:function(e){this.selecting=!1,this.trigger("change:selection",this.getSelected())},startScroll:function(e){if(this.selecting){if(n()(e.relatedTarget).hasClass("upper"))this.direction=-1;else{if(!n()(e.relatedTarget).hasClass("lower"))return void(this.selecting=!1);this.direction=1}n()(document.body).on("mouseup",this.upHandler),this.scrollTimer=setInterval(o().bind(this.scrollList,this),200)}},stopScroll:function(e){this.selecting&&(clearInterval(this.scrollTimer),this.direction=0,n()(document.body).off("mouseup",this.upHandler))},scrollList:function(){this.subEl.scrollTop(+this.subEl.scrollTop()+this.scrollSpeed*this.direction),L(this.cursor,this.baseCursor,this.cursor+this.direction)?this.unSelectItem(this.cursor,!0):this.selectItem(this.cursor+this.direction,!0),this.cursor=this.cursor+this.direction}});var I=s(62035),F=s(18580),B=s(76144),V=s(77475);const M=V.Z.extend({constructor:function(e){e||(e={}),o().extend(e,{resizable:!0,buttons:[{label:B.Z["export.button.continue"],action:"export",primary:!0},{label:F.Z["button.cancel"],action:"cancel",primary:!1}]}),V.Z.prototype.constructor.call(this,e),this.on("button:export",o().bind(this.close,this)),this.on("button:cancel",o().bind(this.close,this))},open:function(e){o().extend(e,{message:B.Z["export.dialog.broken.dependencies.intro"]}),V.Z.prototype.open.call(this,e)}});var P=s(63100),K=s(8045);const z='<div class="section resources tenant-options">\n\n    <js-templateNonce></js-templateNonce>\n    <p class="title">{{- i18n["export.dialog.resources"] }}</p>\n\n    <div class="group">\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.data.sources"] }}</label>\n            <input class="includeDataSources" name="includeDataSources" type="checkbox"\n                   data-bind="checked:includeDataSources, disabled:everything">\n        </div>\n        {{ if(!isServerCe) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.domains"] }}</label>\n            <input class="includeDomains" name="includeDomains" type="checkbox"\n                   data-bind="checked:includeDomains, disabled:everything">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.ad.hoc.views"] }}</label>\n            <input class="includeAdHocViews" name="includeAdHocViews" type="checkbox"\n                   data-bind="checked:includeAdHocViews, disabled:everything">\n        </div>\n        {{ } }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.reports"] }}</label>\n            <input class="includeReports" name="includeReports" type="checkbox"\n                   data-bind="checked:includeReports, disabled:everything">\n        </div>\n        {{ if(!isServerCe) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.dashboards"] }}</label>\n            <input class="includeDashboards" name="includeDashboards" type="checkbox"\n                   data-bind="checked:includeDashboards, disabled:everything">\n        </div>\n        {{ } }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.scheduled.report.jobs"] }}</label>\n            <input class="includeScheduledReportJobs" name="includeScheduledReportJobs" type="checkbox"\n                   data-bind="checked:includeScheduledReportJobs, enabled:enableReportJobs">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.resources.other.resources"] }}</label>\n            <input class="includeOtherResourceFiles" name="includeOtherResourceFiles" type="checkbox"\n                   data-bind="checked:includeOtherResourceFiles, disabled:everything">\n        </div>\n    </div>\n</div>\n\n<div class="section assets tenant-options">\n    <p class="title">{{- i18n["export.dialog.assets"] }}</p>\n\n    <div class="group">\n        {{ if(!isServerCe) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.sub.organizations"] }}</label>\n            <input class="includeSubOrganizations" name="includeSubOrganizations" type="checkbox"\n                   data-bind="checked:includeSubOrganizations, disabled:everything">\n        </div>\n        {{ } }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.dependent.objects"] }}</label>\n            <input class="includeDependentObjects" name="includeDependentObjects" type="checkbox"\n                   data-bind="checked:includeDependentObjects, enabled:someResourceIsChecked">\n        </div>\n\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.repository.permissions"] }}</label>\n            <input class="includeRepositoryPermissions" name="includeRepositoryPermissions" type="checkbox"\n                   data-bind="checked:includeRepositoryPermissions, enabled:someResourceIsChecked">\n        </div>\n        {{ if (isServerOrRootType) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.server.settings"] }}</label>\n            <input class="includeServerSettings" name="includeServerSettings" type="checkbox"\n                   data-bind="checked:includeServerSettings, disabled:everything">\n        </div>\n        {{ } }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.attributes"] }}</label>\n            <input class="includeAttributes" name="includeAttributes" type="checkbox"\n                   data-bind="checked:includeAttributes, disabled:everything">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.assets.attribute.values"] }}</label>\n            <input class="includeAttributeValues" name="includeAttributeValues" type="checkbox"\n                   data-bind="checked:includeAttributeValues, enabled:enableAttributesValues">\n        </div>\n    </div>\n</div>\n',J='<div class="section events">\n\n    <js-templateNonce></js-templateNonce>\n    <p class="title">{{- i18n["export.dialog.events"] }}</p>\n    <div class="group">\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.events.access.events"] }}</label>\n            <input class="includeAccessEvents" name="includeAccessEvents" type="checkbox" data-bind="checked:includeAccessEvents, enabled:everything">\n        </div>\n        {{ if(!isServerCe) { }}\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.events.audit.events"] }}</label>\n            <input class="includeAuditEvents" name="includeAuditEvents" type="checkbox" data-bind="checked:includeAuditEvents">\n        </div>\n        <div class="control checkBox">\n            <label class="wrap" title="">{{- i18n["export.dialog.events.monitoring.events"] }}</label>\n            <input class="includeMonitoringEvents" name="includeMonitoringEvents" type="checkbox" data-bind="checked:includeMonitoringEvents">\n        </div>\n        {{ } }}\n    </div>\n</div>',H='<div class="section roles-users">\n\n    <js-templateNonce></js-templateNonce>\n    <p class="title">{{- i18n["export.dialog.roles.users"] }}</p>\n    <div class="group rolesAndUsers">\n        <div class="control radio">\n            <label class="wrap" title="" for="selectedUsersRoles">{{- i18n["export.dialog.roles.users.selected.roles.users"] }}</label>\n            <input id="selectedUsersRoles" class="selectedUsersRoles" name="sample" type="radio" data-bind="disabled:everything" checked="checked">\n        </div>\n        <div class="control radio">\n            <label class="wrap" title="" for="usersWithSelectedRoles">{{- i18n["export.dialog.roles.users.users.with.selected.roles"] }}</label>\n            <input id="usersWithSelectedRoles" class="usersWithSelectedRoles" name="sample" type="radio" data-bind="disabled:everything">\n        </div>\n        <div class="control radio">\n            <label class="wrap" title="" for="rolesWithSelectedUsers">{{- i18n["export.dialog.roles.users.roles.with.selected.users"] }}</label>\n            <input id="rolesWithSelectedUsers" class="rolesWithSelectedUsers" name="sample" type="radio" data-bind="disabled:everything">\n        </div>\n    </div>\n    <div class="group">\n        <div class="selectRolesUsers column two control pickWells"></div>\n    </div>\n</div>';var W=s(61309),$={};$[m.Z.ROOT_TENANT]=[H,z,J].join(""),$[m.Z.TENANT]=[H,z].join(""),$[m.Z.SERVER_PRO]=[H,z,J].join(""),$[m.Z.SERVER_CE]=[H,z,J].join(""),$[m.Z.REPOSITORY]=['<div class="section resources">\n\n    <js-templateNonce></js-templateNonce>\n    <p>{{- i18n["export.dialog.options"] }}</p>\n    <div class="group">\n        <div class="control checkBox">\n            <label for="includeScheduledReportJobsId" class="wrap" title="">{{- i18n["export.report.jobs"] }}</label>\n            <input id="includeScheduledReportJobsId" class="includeScheduledReportJobs" name="includeScheduledReportJobs" aria-labelledby="includeScheduledReportJobsLabel" type="checkbox" data-bind="checked:includeScheduledReportJobs">\n        </div>\n        <div class="control checkBox">\n            <label for="includeRepositoryPermissionsId" class="wrap" title="">{{- i18n["export.include.permissions"] }}</label>\n            <input id="includeRepositoryPermissionsId" class="includeRepositoryPermissions" name="includeRepositoryPermissions" aria-labelledby="includeRepositoryPermissionsLabel" type="checkbox" data-bind="checked:includeRepositoryPermissions">\n        </div>\n        <div class="control checkBox">\n            <label for="includeDependenciesCheckbox" class="wrap" title="">{{- i18n["export.include.dependencies"] }} </label>\n            <input id="includeDependenciesCheckbox" class="includeDependencies" name="includeDependencies" type="checkbox" data-bind="checked:includeDependencies">\n        </div>\n        {{ if (isSubOrgLevel) { }}\n        <div class="control checkBox">\n            <label for="includeFullResourcePathId" class="wrap" title="">{{- i18n["export.include.full.repo.path"] }}</label>\n            <input id="includeFullResourcePathId" class="includeFullResourcePath" name="includeFullResourcePath" aria-labelledby="includeFullResourcePathLabel" type="checkbox" data-bind="checked:includeFullResourcePath">\n        </div>\n        {{ } }}\n    </div>\n</div>'].join("");var Y=s(53861),q=s(95312),G=a().View.extend({className:"export-view",events:{"change .usersWithSelectedRoles":"includeRolesByUsers","change .rolesWithSelectedUsers":"includeUsersWithRoles","change .selectedUsersRoles":"includeSelectedRolesUsersOnly","change input.jr-jDefaultKey, input.jr-jKeyValue, input.jr-jKeyFile , input.jr-juniversalKeyValue,  input.jr-jCustomKey":"_onKeyTypeChange","click .section .checkBox label":"_clickOnCheckbox","click button.jr-jRepositoryBrowserButton":"_onRepositoryBrowserButtonClick","change .control.select.inline":"_onCustomKeyInput"},computeds:{includeAccessEventsChecked:function(){return!!this.model.get("everything")&&this.model.get("includeAccessEvents")},enableAttributesValues:{deps:["everything","includeAttributes"],get:function(e,t){return!e&&t}},enableReportJobs:{deps:["everything","includeReports"],get:function(e,t){return!e&&t}},someResourceIsChecked:{deps:["everything","includeReports","includeAdHocViews","includeDashboards","includeDomains","includeDataSources","includeOtherResourceFiles"],get:function(e,t,s,i,n,l,o){return!e&&(t||s||i||n||l||o)}},isKeyDefaultValue:{deps:["keyType"],get:function(e){return e===T.Z.DEFAULTKEY}},isKeyUniversalValue:{deps:["keyType"],get:function(e){return e===T.Z.UNIVERSALKEY}},isKeyUseCustom:{deps:["keyType"],get:function(e){return e===T.Z.CUSTOMKEY}}},initialize:function(){o().bindAll(this,"render","doExport","handleExportPhase","filterAuthoritiesBySubOrgs","bindWithRoles","bindWithUsers","changeEnabledState","includeRolesByUsers","includeUsersWithRoles","includeSelectedRolesUsersOnly","sendParameters","onRolesToUsersChange","onUsersToRolesChange","_isServerLevel","_includeUsersOrRoles","_showNotification","_getBrokenDependencies","_clickOnCheckbox","_onModelChange","_resetModel"),this.model||(this.model=new D),this.stateModel=new U.Z,this.customKeyStateModel=new q.Z,this.epoxifyView(),this.loadingDialog=new I.Z({content:F.Z["dialog.overlay.loading"]}),this.notification=new P.Z,this.dependentResourcesDialogView=new M,this.listenTo(this.model,"change",this._onModelChange),this.listenTo(this.stateModel,"change:phase",this.handleExportPhase,this),this.listenTo(this.model,"error:unauthorized",window.location.reload),this.listenTo(this.stateModel,"error:unauthorized",window.location.reload);var e={delay:!1,message:B.Z["export.error.cancelled"]},t={delay:!1,message:B.Z["export.error.unexpected"]};this.listenTo(this.model,"error:notFound",o().bind(this.notification.show,this.notification,e)),this.listenTo(this.stateModel,"error:notFound",o().bind(this.notification.show,this.notification,e)),this.listenTo(this.model,"error:internalServerError",o().bind(this.notification.show,this.notification,t)),this.listenTo(this.stateModel,"error:internalServerError",o().bind(this.notification.show,this.notification,t)),this.listenTo(this.model,"error",o().bind(this.loadingDialog.close,this.loadingDialog)),this.listenTo(this.stateModel,"error",o().bind(this.loadingDialog.close,this.loadingDialog)),this.listenTo(this.dependentResourcesDialogView,"button:export",o().compose(o().bind(this.dependentResourcesDialogView.close,this.dependentResourcesDialogView),o().bind((function(){te.call(this),this._showNotification({message:B.Z["export.finished"],type:"success"})}),this))),this.listenTo(this.dependentResourcesDialogView,"button:cancel",o().bind(se,this,U.Z.STATE.CANCELLED))},_onRepositoryBrowserButtonClick:function(){this.keyFileDialog.open()},_clearSecureKeyErrors:function(){this.model.set({invalidKeyError:"",invalidSecureFileContentError:""})},_onKeyTypeChange:function(e){var t=e.target.value;this.model.set("keyType",t),this._clearSecureKeyErrors()},_onCustomKeyInput:function(e){var t=e.target.selectedIndex,s=n()(".control.select.inline").find("option")[t];this.model.set("keyAlias",s.value,{silent:!0})},render:function(e){e=e||{},this.type=e.type;var t=this._isServerLevel(this.type),s=t||this.type===m.Z.ROOT_TENANT;s?this.$el.addClass("with-events"):this.$el.removeClass("with-events"),this.stopListening(this.model,"change:includeSubOrganizations",this.filterAuthoritiesBySubOrgs),this._resetModel(e);var i=B.Z["export.dialog.file.properties.encryption.hint"];(Y.Z.productTypeIsJrsAmi||Y.Z.productTypeIsMpAmi)&&(i=B.Z["export.dialog.file.properties.encryption.hint.aws"]);var l=this;return this.customKeyStateModel.getCustomKeys().done((function(o){if(o&&o.responseJSON&&o.responseJSON.error)Q(l,e,i,s,t,o);else{o.length&&l.model.set("keyAlias",o[0].alias),ee(l,e,i,s,t,o);for(var r=0;r<o.length;++r){var a=n()("<option />").attr("value",o[r].alias);a.text(o[r].label?o[r].label:o[r].alias),l.$el.find("#importCustomKey").append(a)}}})).fail((function(n){Q(l,e,i,s,t,n)})),this.$el.attr({role:"form"}),this},doExport:function(){var e=this;this.model.isValid(!0)&&(this.loadingDialog.open(),this.model.save().done((function(t){e.stateModel.unset("warnings",{silent:!0}),e.stateModel.set(t),e.model.set("id",t.id)})))},handleExportPhase:function(){var e,t=this.stateModel.get("phase"),s=this._getBrokenDependencies();t==U.Z.STATE.READY&&(this.loadingDialog.close(),o().isEmpty(s)?(te.call(this),e={message:B.Z["export.finished"],type:"success"}):this.dependentResourcesDialogView.open({items:s})),t==U.Z.STATE.FAILED&&(e={message:B.Z["export.error.unexpected"]}),t==U.Z.STATE.CANCELLED&&(e={message:B.Z["export.error.cancelled"]}),e&&this._showNotification(e)},filterAuthoritiesBySubOrgs:function(){var e={excludeSubOrgs:!this.model.get("includeSubOrganizations")};this.rolesList.model.setContext(e),this.usersList.model.setContext(e)},bindWithRoles:function(e){this.model.set({roles:e}),this.onUsersToRolesChange(),e.length?this.rolesToUsers.setContext({roles:e}):this.rolesToUsers.set({items:[]})},bindWithUsers:function(e){this.model.set({users:e}),this.onRolesToUsersChange(),e.length?this.usersToRoles.setContext({users:e}):this.usersToRoles.set({items:[]})},changeEnabledState:function(){var e=this.model.get("everything");this.rolesList.setDisabled(e||this.model.get("rolesForUser")),this.usersList.setDisabled(e||this.model.get("userForRoles")),e&&(this.rolesList.selectNone(),this.usersList.selectNone())},includeRolesByUsers:function(e){var t=n()(e.target).is(":checked");this.model.set({rolesForUser:!t,userForRoles:t}),this.onRolesToUsersChange(),this._includeUsersOrRoles(!t,t)},includeUsersWithRoles:function(e){var t=n()(e.target).is(":checked");this.model.set({rolesForUser:t,userForRoles:!t}),this.onUsersToRolesChange(),this._includeUsersOrRoles(t,!t)},includeSelectedRolesUsersOnly:function(e){n()(e.target).is(":checked")&&(this.model.set({userForRoles:!1,rolesForUser:!1}),this.onRolesToUsersChange(),this.onUsersToRolesChange(),this._includeUsersOrRoles(!1,!1))},sendParameters:function(e){this.model.isValid(!0)&&this.model.save()},onRolesToUsersChange:function(){this.model.get("userForRoles")?(this.usersList.highlightSet(o().map(this.rolesToUsers.get("items"),(function(e){return e.username+(e.tenantId?"|"+e.tenantId:"")}))),this.rolesList.highlightSet([])):this.usersList.highlightSet([])},onUsersToRolesChange:function(){this.model.get("rolesForUser")?(this.rolesList.highlightSet(o().map(this.usersToRoles.get("items"),(function(e){return e.name+(e.tenantId?"|"+e.tenantId:"")}))),this.usersList.highlightSet([])):this.rolesList.highlightSet([])},_isServerLevel:function(e){return e===m.Z.SERVER_CE||e===m.Z.SERVER_PRO},_includeUsersOrRoles:function(e,t){this.rolesList.setDisabled(e),this.usersList.setDisabled(t),this.rolesList.selectNone(),this.usersList.selectNone()},_showNotification:function(e){e=o().defaults(e,{type:"warning"}),this.loadingDialog.isVisible()&&this.loadingDialog.close(),this.notification.show({delay:!1,message:e.message,type:e.type})},_getBrokenDependencies:function(){var e=this.stateModel.get("warnings"),t=[];return o().each(e,(function(e){"export.broken.dependency"===e.code&&t.push(e.parameters)})),o().flatten(o().sortBy(t,(function(e){return e})))},_clickOnCheckbox:function(e){var t=n()(e.target).next();t[0].disabled||this.model.set(t[0].name,!t[0].checked)},_onModelChange:function(){this.model.isValid(!0)},_resetModel:function(e){var t={organization:this.type==m.Z.REPOSITORY?null:e.tenantId};if(this.type===m.Z.ROOT_TENANT||this.type===m.Z.TENANT){var s=this.type===m.Z.ROOT_TENANT?"root_export.zip":e.tenantId+"_export.zip";o().extend(t,{fileName:s})}this.model.reset(t,this.type)}});function Q(e,t,s,i,n,l){ee(e,t,s,i,n,[]),e.notification.show({delay:!1,message:l&&l.responseJSON&&l.responseJSON.message}),e.trigger("error",e,l)}function X(e){this.rolesList=new j({model:N.instance("rest_v2/{{if (tenantId) { }}organizations/{{-tenantId}}/{{ } }}roles?q={{-searchString}}{{ if (excludeSubOrgs) { }}&includeSubOrgs=false{{ } }}",{tenantId:e.tenantId}),customClass:"selectedRoles",title:B.Z["export.dialog.roles.users.roles.label"],selectLabel:B.Z["export.dialog.roles.users.select.all.roles.label"]}),this.rolesList.on("change:selection",this.bindWithRoles),this.rolesList.render(),this.usersList=new j({model:N.instance("rest_v2/{{if (tenantId) { }}organizations/{{-tenantId}}/{{ } }}users?q={{-searchString}}{{ if (excludeSubOrgs) { }}&includeSubOrgs=false{{ } }}",{tenantId:e.tenantId}),customClass:"select selectedUsers",title:B.Z["export.dialog.roles.users.users.label"],selectLabel:B.Z["export.dialog.roles.users.select.all.users.label"]}),this.usersList.on("change:selection",this.bindWithUsers),this.usersList.render(),this.rolesToUsers=N.instance("rest_v2/users?hasAllRequiredRoles=false{{ if (roles) for (var i = 0; i < roles.length; i++) { }}&requiredRole={{-roles[i]}}{{ } }}"),this.rolesToUsers.on("change",this.onRolesToUsersChange),this.usersToRoles=N.instance("rest_v2/roles?hasAllUsers=false{{ if (users) for (var i = 0; i < users.length; i++) { }}&user={{-users[i]}}{{ } }}"),this.usersToRoles.on("change",this.onUsersToRolesChange),this.changeEnabledState(),this.listenTo(this.model,"change:everything",this.changeEnabledState),this.$el.find(".selectRolesUsers").append(this.rolesList.el).append(this.usersList.el),this.listenTo(this.model,"change:includeSubOrganizations",this.filterAuthoritiesBySubOrgs)}function ee(e,t,s,i,l,r){e.template=o().template(function(e){return e=e||{},'<div class="section file-name">\n\n    <js-templateNonce></js-templateNonce>\n    {{ if (!isRepository) { }} <p class="title">{{- i18n["export.dialog.file.properties"] }}</p> {{ } }}\n    <div class="group">\n        <div class="control input" data-bind="validationErrorClass:fileName" data-model-attr="fileName">\n            <span class="wrap">{{- i18n["export.dialog.file.properties.data.file.name"]}}</span>\n            <input type="text" class="fileName"  data-bind="value:fileName, events:[\'keyup\']" aria-label="{{- i18n[\'export.dialog.file.properties.data.file.name\']}}"/>\n            <p class="message hint jr-jEncryptionHint">{{- encryptionHint }}</p>\n            <span class="message warning fileNameMessage" data-bind="validationErrorText:fileName" data-model-attr="fileName"></span>\n        </div>\n\n        {{ if (0) { }}\n        <div class="control checkBox encryptFileWrapper">\n            <label class="wrap" title="">{{- i18n["export.dialog.file.properties.encrypt.file"] }}</label>\n            <input class="encryptFile" name="encryptFile" type="checkbox" data-bind="checked:encryptFile">\n        </div>\n        {{ } }}\n    </div>\n</div>\n'+W.Z+n()('<div class="export-options">\n\n    <js-templateNonce></js-templateNonce>\n    {{ if (!isRepository) { }}\n    <p class="title export-options-title">{{- i18n["export.dialog.options"] }}</p>\n    <div class="section everything">\n        <div class="control checkBox everything">\n            <label class="wrap" title="">{{- i18n["export.dialog.everything"] }}</label>\n            <input class="everything" name="everything" type="checkbox" data-bind="checked:everything">\n        </div>\n    </div>\n    {{ } }}\n</div>').append($[e.type])[0].outerHTML}(t))({everything:!1,i18n:B.Z,i18n2:F.Z,encryptionHint:s,isServerOrRootType:i,isServerLevel:l,isServerCe:e.type===m.Z.SERVER_CE,isRepository:e.type===m.Z.REPOSITORY,isSubOrgLevel:t.isSubOrgLevel,model:o().extend(e.model.toJSON(),{secureKeyTypes:T.Z}),showCustomKey:0!==r.length,showKeyValue:!1,exportMode:!0}),e.$el.html(e.template),e.$(".selectRolesUsers").length&&X.call(e,t),e.applyEpoxyBindings(),e.$("input").length&&e.$("input")[0].focus()}function te(){var e=document.createElement("iframe");e.src=this.model.url()+"/"+this.stateModel.id+"/"+this.model.get("fileName"),e.style.display="none",n()("body").append(e)}function se(e){this.model.cancel(),this.stateModel.set("phase",e)}o().extend(G.prototype,K.Z);const ie=G},34052:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var i=s(97836),n=s.n(i),l=s(95992),o="index",r="keyValue",a=l.Z.extend({constructor:function(e){this.code=e,this.args=Array.prototype.slice.call(arguments,1)},bundle:{}});a.prototype.toString=function(){var e=this.bundle[this.code];if(!e)return this.code;var t=this._getArgsType(this.args);return t===o?e=this._interpolateIndexArgs(this.args,e):t===r&&(e=this._interpolateObjectArgs(this.args,e)),e},a.prototype._getArgsType=function(e){if(e&&e.length){var t=n().first(e);return n().isObject(t)?r:o}},a.prototype._interpolateObjectArgs=function(e,t){var s=e[0].separator||", ",i=e.reduce((function(e,t){var i=t.key,n=t.value;return e[i]?e[i]=e[i]+s:e[i]="",e[i]=e[i]+n,e}),{});return t=n().keys(i).reduce((function(e,t){var s=i[t],n="\\{"+t+"\\}";return e.replace(new RegExp(n,"g"),s)}),t)},a.prototype._interpolateIndexArgs=function(e,t){for(var s=0,i=e.length;s<i;s++){var n=e[s],l="\\{"+s+"\\}";t=t.replace(new RegExp(l,"g"),n)}return t},a.create=function(e){return function(t){var s=Object.create(a.prototype);return(s=n().extend(s,{bundle:e,code:t,args:Array.prototype.slice.call(arguments,1)})).toString(s)}};const c=a}}]);
//# sourceMappingURL=chunk.3739.js.map