{"version":3,"sources":["webpack://jrs-ui/./src/components/components.searchBox.js","webpack://jrs-ui/./src/controls/controls.report.js","webpack://jrs-ui/./src/manage/mng.common.js","webpack://jrs-ui/./src/manage/mng.org.module.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/LoadingDialog.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/template/loadingDialogTemplate.htm","webpack://jrs-ui/../js-sdk/src/common/component/dialog/template/alertDialogTemplate.htm","webpack://jrs-ui/../js-sdk/src/common/component/dialog/AlertDialog.js","webpack://jrs-ui/./src/repository/repository.search.main.js","webpack://jrs-ui/./src/repository/repository.search.actions.js","webpack://jrs-ui/./src/tenantImportExport/export/view/ExportDialogView.js","webpack://jrs-ui/./src/repository/repository.search.components.js","webpack://jrs-ui/./src/repository/repository.search.root.js","webpack://jrs-ui/./src/components/components.dependent.dialog.js","webpack://jrs-ui/./src/repository/repository.common.js","webpack://jrs-ui/./src/settings/settingsStore.js","webpack://jrs-ui/./src/util/tools.infiniteScroll.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/Dialog.js","webpack://jrs-ui/../js-sdk/src/common/extension/backboneValidationExtension.js","webpack://jrs-ui/../js-sdk/src/common/extension/customEventExtension.js"],"names":["SearchBox","options","this","_id","id","_dom","jQuery","_enabled","_process","_assignHandlers","addMethod","_input","find","_clearButton","_searchButton","on","e","Event","stop","_keyPressHandler","bindAsEventListener","_clearHandler","_searchHandler","KEY_RETURN","keyCode","_doSearch","getText","blank","removeClass","layoutModule","addClass","setText","getValue","text","setValue","_updateClearButtonVisibility","buttonManager","attr","onSearch","isMandatoryInputControls","atLeastOneParameterDoesntHaveDefaultOrUrlValue","_","Report","parameterName","Controls","extend","_messages","layouts","LAYOUT_POPUP_SCREEN","LAYOUT_SEPARATE_PAGE","LAYOUT_TOP_OF_PAGE","LAYOUT_IN_PAGE","controlDialog","reportOptionsDialog","inputControlsLocation","toggleControlsOn","controller","hideControls","selectionChanged","initialInputControlsFetched","initialize","JRS","reportUri","reportUnitURI","reportOptionUri","reportOptionsURI","viewModel","getViewModel","initializeOptions","confirmInputValues","debounce","applyInputValues","Utils","LOADING_DIALOG_DELAY","cancelInputValues","cancel","resetInputValues","resetToInitial","buttonActions","save","remove","dialogButtonActions","ControlsBase","ControlDialog","elem","target","pattern","matchAny","stopPropagation","hasClass","event","data","hasInputControls","dfd","_fetchAndSetInputControlsStateOnce","then","isValidSelection","areAllControlsValid","refreshReport","Deferred","resolve","show","xhr","refreshReportDfd","showLoadingDialogOn","always","nothingToDisplay","centerElement","horz","vert","DATA_REFRESH_BUTTON","isProVersion","optionsContainerSelector","reportControlsLayout","reportOptions","ReportOptionsStub","fetch","done","append","getElem","lastReportOptionsSelection","get","fail","updateWarningMessage","showWarning","error","option","uri","set","selection","bind","reorderedStructure","newIcOrder","pluck","join","optionsButtonActions","optionName","input","selectedData","overwrite","optionNameToOverwrite","add","parent","hideWarning","dialogs","length","container","hide","err","JSON","parse","responseText","errorCode","OptionsDialog","label","dialog","ConfirmationDialog","removeOption","html","enableRemoveButton","open","separatePageICLayoutFirstShow","goBack","refreshControlsToSelectionDfd","_refreshControlsToSelection","lastSelection","showErrorPopup","responseJSON","message","showReport","resetControlsToSelection","getLastSelection","validate","showOptionDialog","checkOnChangedSelection","freshData","deferred","promise","_refreshReportOnConfirm","isEmpty","ex","reject","_refreshReportOnApply","_continue","window","viewer","isExportRunning","confirm","getMessage","confirmedExportCancel","lastSuccessfulReportOption","lastSuccessfulSelection","jive","refreshReportPromise","overlay","Overlay","zIndex","$el","hasError","initialSelection","showControls","toggleControls","showDialog","triggerNativeEvent","isIPad","touchController","reset","height","document","getElementById","selectAndFocusOn","fetchRawValuesDfd","reportExecutionId","fetchReportRawParameterValues","values","reportParameterValues","allRequestParameters","getAllRequestParameters","fetchAndSetInputControlsState","RegExpRepresenter","expression","charMap","expressionTokens","__parse","Object","assign","orgModule","TREE_ID","COOKIE_NAME","messages","ActionMap","SEARCH","BROWSE","NEXT","SELECT_AND_GET_DETAILS","SEARCH_AVAILABLE","SEARCH_ASSIGNED","NEXT_AVAILABLE","NEXT_ASSIGNED","CREATE","UPDATE","DELETE","DELETE_ALL","EXIST","ORG_BROWSE","ENTITY_SEARCH","ENTITY_NEXT","ENTITY_SELECT_AND_GET_DETAILS","RESULT_CHANGED","RESULT_NEXT","ENTITY_DETAILS_LOADED","SEARCH_AVAILABLE_LOADED","SEARCH_ASSIGNED_LOADED","NEXT_AVAILABLE_LOADED","NEXT_ASSIGNED_LOADED","SERVER_ERROR","SERVER_UNAVAILABLE","ENTITY_CREATED","ENTITY_UPDATED","ENTITY_DELETED","ENTITIES_DELETED","observe","eventName","handler","_getContainer","stopObserving","fire","memo","messageId","Template","evaluate","_comparator","l1","l2","_container","body","Configuration","nameSeparator","userDefaultRole","userNameNotSupportedSymbols","roleNameNotSupportedSymbols","emailRegExpPattern","superuserRole","adminRole","anonymousRole","jsonOrNode","Error","param","name","treeNode","tenantId","tenantName","alias","tenantAlias","desc","tenantDesc","tenantUri","parentId","subTenantCount","level","org","primaryNavModule","deepClone","toQueryString","isInherited","permission","inheritedPermission","isDisabled","newPermission","userName","fullName","password","confirmPassword","email","enabled","external","roles","each","role","push","permissionToDisplay","_flowId","FLOW_ID","encodeURIComponent","user","toData","roleName","selectedItem","selectedTenant","properties","localStorage","setItem","stringify","organization","entityEvent","changeDisable","_EDIT_BUTTON_ID","entityId","unlock","force","refreshAttributes","ID_PATTERN","_listId","_containerId","_searchBoxId","list","dynamicList","listTemplateDomId","listTemplateId","itemTemplateDomId","itemTemplateId","multiSelect","selectionDefaultsToCursor","comparator","item1","item2","getLabel","_initEvents","_infiniteScroll","InfiniteScroll","contentId","_searchBox","onLoad","toolbarModel","toolbar","item","lastSelectedName","getNameWithTenant","tenantsTree","locked","getTenant","isCtrlHeld","refresh","stopSelectOrUnselect","entity","showConfirm","_createEntityItem","value","getDisplayName","entityList","processTemplate","element","select","update","xssUtil","getSearchText","setSearchText","getSelectedEntities","getSelectedItems","collect","setEntities","entities","items","setItems","findEntity","getItems","addEntities","addItems","selectEntity","entityName","matched","detect","isSelected","deselect","restoreSelectedEntity","deselectAll","resetSelected","newEntity","findAll","entityNameOrNameSet","all","isArray","include","removeItems","_EDIT_MODE_CLASS","_moveButtonsId","_value","isEditMode","_NOTHING_TO_DISPLAY_ID","_ASSIGNED_VIEW_ID","_ASSIGNED_VIEW_LIST_ID","_ASSIGNED_ID","_AVAILABLE_ID","_ASSIGNED_LIST_ID","_AVAILABLE_LIST_ID","_ATTRIBUTES_LIST_ID","_SAVE_BUTTON_ID","_CANCEL_BUTTON_ID","_DELETE_BUTTON_ID","_REMOVE_FROM_ASSIGNED_BUTTON_ID","_ADD_TO_ASSIGNED_BUTTON_ID","_BUTTONS_CONTAINER_ID","_MOVE_BUTTONS_CONTAINER_ID","_DND_CLASS","_DROP_CLASS","buttonsFunctions","attributesTypesEnum","_toggleButton","attributes","attributesType","TENANT","USER","optionsFactory","attributesViewOptionsFactory","scrollEventTrait","AttributesViewFacade","attributesFacade","context","type","showAssigned","initDnD","initEvents","initButtonsFunctions","_initConfirmationDialog","self","i18n","confirmationDialog","title","cancelOnEdit","propertiesIsChanged","isChanged","containsUnsavedItems","saveButton","removeAttribute","removeClassName","setAttribute","isRoot","getCurrentView","setContext","render","$","addClassName","changeMode","lock","setDetailsLoadedEntity","detailsLoadedEntity","getDetailsLoadedEntity","editButton","cancelButton","deleteButton","removeFromAssigned","addToAssigned","assignedViewList","viewAssignedListTemplateDomId","viewAssignedItemTemplateDomId","assignedComparator","allowSelections","commonOptions","dragPattern","selectOnMousedown","setCursorOnMouseDown","assignedList","availableList","searchAssigned","assignedViewSearchBox","identify","availableSearchBox","assignedSearchBox","assignedViewInfiniteScroll","parentNode","availableInfiniteScroll","assignedInfiniteScroll","Droppables","up","accept","hoverclass","onDrop","dragged","dropped","_addToAssigned","_removeFromAssigned","assignedSelectionHandler","availableSelectionHandler","button","call","preventDefault","extObj","asyncValidate","saveChildren","trigger","_deleteEntity","_addFromAssigned","edit","tabs","attributeTab","propertiesTab","$anchor","hideFilters","detachScrollEvent","$container","toggleMode","initScrollEvent","$$","down","_assigned","_unassigned","style","_editEntity","canEdit","canDelete","_showEntity","orgProperties","currentUser","setValuesProperty","setProperties","_moveEntities","bToAssigned","from","to","fromList","toList","concat","available","compact","fromItem","equals","_entitiesToItems","isAvailable","tooltipText","template","undefined","JSTooltip","templateId","nameAnchor","insert","writeAttribute","getManagerURL","getAssignedEntities","getUnassignedEntities","setAssignedEntities","filteredEntities","_filterEntities","addAssignedEntities","setAvailableEntities","addAvailableEntities","removeSet","addSet","allEntities","removeEntity","toLowerCase","changeReadonly","elementsPatterns","elementPattern","resetValidation","panel","ValidationModule","invokeFn","beforeInvoke","isFunction","invokeAction","apply","arguments","doNothing","eventId","actionURL","localContext","flowExecutionKey","onSuccess","onError","ajaxTargettedUpdate","postData","callback","response","errorHandler","ajaxAgent","getResponseHeader","baseErrorHandler","mode","AjaxRequester","_actionModel","actionModel","toolbarButtonModule","_toActionMap","buttonId","testFn","toFunction","test","bulkActionModel","actionMap","bulkAction","action","actionArgs","myAction","getAsFunction","args","belongsToLocalContext","validator","isValid","regExp","errorMessage","symbols","unsupportedSymbols","messageKey","onValid","onInvalid","replaceKey","max","hasAttribute","readAttribute","maxlength","parseInt","replace","asElement","matches","exec","truncate","result","$A","i","ch","charAt","substring","token","startsWith","eval","chars","getCharacters","len","Dialog","events","el","additionalCssClasses","constructor","modal","showProgress","progress","cancellable","close","contentTemplate","titleContainerId","bodyContainerId","buttons","primary","setMessage","whiteList","content","rendered","renderContent","$contentContainer","invokeFolderAction","actionName","folder","theFolder","repositorySearch","model","getContextFolder","folderActionFactory","invokeResourceAction","resource","theResource","getSelectedResources","resourceActionFactory","invokeBulkAction","resourceName","resources","bulkActionFactory","invokeRedirectAction","RedirectAction","isFolderCopyOrMove","CopyMoveController","isCopyFolder","isMoveFolder","isResourceCopyOrMove","isCopyResource","isMoveResource","canFolderBeEdited","isEditable","canFolderBeCopied","isOrganization","isOrganizationsRoot","isReadable","canFolderBeCopiedOrMovedToFolder","toFolder","object","URI","canFolderBeMoved","isPublic","isTemp","isRemovable","isActiveThemeFolder","isThemeRootFolder","canFolderPropertiesBeEdited","canResourceBeCopied","canResourceBeMoved","canResourceBeDeleted","canResourcePropertiesBeShowed","canResourcePropertiesBeEdited","canAllBeRun","detected","canBeRun","canAllBeEdited","canResourceBeEdited","canAllBeOpened","canBeOpenedInDesigner","canBeOpened","canAllBeCopied","canAllBeMoved","canAllBeCopiedOrMovedToFolder","isBulkAction","allow","isThemeFolder","resourceType","endsWith","canAllBePasted","getSelectedFolder","canAllBeDeleted","isPermissionsChanged","dialogsPool","getAllPermissionsDialogs","isPropertiesChanged","getAllPropertiesDialogs","isFlowRedirectRunning","Mode","LIBRARY","ResourceType","REPORT_UNIT","ADHOC_REPORT_UNIT","OLAP_UNIT","DASHBOARD_RESOURCE","DASHBOARD","REPORT_OPTIONS","REPORT_DATA_SOURCE","JDBC_REPORT_DATA_SOURCE","JNDI_JDBC_REPORT_DATA_SOURCE","VIRTUAL_REPORT_DATA_SOURCE","CUSTOM_REPORT_DATA_SOURCE","BEAN_REPORT_DATA_SOURCE","OLAP_DATA_SOURCE","OLAP_CLIENT_CONNECTION","QUERY","INPUT_CONTROL","LIST_OF_VALUES","LIST_OF_VALUES_ITEM","DATA_TYPE","MONDRIAN_CONNECTION","SECURE_MONDRIAN_CONNECTION","XMLA_CONNECTION","MONDRIAN_XMLA_DEFINITION","CONTENT_RESOURCE","FILE_RESOURCE","SEMANTIC_LAYER_DATA_SOURCE","DATA_DEFINER_UNIT","SearchAction","GET_RESOURCE_CHILDREN","SEARCH_RUN","SEARCH_BROWSE","SEARCH_FILTER","SEARCH_SORT","SEARCH_NEXT","SEARCH_ROLLBACK","SEARCH_SEARCH","SEARCH_CHILDREN","STATE_CHANGED","FILTER_PATH_CHANGED","CHILDREN_LOADED","RESULT_ERROR","REDIRECT_ERROR","FLOW_REDIRECT_RUNNING","InfoAction","GET_DISPLAY_PATH","PermissionAction","PermissionEvent","LOADED","UPDATED","ERROR","FolderAction","COPY","MOVE","FolderEvent","DELETED","DELETE_ERROR","CREATED","CREATE_ERROR","COPIED","COPY_ERROR","MOVED","MOVE_ERROR","UPDATE_ERROR","ResourceAction","GENERATE","CONVERT","ResourceEvent","GENERATED","GENERATE_ERROR","CONVERTED","CONVERT_ERROR","RedirectType","FLOW_REDIRECT","LOCATION_REDIRECT","WINDOW_REDIRECT","ThemeAction","SETTHEME","DOWNLOAD_THEME","REUPLOAD","ThemeEvent","REUPLOADED","THEME_ERROR","ResourcesFavoriteAction","FILTER_ID","ALL_RESOURCES","FAVORITE_RESOURCES","rsInitOptions","jsonToEntities","clazz","webHelpModule","enableDnD","setPublicFolderUri","publicFolderUri","setTempFolderUri","tempFolderUri","setRootFolderUri","rootFolderUri","setOrganizationsFolderUri","organizationsFolderUri","setFolderSeparator","folderSeparator","setAdministrator","isAdministrator","setConfiguration","configuration","setServerState","state","CursorManager","navigateToResourcePage","bulkActions","foldersPanel","filtersPanel","getFiltersConfiguration","getFiltersState","secondarySearchBox","getTextState","filterPath","resultsPanel","favoriteSwitchControl","sortersPanel","getSortersConfiguration","getSortState","initFolderEvents","initResourceEvents","initThemeEvents","ServerAction","createSearchAction","filterId","filterOption","optionId","sortBy","sorterId","folderUri","refreshToolbar","position","resourceUri","URIString","createPermissionAction","finishEdit","toPermissionData","entitiesWithPermission","toJSON","getPermissionsDialog","responseData","inputData","stopWaiting","doSet","_byUsersButton","_byRolesButton","enable","updateEntities","alert","rJson","r","Resource","addChild","setResources","isLoaded","isLoading","setLoading","_getElement","enableItems","updateUI","setPathItems","rData","getList","setCursor","addResources","defaultErrorHandler","isflowRedirectRunning","systemConfirm","errorPopupMessage","_disableBfCacheIfSafari","history","locObj","navigationPaths","queryParams","params","destination","__jrsConfigs__","url","navigateBackUtils","showContextMenu","targetEvent","isFolderContextMenu","closest","trim","showFolderMenu","isResourceContextMenu","showResourceBulkMenu","showResourceMenu","isWebKitEngine","domUtil","customFilters","parentFolder","getParentFolder","refreshFolder","tree","_selectOrEditNode","node","targetFolder","createAndSelectFolder","moveOrCopyFolder","updateFolder","dependentResources","okOnly","canSave","topMessage","bottomMessage","removeResources","reselectFolder","selectedFolder","updateResource","run","createRunResourceAction","location","getSelectedUri","doBrowse","msg","indexOf","restOfString","createGenerateAction","errorDialog","AlertDialog","cursor","reload","isActiveTheme","themeUri","createFolderAction","_createAction","actionFactory","getContextResource","_organizationsFolderUri","_rootFolderUri","_tempFolderUri","_publicFolderUri","_folderSeparator","_configuration","_serverState","_uiState","contextFolder","contextResource","selectedResources","_isAdministrator","getOrganizationsFolderUri","getRootFolderUri","getTempFolderUri","getPublicFolderUri","getFolderSeparator","getConfiguration","filters","sorters","getServerState","getUIState","getFolderUriState","setSelectedFolder","setContextFolder","setSelectedResources","RUN","EDIT","OPEN","CUT","PASTE","REMOVE","_holderId","_folderMenu","_resourceMenu","_resourceBulkMenu","page","isSupportsTouch","isRightClick","touches","coordinates","_move","_copy","_dndMode","onMove","move","onCopy","copy","onCancel","none","isObjectInstanceOf","o","Folder","isDnD","isMove","isCopy","isDnd","className","index","json","_json","description","date","dateTimestamp","dateTime","updateDate","updateDateTimestamp","updateDateTime","parentUri","fileType","isScheduled","scheduled","isFavorite","favorite","_permissions","permissions","hasChildren","isChild","parentResource","isOpen","_children","split","last","size","childIndex","child","isAdministrable","extra","prototype","getReadableUri","match","isWritable","ResourcesUtils","getResourceUris","uriList","getResourceUriAndTypeList","getSelectedResourceUris","map","checkNameLength","resourceNameMaxLength","checkDescriptionLength","resourceDescriptionMaxLength","labelValidator","resourceLabelMaxLength","descriptionValidator","_fileTypeValidatorTemplate","expectedType","zipFileTypeValidator","isCustomDataSource","getInitConfiguration","customDataSources","str","fromStr","lastIndexOf","getInitOptions","HTMLInputElement","HTMLTextAreaElement","canResourceBeCreated","Action","invokeCreate","resourceTypeSuffix","createCreateResourceAction","isCopyOrMove","isNonActiveThemeFolder","canThemeBeReuploaded","canFolderBeDeleted","canFolderBeExported","pathElements","canFolderPermissionsBeAssigned","canFolderPropertiesBeShowed","runActionFactory","typeSuffix","canBeGenerated","canBeConverted","openActionFactory","canBeRunInBackground","canBeScheduled","hasEditActionImpl","editActionFactory","allowed","canCreateFolder","canResourcePermissionsBeAssigned","canAllPropertiesBeShowed","canAllPropertiesBeEdited","canBeAddedToFavorites","every","canBeRemovedFromFavorites","DEFAULT","contains","j","createResourceAction","initDownload","createConvertAction","createEditResourceAction","createOpenResourceAction","showDeleteResourceConfirm","showBulkDeleteResourcesConfirm","cascade","number","status","_serverErrorHandler","onFavoriteItem","favoriteList","request","headers","favorites","ajaxIframeDownload","onload","contentDocument","evalJSON","errorEventName","sourceFolderUri","destFolderUri","themeName","copyUris","moveUris","selectedResource","convertErrorResponse","dataObj","existingLabels","filteredResources","dependenciesBtnOk","dialogTitle","promptFilteredRetry","resp","successEvent","DIMMER_TIMEOUT","flowId","FLOW_URL","paramsMap","hash","encode","isUndefined","ajaxLoading","ajax","click","form","_serializeParams","timeout","setTimeout","strip","submit","hidePopup","clearTimeout","isContentResource","downloadFileByUrl","redirectToUrl","w","opener","inNewTab","reportUnit","standAlone","ParentFolderUri","parentFlow","dashboardResource","flow","typeEquals","factoryMethod","createRunResourceInNewTabAction","actionType","isEdit","currentQuery","resourceTypeToDefaultRedirectTypeMap","getDefaultRedirectTypeByResourceType","defaultRedirectType","createRunInBackgroundResourceAction","reportUnitParentURI","createScheduleAction","createActionFactory","expectedFileType","confirmAndLeave","hasReports","resizable","_onExportButtonClick","_closeExportDialog","exportView","ExportView","listenTo","disable","openRepoDialog","repoData","eventTarget","ancestors","filter","hasClassName","uris","jrsConfigs","orgTemplateFolderUri","subOrgRegExp","RegExp","rootOrgTemplateRegExp","isSubOrgLevel","renderOptions","exportTypesEnum","subtitle","i18n2","addCssClasses","_openExportDialog","openTenantDialog","tenant","fieldIsValid","fieldIsInvalid","doExport","css","width","focusElement","setContent","setTitle","setReturnFocus","applyEpoxyBindings","delegateEvents","minHeight","outerHeight","outerWidth","exportDialog","ExportDialogView","favoriteFilter","checked","onclick","_bulkActions","_treeId","_uri","_cookieName","_canDoBrowse","_touchController","_browseRepoTimer","isFolderSet","storedUri","getItem","getTreeId","parents","eq","dynamicTree","providerId","rootUri","organizationId","urlGetNode","urlGetChildren","escapeHyperlinks","disableSelectionWithoutCursorStyle","nodePosition","getBoxOffsets","focused","menuLeft","menuTop","_overNode","refreshDropTarget","setDragStartState","draggable","isMetaHeld","setDragEndState","isDropTarget","refreshStyle","onHover","hover","Draggables","touch","changedTouches","getTreeNodeByElement","elementFromPoint","pageX","pageY","getTreeNodeByEvent","console","openAndSelectNode","rootNode","getFirstChild","getSelectedNode","scroll","showTreePrefetchNodes","selectFolder","shouldFocus","updateSubFolders","getTreeNodeChildren","changeName","resortSubtree","refreshNode","hasChilds","setHasChilds","handleNode","isloaded","isIconEvent","removeChild","n","_list","_resultListHeaderId","_resultListId","_resultsContainerId","_touchScroller","_folderDisplayPathCache","NOTHING_TO_DISPLAY_ID","RESOURCE_NAME_TOOLTIP_ID","NAME_PATTERN","LINK_NAME_PATTERN","DISCLOSURE_PATTERN","SCHEDULED_PATTERN","FAVORITE_PATTERN","LOADING_CLASS_NAME","it","_header","_intiListEvents","_initDnD","TouchController","scrollbars","resizeHandler","_toggleInfiniteScrollBasedOnViewportHeight","_fixHeaderWidth","setStyle","getWidth","_createResourceItem","resourceItem","cssClassName","openHandlerPattern","closeHandlerPattern","favoriteIconPattern","scheduleIconPattern","excludeFromSelectionTriggers","listOptions","b","nameSelector","nameTitleElement","that","loadTextCallback","tooltip","folderPath","folderDisplayPath","updateTooltip","separator","getUri","updateText","isFolder","descriptionValue","jsTooltip","modifiedDate","createdDate","scheduleIcon","favoriteIcon","baseRefreshStyle","ariaLabel","first","_isLinkEvent","_isScheduleIconEvent","_isFavoriteIconClicked","_element","_selectOrUnselectResources","itemPosition","menuPosition","resourceVal","selectedElement","lItem","is","_isDisclosureEvent","_refreshEmptyListMessage","_isListHeightLessThanViewport","clientHeight","children","other","removedItems","compositeItems","isComposite","_renderHeader","headerClone","clone","prepend","toItem","tooltipModule","CustomEvent","dispatchEvent","getItemByEvent","isItemSelected","selectItem","findResource","_filtersLists","_ignoreFilterEvent","filtersMetaData","selectedFilters","childElements","Element","_createFiltersList","_buttonToggleListener","_refreshScroll","_createItemsList","filterMetaData","optionsMetaData","allItems","optionMetaData","labelId","partition","showCount","isMore","templateDomId","openUp","respondOnItemEvents","isSeparator","getId","isRestore","filterOptionSelector","$break","baseList","_contentBodySelector","_filterPathList","isLast","pathItems","lastIndex","listItems","pathItem","_LABEL_TEMPLATE_DOM_ID","_ignoreSortEvent","sortersList","sortersMetaData","selectedSorter","labelItem","isLabel","sortItems","sorterMetaData","listOrientation","ITEM_SELECTED","disableItems","_getLabelTemplate","ResourcePermissions","_resource","_eventSourceFocusableElement","findElement","_isVisible","ENTITY_LIST_ID","_listContainerId","LIST_CONTAINER_ID","SEARCH_BOX_ID","viewBy","_processTemplate","addVar","TEMPLATE_DOM_ID","BODY_PATTERN","path","PATH_PATTERN","_viewByTabSet","VIEW_BY_TAB_SET_PATTERN","_searchBoxInput","SEARCH_BOX_INPUT_PATTERN","TAB_PATTERN","_submitButton","SUBMIT_BUTTON","_applyButton","APPLAY_BUTTON","_cancelButton","CANCEL_BUTTON","viewType","listContainer","searchBox","veSelector","leSelector","valueElement","_waiting","_hideWarning","getChangedEntities","_showWarning","key","elementTarget","prev","next","buttonEl","focus","off","li","listItem","navigateToManager","tagName","selectedIndex","getResolvedPermission","PERMISSIONS_PATTERN","LIST_TEMPLATE_ID","ITEM_TEMPLATE_ID","forceLayout","_initControls","_clearPositionStyles","_buttonClickHandler","_keyDownHandler","_selectFocusInHandler","_selectFocusOutHandler","_launcherClickHandler","_selectMouseOverHandler","marginLeft","marginTop","top","left","_waitingItem","WAIT_ITEM_TEMPLATE_ID","nameTooltipSelector","NAME_TOOLTIP_PATTERN","permissionsSelector","TOOLTIP_TEMPLATE_DOM_ID","_this","nameTooltip","origRemove","permissionsConfig","p","_selectChangeHandler","_createItem","listId","listUl","removeAttr","resetList","scrollReset","changed","updated","resourcePermissionsObj","POOL_NOT_FOUND_EXCEPTION","DIALOD_EXIST_EXCEPTION","NULL_RESOURCE_EXCEPTION","_permissionsDialogPool","_propertiesDialogPool","_getPool","pool","ResourceProperties","toString","_createDialog","_createOrGetDialog","_getDialog","resourceOrUri","isString","_getAllDialogs","_removeDialog","createPermissionsDialog","createPropertiesDialog","createOrGetPermissionsDialog","createOrGetPropertiesDialog","getPropertiesDialog","removePermissionsDialog","removePropertiesDialog","_changedCallback","changedCallback","_showMode","showMode","_label","_updateValueAndLabel","_description","_updateContentAndLabel","_path","permissionsToString","_okButton","_hide","_isDataValid","showCreateFolderConfirm","doShow","closable","doHide","clear","isLabelValid","isDescriptionValid","doAdd","DeleteConfirmation","ID_DELETE_DIALOG_CONTAINER","ID_DELETE_DIALOG_OK_BUTTON","ID_DELETE_DIALOG_CANCEL_BUTTON","showDeleteFolderConfirm","count","_showDeleteDialog","dialogText","focusTarget","confirmDialogOpts","returnFocusTo","confirmDialog","showResourceProperties","editResourceProperties","showFolderProperties","editFolderProperties","addToFavorite","itemHovered","resourceSelectedElement","selectedElem","selectedResourceList","setFavorite","forEach","editResourcePermissions","showAndWait","editFolderPermissions","showUploadThemeConfirm","reupload","isReupload","zip","upload","_eventId","_flowExecutionKey","basicURI","slice","reuploadAction","fileSender","responseBody","respObj","themeExist","doUpload","repositorySearchRoot","repositorySearchActions","repositorySearchComponents","dependenciesPanel","actionsMap","_$title","_titleBackup","_changeMessage","_switchButtons","_initList","uriElement","uristring","$buttonElements","saveAs","ok","$button","_contentId","_scroll","_loadFactor","loadFactor","_lastContentHeight","_loading","control","_control","_content","_eventType","_onScrollHandler","_handler","controlScrollTop","y","scrollTop","contentHeight","getHeight","controlHeight","allowLoad","isBottom","wait","_waitIndicator","dimensions","getDimensions","offsets","positionedOffset","after","Panel","defaultTemplate","dialogTemplate","traits","additionalBodyCssClasses","resizablePanelTrait","dialogOptions","collapsed","resetSizeOnOpen","OptionContainer","contextName","optionTemplate","dialogButtonTemplate","buttonView","buttonModel","getTemplateArguments","templateArguments","setElement","res","dimmer","Dimmer","handle","addClasses","containment","isVisible","highestIndex","_setMinSize","_position","_increaseZIndex","lastFocusedElement","activeElement","firstFocusable","stdnav","_onDialogResize","classNames","toggleCollapsedState","enableButton","disableButton","minWidth","setMinSizeAsSize","elHeight","elWidth","bodyHeight","bodyWidth","fitByHeight","fitByWidth","Math","_focus","_onKeyDown","_onKeyboardEvent","resetHighestIndex","numberUtils","NumberUtils","originalValidate","Validation","attrs","valid","view","invalid","doesNotContainSymbols","forbiddenSymbols","integerNumber","isNumberInt","types","some","fn","typeFn","hexColor","xRegExpPattern","customValue","startsWithLetter","substr","containsOnlyWordCharacters","search","arrayMinLength","minLength","bubbles","cancelable","detail","evt","createEvent","initCustomEvent"],"mappings":"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","file":"_chunks/chunk.7080.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: Yuriy Plakosh\n * @version: $Id$\n */\n\n/*\n * Search box class.\n *\n * @param options {JSON Object} - Set of options for search box:\n * <ul>\n *      <li>id - the identifier of search box form element in the DOM</li>\n * </ul>\n */\n\nimport layoutModule from '../core/core.layout';\nimport buttonManager from '../core/core.events.bis';\nimport jQuery from 'jquery';\n\nvar SearchBox = function(options) {\n    this._id = options.id;\n    this._dom = jQuery('#' + this._id)[0];\n    this._enabled = true;\n\n    this._process();\n    this._assignHandlers();\n};\n\n/**\n * Processes DOM.\n */\nSearchBox.addMethod('_process', function() {\n    this._input = jQuery(this._dom).find('input')[0];\n    this._clearButton = jQuery(this._dom).find('.button.searchClear')[0];\n    this._searchButton = jQuery(this._dom).find('.button.search')[0];\n});\n\n/**\n * Assigns handlers.\n */\nSearchBox.addMethod('_assignHandlers', function() {\n    jQuery(this._dom).on('submit', function(e) {\n        Event.stop(e);\n    });\n\n    jQuery(this._input).on(\"keypress\", this._keyPressHandler.bindAsEventListener(this));\n\n    jQuery(this._clearButton).on('click', this._clearHandler.bindAsEventListener(this));\n    jQuery(this._searchButton).on('click', this._searchHandler.bindAsEventListener(this));\n});\n\n/**\n * Key pressed handler for input field.\n */\nSearchBox.addMethod('_keyPressHandler', function(e) {\n    if (this._enabled && Event.KEY_RETURN == e.keyCode) {\n        this._doSearch();\n\n        // Fix to prevent click event handling on clear button when enter key is pressed in the input field.\n        Event.stop(e);\n    }\n});\n\n/**\n * Updates visibility of clear button.\n */\nSearchBox.addMethod('_updateClearButtonVisibility', function() {\n    if (!this.getText().blank()) {\n        jQuery(this._clearButton).addClass(layoutModule.UP_CLASS);\n    } else {\n        jQuery(this._clearButton).removeClass(layoutModule.UP_CLASS);\n    }\n});\n\n/**\n * Click handler for clear button.\n */\nSearchBox.addMethod('_clearHandler', function() {\n    if (this._enabled) {\n        this.setText(\"\");\n        this._doSearch();\n    }\n});\n\n/**\n * Click handler for search button.\n */\nSearchBox.addMethod('_searchHandler', function() {\n    if (this._enabled) {\n        this._doSearch();\n    }\n});\n\n/**\n * Gets search box text.\n */\nSearchBox.addMethod('getText', function() {\n    return this._input.getValue();\n});\n\n/**\n * Sets search box text.\n */\nSearchBox.addMethod('setText', function(text) {\n    this._input.setValue(text);\n    this._updateClearButtonVisibility();\n});\n\n/**\n * Enables search box.\n */\nSearchBox.addMethod('enable', function() {\n    buttonManager.enable(this._clearButton);\n    buttonManager.enable(this._searchButton);\n    jQuery(this._input).attr(layoutModule.READONLY_ATTR_NAME, null);\n    jQuery(this._dom).attr(layoutModule.DISABLED_ATTR_NAME, null);\n\n    this._enabled = true;\n});\n\n/**\n * Disables search box.\n */\nSearchBox.addMethod('disable', function() {\n    buttonManager.disable(this._clearButton);\n    buttonManager.disable(this._searchButton);\n    jQuery(this._input).attr(layoutModule.READONLY_ATTR_NAME, layoutModule.READONLY_ATTR_NAME);\n    jQuery(this._dom).attr(layoutModule.DISABLED_ATTR_NAME, layoutModule.DISABLED_ATTR_NAME);\n\n    this._enabled = false;\n});\n\n/**\n * Does search action.\n */\nSearchBox.addMethod('_doSearch', function(text) {\n    this._updateClearButtonVisibility();\n    this.onSearch(this.getText());\n});\n\n/**\n * Is invoked when search action was performed (search button pressed, clear button pressed, enter key pressed in the\n * text input field). This method should be replaced in the instance of SearchBox class to handle search action.\n *\n * @param text the text in the search box.\n */\nSearchBox.addMethod('onSearch', function(text) {\n    // No-op.\n});\n\nexport default SearchBox;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global viewer, confirm, alert, Report */\nimport {JRS} from \"../namespace/namespace\";\nimport layoutModule from '../core/core.layout';\nimport Controls from './controls.core';\nimport {\n    centerElement,\n    matchAny,\n    triggerNativeEvent,\n    isIPad,\n    selectAndFocusOn\n} from \"../util/utils.common\";\nimport dialogs from '../components/components.dialogs';\nimport {ControlsBase, OptionsDialog, ControlDialog} from \"./controls.base\";\nimport ReportOptionsStub from './controls.options';\nimport '../reportViewer/report.view.base';\nimport {isProVersion} from \"../namespace/namespace\";\nimport Report from '../reportViewer/report.view.base';\nimport './controls.controller';\nimport jQuery from 'jquery';\nimport _ from 'underscore';\nimport ConfirmationDialog from 'js-sdk/src/common/component/dialog/ConfirmationDialog';\nimport Overlay from 'js-sdk/src/components/overlay/Overlay';\nimport { showErrorPopup } from '../core/core.ajax.utils';\n\nconst isMandatoryInputControls = () => {\n    const atLeastOneParameterDoesntHaveDefaultOrUrlValue = !_.isUndefined(_.find(Report.parametersWithoutDefaultValues, function (parameterName) {\n        return !_.contains(_.keys(Report.getAllRequestParameters()), parameterName);\n    }));\n\n    // Report.reportParameterValues will be filled when returning from drill through.\n    // _.isEmpty(Report.reportParameterValues) means that we are not returning from drill through.\n\n    return (Report.hasInputControls && ((Report.reportForceControls || atLeastOneParameterDoesntHaveDefaultOrUrlValue) && _.isEmpty(Report.reportParameterValues)));\n};\n\nvar ControlsReport = function (jQuery, _, Controls, Report) {\n    return _.extend(Controls, {\n        _messages: {},\n        layouts: {\n            LAYOUT_POPUP_SCREEN: 1,\n            LAYOUT_SEPARATE_PAGE: 2,\n            LAYOUT_TOP_OF_PAGE: 3,\n            LAYOUT_IN_PAGE: 4\n        },\n        controlDialog: null,\n        reportOptionsDialog: null,\n        inputControlsLocation: null,\n        toggleControlsOn: false,\n        controller: null,\n        hideControls: null,\n        selectionChanged: true,\n        initialInputControlsFetched: false,\n        initialize: function () {\n            this.controller = new JRS.Controls.Controller({\n                reportUri: Report.reportUnitURI,\n                reportOptionUri: Report.reportOptionsURI\n            }); // Pre-selected parameters have priority over url ones.\n\n            this.viewModel = Controls.controller.getViewModel();\n            this.initializeOptions();\n\n            const confirmInputValues = _.debounce(() => {\n                Controls.applyInputValues(true);\n            }, Controls.Utils.LOADING_DIALOG_DELAY, true);\n\n            const applyInputValues = _.debounce(() => {\n                Controls.applyInputValues();\n            }, Controls.Utils.LOADING_DIALOG_DELAY, true);\n\n            const cancelInputValues = _.debounce(() => {\n                Controls.cancel();\n            }, Controls.Utils.LOADING_DIALOG_DELAY, true);\n\n            const resetInputValues = _.debounce(() => {\n                Controls.resetToInitial();\n            }, Controls.Utils.LOADING_DIALOG_DELAY, true);\n\n            this.buttonActions = {\n                'button#ok': confirmInputValues,\n                'button#apply': applyInputValues,\n                'button#cancel': cancelInputValues,\n                'button#reset': resetInputValues,\n                'button#save': Controls.save,\n                'button#remove': Controls.remove\n            };\n\n            var dialogButtonActions = {\n                'button#ok': confirmInputValues,\n                'button#cancel': cancelInputValues,\n                'button#reset': resetInputValues,\n                'button#apply': applyInputValues,\n                'button#save': Controls.save,\n                'button#remove': Controls.remove\n            };\n\n            if (jQuery('#' + ControlsBase.INPUT_CONTROLS_DIALOG)[0]) {\n                this.controlDialog = new ControlDialog(dialogButtonActions);\n            }\n\n            if (jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM)[0]) {\n                jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM).on('click', function (e) {\n                    var elem = e.target;    //                observe Input Controls buttons\n                    for (var pattern in this.buttonActions) {\n                        if (matchAny(elem, [pattern], true)) {\n                            this.buttonActions[pattern]();\n                            e.stopPropagation();\n                            return;\n                        }\n                    }\n                }.bindAsEventListener(this));\n            }\n\n            this.inputControlsLocation = jQuery('#' + ControlsBase.INPUT_CONTROLS_CONTAINER)[0] ? jQuery('#' + ControlsBase.INPUT_CONTROLS_CONTAINER)[0] : jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM)[0];\n\n            if (jQuery('#' + ControlsBase.TOOLBAR_CONTROLS_BUTTON)[0]) {\n                this.toggleControlsOn = jQuery('#' + ControlsBase.TOOLBAR_CONTROLS_BUTTON).hasClass('down');\n            }\n\n            JRS.Controls.listen({\n                'viewmodel:selection:changed': function () {\n                    Controls.selectionChanged = true;\n                },\n                'reportoptions:selection:changed': function (event, data) {\n                    Controls.selectionChanged = true;\n                }\n            });\n\n            if (Report.hasInputControls) {\n                const dfd = this._fetchAndSetInputControlsStateOnce().then(() => {\n                    const viewModel = Controls.controller.getViewModel();\n                    const isValidSelection = viewModel.areAllControlsValid();\n\n                    // when their is wrong URL params show control dailog\n                    if (isMandatoryInputControls() || !isValidSelection) {\n                        Controls.show();\n\n                        Controls.controlDialog && Controls.controlDialog.show();\n                    } else {\n                        return Controls.refreshReport().catch(() => {\n                            return jQuery.Deferred().resolve();\n                        });\n                    }\n                }).catch((xhr) => {\n                    const refreshReportDfd = Controls.refreshReport();\n                    Controls.Utils.showLoadingDialogOn(refreshReportDfd, null, true);\n                }).always(() => {\n                    const viewModel = Controls.controller.getViewModel();\n                    const isValidSelection = viewModel.areAllControlsValid();\n\n                    if (isMandatoryInputControls() || !isValidSelection) {\n                        if (Report && Report.nothingToDisplay) {\n                            Report.nothingToDisplay.removeClass(layoutModule.HIDDEN_CLASS);\n\n                            centerElement(Report.nothingToDisplay, {\n                                horz: true,\n                                vert: true\n                            });\n\n                            jQuery('#' + Report.DATA_REFRESH_BUTTON).attr(layoutModule.DISABLED_ATTR_NAME,\n                                layoutModule.DISABLED_ATTR_NAME);\n                        }\n                    }\n                });\n\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n            } else {\n                const dfd = Controls.refreshReport();\n\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n            }\n        },\n\n        initializeOptions: function () {\n            function showSubHeader() {\n                var parent;\n                if (Controls.layouts.LAYOUT_POPUP_SCREEN == Report.reportControlsLayout) {\n                    parent = jQuery('#' + ControlsBase.INPUT_CONTROLS_DIALOG);\n                } else {\n                    parent = jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM);\n                }\n                if (parent && parent.length > 0) {\n                    parent.addClass('showingSubHeader');\n                }\n            }\n            function hideSubHeader() {\n                var parent;\n                if (Controls.layouts.LAYOUT_POPUP_SCREEN == Report.reportControlsLayout) {\n                    parent = jQuery('#' + ControlsBase.INPUT_CONTROLS_DIALOG);\n                } else {\n                    parent = jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM);\n                }\n                if (parent && parent.length > 0) {\n                    parent.removeClass('showingSubHeader');\n                }\n            }\n            if (isProVersion()) {\n                var optionsContainerSelector;\n                if (this.layouts.LAYOUT_POPUP_SCREEN == Report.reportControlsLayout) {\n                    optionsContainerSelector = '#' + ControlsBase.INPUT_CONTROLS_DIALOG + ' .sub.header';\n                } else if (this.layouts.LAYOUT_TOP_OF_PAGE == Report.reportControlsLayout) {\n                    optionsContainerSelector = '#' + ControlsBase.INPUT_CONTROLS_FORM + ' .sub.header';\n                } else {\n                    optionsContainerSelector = '#' + ControlsBase.INPUT_CONTROLS_FORM + ' .sub.header';\n                }\n                const ReportOptions = JRS.Controls.ReportOptions || ReportOptionsStub;\n                var reportOptions = new ReportOptions();\n                reportOptions.fetch(Report.reportUnitURI, Report.reportOptionsURI).done(function () {\n                    jQuery(optionsContainerSelector).append(reportOptions.getElem());\n                    Controls.lastReportOptionsSelection = reportOptions.get('selection');\n                }).fail(function () {\n                    jQuery(optionsContainerSelector).addClass('hidden');\n                }).always(function () {\n                    if (!Controls.lastReportOptionsSelection) {\n                        Controls.lastReportOptionsSelection = reportOptions.get('defaultOption');\n                    }\n                });\n                reportOptions.updateWarningMessage = function () {\n                    Controls.reportOptionsDialog.showWarning(this.error);\n                };\n                JRS.Controls.listen({\n                    'viewmodel:selection:changed': function () {\n                        var option = reportOptions.find({ uri: Report.reportUnitURI });\n                        reportOptions.set({ selection: option }, true);\n                    },\n                    'viewmodel:order:changed': _.bind(function (event, reorderedStructure) {\n                        Report.newIcOrder = _.pluck(reorderedStructure, 'id').join(';');\n                    }, this)\n                });\n                var optionsButtonActions = {\n                    'button#saveAsBtnSave': function () {\n                        var optionName = Controls.reportOptionsDialog.input.getValue();\n                        var selectedData = Controls.viewModel.get('selection');\n                        var overwrite = optionName === Controls.reportOptionsDialog.optionNameToOverwrite;\n                        reportOptions.add(Report.reportUnitURI, optionName, selectedData, overwrite).done(function () {\n                            Controls.reportOptionsDialog.hideWarning();\n                            dialogs.systemConfirm.show(ControlsBase.getMessage('report.options.option.saved'));\n                            showSubHeader();\n                            var container = reportOptions.getElem().parent();\n                            if (container.length > 0) {\n                                container.removeClass('hidden');\n                            } else {\n                                jQuery(optionsContainerSelector).removeClass('hidden');\n                                jQuery(optionsContainerSelector).append(reportOptions.getElem());\n                            }\n                            if (Controls.layouts.LAYOUT_TOP_OF_PAGE == Report.reportControlsLayout) {\n                                jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM + ' .header').removeClass('hidden');\n                            }\n                            Controls.reportOptionsDialog.hide();\n                            delete Controls.reportOptionsDialog.optionNameToOverwrite;\n                        }).fail(function (err) {\n                            if (err) {\n                                try {\n                                    var errorResponse = JSON.parse(err.responseText);\n                                    //check on error  for overwrite\n                                    if (errorResponse.errorCode === 'report.options.dialog.confirm.message') {\n                                        !overwrite && (Controls.reportOptionsDialog.optionNameToOverwrite = optionName);\n                                    }\n                                } catch (e) {\n                                }    // In this scenario security error is handled earlier, in errorHandler, so we can ignore exception here.\n                                // Comment this because it will not work in IE, but can be uncommented for debug purpose.\n                                // console.error(\"Can't parse server response: %s\", \"controls.core\", err.responseText);\n                            }\n                        });\n                    },\n                    'button#saveAsBtnCancel': function () {\n                        Controls.reportOptionsDialog.hide();\n                        delete Controls.reportOptionsDialog.optionNameToOverwrite;\n                    }\n                };\n                if (jQuery('#' + ControlsBase.SAVE_REPORT_OPTIONS_DIALOG)[0]) {\n                    this.reportOptionsDialog = new OptionsDialog(optionsButtonActions);\n                }\n                this.remove = function () {\n                    var optionName = reportOptions.get('selection').label;\n\n                    var dialog = new ConfirmationDialog({\n                        text: ControlsBase.getMessage(\"report.options.option.confirm.remove\", {option: optionName})\n                    });\n\n                    dialog.on(\"button:yes\", function() {\n                        reportOptions.removeOption(Report.reportUnitURI, reportOptions.get('selection').id).done(function () {\n                            if (!reportOptions.get('values')) {\n                                hideSubHeader();\n                                var container = reportOptions.getElem().parent();\n                                if (container.length > 0) {\n                                    container.addClass('hidden');\n                                } else {\n                                    jQuery(optionsContainerSelector).addClass('hidden');\n                                    jQuery(optionsContainerSelector).html('');\n                                }\n                                if (Controls.layouts.LAYOUT_TOP_OF_PAGE == Report.reportControlsLayout) {\n                                    jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM + ' .header').addClass('hidden');\n                                }\n                            }\n                            reportOptions.enableRemoveButton(false);    // change the Remove button to Save\n                            dialogs.systemConfirm.show(ControlsBase.getMessage(\"report.options.option.removed\"));\n                        });\n                        dialog.remove();\n                    });\n\n                    dialog.on(\"button:no\", function(){\n                        dialog.remove();\n                    });\n                    dialog.open();\n                };\n                Controls.reportOptions = reportOptions;\n            }\n        },\n        cancel: function () {\n            if (Report.reportControlsLayout === Controls.layouts.LAYOUT_SEPARATE_PAGE\n                && Controls.separatePageICLayoutFirstShow) {\n                Report.goBack();\n            } else {\n                const refreshControlsToSelectionDfd = this._refreshControlsToSelection(Controls.lastSelection);\n\n                refreshControlsToSelectionDfd.then(() => {\n                    // below call is to fetch report, since we already fetch report with last selected values\n                    // return Controls.refreshReport().catch(() => {\n                    //     return jQuery.Deferred().resolve();\n                    // });\n                }).catch((xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                }).always(function () {\n                    if (Report.reportControlsLayout === Controls.layouts.LAYOUT_POPUP_SCREEN) {\n                        Controls.controlDialog.hide();\n                    } else if (Report.reportControlsLayout === Controls.layouts.LAYOUT_SEPARATE_PAGE) {\n                        Controls.showReport();\n                    }\n                    if (Controls.reportOptions) {\n                        if (Controls.lastReportOptionsSelection) {\n                            Controls.reportOptions.set({ 'selection': Controls.lastReportOptionsSelection }, true);\n                        }\n                    }\n                });\n\n                Controls.Utils.showLoadingDialogOn(refreshControlsToSelectionDfd, null, true);\n            }\n        },\n\n        _refreshControlsToSelection: function(selection) {\n            return Controls.controller.resetControlsToSelection(selection);\n        },\n\n        getLastSelection: function () {\n            return this.lastSelection;\n        },\n\n        save: function () {\n            if (Controls.selectionChanged) {\n                Controls.controller.validate().then(Controls.showOptionDialog);\n            } else {\n                Controls.showOptionDialog();\n            }\n        },\n        refreshReport: function (checkOnChangedSelection, freshData) {\n            if (checkOnChangedSelection) {\n                const deferred = new jQuery.Deferred();\n                let promise = deferred.promise();\n                const selectedData = Controls.viewModel.get('selection');\n\n                const isSelectionChanged = JRS.Controls.ViewModel.isSelectionChanged(Controls.lastSelection, selectedData);\n\n                if (!isSelectionChanged) {\n                    deferred.resolve();\n                    return promise();\n                }\n            }\n\n            return this._refreshReportOnConfirm(freshData);\n        },\n\n        _refreshReportOnConfirm: function (freshData) {\n            const selectedData = Controls.viewModel.get('selection');\n            let promise;\n\n            try {\n                if (selectedData && !_.isEmpty(selectedData)) {\n                    promise = Report.refreshReport({freshData: freshData}, null,selectedData);\n                    Controls.lastSelection = selectedData;\n                } else {\n                    promise = Report.refreshReport();\n                    Controls.lastSelection = {};\n                }\n\n                return promise;\n            } catch (ex) {\n                return jQuery.Deferred().reject(ex);\n            }\n        },\n\n        _refreshReportOnApply: function() {\n            const dfd = jQuery.Deferred();\n            const selectedData = Controls.viewModel.get('selection');\n\n            if (selectedData && !_.isEmpty(selectedData)) {\n                return Report.refreshReport(null, null, selectedData);\n            }\n\n            return dfd.resolve();\n        },\n\n        applyInputValues: function (hideControls, freshData) {\n            let _continue = true;\n            if (window.viewer && window.viewer.isExportRunning()) {\n                _continue = confirm(Report.getMessage(\"jasper.report.view.export.in.progress.confirm.continue\"));\n                window.viewer.confirmedExportCancel = _continue;\n            }\n            if (!_continue) {\n                Controls.resetToInitial();\n                hideControls && Controls.hide();\n                return;\n            }\n\n            const viewModel = Controls.viewModel;\n            if (Controls.selectionChanged) {\n                Controls.controller.validate().then((areAllControlsValid) => {\n                    if (areAllControlsValid) {\n                        const lastSuccessfulSelection = Controls.lastSelection;\n                        let lastSuccessfulReportOption;\n\n                        if (Controls.reportOptions) {\n                            lastSuccessfulReportOption = Controls.lastReportOptionsSelection;\n                        }\n                        // Fix for bug #42128 - jive must be hidden before applying input controls values\n                        window.viewer && window.viewer.jive && window.viewer.jive.hide();\n                        hideControls && Controls.hide();\n                        var refreshReportPromise = Controls.refreshReport(null, freshData);\n                        refreshReportPromise && refreshReportPromise.then(function () {\n                            Controls.selectionChanged = false;\n                        }, function () {\n                            // using overlay here solely for this error dialog,\n                            // because components.dialogs share state, closing built-in pageDimmer\n                            // when the option is set to make it visible\n                            const overlay = new Overlay({\n                                zIndex: dialogs.errorPopup.getZIndex() - 1\n                            });\n\n                            jQuery(\"body\").append(overlay.$el);\n\n                            overlay.show();\n                            //application of input controls was failed probably because of\n                            //report cancellation\n                            //in this case if hideControls is true we have to set values to\n                            //latest successfull value\n                            Controls.lastSelection = lastSuccessfulSelection;\n                            Controls.lastReportOptionsSelection = lastSuccessfulReportOption;\n\n                            // refresh report with IC after an error, on error dialog close\n                            dialogs.errorPopup.onClose = function() {\n                                Report.hasError = true;\n                                if (Controls.lastSelection && !_.isEmpty(Controls.lastSelection)) {\n                                    Report.refreshReport({freshData: freshData}, null,\n                                        Controls.lastSelection);\n                                } else {\n                                    Report.refreshReport({freshData: freshData});\n                                }\n\n                                overlay.remove();\n                            };\n\n                            if (hideControls) {\n                                Controls.cancel();\n                                Controls.hide();\n\n                                Controls.selectionChanged = false;\n                            }\n                        });\n\n                        if (Controls.reportOptions) {\n                            Controls.lastReportOptionsSelection = Controls.reportOptions.get('selection');\n                            if(!refreshReportPromise) {\n                                dialogs.popup.hide(jQuery('#loading')[0]);\n                            }\n                        }\n                    }\n                });\n            } else if (viewModel.areAllControlsValid()) {\n                hideControls && Controls.hide();\n            }\n        },\n        resetToInitial: function () {\n            const refreshControlsToSelectionDfd = this._refreshControlsToSelection(Controls.initialSelection)\n                .then(() => {\n                    Controls.selectionChanged = true;\n\n                    // after reset button click \"saved values\" dropdown should be update\n                    var reportOptions = Controls.reportOptions;\n                    if (reportOptions) {\n                        var option = reportOptions.find({ uri: Report.reportOptionsURI ? Report.reportOptionsURI : Report.reportUnitURI });\n                        if (option) {\n                            reportOptions.set({ selection: option }, true);\n                            return;\n                        }\n                    }\n                }, (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                });\n\n            Controls.Utils.showLoadingDialogOn(refreshControlsToSelectionDfd, null, true);\n            // Controls.selectionChanged = true;\n            //\n            // var reportOptions = Controls.reportOptions;\n            //\n            // if (reportOptions) {\n            //     var option = reportOptions.find({ uri: Report.reportOptionsURI ? Report.reportOptionsURI : Report.reportUnitURI });\n            //     if (option) {\n            //         reportOptions.set({ selection: option });\n            //         return;\n            //     }\n            // }\n            //\n            // var finalInitialParameters = null;\n            //\n            // if (inputControlsSettings.useUrlParametersOnReset === 'true') {\n            //     //use params passed through url as defaults\n            //     finalInitialParameters = _.extend(Report.getAllRequestParameters(), Report.reportParameterValues);\n            // }\n            //\n            // Controls.controller.reset(null, finalInitialParameters);\n        },\n        show: function () {\n            switch (Report.reportControlsLayout) {\n            case 2:\n                Controls.showControls();\n                break;\n            case 3:\n                Controls.toggleControls();\n                break;\n            case 4:\n                /* Controls \"in page\" cannot be opened or closed, they're always shown. */\n                break;\n            default:\n                Controls.showDialog();\n            }\n        },\n        hide: function () {\n            switch (Report.reportControlsLayout) {\n            case 2:\n                Controls.showReport();\n                break;\n            case 3:\n                /* Controls \"top of page\" can be closed only using input controls button. */\n                break;\n            case 4:\n                /* Controls \"in page\" cannot be opened or closed, they're always shown. */\n                break;\n            default:\n                Controls.controlDialog.hide();\n            }\n        },\n        toggleControls: function () {\n            const hideInputControlsPanel = () => {\n                jQuery('#' + ControlsBase.TOOLBAR_CONTROLS_BUTTON).removeClass('down').addClass('up');\n                jQuery('.panel.pane.inputControls').addClass(layoutModule.HIDDEN_CLASS)[0];    // Due to the html markup of the AdHoc Chart, there is an issue when the\n\n                // Due to the html markup of the AdHoc Chart, there is an issue when the\n                // AdHoc Chart Report is rendering and there is an TopOfThePage Control there:\n                // they interfere with each other because AdHoc uses absolute positioning to get as much space as it needs,\n                // and this prevents controls from being visible.\n                // So, when controls are getting closed, we need to re-launch the \"resize\" event to let viewer.js to re-calculate the position of the window\n                // TODO: This should use eventAutomation.triggerNativeEvent when this is converted to use RequireJS\n                triggerNativeEvent('resize');\n            };\n\n            const showInputControlsPanel = () => {\n                jQuery('#' + ControlsBase.TOOLBAR_CONTROLS_BUTTON).removeClass('up').addClass('down');\n                jQuery('.panel.pane.inputControls').removeClass(layoutModule.HIDDEN_CLASS)[0];\n            };\n\n            if (Controls.toggleControlsOn) {\n                hideInputControlsPanel();\n            } else {\n                this._fetchAndSetInputControlsStateOnce().then(() => {\n                    showInputControlsPanel();\n                }).catch((xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                });\n            }\n\n            Controls.toggleControlsOn = !Controls.toggleControlsOn;\n\n            isIPad() && Report.touchController.reset();\n            /**\n             * Fix to force rendering of input controls on webkit.\n             */\n            jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM).show().height();\n        },\n        showDialog: function () {\n            if (Controls.controlDialog) {\n                this._fetchAndSetInputControlsStateOnce().then(() => {\n                    Controls.controlDialog.show();\n                }).catch((xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                });\n            }\n        },\n        showReport: function () {\n            jQuery('#' + layoutModule.PAGE_BODY_ID).removeClass(layoutModule.CONTROL_PAGE_CLASS).addClass(layoutModule.ONE_COLUMN_CLASS);\n        },\n        showControls: function () {\n            const showControlsPage = () => {\n                jQuery('#' + layoutModule.PAGE_BODY_ID).removeClass(layoutModule.ONE_COLUMN_CLASS).addClass(layoutModule.CONTROL_PAGE_CLASS);\n                document.getElementById(ControlsBase.INPUT_CONTROLS_FORM) && jQuery('#' + ControlsBase.INPUT_CONTROLS_FORM).show();\n            };\n\n            this._fetchAndSetInputControlsStateOnce().then(() => {\n                showControlsPage();\n            }).catch((xhr) => {\n                showErrorPopup(xhr.responseJSON.message);\n            });\n        },\n        showOptionDialog: function () {\n            JRS.Controls.Utils.wait(200).then(function () {\n                //workaround for bug 27415,\n                //because can't prevent bubbling up to parent dialog window,\n                //so add delay and only then shows options dialog on top of controls dialog\n                if (Controls.viewModel.areAllControlsValid()) {\n                    Controls.reportOptionsDialog.show();\n                    selectAndFocusOn(Controls.reportOptionsDialog.input);\n                }\n            });\n        },\n\n        _fetchAndSetInputControlsStateOnce: function() {\n            const dfd = jQuery.Deferred();\n\n            if (!this.initialInputControlsFetched) {\n\n                const fetchRawValuesDfd = jQuery.Deferred();\n                if (Report.reportExecutionId && Report.reportExecutionId.length) {\n                    this.controller.fetchReportRawParameterValues(Report.reportExecutionId).then(values => {\n                        Report.reportParameterValues = values;\n                        fetchRawValuesDfd.resolve();\n                    }, (...args) => {\n                        fetchRawValuesDfd.reject(...args);\n                    });\n                } else {\n                    fetchRawValuesDfd.resolve();\n                }\n\n                fetchRawValuesDfd.then(() => {\n                    const allRequestParameters = _.extend(Report.getAllRequestParameters(), Report.reportParameterValues);\n                    this.controller.fetchAndSetInputControlsState(allRequestParameters).then(() => {\n                        this.initialInputControlsFetched = true;\n\n                        const viewModel = Controls.controller.getViewModel();\n                        const selection = viewModel.get('selection');\n\n                        Controls.lastSelection = selection;\n                        Controls.initialSelection = selection;\n\n                        return dfd.resolve();\n                    }, (...args) => {\n                        dfd.reject(...args);\n                    });\n\n                    Controls.Utils.showLoadingDialogOn(dfd, null, true);\n                }, (...args) => {\n                    dfd.reject(...args);\n                });\n            } else {\n                dfd.resolve();\n            }\n\n            return dfd;\n        }\n    });\n}(jQuery, _, Controls, Report);\n\nexport default ControlsReport;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n// Main module for manege organizations, users and roles\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\nimport {Droppables} from 'dragdropextra';\nimport {$, $$, $A, Template} from 'prototype';\nimport SearchBox from '../components/components.searchBox';\nimport toolbarButtonModule from '../components/components.toolbarButtons.events';\nimport {\n    toFunction,\n    getAsFunction,\n    isArray,\n    matchAny,\n    centerElement,\n    ValidationModule,\n    deepClone,\n    doNothing\n} from '../util/utils.common';\nimport layoutModule from '../core/core.layout';\nimport {dynamicList} from '../components/list.base';\nimport InfiniteScroll from '../util/tools.infiniteScroll';\nimport {JSTooltip} from '../components/components.tooltip';\nimport buttonManager from '../core/core.events.bis';\nimport primaryNavModule from '../actionModel/actionModel.primaryNavigation';\nimport {ajaxTargettedUpdate, AjaxRequester} from \"../core/core.ajax\";\nimport {baseErrorHandler} from \"../core/core.ajax.utils\";\nimport orgModule from './mng.org.module';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport jQuery from 'jquery';\n\nObject.assign(orgModule, {\n    TREE_ID: 'orgTree',\n    COOKIE_NAME: 'selectedTenant',\n    messages: [],\n    ActionMap: {\n        SEARCH: 'search',\n        BROWSE: 'browse',\n        NEXT: 'next',\n        SELECT_AND_GET_DETAILS: 'selectAndGetDetails',\n        SEARCH_AVAILABLE: 'searchAvailable',\n        SEARCH_ASSIGNED: 'searchAssigned',\n        NEXT_AVAILABLE: 'nextAvailable',\n        NEXT_ASSIGNED: 'nextAssigned',\n        CREATE: 'create',\n        UPDATE: 'update',\n        DELETE: 'delete',\n        DELETE_ALL: 'deleteAll',\n        EXIST: 'exist'\n    },\n    Event: {\n        /** Request events. */\n        ORG_BROWSE: 'org:browse',\n        ENTITY_SEARCH: 'entity:search',\n        ENTITY_NEXT: 'entity:next',\n        ENTITY_SELECT_AND_GET_DETAILS: 'entity:selectAndGetDetails',\n        /** Response events. */\n        RESULT_CHANGED: 'result:changed',\n        RESULT_NEXT: 'result:next',\n        ENTITY_DETAILS_LOADED: 'entity:detailsLoaded',\n        SEARCH_AVAILABLE_LOADED: 'searchAvailable:loaded',\n        SEARCH_ASSIGNED_LOADED: 'searchAssigned:loaded',\n        NEXT_AVAILABLE_LOADED: 'nextAvailable:loaded',\n        NEXT_ASSIGNED_LOADED: 'nextAssigned:loaded',\n        SERVER_ERROR: 'server:error',\n        SERVER_UNAVAILABLE: 'server:unavailable',\n        ENTITY_CREATED: 'entity:created',\n        ENTITY_UPDATED: 'entity:updated',\n        ENTITY_DELETED: 'entity:deleted',\n        ENTITIES_DELETED: 'entities:deleted'\n    },\n    observe: function (eventName, handler) {\n        this._getContainer().observe(eventName, handler);\n    },\n    stopObserving: function (eventName, handler) {\n        this._getContainer().stopObserving(eventName, handler);\n    },\n    fire: function (eventName, memo) {\n        this._getContainer().fire(eventName, memo);\n    },\n    getMessage: function (messageId, options) {\n        var message = orgModule.messages[messageId];\n        return message ? new Template(message).evaluate(options ? options : {}) : '';\n    },\n    _comparator: function (l1, l2) {\n        return l1 > l2 ? 1 : l1 < l2 ? -1 : 0;\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = document.body;\n        }\n        return this._container;\n    },\n    Configuration: {\n        nameSeparator: '|',\n        userDefaultRole: 'ROLE_USER',\n        userNameNotSupportedSymbols: '[|]',\n        roleNameNotSupportedSymbols: '[|]',\n        emailRegExpPattern: '^[\\\\p{L}\\\\p{M}\\\\p{N}._%\\'-\\\\@\\\\,\\\\;\\\\s]+$',\n        superuserRole: 'ROLE_SUPERUSER',\n        adminRole: 'ROLE_ADMINISTRATOR',\n        anonymousRole: 'ROLE_ANONYMOUS'\n    }\n});\n\norgModule.systemRoles = [\n    orgModule.Configuration.userDefaultRole,\n    orgModule.Configuration.superuserRole,\n    orgModule.Configuration.adminRole,\n    orgModule.Configuration.anonymousRole\n];    /**\n * This Class represents tenant in JS\n *\n * @param node {@link dynamicTree.TreeNode}\n */\n/**\n * This Class represents tenant in JS\n *\n * @param node {@link dynamicTree.TreeNode}\n */\norgModule.Organization = function (jsonOrNode) {\n    if (!jsonOrNode) {\n        throw new Error('Can\\'t create Organization from undefined json or node');\n    }\n    if (jsonOrNode.param) {\n        this.id = jsonOrNode.param.id;\n        this.name = jsonOrNode.name;\n        this.uri = jsonOrNode.param.uri;\n        this.treeNode = jsonOrNode;\n    } else {\n        this.id = jsonOrNode.tenantId || jsonOrNode.id;\n        this.name = jsonOrNode.tenantName;\n        this.alias = jsonOrNode.tenantAlias || jsonOrNode.alias || '';\n        this.desc = jsonOrNode.tenantDesc;\n        this.uri = jsonOrNode.tenantUri;\n        this.parentId = jsonOrNode.parentId;\n        this.subTenantCount = jsonOrNode.subTenantCount;\n    }\n};\norgModule.Organization.addMethod('isRoot', function (level) {\n    // TODO: load name of root organization from configuration.\n    return this.id == 'organizations';\n});\norgModule.Organization.addMethod('getNameWithTenant', function () {\n    return this.id;\n});\norgModule.Organization.addMethod('getDisplayName', function () {\n    return this.name;\n});\norgModule.Organization.addMethod('equals', function (org) {\n    return org && this.id == org.id;\n});\norgModule.Organization.addMethod('toJSON', function (org) {\n    return {\n        tenantId: this.id,\n        tenantName: this.name,\n        tenantAlias: this.alias,\n        tenantDesc: this.desc,\n        parentId: this.parentId,\n        tenantUri: this.uri\n    };\n});\norgModule.Organization.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.organization);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({ tenantId: this.id });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.Permission = function (options) {\n    this.isInherited = !!options.isInherited;\n    if (options.permission) {\n        this.permission = options.permission;\n    }\n    if (options.inheritedPermission) {\n        this.inheritedPermission = options.inheritedPermission;\n    }\n    this.isDisabled = !!options.isDisabled;\n};\norgModule.Permission.addMethod('getResolvedPermission', function () {\n    return this.isInherited ? this.inheritedPermission : this.permission;\n});\norgModule.Permission.addMethod('toJSON', function () {\n    return {\n        permission: this.permission,\n        isInherited: this.isInherited,\n        inheritedPermission: this.inheritedPermission,\n        newPermission: this.newPermission\n    };\n});\norgModule.Permission.addMethod('toData', function () {\n    return {\n        permission: this.permission,\n        isInherited: this.isInherited,\n        inheritedPermission: this.inheritedPermission,\n        newPermission: this.newPermission\n    };\n});\norgModule.User = function (options) {\n    if (options) {\n        this.userName = options.userName;\n        this.fullName = options.fullName;\n        this.password = options.password || '';\n        this.confirmPassword = options.confirmPassword || '';\n        this.tenantId = options.tenantId;\n        this.email = options.email;\n        this.enabled = options.enabled;\n        this.external = options.external;\n        this.roles = [];\n        if (options.roles) {\n            options.roles.each(function (role) {\n                this.roles.push(new orgModule.Role(role));\n            }.bind(this));\n        }\n        if (options.permissionToDisplay) {\n            this.permission = new orgModule.Permission(options.permissionToDisplay);\n        }\n    }\n};\norgModule.User.addVar('FLOW_ID', 'userListFlow');\norgModule.User.addMethod('getDisplayName', function () {\n    return this.userName;\n});\norgModule.User.addMethod('getNameWithTenant', function () {\n    if (this.tenantId && !this.tenantId.blank()) {\n        return this.userName + orgModule.Configuration.userNameSeparator + this.tenantId;\n    } else {\n        return this.userName;\n    }\n});\norgModule.User.addMethod('getManagerURL', function () {\n    return 'flow.html?' + Object.toQueryString({\n        _flowId: this.FLOW_ID,\n        text: typeof this.userName !== 'undefined' ? encodeURIComponent(this.userName) : this.userName,\n        tenantId: typeof this.tenantId !== 'undefined' ? encodeURIComponent(this.tenantId) : this.tenantId\n    });\n});\norgModule.User.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.user);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({\n        text: this.userName,\n        tenantId: this.tenantId\n    });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.User.addMethod('equals', function (user) {\n    return user && this.userName == user.userName && this.tenantId == user.tenantId;\n});\norgModule.User.addMethod('toPermissionData', function (user) {\n    return {\n        userName: this.userName,\n        tenantId: this.tenantId,\n        permissionToDisplay: this.permission.toData()\n    };\n});\norgModule.Role = function (options) {\n    if (options) {\n        this.roleName = options.roleName;\n        this.external = options.external;\n        this.tenantId = options.tenantId;\n    }\n    if (options.permissionToDisplay) {\n        this.permission = new orgModule.Permission(options.permissionToDisplay);\n    }\n};\norgModule.Role.addVar('FLOW_ID', 'roleListFlow');\norgModule.Role.addMethod('getDisplayName', function () {\n    return this.roleName;\n});\norgModule.Role.addMethod('getNameWithTenant', function () {\n    if (this.tenantId && !this.tenantId.blank()) {\n        return this.roleName + orgModule.Configuration.userNameSeparator + this.tenantId;\n    } else {\n        return this.roleName;\n    }\n});\norgModule.Role.addMethod('getManagerURL', function () {\n    return 'flow.html?' + Object.toQueryString({\n        _flowId: this.FLOW_ID,\n        // Object.toQueryString already does encodeURIComponent() once, so we have double encoding here\n        text: typeof this.roleName !== 'undefined' ? encodeURIComponent(this.roleName) : this.roleName,\n        tenantId: typeof this.tenantId !== 'undefined' ? encodeURIComponent(this.tenantId) : this.tenantId\n    });\n});\norgModule.Role.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.role);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({\n        text: this.roleName,\n        tenantId: this.tenantId\n    });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.Role.addMethod('equals', function (role) {\n    return role && this.roleName == role.roleName && this.tenantId == role.tenantId;\n});\norgModule.Role.addMethod('toPermissionData', function (user) {\n    return {\n        roleName: this.roleName,\n        tenantId: this.tenantId,\n        permissionToDisplay: this.permission.toData()\n    };\n});\n\norgModule.initTenantsTreeEvents = function () {\n    orgModule.manager.tenantsTree.on('selection:change', function (selectedItem) {\n        if (!orgModule.manager.lastSelectedOrg || orgModule.manager.lastSelectedOrg.id !== selectedItem.id) {\n            var selectedTenant = new orgModule.Organization(selectedItem), properties = orgModule.properties;\n            orgModule.manager.tenantsTree.setTenant(selectedTenant);\n            window.localStorage && localStorage.setItem(orgModule.COOKIE_NAME, JSON.stringify(selectedItem));\n            orgModule.fire(orgModule.Event.ORG_BROWSE, {\n                organization: selectedTenant,\n                entityEvent: false\n            });\n            if (orgModule.orgManager) {\n                properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n                orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                    entityId: selectedTenant.id,\n                    entityEvent: false\n                });\n            }\n            if (orgModule.userManager || orgModule.roleManager) {\n                properties.hide();\n                properties.unlock();\n            }\n        }\n    });\n    orgModule.manager.tenantsTree.on('import:finished', function (tenantId) {\n        var properties = orgModule.properties;\n        orgModule.fire(orgModule.Event.ORG_BROWSE, {\n            force: true,\n            entityEvent: false\n        });\n        if (orgModule.orgManager) {\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                refreshAttributes: true,\n                entityId: tenantId,\n                entityEvent: false\n            });\n        }\n    });\n};\n\norgModule.entityList = {\n    ID_PATTERN: '.ID > a',\n    _listId: 'entitiesList',\n    _containerId: 'listContainer',\n    _searchBoxId: 'secondarySearchBox',\n    initialize: function (options) {\n        this.list = new dynamicList.List(this._listId, {\n            listTemplateDomId: options.listTemplateId,\n            itemTemplateDomId: options.itemTemplateId,\n            multiSelect: true,\n            selectionDefaultsToCursor: true,\n            comparator: function (item1, item2) {\n                return orgModule._comparator(item1.getLabel(), item2.getLabel());\n            }\n        });\n        this._initEvents();    // Infinite scroll setup.\n        // Infinite scroll setup.\n        this._infiniteScroll = new InfiniteScroll({\n            id: this._containerId,\n            contentId: this._listId\n        });\n        this._searchBox = new SearchBox({ id: this._searchBoxId });\n        if (options.text) {\n            this._searchBox.setText(options.text);\n        }\n        this._infiniteScroll.onLoad = function () {\n            orgModule.fire(orgModule.Event.ENTITY_NEXT, {});\n        };\n        this._searchBox.onSearch = function (text) {\n            orgModule.fire(orgModule.Event.ENTITY_SEARCH, { text: text });\n        };\n        orgModule.toolbar.initialize(options.toolbarModel);\n        this.toolbar = orgModule.toolbar;\n        this.list.show();\n    },\n    _initEvents: function () {\n        this.list.observe('item:selected', function (event) {\n            var item = event.memo.item, properties = orgModule.properties;\n            this.lastSelectedName = item.getValue().getNameWithTenant();\n            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                entityId: item.getValue().id,\n                entityEvent: true\n            });\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n        }.bindAsEventListener(this));\n        this.list.observe('item:unselected', function (event) {\n            var tenantsTree = orgModule.manager.tenantsTree, properties = orgModule.properties;\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);    // Due to complexity of code in mng.common (event flow) there is need to handle some cases in such inappropriate manner\n            // This need to by refactored once mng.common will be refactored in new AMD way + new tree.\n            // Due to complexity of code in mng.common (event flow) there is need to handle some cases in such inappropriate manner\n            // This need to by refactored once mng.common will be refactored in new AMD way + new tree.\n            if (!properties.locked && tenantsTree) {\n                orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                    entityId: tenantsTree.getTenant().id,\n                    entityEvent: true,\n                    isCtrlHeld: event.memo.isCtrlHeld\n                });\n            } else {\n                properties.hide();\n                this.toolbar.refresh();\n            }\n        }.bindAsEventListener(this));\n        this.list.observe('item:beforeSelectOrUnselect', function (event) {\n            var item = event.memo.item;\n            event.stopSelectOrUnselect = !orgModule.invokeClientAction('cancelIfEdit', {\n                entity: item.getValue(),\n                showConfirm: event.memo.showConfirm\n            });\n        }.bindAsEventListener(this));\n    },\n    //    _refreshProperties: function() {\n    //        if (this.list.getSelectedItems().length == 1) {\n    //            orgModule.properties.show(this.list.getSelectedItems()[0].getValue());\n    //        } else {\n    //            orgModule.properties.hide();\n    //        }\n    //    },\n    _createEntityItem: function (value) {\n        var item = new dynamicList.ListItem({\n            label: value.getDisplayName(),\n            value: value\n        });\n        var entityList = this;\n        item.processTemplate = function (element) {\n            var id = element.select(entityList.ID_PATTERN)[0];\n            id.update(xssUtil.hardEscape(this.getValue().getDisplayName()));\n            return element;\n        };\n        return item;\n    },\n    getSearchText: function () {\n        return this._searchBox.getText();\n    },\n    setSearchText: function (text) {\n        return this._searchBox.setText(text);\n    },\n    getSelectedEntities: function () {\n        if (this.list) {\n            return this.list.getSelectedItems().collect(function (item) {\n                return item.getValue();\n            });\n        } else {\n            return [];\n        }\n    },\n    setEntities: function (entities) {\n        var items = entities.collect(this._createEntityItem.bind(this));\n        this._infiniteScroll.reset();\n        this.list.setItems(items);\n        this.list.show();\n        this.toolbar.refresh();\n    },\n    findEntity: function (name) {\n        var items = this.list.getItems(), options = orgModule.properties.options || orgModule.userManager.options;\n        return options._.find(items, function (item) {\n            return item.getValue().fullName === name;\n        });\n    },\n    addEntities: function (entities) {\n        var items = entities.collect(this._createEntityItem.bind(this));\n        this.list.addItems(items);\n        this.list.refresh();\n        this.toolbar.refresh();\n    },\n    selectEntity: function (entityName) {\n        var all = this.list.getItems();\n        var matched = all.detect(function (item) {\n            return item.getValue().getNameWithTenant() == entityName;\n        });\n        if (matched) {\n            matched.isSelected() && matched.deselect();\n            matched.select();\n            this.lastSelectedName = matched.getValue().getNameWithTenant();\n        }\n    },\n    restoreSelectedEntity: function (entityName) {\n        this.selectEntity(this.lastSelectedName ? this.lastSelectedName : entityName);\n    },\n    deselectAll: function () {\n        this.list.resetSelected();\n    },\n    update: function (entityName, newEntity) {\n        var all = this.list.getItems();\n        var matched = all.findAll(function (item) {\n            return item.getValue().getNameWithTenant() == entityName;\n        });\n        matched.each(function (item) {\n            item.setValue(newEntity);\n            item.refresh();\n        });\n    },\n    remove: function (entityNameOrNameSet) {\n        var all = this.list.getItems();\n        var matched;\n        if (isArray(entityNameOrNameSet)) {\n            matched = all.findAll(function (item) {\n                return entityNameOrNameSet.include(item.getValue().getNameWithTenant());\n            });\n        } else {\n            matched = all.findAll(function (item) {\n                return item.getValue().getNameWithTenant() == entityNameOrNameSet;\n            });\n        }\n        this.list.resetSelected();\n        this.list.removeItems(matched);\n    }\n};\norgModule.properties = {\n    _EDIT_MODE_CLASS: 'editMode',\n    _moveButtonsId: 'moveButtons',\n    _id: 'properties',\n    _value: null,\n    isEditMode: false,\n    _NOTHING_TO_DISPLAY_ID: 'nothingToDisplay',\n    _ASSIGNED_VIEW_ID: 'assignedView',\n    _ASSIGNED_VIEW_LIST_ID: 'assignedViewList',\n    _ASSIGNED_ID: 'assigned',\n    _AVAILABLE_ID: 'available',\n    _ASSIGNED_LIST_ID: 'assignedList',\n    _AVAILABLE_LIST_ID: 'availableList',\n    _ATTRIBUTES_LIST_ID: 'attributesTab',\n    _EDIT_BUTTON_ID: 'edit',\n    _SAVE_BUTTON_ID: 'save',\n    _CANCEL_BUTTON_ID: 'cancel',\n    _DELETE_BUTTON_ID: 'delete',\n    _REMOVE_FROM_ASSIGNED_BUTTON_ID: 'removeFromAssigned',\n    _ADD_TO_ASSIGNED_BUTTON_ID: 'addToAssigned',\n    _BUTTONS_CONTAINER_ID: 'propertiesButtons',\n    _MOVE_BUTTONS_CONTAINER_ID: 'moveButtons',\n    _DND_CLASS: '.draggable',\n    _DROP_CLASS: 'wrap',\n    buttonsFunctions: {},\n    initialize: function (options) {\n        var attributesTypesEnum = options.attributesTypesEnum;\n        this.options = options;\n        this.locked = false;\n        this.hide();\n        this.processTemplate(options);\n        this._toggleButton();\n        if (options.attributes) {\n            var attributesType = !orgModule.userManager && orgModule.orgManager ? attributesTypesEnum.TENANT : attributesTypesEnum.USER, optionsFactory = options.attributesViewOptionsFactory, scrollEventTrait = options.scrollEventTrait, AttributesViewFacade = options.AttributesViewFacade;\n            this.options._.extend(this, scrollEventTrait);\n            this.attributesFacade = new AttributesViewFacade(optionsFactory({\n                context: options.attributes.context,\n                container: jQuery('#attributesTab'),\n                type: attributesType\n            }));\n        }\n        if (this.options.showAssigned) {\n            this.initDnD();\n        }\n        this.initEvents();\n        this.initButtonsFunctions();\n        this.options.ConfirmationDialog && this._initConfirmationDialog();\n    },\n    _initConfirmationDialog: function () {\n        var self = this, i18n = this.options.i18n;\n        this.confirmationDialog = new this.options.ConfirmationDialog({\n            title: i18n['attributes.confirm.dialog.title'],\n            text: i18n['attributes.confirm.cancel.dialog.text']\n        });\n        this.confirmationDialog.on('button:yes', function () {\n            self.cancelOnEdit();\n        });\n    },\n    _toggleButton: function () {\n        var propertiesIsChanged = this.isChanged(), attributesAndPropertiesChanged = this.attributesFacade && this.attributesFacade.containsUnsavedItems() || propertiesIsChanged;\n        attributesAndPropertiesChanged ? this.saveButton.removeAttribute('disabled') : this.saveButton.removeClassName('over').setAttribute('disabled', 'disabled');\n    },\n    show: function (value, refreshAttributes) {\n        if (!this.locked) {\n            if (this.attributesFacade) {\n                var self = this, isRoot = value && value.isRoot && value.isRoot(), context = !isRoot ? value : this.options._.extend({}, value, { id: null });\n                this.attributesFacade.getCurrentView().setContext(context, refreshAttributes).done(function () {\n                    self.attributesFacade.render(isRoot);\n                });\n            }\n            var nothingToDisplay = $(this._NOTHING_TO_DISPLAY_ID);\n            nothingToDisplay.addClassName(layoutModule.HIDDEN_CLASS);\n            document.body.removeClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS);\n            this._value = value;\n            this.changeMode(false);\n        }\n    },\n    hide: function () {\n        if (!this.locked) {\n            var nothingToDisplay = $(this._NOTHING_TO_DISPLAY_ID);\n            nothingToDisplay.removeClassName(layoutModule.HIDDEN_CLASS);\n            centerElement(nothingToDisplay, {\n                horz: true,\n                vert: true\n            });\n            document.body.addClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS);\n            this._value = null;\n            this.changeMode(false);\n        }\n    },\n    lock: function () {\n        this.locked = true;\n    },\n    unlock: function () {\n        this.locked = false;\n    },\n    setDetailsLoadedEntity: function (entity) {\n        this.detailsLoadedEntity = entity;\n    },\n    getDetailsLoadedEntity: function () {\n        return this.detailsLoadedEntity;\n    },\n    processTemplate: function (options) {\n        this.editButton = $(this._EDIT_BUTTON_ID);\n        this.saveButton = $(this._SAVE_BUTTON_ID);\n        this.cancelButton = $(this._CANCEL_BUTTON_ID);\n        this.deleteButton = $(this._DELETE_BUTTON_ID);\n        if (this.options.showAssigned) {\n            this.removeFromAssigned = $(this._REMOVE_FROM_ASSIGNED_BUTTON_ID);\n            this.addToAssigned = $(this._ADD_TO_ASSIGNED_BUTTON_ID);\n            this.assignedViewList = new dynamicList.List(this._ASSIGNED_VIEW_LIST_ID, {\n                listTemplateDomId: options.viewAssignedListTemplateDomId,\n                itemTemplateDomId: options.viewAssignedItemTemplateDomId,\n                comparator: this.assignedComparator,\n                allowSelections: false,\n                selectionDefaultsToCursor: false\n            });\n            var commonOptions = {\n                listTemplateDomId: 'list_responsive_collapsible_fields',\n                itemTemplateDomId: 'list_responsive_collapsible_fields:fields',\n                comparator: this.assignedComparator,\n                dragPattern: this._DND_CLASS,\n                allowSelections: true,\n                selectionDefaultsToCursor: true,\n                multiSelect: true,\n                selectOnMousedown: true,\n                setCursorOnMouseDown: true\n            };\n            this.assignedList = new dynamicList.List(this._ASSIGNED_LIST_ID, Object.extend({}, commonOptions, {\n                allowSelections: false,\n                selectionDefaultsToCursor: false    //selectOnMouseDown: false,\n                //setCursorOnMouseDown: false\n            }));\n            this.availableList = new dynamicList.List(this._AVAILABLE_LIST_ID, commonOptions);    //            this.assignedList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.assignedList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.availableList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.availableList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.assignedList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.assignedList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.availableList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.availableList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            if (options.searchAssigned) {\n                this.assignedViewSearchBox = new SearchBox({ id: $(this._ASSIGNED_VIEW_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n                this.assignedViewSearchBox.onSearch = function (text) {\n                    orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: text });\n                };\n            }\n            this.availableSearchBox = new SearchBox({ id: $(this._AVAILABLE_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n            this.availableSearchBox.onSearch = function (text) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE, { text: text });\n            };\n            this.assignedSearchBox = new SearchBox({ id: $(this._ASSIGNED_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n            this.assignedSearchBox.onSearch = function (text) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: text });\n            };\n            if (options.searchAssigned) {\n                this.assignedViewInfiniteScroll = new InfiniteScroll({\n                    id: $($(this._ASSIGNED_VIEW_LIST_ID).parentNode).identify(),\n                    contentId: this._ASSIGNED_VIEW_LIST_ID\n                });\n                this.assignedViewInfiniteScroll.onLoad = function () {\n                    orgModule.invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED, {});\n                };\n            }\n            this.availableInfiniteScroll = new InfiniteScroll({\n                id: $($(this._AVAILABLE_LIST_ID).parentNode).identify(),\n                contentId: this._AVAILABLE_LIST_ID\n            });\n            this.availableInfiniteScroll.onLoad = function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.NEXT_AVAILABLE, {});\n            };\n            this.assignedInfiniteScroll = new InfiniteScroll({\n                id: $($(this._ASSIGNED_LIST_ID).parentNode).identify(),\n                contentId: this._ASSIGNED_LIST_ID\n            });\n            this.assignedInfiniteScroll.onLoad = function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED, {});\n            };\n        }\n    },\n    initDnD: function () {\n        Droppables.add($(this._ASSIGNED_LIST_ID).up(), {\n            accept: [this._DROP_CLASS],\n            hoverclass: layoutModule.DROP_TARGET_CLASS,\n            onDrop: function (dragged, dropped, event) {\n                if (dragged.items) {\n                    this._addToAssigned();\n                }\n            }.bind(this)\n        });\n        Droppables.add($(this._AVAILABLE_LIST_ID).up(), {\n            accept: [this._DROP_CLASS],\n            hoverclass: layoutModule.DROP_TARGET_CLASS,\n            onDrop: function (dragged, dropped, event) {\n                if (dragged.items) {\n                    this._removeFromAssigned();\n                }\n            }.bind(this)\n        });\n    },\n    initEvents: function () {\n        function assignedSelectionHandler() {\n            (this.assignedList.getSelectedItems().length > 0 ? buttonManager.enable : buttonManager.disable)(this.removeFromAssigned);\n        }\n        function availableSelectionHandler() {\n            (this.availableList.getSelectedItems().length > 0 ? buttonManager.enable : buttonManager.disable)(this.addToAssigned);\n        }\n        $(this._BUTTONS_CONTAINER_ID).observe('click', function (event) {\n            var element = event.element();\n            var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n            if (button) {\n                if (this.buttonsFunctions[button.identify()]) {\n                    this.buttonsFunctions[button.identify()].call(this);\n                }\n            }\n            event.preventDefault();\n            event.stopPropagation();\n        }.bindAsEventListener(this));\n        if (this.options.showAssigned) {\n            $(this._MOVE_BUTTONS_CONTAINER_ID).observe('click', function (event) {\n                var element = event.element();\n                var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n                if (button) {\n                    if (button == this.removeFromAssigned) {\n                        this._removeFromAssigned();\n                    } else if (button == this.addToAssigned) {\n                        this._addToAssigned();\n                    }\n                }\n                event.preventDefault();\n                event.stopPropagation();\n            }.bindAsEventListener(this));\n            this.assignedList.observe('item:selected', assignedSelectionHandler.bindAsEventListener(this));\n            this.assignedList.observe('item:unselected', assignedSelectionHandler.bindAsEventListener(this));\n            this.assignedList.observe('item:dblclick', function (event) {\n                this._removeFromAssigned();\n            }.bindAsEventListener(this));\n            this.availableList.observe('item:selected', availableSelectionHandler.bindAsEventListener(this));\n            this.availableList.observe('item:unselected', availableSelectionHandler.bindAsEventListener(this));\n            this.availableList.observe('item:dblclick', function (event) {\n                this._addToAssigned();\n            }.bindAsEventListener(this));\n        }\n        this.attributesFacade && this.attributesFacade.on('change', this.options._.bind(this._toggleButton, this));\n    },\n    initButtonsFunctions: function () {\n        this.buttonsFunctions[this._EDIT_BUTTON_ID] = function () {\n            this.changeMode(true);\n        };\n        this.buttonsFunctions[this._SAVE_BUTTON_ID] = function () {\n            var extObj = this;\n            var dfd = new jQuery.Deferred();\n            if(this.asyncValidate) {\n                this.asyncValidate().done(function() {\n                    extObj.attributesFacade ? extObj.attributesFacade.getCurrentView().saveChildren().done(function () {\n                        dfd.resolve();\n                    }).fail(function () {\n                        dfd.reject();\n                        jQuery('.tab[tabid=\\'#attributesTab\\']').trigger('mouseup');\n                    }) : dfd.resolve();\n                    dfd.done(function () {\n                        extObj.save(extObj._value);\n                    });\n                });\n            } else if(this.validate()) {\n                //This part never gets called, we can remove this in future.\n                this.attributesFacade ? this.attributesFacade.getCurrentView().saveChildren().done(function () {\n                    dfd.resolve();\n                }).fail(function () {\n                    dfd.reject();\n                    jQuery('.tab[tabid=\\'#attributesTab\\']').trigger('mouseup');\n                }) : dfd.resolve();\n                dfd.done(function () {\n                    extObj.save(extObj._value);\n                });\n            }\n        };\n        this.buttonsFunctions[this._CANCEL_BUTTON_ID] = function () {\n            if (this.attributesFacade) {\n                this.isChanged() ? this.confirmationDialog.open() : this.cancelOnEdit();\n            } else {\n                orgModule.invokeClientAction('cancelIfEdit', { entity: this.getValue() });\n            }\n        };\n        this.buttonsFunctions[this._DELETE_BUTTON_ID] = function () {\n            this._deleteEntity();\n        };\n        this.buttonsFunctions[this._REMOVE_FROM_ASSIGNED_BUTTON_ID] = function () {\n            this._removeFromAssigned();\n        };\n        this.buttonsFunctions[this._ADD_TO_ASSIGNED_BUTTON_ID] = function () {\n            this._addFromAssigned();\n        };\n    },\n    cancelOnEdit: function () {\n        var self = this;\n        if (this.isEditMode) {\n            this.cancel().done(function () {\n                self.unlock();\n                self.changeMode(false);\n                self._toggleButton();\n            });\n        }\n    },\n    changeMode: function (edit) {\n        this.isEditMode = edit;\n        var tabs, attributeTab, propertiesTab, $anchor;\n        if (this.attributesFacade) {\n            attributeTab = $('attributesTab');\n            var hideFilters = !!this._value && this._value.id === 'organizations';\n            this.detachScrollEvent(this.attributesFacade.getCurrentView().$container.parent());\n            this.attributesFacade.toggleMode(edit, hideFilters);\n            edit && this.initScrollEvent(this.attributesFacade.getCurrentView());\n            tabs = $$('.tertiary')[0];\n            propertiesTab = $('propertiesTab');\n            $anchor = jQuery('.control.tabSet.anchor');\n        }\n        if (edit) {\n            $(this._id).addClassName(this._EDIT_MODE_CLASS);\n            if (tabs) {\n                tabs.down('.selected').removeClassName('selected');\n                tabs.down('li', 0).addClassName('selected');\n                tabs.addClassName('tabbed');\n                attributeTab.addClassName('hidden');\n                propertiesTab.removeClassName('hidden');\n                $anchor.removeClass('attributesAnchor');\n            }\n            this._assigned = [];\n            this._unassigned = [];\n            if (this.options.showAssigned) {\n                centerElement($(this._moveButtonsId), { horz: true });\n                $(this._moveButtonsId).style.zIndex = 1000;    //fix for bug 26831\n                //fix for bug 26831\n                this.assignedList.setItems([]);\n                this.assignedList.show();\n                this.availableList.setItems([]);\n                this.availableList.show();\n                buttonManager.disable(this.removeFromAssigned);\n                buttonManager.disable(this.addToAssigned);\n                this.assignedSearchBox.setText('');\n                this.availableSearchBox.setText('');\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: this.assignedSearchBox.getText() });\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE, { text: this.availableSearchBox.getText() });\n            }\n            this._editEntity();\n            this._toggleButton();\n        } else {\n            $(this._id).removeClassName(this._EDIT_MODE_CLASS);\n            if (tabs) {\n                attributeTab.removeClassName('hidden');\n                propertiesTab.removeClassName('hidden');\n                tabs.removeClassName('tabbed');\n            }\n            if (this.options.searchAssigned && this.assignedViewSearchBox) {\n                this.assignedViewSearchBox.setText('');\n            }\n            this.changeDisable(this.canEdit(), ['#' + this._EDIT_BUTTON_ID]);\n            this.changeDisable(this.canDelete(), ['#' + this._DELETE_BUTTON_ID]);\n            this._showEntity();\n            this._assigned = [];\n            this._unassigned = [];\n        }\n    },\n    canEdit: function () {\n        return true;\n    },\n    canDelete: function () {\n        let orgProperties = this.getValue();\n        if ( orgProperties && orgProperties.getNameWithTenant() === this.options.currentUser) {\n            return false;\n        }\n        return !!orgProperties && orgProperties.uri !== '/';\n    },\n    setValuesProperty: function (name, value) {\n        this._value[name] = value;\n    },\n    getValue: function () {\n        return this._value;\n    },\n    setProperties: function (properties) {\n    },    // Template method.\n\n    isChanged: function (properties) {\n    },    // Template method.\n\n    save: function (properties) {\n    },    // Template method.\n\n    validate: function () {\n        // Template method.\n        return true;\n    },\n    assignedComparator: function (item1, item2) {\n        var l1 = item1.getLabel();\n        var l2 = item2.getLabel();\n        return l1 > l2 ? 1 : l1 < l2 ? -1 : 0;\n    },\n    _moveEntities: function (bToAssigned) {\n        var from, to, fromList, toList;\n        if (bToAssigned) {\n            from = this._unassigned;\n            fromList = this.availableList;\n            to = this._assigned;\n            toList = this.assignedList;\n        } else {\n            from = this._assigned;\n            fromList = this.assignedList;\n            to = this._unassigned;\n            toList = this.availableList;\n        }\n        var items = fromList.getSelectedItems();\n        var entities = items.collect(function (item) {\n            return item.getValue();\n        });\n        to = to.concat(entities.collect(function (entity) {\n            return entity.available == bToAssigned ? entity : null;\n        })).compact();\n        from = from.reject(function (fromItem) {\n            return entities.detect(function (entity) {\n                return fromItem.equals(entity);\n            });\n        });\n        fromList.removeItems(items);\n        toList.addItems(items, true);\n        toList.refresh();\n        if (bToAssigned) {\n            this._unassigned = from;\n            this._assigned = to;\n        } else {\n            this._assigned = from;\n            this._unassigned = to;\n        }\n    },\n    _addToAssigned: function () {\n        this._moveEntities(true);\n    },\n    _removeFromAssigned: function () {\n        this._moveEntities(false);\n    },\n    _entitiesToItems: function (entities, isAvailable) {\n        entities = entities ? entities : [];\n        return entities.collect(function (entity) {\n            var label = '';\n            var tooltipText = [], template = 'orgTooltip';\n            if (entity instanceof orgModule.User) {\n                label = entity.userName;\n                if (entity.fullName && entity.fullName.length > 0) {\n                    tooltipText = [entity.fullName];\n                }\n                template = entity.tenantId ? 'fullNameAndOrgTooltip' : 'fullNameTooltip';\n            } else if (entity instanceof orgModule.Role) {\n                label = entity.roleName;\n                template = entity.tenantId ? 'orgTooltip' : undefined;\n            }\n            if (entity.tenantId && entity.tenantId.length > 0) {\n                tooltipText.push(entity.tenantId);\n            }\n            entity.available = !!isAvailable;\n            var item = new dynamicList.ListItem({\n                label: label,\n                value: entity\n            });\n            if (this.isEditMode) {\n                item.processTemplate = function (element) {\n                    if (tooltipText.length > 0) {\n                        new JSTooltip(element, {\n                            text: xssUtil.hardEscape(tooltipText),\n                            templateId: template\n                        });\n                    }\n                    return dynamicList.ListItem.prototype.processTemplate.call(this, element);\n                };\n            } else {\n                item.processTemplate = function (element) {\n                    var nameAnchor = element.select('a')[0];\n                    nameAnchor.insert(xssUtil.hardEscape(this.getLabel()));\n                    nameAnchor.writeAttribute('href', this.getValue().getManagerURL());\n                    if (tooltipText.length > 0) {\n                        new JSTooltip(element, {\n                            text: xssUtil.hardEscape(tooltipText),\n                            templateId: template\n                        });\n                    }\n                    return element;\n                };\n            }\n            return item;\n        }.bind(this));\n    },\n    getAssignedEntities: function () {\n        return this._assigned;\n    },\n    getUnassignedEntities: function () {\n        return this._unassigned;\n    },\n    setAssignedEntities: function (entities) {\n        this.assignedViewInfiniteScroll && this.assignedViewInfiniteScroll.reset();\n        this.assignedInfiniteScroll && this.assignedInfiniteScroll.reset();\n        var list = this.isEditMode ? this.assignedList : this.assignedViewList;\n        var filteredEntities = this._filterEntities(entities, this._unassigned, this._assigned, this.assignedSearchBox.getText());\n        list.setItems(this._entitiesToItems(filteredEntities));\n        list.refresh();\n    },\n    addAssignedEntities: function (entities) {\n        var list = this.isEditMode ? this.assignedList : this.assignedViewList;\n        var filteredEntities = this._filterEntities(entities, this._unassigned, this._assigned, this.assignedSearchBox.getText());\n        list.addItems(this._entitiesToItems(filteredEntities));\n        list.refresh();\n    },\n    setAvailableEntities: function (entities) {\n        this.availableInfiniteScroll.reset();\n        var filteredEntities = this._filterEntities(entities, this._assigned, this._unassigned, this.availableSearchBox.getText());\n        this.availableList.setItems(this._entitiesToItems(filteredEntities, true));\n        this.availableList.refresh();\n    },\n    addAvailableEntities: function (entities) {\n        var filteredEntities = this._filterEntities(entities, this._assigned, this._unassigned, this.availableSearchBox.getText());\n        this.availableList.addItems(this._entitiesToItems(filteredEntities, true));\n        this.availableList.refresh();\n    },\n    _filterEntities: function (entities, removeSet, addSet, text) {\n        var allEntities = entities.reject(function (entity) {\n            return removeSet.detect(function (removeEntity) {\n                return removeEntity.equals(entity);\n            });\n        });\n        text = text.toLowerCase();\n        allEntities = allEntities.concat(addSet.findAll(function (entity) {\n            return entity.getDisplayName().toLowerCase().include(text);\n        }));\n        return allEntities;\n    },\n    changeReadonly: function (edit, elementsPatterns) {\n        elementsPatterns.each(function (elementPattern) {\n            $(this._id).select(elementPattern)[0].writeAttribute(layoutModule.READONLY_ATTR_NAME, edit ? null : layoutModule.READONLY_ATTR_NAME);\n        }.bind(this));\n    },\n    resetValidation: function (elementsPatterns) {\n        var panel = $(this._id);\n        elementsPatterns.each(function (elementPattern) {\n            ValidationModule.hideError(panel.select(elementPattern)[0]);\n        }.bind(this));\n    },\n    changeDisable: function (edit, elementsPatterns) {\n        elementsPatterns.each(function (elementPattern) {\n            if (edit) {\n                buttonManager.enable($(this._id).select(elementPattern)[0]);\n            } else {\n                buttonManager.disable($(this._id).select(elementPattern)[0]);\n            }\n        }.bind(this));\n    },\n    _deleteEntity: function () {\n    },    // Template method.\n\n    _editEntity: function () {\n    },    // Template method.\n\n    _showEntity: function () {\n    }    // Template method.\n};\norgModule.addDialog = {\n    show: function (organization) {\n    },    // Template method.\n\n    hide: function (organization) {\n    }    // Template method.\n};\norgModule.Action = function (invokeFn, beforeInvoke) {\n    if (Object.isFunction(invokeFn)) {\n        beforeInvoke = beforeInvoke && Object.isFunction(beforeInvoke) ? beforeInvoke : this.beforeInvoke;\n        this.invokeAction = function () {\n            if (beforeInvoke()) {\n                return invokeFn.apply(this, arguments);\n            }\n        };\n    }\n};    /**\n * Invokes action.\n */\n/**\n * Invokes action.\n */\norgModule.Action.addMethod('invokeAction', doNothing);    /**\n * Invokes function before action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\n/**\n * Invokes function before action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\norgModule.Action.addMethod('beforeInvoke', function () {\n    return true;\n});\norgModule.ServerAction = function (eventId, options) {\n    this.actionURL = 'flow.html?_flowExecutionKey=' + window.localContext.flowExecutionKey + '&_eventId=' + eventId;\n    this.data = Object.toQueryString(options);\n    this.onSuccess = doNothing();\n    this.onError = doNothing();\n};    /**\n * Invokes server action.\n */\n/**\n * Invokes server action.\n */\norgModule.ServerAction.addMethod('invokeAction', function () {\n    if (this.beforeInvoke()) {\n        ajaxTargettedUpdate(this.actionURL, {\n            postData: this.data,\n            callback: function (response) {\n                if (response.error) {\n                    this.onError(response.error);\n                } else {\n                    this.onSuccess(response.data);\n                }\n            }.bind(this),\n            errorHandler: function (ajaxAgent) {\n                if (ajaxAgent.getResponseHeader('LoginRequested')) {\n                    orgModule.fire(orgModule.Event.SERVER_UNAVAILABLE, {});\n                    return true;\n                }\n                return baseErrorHandler(ajaxAgent);\n            },\n            mode: AjaxRequester.prototype.EVAL_JSON\n        });\n    }\n});    /**\n * Invokes function before server action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\n/**\n * Invokes function before server action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\norgModule.ServerAction.addMethod('beforeInvoke', function () {\n    return true;\n});\norgModule.toolbar = {\n    _actionModel: {},\n    initialize: function (actionModel) {\n        this._actionModel = actionModel;\n        toolbarButtonModule.initialize(this._toActionMap(this._actionModel));\n        this.refresh();\n    },\n    refresh: function () {\n        for (var name in this._actionModel) {\n            var id = this._actionModel[name].buttonId;\n            var testFn = toFunction(this._actionModel[name].test);\n            toolbarButtonModule.setButtonState($(id), testFn());\n        }\n    },\n    _toActionMap: function (bulkActionModel) {\n        var actionMap = {};\n        for (var name in bulkActionModel) {\n            var bulkAction = bulkActionModel[name];\n            var id = bulkAction.buttonId;\n            actionMap[id] = function (action, actionArgs) {\n                return function () {\n                    var myAction = getAsFunction(action);\n                    var args = actionArgs;\n                    var belongsToLocalContext = window.localContext && window.localContext[action];\n                    if (args && isArray(args)) {\n                        myAction.apply(belongsToLocalContext ? window.localContext : null, args);\n                    } else {\n                        myAction.call(belongsToLocalContext ? window.localContext : null, args);\n                    }\n                };\n            }(bulkAction.action, bulkAction.actionArgs);\n        }\n        return actionMap;\n    }\n};    ////////////////////////////////////////////////////////////////////////////////////////\n// Input validator\n////////////////////////////////////////////////////////////////////////////////////////\n/**\n * Parameter should have two properties:\n * <ul>\n * <li>regExp {RegExp} - expression must contains list of unsupported symbols</li>\n * <li>unsupportedSymbols {String} -  list of unsupported symbols which will be displayed in error message</li>\n * </ul>\n * @param input {DOMElement}\n */\n////////////////////////////////////////////////////////////////////////////////////////\n// Input validator\n////////////////////////////////////////////////////////////////////////////////////////\n/**\n * Parameter should have two properties:\n * <ul>\n * <li>regExp {RegExp} - expression must contains list of unsupported symbols</li>\n * <li>unsupportedSymbols {String} -  list of unsupported symbols which will be displayed in error message</li>\n * </ul>\n * @param input {DOMElement}\n */\norgModule.createInputRegExValidator = function (input) {\n    return {\n        validator: function (value) {\n            var matches = input.regExp.test(value);\n            var isValid = !matches;\n            var errorMessage = isValid ? '' : orgModule.getMessage('unsupportedSymbols', { symbols: input.unsupportedSymbols });\n            input.isValid = isValid;\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: input\n    };\n};    /**\n *  Check element value isn't blank\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\n/**\n *  Check element value isn't blank\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\norgModule.createBlankValidator = function (element, messageKey, onValid, onInvalid) {\n    return {\n        validator: function (value) {\n            var isValid = !value.blank();\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element,\n        onValid: onValid,\n        onInvalid: onInvalid\n    };\n};    /**\n *  Check max length of value\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\n/**\n *  Check max length of value\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\norgModule.createMaxLengthValidator = function (element, messageKey, replaceKey) {\n    return {\n        validator: function (value) {\n            var max = element.hasAttribute('maxlength') ? element.readAttribute('maxlength') : element.maxlength;\n            var isValid = value.length < parseInt(max);\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            replaceKey && (errorMessage = errorMessage.replace(replaceKey, max));\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};    /**\n *\n *\n * @param element {DOMElement} Validated element\n * @param asElement {DOMElement} Element to compare with\n * @param messageKey {String}\n */\n/**\n *\n *\n * @param element {DOMElement} Validated element\n * @param asElement {DOMElement} Element to compare with\n * @param messageKey {String}\n */\norgModule.createSameValidator = function (element, asElement, messageKey) {\n    return {\n        validator: function (value) {\n            var isValid = value === asElement.getValue();\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};    /**\n *\n *\n * @param element {DOMElement} Validated element\n * @param messageKey {String}\n */\n/**\n *\n *\n * @param element {DOMElement} Validated element\n * @param messageKey {String}\n */\norgModule.createRegExpValidator = function (element, messageKey, regExp) {\n    return {\n        validator: function (value) {\n            var matches = regExp.exec(value);\n            var isValid = !matches && value.length === 0 || matches && value == matches[0];\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};\norgModule.truncateOrgName = function (name) {\n    return name && name.length > 0 ? name.truncate(15) : '';\n};    ////////////////////////////////////////////////////////////////////////////////////////\n// Used to convert regular expression with unsupported symbols into string separated by comas.\n////////////////////////////////////////////////////////////////////////////////////////\n////////////////////////////////////////////////////////////////////////////////////////\n// Used to convert regular expression with unsupported symbols into string separated by comas.\n////////////////////////////////////////////////////////////////////////////////////////\nfunction RegExpRepresenter(expression) {\n    this.charMap = { '\\\\s': ' ' };\n    this.expressionTokens = this.__parse(expression);\n}\nRegExpRepresenter.addMethod('__parse', function (expression) {\n    var result = $A();\n    for (var i = 1; i < expression.length - 1; i++) {\n        var ch = expression.charAt(i);\n        if (ch == '\\\\') {\n            ch += expression.charAt(++i);\n        }\n        if (ch == '\\\\u') {\n            ch += expression.substring(++i, i + 4);\n            i += 3;\n        }\n        result.push(ch);\n    }\n    return result;\n});\nRegExpRepresenter.addMethod('getCharacters', function () {\n    var result = $A();\n    this.expressionTokens.each(function (token) {\n        if (token.startsWith('\\\\u')) {\n            /*eslint-disable-next-line no-eval*/\n            result.push(eval('\"' + token + '\"'));\n        } else if (token.startsWith('\\\\')) {\n            var ch = this.charMap[token];\n            result.push(ch ? ch : token.substring(1, token.length));\n        } else {\n            result.push(token);\n        }\n    }.bind(this));\n    return result;\n});\nRegExpRepresenter.addMethod('getRepresentedString', function () {\n    var result = '';\n    var chars = this.getCharacters();\n    var len = chars.length;\n    for (var i = 0; i < len; i++) {\n        var ch = chars[i];\n        if (ch == ' ' || ch == '.' || ch == ',') {\n            result += '[' + ch + ']';\n        } else {\n            result += ch;\n        }\n        if (i < len - 1) {\n            result += ', ';\n        }\n    }\n    return result;\n});\n\nexport default orgModule;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from './Dialog';\nimport confirmDialogTemplate from './template/loadingDialogTemplate.htm';\nimport i18n from '../../../i18n/CommonBundle.properties';\nexport default Dialog.extend({\n    events: _.extend({}, Dialog.prototype.events, { 'click button': 'cancel' }),\n    el: function () {\n        return this.template({\n            title: this.title,\n            additionalCssClasses: this.additionalCssClasses,\n            i18n: i18n\n        });\n    },\n    constructor: function (options) {\n        this.options = options || {};\n        Dialog.prototype.constructor.call(this, {\n            modal: true,\n            additionalCssClasses: this.options.additionalCssClasses,\n            template: confirmDialogTemplate,\n            title: this.options.title || i18n['dialog.overlay.title']\n        });\n        if (this.options.showProgress) {\n            this.progress = _.bind(function (progress) {\n                if (arguments.length === 0) {\n                    return +this.$('.percents').text();\n                } else {\n                    return this.$('.percents').text(progress + '%');\n                }\n            }, this);\n            this.on('open', _.bind(this.progress, this, 0));\n        }\n    },\n    initialize: function () {\n        Dialog.prototype.initialize.apply(this, arguments);\n        if (this.options.cancellable) {\n            this.on('button:cancel', this.close);\n        } else {\n            this.$('button').hide();\n        }\n    },\n    cancel: function () {\n        this.trigger('button:cancel', this);\n    }\n});","export default \"<div class=\\\"panel dialog loading overlay moveable centered_horz centered_vert {{- additionalCssClasses }}\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <div class=\\\"content \\\">\\n        <div class=\\\"header mover\\\">\\n            <div class=\\\"title\\\">{{- title }}</div>\\n        </div>\\n\\n        <div class=\\\"body\\\">\\n            <p class=\\\"message\\\">{{- i18n['dialog.overlay.loading'] }}<b class=\\\"percents\\\"></b></p>\\n            <button class=\\\"button action up\\\">\\n                <span class=\\\"wrap\\\">{{- i18n['button.cancel'] }}</span>\\n                <span class=\\\"icon\\\"></span>\\n            </button>\\n        </div>\\n\\n    </div>\\n</div>\";","export default \"<p class='alertText'>\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{- message }}\\n</p>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from './Dialog';\nimport xssUtil from '../../util/xssUtil';\nimport alertDialogTemplate from './template/alertDialogTemplate.htm';\nimport i18n from '../../../i18n/CommonBundle.properties';\nexport default Dialog.extend({\n    contentTemplate: _.template(alertDialogTemplate),\n    constructor: function (options) {\n        options || (options = {});\n        Dialog.prototype.constructor.call(this, {\n            modal: options.modal !== false,\n            message: options.message,\n            additionalCssClasses: 'alertDialog ' + (options.additionalCssClasses || ''),\n            title: options.title || i18n['dialog.exception.title'],\n            id: options.id,\n            titleContainerId: options.titleContainerId,\n            bodyContainerId: options.bodyContainerId,\n            buttons: [{\n                label: i18n['button.close'],\n                action: 'close',\n                primary: true\n            }]\n        }, options);\n    },\n    initialize: function (options) {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.on('button:close', this.close);\n        this.setMessage(options.message);\n    },\n    setMessage: function (message) {\n        message = xssUtil.softHtmlEscape(message, {whiteList: [\"br\"]});\n        this.content = this.contentTemplate({ message: message });\n        var rendered = this.renderContent();\n        this.$contentContainer.html(rendered);\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global alert, confirm*/\n/**\n * Local context initialization.\n */\n\nimport {$ , Template} from 'prototype';\nimport jQuery from 'jquery';\nimport _ from 'underscore';\nimport {\n    isIPad,\n    isWebKitEngine,\n    isSupportsTouch,\n    isRightClick,\n    deepClone\n} from \"../util/utils.common\";\nimport layoutModule from '../core/core.layout';\nimport webHelpModule from '../components/components.webHelp';\nimport orgModule from '../manage/mng.common';\nimport buttonManager from '../core/core.events.bis';\nimport dialogs from '../components/components.dialogs';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport __jrsConfigs__ from 'js-sdk/src/jrs.configs';\nimport AlertDialog from 'js-sdk/src/common/component/dialog/AlertDialog';\nimport i18n from '../i18n/jasperserver_messages.properties';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport ConfirmationDialog from 'js-sdk/src/common/component/dialog/ConfirmationDialog';\nimport domUtil from 'js-sdk/src/common/util/domUtil';\nimport navigateBackUtils from '../navigateBack/utils/navigateBackUtils';\n\n//var localContext = window;\n//////////////////////////\n// Tests for action model\n//////////////////////////\nfunction invokeAction(actionName) {\n    var action = repositorySearch.Action['create' + actionName].call();\n    action.invokeAction();\n}\nfunction invokeFolderAction(actionName, folder, options) {\n    var theFolder = folder ? folder : repositorySearch.model.getContextFolder();\n    var action = repositorySearch.folderActionFactory[actionName](theFolder, options);\n    action.invokeAction();\n}\nfunction invokeResourceAction(actionName, resource, options) {\n    var theResource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    var action = repositorySearch.resourceActionFactory[actionName](theResource, options);\n    action.invokeAction();\n}\nfunction invokeBulkAction(actionName, resourceName, event) {\n    var resources = repositorySearch.model.getSelectedResources();\n    var action = repositorySearch.bulkActionFactory[actionName](resources, event);\n    action.invokeAction();\n}\n\nvar invokeRedirectAction = _.debounce(function (actionName, options) {\n    var action = repositorySearch.RedirectAction['create' + actionName].call();\n    action.invokeAction(options);\n}, 500)\n\nfunction invokeCreate(resourceTypeSuffix, fileType) {\n    var action = repositorySearch.RedirectAction.createCreateResourceAction(resourceTypeSuffix, fileType);\n    action.invokeAction();\n}\nfunction isCopyOrMove() {\n    return repositorySearch.CopyMoveController.isCopy() || repositorySearch.CopyMoveController.isMove();\n}\nfunction isFolderCopyOrMove() {\n    return repositorySearch.CopyMoveController.isCopyFolder() || repositorySearch.CopyMoveController.isMoveFolder();\n}\nfunction isResourceCopyOrMove() {\n    return repositorySearch.CopyMoveController.isCopyResource() || repositorySearch.CopyMoveController.isMoveResource();\n}\nfunction canCreateFolder() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganizationsRoot() && folder.isEditable();\n}\nfunction canFolderBeDeleted() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganization() && !folder.isRoot() && !folder.isPublic() && !folder.isTemp() && !folder.isOrganizationsRoot() && folder.isRemovable() && !folder.isActiveThemeFolder() && !folder.isThemeRootFolder();\n}\nfunction canFolderBeEdited(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    return folder && folder.isEditable();\n}\nfunction canFolderBeCopied(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganization() && !folder.isRoot() && !folder.isOrganizationsRoot() && folder.isReadable();\n}\nfunction canFolderBeCopiedOrMovedToFolder(folder) {\n    var toFolder = folder ? folder : repositorySearch.model.getContextFolder();\n    var canFolderBeCopiedOrMoved = isFolderCopyOrMove() && !toFolder.isOrganizationsRoot() && canFolderBeEdited(toFolder);\n    if (!canFolderBeCopiedOrMoved) {\n        return false;\n    }\n    var theFolder = repositorySearch.CopyMoveController.object;\n    return toFolder.URI !== theFolder.URI;\n}\nfunction canFolderBeMoved(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganization() && !folder.isRoot() && !folder.isPublic() && !folder.isTemp() && !folder.isOrganizationsRoot() && folder.isRemovable() && !folder.isActiveThemeFolder() && !folder.isThemeRootFolder();\n}\nfunction canFolderBeExported(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    var pathElements = folder.URI.split('/');\n    return !((folder.URI === '/' || pathElements[pathElements.length - 1] === 'organizations' || pathElements[pathElements.length - 2] === 'organizations') && pathElements[pathElements.length - 1] !== 'org_template');\n}\nfunction canFolderPermissionsBeAssigned() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isAdministrable();\n}\nfunction canFolderPropertiesBeShowed() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isReadable() && !canFolderPropertiesBeEdited();\n}\nfunction canFolderPropertiesBeEdited() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isEditable() && !folder.isOrganization() && !folder.isOrganizationsRoot() && !folder.isRoot();\n}\nfunction canResourceBeCreated(type) {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && !folder.isOrganization() && !folder.isRoot() && !folder.isOrganizationsRoot() && folder.isEditable();\n}\nfunction canBeRun(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable() && repositorySearch.runActionFactory[resource.typeSuffix()] && !repositorySearch.isflowRedirectRunning;\n}\nfunction canBeGenerated(resource) {\n    return false;\n}\nfunction canBeConverted(resource) {\n    return false;\n}\nfunction canResourceBeEdited(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    var hasEditActionImpl = repositorySearch.editActionFactory[resource.typeSuffix()] || ResourcesUtils.isCustomDataSource(resource);\n    var allowed = resource && resource.isEditable() && hasEditActionImpl;    // Edit menu item is forbidden.\n    // Edit menu item is forbidden.\n    if (['DashboardResource'].include(resource.typeSuffix())) {\n        return false;\n    } else {\n        return allowed;\n    }\n}\nfunction canBeOpenedInDesigner(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isEditable() && repositorySearch.openActionFactory[resource.typeSuffix()] && resource.typeSuffix() !== 'ContentResource';\n}\nfunction canBeOpened(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable() && repositorySearch.openActionFactory[resource.typeSuffix()] && resource.typeSuffix() === 'ContentResource';\n}\nfunction canBeRunInBackground(resource) {\n    return window.canBeScheduled(resource);\n}\nfunction canBeScheduled(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable() && [\n        repositorySearch.ResourceType.REPORT_UNIT,\n        repositorySearch.ResourceType.ADHOC_REPORT_UNIT,\n        repositorySearch.ResourceType.REPORT_OPTIONS\n    ].include(resource.resourceType);\n}\nfunction canResourceBeCopied(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable();\n}\nfunction canResourceBeMoved(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isRemovable();\n}\nfunction canResourceBeDeleted(resource) {\n    resource = repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isRemovable();\n}\nfunction canResourcePropertiesBeShowed() {\n    var resource = repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isReadable() && !resource.isEditable();\n}\nfunction canResourcePropertiesBeEdited(resource) {\n    resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isEditable();\n}\nfunction canResourcePermissionsBeAssigned() {\n    var resource = repositorySearch.model.getSelectedResources()[0];\n    return resource && resource.isAdministrable();\n}\nfunction canAllBeRun() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !window.canBeRun(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllBeEdited() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !window.canResourceBeEdited(resource);\n    });\n    return resources.length > 0 && detected === undefined && !isIPad();\n}\nfunction canAllBeOpened() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !window.canBeOpenedInDesigner(resource) && !window.canBeOpened(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllBeCopied() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !canResourceBeCopied(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllBeMoved() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !canResourceBeMoved(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllBeCopiedOrMovedToFolder(folder) {\n    folder = folder ? folder : repositorySearch.model.getContextFolder();\n    var canAllBeCopiedOrMoved = isResourceCopyOrMove() && !folder.isOrganizationsRoot() && canFolderBeEdited(folder);\n    if (!canAllBeCopiedOrMoved) {\n        return false;\n    }\n    var resources = repositorySearch.CopyMoveController.isBulkAction() ? repositorySearch.CopyMoveController.object : [repositorySearch.CopyMoveController.object];\n    var allow = true;\n    if (folder.isThemeRootFolder() || folder.isThemeFolder()) {\n        var allFiles = resources.detect(function (resource) {\n            return !resource.resourceType.endsWith('.FileResource');\n        }) == null;\n        allow = allFiles;\n    }\n    return allow;\n}\nfunction canAllBePasted() {\n    return canAllBeCopiedOrMovedToFolder(repositorySearch.model.getSelectedFolder());\n}\nfunction canAllPropertiesBeShowed() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function () {\n        return !canResourcePropertiesBeShowed();\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canAllPropertiesBeEdited() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !canResourcePropertiesBeEdited(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction canBeAddedToFavorites() {\n    let resources = repositorySearch.model.getSelectedResources();\n    return resources.every((resource)=>{\n        return !resource.isFavorite;\n    });\n}\nfunction canBeRemovedFromFavorites() {\n    let resources = repositorySearch.model.getSelectedResources();\n    return resources.every((resource)=>{\n        return resource.isFavorite;\n    });\n}\n\nfunction canAllBeDeleted() {\n    var resources = repositorySearch.model.getSelectedResources();\n    var detected = resources.detect(function (resource) {\n        return !canResourceBeDeleted(resource);\n    });\n    return resources.length > 0 && detected === undefined;\n}\nfunction isThemeFolder() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isThemeFolder();\n}\nfunction isNonActiveThemeFolder() {\n    var folder = repositorySearch.model.getContextFolder();\n    return isThemeFolder() && !folder.isActiveThemeFolder();\n}\nfunction isThemeRootFolder() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isThemeRootFolder();\n}\nfunction canThemeBeReuploaded() {\n    var folder = repositorySearch.model.getContextFolder();\n    return folder && folder.isThemeFolder() && canFolderBeEdited(folder);\n}\nfunction isPermissionsChanged() {\n    var permissionDialogs = repositorySearch.dialogsPool.getAllPermissionsDialogs();\n    return permissionDialogs.detect(function (dialog) {\n        return dialog.isChanged();\n    });\n}\nfunction isPropertiesChanged() {\n    var propertyDialogs = repositorySearch.dialogsPool.getAllPropertiesDialogs();\n    return propertyDialogs.detect(function (dialog) {\n        return dialog.isChanged();\n    });\n}    ////////////////////////////\n// Repository search object\n////////////////////////////\n////////////////////////////\n// Repository search object\n////////////////////////////\nvar repositorySearch = {\n    _container: null,\n    mode: null,\n    isFlowRedirectRunning: false,\n    flowExecutionKey: '',\n    messages: [],\n    Mode: {\n        SEARCH: 'search',\n        BROWSE: 'browse',\n        LIBRARY: 'library'\n    },\n    ResourceType: {\n        REPORT_UNIT: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.ReportUnit',\n        ADHOC_REPORT_UNIT: 'com.jaspersoft.ji.adhoc.AdhocReportUnit',\n        OLAP_UNIT: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapUnit',\n        DASHBOARD_RESOURCE: 'com.jaspersoft.ji.adhoc.DashboardResource',\n        DASHBOARD: 'com.jaspersoft.ji.dashboard.DashboardModelResource',\n        REPORT_OPTIONS: 'com.jaspersoft.ji.report.options.metadata.ReportOptions',\n        REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.ReportDataSource',\n        JDBC_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.JdbcReportDataSource',\n        JNDI_JDBC_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.JndiJdbcReportDataSource',\n        VIRTUAL_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.VirtualReportDataSource',\n        CUSTOM_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.CustomReportDataSource',\n        BEAN_REPORT_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.jasperreports.domain.BeanReportDataSource',\n        OLAP_DATA_SOURCE: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapDataSource',\n        OLAP_CLIENT_CONNECTION: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.OlapClientConnection',\n        QUERY: 'com.jaspersoft.jasperserver.api.metadata.common.domain.Query',\n        INPUT_CONTROL: 'com.jaspersoft.jasperserver.api.metadata.common.domain.InputControl',\n        LIST_OF_VALUES: 'com.jaspersoft.jasperserver.api.metadata.common.domain.ListOfValues',\n        LIST_OF_VALUES_ITEM: 'com.jaspersoft.jasperserver.api.metadata.common.domain.ListOfValuesItem',\n        DATA_TYPE: 'com.jaspersoft.jasperserver.api.metadata.common.domain.DataType',\n        MONDRIAN_CONNECTION: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.MondrianConnection',\n        SECURE_MONDRIAN_CONNECTION: 'com.jaspersoft.ji.ja.security.domain.SecureMondrianConnection',\n        XMLA_CONNECTION: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.XMLAConnection',\n        MONDRIAN_XMLA_DEFINITION: 'com.jaspersoft.jasperserver.api.metadata.olap.domain.MondrianXMLADefinition',\n        CONTENT_RESOURCE: 'com.jaspersoft.jasperserver.api.metadata.common.domain.ContentResource',\n        FILE_RESOURCE: 'com.jaspersoft.jasperserver.api.metadata.common.domain.FileResource',\n        SEMANTIC_LAYER_DATA_SOURCE: 'com.jaspersoft.commons.semantic.datasource.SemanticLayerDataSource',\n        DATA_DEFINER_UNIT: 'com.jaspersoft.commons.semantic.DataDefinerUnit'\n    },\n    SearchAction: {\n        NEXT: 'next',\n        GET_RESOURCE_CHILDREN: 'getResourceChildren'\n    },\n    Event: {\n        SEARCH_RUN: 'search:run',\n        SEARCH_BROWSE: 'search:browse',\n        SEARCH_FILTER: 'search:filter',\n        SEARCH_SORT: 'search:sort',\n        SEARCH_NEXT: 'search:next',\n        SEARCH_ROLLBACK: 'search:rollback',\n        SEARCH_SEARCH: 'search:search',\n        SEARCH_CHILDREN: 'search:children',\n        STATE_CHANGED: 'state:changed',\n        FILTER_PATH_CHANGED: 'filterPath:changed',\n        RESULT_CHANGED: 'result:changed',\n        CHILDREN_LOADED: 'resourceChildren:loaded',\n        RESULT_NEXT: 'result:next',\n        RESULT_ERROR: 'result:error',\n        REDIRECT_ERROR: 'redirect:error',\n        FLOW_REDIRECT_RUNNING: 'flowRedirect:running'\n    },\n    InfoAction: { GET_DISPLAY_PATH: 'getDisplayPath' },\n    PermissionAction: {\n        BROWSE: 'permissionBrowse',\n        SEARCH: 'permissionSearch',\n        NEXT: 'permissionNext',\n        UPDATE: 'permissionsUpdate'\n    },\n    PermissionEvent: {\n        BROWSE: 'permission:browse',\n        SEARCH: 'permission:search',\n        NEXT: 'permission:next',\n        UPDATE: 'permission:update',\n        LOADED: 'permission:loaded',\n        UPDATED: 'permission:updated',\n        ERROR: 'permission:error'\n    },\n    FolderAction: {\n        CREATE: 'createFolder',\n        COPY: 'copyFolder',\n        MOVE: 'moveFolder',\n        UPDATE: 'updateFolder',\n        DELETE: 'deleteFolder'\n    },\n    FolderEvent: {\n        DELETED: 'folder:deleted',\n        DELETE_ERROR: 'folder:deleteError',\n        CREATED: 'folder:created',\n        CREATE_ERROR: 'folder:createError',\n        COPIED: 'folder:copied',\n        COPY_ERROR: 'folder:copyError',\n        MOVED: 'folder:moved',\n        MOVE_ERROR: 'folder:moveError',\n        UPDATED: 'folder:updated',\n        UPDATE_ERROR: 'folder:updateError'\n    },\n    ResourceAction: {\n        DELETE: 'deleteResources',\n        COPY: 'copyResources',\n        MOVE: 'moveResources',\n        UPDATE: 'updateResource',\n        GENERATE: 'generate',\n        CONVERT: 'convert'\n    },\n    ResourceEvent: {\n        DELETED: 'resource:deleted',\n        DELETE_ERROR: 'resource:deleteError',\n        COPIED: 'resource:copied',\n        COPY_ERROR: 'resource:copyError',\n        MOVED: 'resource:moved',\n        MOVE_ERROR: 'resource:moveError',\n        UPDATED: 'resource:updated',\n        UPDATE_ERROR: 'resource:updateError',\n        GENERATED: 'resource:generated',\n        GENERATE_ERROR: 'resource:generateError',\n        CONVERTED: 'resource:converted',\n        CONVERT_ERROR: 'resource:convertError'\n    },\n    RedirectType: {\n        FLOW_REDIRECT: 0,\n        LOCATION_REDIRECT: 1,\n        WINDOW_REDIRECT: 2\n    },\n    ThemeAction: {\n        SETTHEME: 'setActiveTheme',\n        DOWNLOAD_THEME: 'downloadTheme',\n        REUPLOAD: 'reuploadTheme'\n    },\n    ThemeEvent: {\n        UPDATED: 'theme:updated',\n        REUPLOADED: 'theme:reuploaded',\n        THEME_ERROR: 'theme:error'\n    },\n    ResourcesFavoriteAction: {\n        FILTER_ID: 'favoriteFilter',\n        ALL_RESOURCES: 'favoriteFilter-all',\n        FAVORITE_RESOURCES: 'favoriteFilter-favorites'\n    },\n    initialize: function (localContext) {\n        var options = localContext.rsInitOptions;\n        repositorySearch.mode = options.mode;\n        repositorySearch.flowExecutionKey = options.flowExecutionKey;\n        layoutModule.resizeOnClient(document.body.id == 'repoSearch' ? 'searchFilters' : 'folders', 'results');\n        webHelpModule.setCurrentContext(repositorySearch.mode === repositorySearch.Mode.SEARCH ? 'search' : 'repo');\n        options.enableDnD = repositorySearch.mode == repositorySearch.Mode.BROWSE && !isIPad();\n        repositorySearch.model.setPublicFolderUri(options.publicFolderUri);\n        repositorySearch.model.setTempFolderUri(options.tempFolderUri);\n        repositorySearch.model.setRootFolderUri(options.rootFolderUri);\n        repositorySearch.model.setOrganizationsFolderUri(options.organizationsFolderUri);\n        repositorySearch.model.setFolderSeparator(options.folderSeparator);\n        repositorySearch.model.setAdministrator(options.isAdministrator);\n        repositorySearch.model.setConfiguration(options.configuration);\n        repositorySearch.model.setServerState(options.state);\n        repositorySearch.CursorManager.initialize();\n        repositorySearch.actionModel.initialize();\n        this.navigateToResourcePage();\n\n        if (repositorySearch.mode == repositorySearch.Mode.BROWSE) {\n            repositorySearch.toolbar.initialize(repositorySearch.actionModel.bulkActions);\n            repositorySearch.foldersPanel.initialize(options);\n        } else {\n            repositorySearch.filtersPanel.initialize(repositorySearch.model.getFiltersConfiguration(), repositorySearch.model.getFiltersState());\n            repositorySearch.secondarySearchBox.initialize(repositorySearch.model.getTextState());\n            repositorySearch.filterPath.initialize();\n        }\n        repositorySearch.resultsPanel.initialize(options);\n        if(repositorySearch.mode === repositorySearch.Mode.LIBRARY){\n            repositorySearch.favoriteSwitchControl.initialize(options);\n        }\n        repositorySearch.sortersPanel.initialize(repositorySearch.model.getSortersConfiguration(), repositorySearch.model.getSortState());\n        repositorySearch.initFolderEvents();\n        repositorySearch.initResourceEvents();\n        repositorySearch.initThemeEvents();\n        repositorySearch.observe('search:filter', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('filter', {\n                filterId: event.memo.filterId,\n                filterOption: event.memo.optionId\n            });\n            action.invokeAction();\n        });\n        repositorySearch.observe('search:sort', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('sort', { sortBy: event.memo.sorterId });\n            action.invokeAction();\n        });\n        repositorySearch.observe('search:browse', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('browse', { folderUri: event.memo.uri });\n            action.invokeAction();\n            repositorySearch.actionModel.refreshToolbar();\n        });\n        repositorySearch.observe('search:search', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('search', { text: event.memo.text });\n            action.invokeAction();\n        });\n        repositorySearch.observe('search:next', function (event) {\n            var action = new this.ServerAction.createSearchAction(this.SearchAction.NEXT, {});\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('search:rollback', function (event) {\n            var action = new repositorySearch.ServerAction.createSearchAction('rollback', { position: event.memo.position });\n            action.invokeAction();\n        });\n        repositorySearch.observe('search:children', function (event) {\n            var resource = event.memo.resource;\n            var item = event.memo.item;\n            var action = new this.ServerAction.createSearchAction(this.SearchAction.GET_RESOURCE_CHILDREN, {\n                resourceUri: resource.URIString,\n                resourceType: resource.resourceType,\n                item: item\n            });\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:browse', function (event) {\n            var action = new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.BROWSE, event.memo);\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:search', function (event) {\n            var action = new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.SEARCH, event.memo);\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:next', function (event) {\n            var action = new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.NEXT, event.memo);\n            action.invokeAction();\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:update', function (event) {\n            var uri = event.memo.uri;\n            var entities = event.memo.entities;\n            var finishEdit = event.memo.finishEdit;\n            if (entities.length > 0) {\n                var data = entities.collect(function (entity) {\n                    return entity.toPermissionData();\n                });\n                var action = new repositorySearch.ServerAction.createPermissionAction(this.PermissionAction.UPDATE, {\n                    uri: uri,\n                    entitiesWithPermission: Object.toJSON(data),\n                    finishEdit: finishEdit\n                });\n                action.invokeAction();\n            } else {\n                var dialog = repositorySearch.dialogsPool.getPermissionsDialog(uri);\n                finishEdit && dialog.hide();\n            }\n        }.bindAsEventListener(repositorySearch));\n        function jsonToEntities(entities, type) {\n            if (entities) {\n                var clazz = type == 'USER' ? orgModule.User : orgModule.Role;\n                return entities.collect(function (entity) {\n                    return new clazz(entity);\n                });\n            } else {\n                return [];\n            }\n        }\n        repositorySearch.observe('permission:loaded', function (event) {\n            var data = event.memo.responseData;\n            var dialog = repositorySearch.dialogsPool.getPermissionsDialog(event.memo.inputData.uri);\n            dialog.stopWaiting();\n            if (data) {\n                if (event.memo.doSet) {\n                    dialog.setEntities(jsonToEntities(data.entities, data.type));\n                } else {\n                    dialog.addEntities(jsonToEntities(data.entities, data.type));\n                }\n                if (data.type === 'USER') {\n                    buttonManager.select(dialog._byUsersButton.parentNode);\n                    buttonManager.unSelect(dialog._byRolesButton.parentNode);\n                } else {\n                    buttonManager.unSelect(dialog._byUsersButton.parentNode);\n                    buttonManager.select(dialog._byRolesButton.parentNode);\n                }\n            }\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:updated', function (event) {\n            var uri = event.memo.inputData.uri;\n            var finishEdit = event.memo.inputData.finishEdit;\n            var dialog = repositorySearch.dialogsPool.getPermissionsDialog(uri);\n            dialog.enable();\n            if (finishEdit) {\n                dialog.hide();\n            } else {\n                var data = event.memo.responseData;\n                data && dialog.updateEntities(jsonToEntities(data.entities, data.type));\n            }\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('permission:error', function (event) {\n            alert(Object.toJSON(event.memo));\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('resourceChildren:loaded', function (event) {\n            var item = event.memo.inputData.item;\n            var resource = item.getValue();\n            var data = event.memo.responseData;\n            if (Object.isArray(data)) {\n                var resources = [];\n                data.each(function (rJson) {\n                    var r = new Resource(rJson);\n                    resource.addChild(r);\n                    resources.push(r);\n                });\n                repositorySearch.resultsPanel.setResources(resources, item);\n                if (resource.isLoaded() && item.isLoading) {\n                    item.setLoading(false);\n                }\n                if (jQuery(item._getElement()).hasClass('cursor')){\n                    jQuery('.subfocus').removeClass('subfocus');\n                    jQuery(item._getElement()).addClass('subfocus').addClass('focus-visible');\n                }\n            }\n        }.bindAsEventListener(repositorySearch));\n        repositorySearch.observe('state:changed', function (event) {\n            repositorySearch.sortersPanel.enableItems();\n            repositorySearch.updateUI(event.memo.state);\n        });\n        repositorySearch.observe('filterPath:changed', function (event) {\n            repositorySearch.filterPath.setPathItems(event.memo.filterPath);\n        });\n        repositorySearch.observe('result:changed', function (event) {\n            var data = event.memo.resources;\n            var resources = data.collect(function (rData) {\n                return new Resource(rData);\n            });\n            repositorySearch.resultsPanel.setResources(resources);\n\n            var list = repositorySearch.resultsPanel.getList(),\n                items = list.getItems();\n\n            list.setCursor(items[0]);\n        });\n        repositorySearch.observe('result:next', function (event) {\n            var data = event.memo.resources;\n            var resources = data.collect(function (rData) {\n                return new Resource(rData);\n            });\n            repositorySearch.resultsPanel.addResources(resources);\n        });\n        repositorySearch.observe('result:error', this.defaultErrorHandler);\n        repositorySearch.observe('redirect:error', this.defaultErrorHandler);\n        repositorySearch.observe('flowRedirect:running', function () {\n            repositorySearch.isflowRedirectRunning = true;\n            repositorySearch.toolbar.refresh();\n        });    // First call\n        // First call\n        if (repositorySearch.Mode.BROWSE != options.mode) {\n            repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH, { text: repositorySearch.model.getTextState() });\n        }\n        if (!localContext.rsInitOptions.systemConfirm.blank()) {\n            dialogs.systemConfirm.show(localContext.rsInitOptions.systemConfirm);\n        }    //Show popup dialog if error message present\n        //Show popup dialog if error message present\n        if (!localContext.rsInitOptions.errorPopupMessage.blank()) {\n            dialogs.errorPopup.show(localContext.rsInitOptions.errorPopupMessage);\n        }\n        this._disableBfCacheIfSafari();\n    },\n    navigateToResourcePage: function(){\n        let mode= repositorySearch.mode;\n        if(mode && history.length > 1) {\n            let locObj = window.primaryNavModule.navigationPaths[mode],\n                queryParams = window.primaryNavModule.navigationPaths[mode].params;\n            queryParams = queryParams ? '?' + queryParams : '';\n\n            const destination = __jrsConfigs__.urlContext + '/' + locObj.url + queryParams;\n            navigateBackUtils.setLocation(destination);\n        }\n    },\n    showContextMenu: function (e) {\n        var event = e.memo.targetEvent;\n        if (repositorySearch.mode === repositorySearch.Mode.BROWSE) {\n            if (repositorySearch.foldersPanel.isFolderContextMenu(event)) {\n                const label = jQuery(e.memo.targetEvent?.target).closest('li').find('p').text().trim();\n                repositorySearch.actionModel.showFolderMenu(event, undefined, label);\n            }\n        }\n        if (repositorySearch.resultsPanel.isResourceContextMenu(event)) {\n            var resources = repositorySearch.model.getSelectedResources();\n            if (resources.length > 1) {\n                repositorySearch.actionModel.showResourceBulkMenu(event);\n            } else {\n                repositorySearch.actionModel.showResourceMenu(event);\n            }\n        }\n    },\n    _disableBfCacheIfSafari: function () {\n        if (isWebKitEngine()) {\n            domUtil.disableBackForwordCache();\n        }\n    },\n    updateUI: function (state) {\n        // Check sort state.\n        if (state.sortBy != repositorySearch.model.getSortState()) {\n            jQuery(repositorySearch.sortersPanel).find(state.sortBy, true)[0];\n        }    // Check text state.\n        // Check text state.\n        if (state.text != repositorySearch.model.getTextState()) {\n            if (repositorySearch.mode != repositorySearch.Mode.BROWSE) {\n                repositorySearch.secondarySearchBox.setText(state.text);\n            }\n        }    // Check filters states.\n        // Check filters states.\n        for (var filterId in state.customFilters) {\n            if (state.customFilters[filterId] != repositorySearch.model.getFiltersState()[filterId]) {\n                jQuery(repositorySearch.filtersPanel).find(filterId, state.customFilters[filterId], true)[0];\n            }\n        }\n        // TODO: select folder\n        repositorySearch.model.setServerState(state);\n    },\n    initFolderEvents: function () {\n        this.observe('folder:deleted', function (event) {\n            var folder = event.memo.inputData.folder;\n            var parentFolder = folder.getParentFolder();\n            var foldersPanel = repositorySearch.foldersPanel;\n            foldersPanel.refreshFolder(parentFolder);\n            if (parentFolder.URI === '/') {\n                //force root folder selection\n                foldersPanel.tree._selectOrEditNode(undefined, parentFolder.node, false);\n            }\n        });\n        this.observe('folder:deleteError', this.defaultErrorHandler);\n        this.observe('folder:created', function (event) {\n            var toFolder = event.memo.inputData.toFolder;\n            var targetFolder = event.memo.responseData;\n            repositorySearch.foldersPanel.createAndSelectFolder(targetFolder, toFolder);\n        });\n        this.observe('folder:createError', this.defaultErrorHandler);\n        this.observe('folder:copied', function (event) {\n            var folder = event.memo.inputData.folder;\n            var toFolder = event.memo.inputData.toFolder;\n            repositorySearch.CopyMoveController.cancel();\n            repositorySearch.foldersPanel.moveOrCopyFolder(folder, toFolder, true);\n        });\n        this.observe('folder:copyError', this.defaultErrorHandler);\n        this.observe('folder:moved', function (event) {\n            var folder = event.memo.inputData.folder;\n            var toFolder = event.memo.inputData.toFolder;\n            repositorySearch.CopyMoveController.cancel();\n            repositorySearch.foldersPanel.moveOrCopyFolder(folder, toFolder);\n        });\n        this.observe('folder:moveError', this.defaultErrorHandler);\n        this.observe('folder:updated', function (event) {\n            var folder = event.memo.inputData.folder;\n            var label = event.memo.responseData.label;\n            var desc = event.memo.responseData.desc;\n            repositorySearch.foldersPanel.updateFolder(folder, label, desc);\n        });\n        this.observe('folder:updateError', this.defaultErrorHandler);\n    },\n    initResourceEvents: function () {\n        this.observe('resource:deleted', function (event) {\n            var resources = event.memo.inputData.resources;\n            var response = event.memo.responseData;\n            if (response.dependentResources) {\n                dialogs.dependentResources.show(response.dependentResources, null, {\n                    okOnly: true,\n                    canSave: false,\n                    topMessage: repositorySearch.messages['dialog.dependencies.resources.message'],\n                    bottomMessage: repositorySearch.messages['dialog.dependencies.resources.deleteMessage']\n                });\n            } else {\n                repositorySearch.resultsPanel.removeResources(resources);\n            }\n        });\n        this.observe('resource:deleteError', this.defaultErrorHandler);\n        this.observe('resource:copied', function (event) {\n            var folder = event.memo.inputData.folder;\n            repositorySearch.foldersPanel.reselectFolder(folder);\n        });\n        this.observe('resource:copyError', this.defaultErrorHandler);\n        this.observe('resource:moved', function (event) {\n            var toFolder = event.memo.inputData.folder;\n            var selectedFolder = repositorySearch.model.getSelectedFolder();\n            repositorySearch.foldersPanel.reselectFolder(toFolder);\n            repositorySearch.foldersPanel.reselectFolder(selectedFolder);\n        });\n        this.observe('resource:moveError', this.defaultErrorHandler);\n        this.observe('resource:updated', function (event) {\n            repositorySearch.resultsPanel.updateResource(new Resource(event.memo.responseData));\n        });\n        this.observe('resource:updateError', this.defaultErrorHandler);\n        this.observe('resource:generated', function (event) {\n            var inputData = event.memo.inputData;\n            var data = event.memo.responseData;\n            var resource = new Resource(data);\n            if (inputData.run) {\n                var action = repositorySearch.RedirectAction.createRunResourceAction(resource, false);\n                action.invokeAction();\n            } else {\n                if (repositorySearch.mode == repositorySearch.Mode.BROWSE) {\n                    if (inputData.location == repositorySearch.foldersPanel.getSelectedUri()) {\n                        repositorySearch.foldersPanel.doBrowse();\n                    }\n                } else {\n                    repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH, { text: repositorySearch.model.getTextState() });\n                }\n            }\n            dialogs.systemConfirm.show(repositorySearch.messages['RM_REPORT_CREATED'], 5000);\n        });\n        this.observe('resource:generateError', function (event) {\n            var error = event.memo.responseData;\n            var msg = error.msg;\n            var data = error.data;\n            var action;\n            if(msg && msg.indexOf(\"SYSTEM_CONFIRM_REQUIRED\") > -1) {\n                if (data) {\n                    var dialog = new ConfirmationDialog({text: Utils.restOfString(msg, \"SYSTEM_CONFIRM_REQUIRED:\")});\n                    dialog.on(\"button:yes\", function(){\n                        data.overwrite = true;\n\n                        var name = repositorySearch.ResourceAction.GENERATE;\n                        action = new repositorySearch.ServerAction.createGenerateAction(name, data);\n                        action.invokeAction();\n                        dialog.remove();\n                    });\n                    dialog.on(\"button:no\", function(){\n                        dialog.remove();\n                    });\n                    dialog.open();\n                }\n            } else {\n                repositorySearch.defaultErrorHandler(event);\n            }\n        });\n        this.observe('resource:converted', function (event) {\n            dialogs.systemConfirm.show(event.memo.responseData || event.memo, 5000);\n            if (repositorySearch.mode == repositorySearch.Mode.BROWSE) {\n                repositorySearch.foldersPanel.doBrowse();\n            } else {\n                repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH, { text: repositorySearch.model.getTextState() });\n            }\n        });\n        this.observe('resource:convertError', this.defaultErrorHandler);\n    },\n    defaultErrorHandler: function (event) {\n        this.errorDialog && this.errorDialog.remove();\n        this.errorDialog = new AlertDialog({ title: i18n['dialog.dependencies.title'], id: 'dependenciesDialogId', titleContainerId: 'dependenciesDialogTitle', bodyContainerId: 'dependenciesDialogBody' });\n        this.errorDialog.setMessage(event.memo.responseData || event.memo);\n        this.errorDialog.open();\n\n        repositorySearch.sortersPanel.enableItems();\n    },\n    initThemeEvents: function () {\n        this.observe('theme:updated', function (event) {\n            var data = event.memo.responseData;\n            if (data && data.refresh) {\n                document.body.style.cursor = 'wait';\n                window.location.reload(true);\n            } else {\n                var folder = repositorySearch && repositorySearch.model && repositorySearch.model.getContextFolder() && repositorySearch.model.getContextFolder().getParentFolder();\n                if (folder && repositorySearch.foldersPanel && repositorySearch.foldersPanel.refreshFolder) {\n                    repositorySearch.foldersPanel.refreshFolder(folder);\n                }\n            }\n        });\n        this.observe('theme:reuploaded', function (event) {\n            if (event.memo.responseData.isActiveTheme) {\n                var uri = event.memo.responseData.themeUri;\n                var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME, { folderUri: uri });\n                action.invokeAction();\n            }\n        });\n        this.observe('theme:error', function (event) {\n            var data = event.memo.responseData;\n            if (data) {\n                alert(data);\n            }\n        });\n    },\n    getMessage: function (messageId, object) {\n        var message = repositorySearch.messages[messageId];\n        return message ? new Template(message).evaluate(object ? object : {}) : '';\n    },\n    /**\n     * TODO: add comment.\n     *\n     * @param action\n     */\n    _createAction: function (actionFactory, actionName) {\n        var action;\n        if (actionName.endsWith('FolderAction')) {\n            var folder = repositorySearch.model.getContextFolder();\n            action = actionFactory['create' + actionName].call(null, folder);\n        } else if (actionName.endsWith('ResourceAction') || actionName.endsWith('RunAction')) {\n            var resource = repositorySearch.model.getContextResource();\n            action = actionFactory['create' + actionName].call(null, resource);\n        } else {\n            action = actionFactory['create' + actionName].call();\n        }\n        return action;\n    },\n    observe: function (eventName, handler) {\n        this._getContainer().observe(eventName, handler);\n    },\n    stopObserving: function (eventName, handler) {\n        this._getContainer().stopObserving(eventName, handler);\n    },\n    fire: function (eventName, memo) {\n        this._getContainer().fire(eventName, memo);\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = document.body;\n        }\n        return this._container;\n    }\n};    //////////////////////////////////\n// Repository search model object\n//////////////////////////////////\n//////////////////////////////////\n// Repository search model object\n//////////////////////////////////\nrepositorySearch.model = {\n    _organizationsFolderUri: null,\n    _rootFolderUri: null,\n    _tempFolderUri: null,\n    _publicFolderUri: null,\n    _folderSeparator: null,\n    _configuration: {},\n    _serverState: {},\n    _uiState: {\n        selectedFolder: null,\n        contextFolder: null,\n        contextResource: null,\n        selectedResources: []\n    },\n    _isAdministrator: false,\n    setOrganizationsFolderUri: function (uri) {\n        this._organizationsFolderUri = uri;\n    },\n    getOrganizationsFolderUri: function () {\n        return this._organizationsFolderUri;\n    },\n    setRootFolderUri: function (uri) {\n        this._rootFolderUri = uri;\n    },\n    getRootFolderUri: function () {\n        return this._rootFolderUri;\n    },\n    setTempFolderUri: function (uri) {\n        this._tempFolderUri = uri;\n    },\n    getTempFolderUri: function () {\n        return this._tempFolderUri;\n    },\n    setPublicFolderUri: function (uri) {\n        this._publicFolderUri = uri;\n    },\n    getPublicFolderUri: function () {\n        return this._publicFolderUri;\n    },\n    setFolderSeparator: function (folderSeparator) {\n        this._folderSeparator = folderSeparator;\n    },\n    getFolderSeparator: function () {\n        return this._folderSeparator;\n    },\n    setConfiguration: function (configuration) {\n        this._configuration = configuration;\n    },\n    /**\n     * Gets configuration of the repository search.\n     */\n    getConfiguration: function () {\n        return this._configuration;\n    },\n    /**\n     * Gets configuration of filters\n     */\n    getFiltersConfiguration: function () {\n        return this.getConfiguration().filters;\n    },\n    /**\n     * Gets configuration of sorters.\n     */\n    getSortersConfiguration: function () {\n        return this.getConfiguration().sorters;\n    },\n    setServerState: function (state) {\n        this._serverState = state;\n    },\n    /**\n     * Gets Server state of the repository search.\n     */\n    getServerState: function () {\n        return this._serverState;\n    },\n    /**\n     * Gets UI state of the repository search.\n     */\n    getUIState: function () {\n        return this._uiState;\n    },\n    setAdministrator: function (isAdministrator) {\n        this._isAdministrator = isAdministrator;\n    },\n    isAdministrator: function () {\n        return this._isAdministrator;\n    },\n    /**\n     * Gets state of filters.\n     */\n    getFiltersState: function () {\n        return this.getServerState().customFilters;\n    },\n    /**\n     * Gets state of sorters.\n     */\n    getSortState: function () {\n        return this.getServerState().sortBy;\n    },\n    /**\n     * Gets state of text.\n     */\n    getTextState: function () {\n        return this.getServerState().text;\n    },\n    /**\n     * Gets state of folderUri.\n     */\n    getFolderUriState: function () {\n        return this.getServerState().folderUri;\n    },\n    setSelectedFolder: function (folder) {\n        this.getUIState().selectedFolder = folder;\n\n        return folder;\n    },\n    getSelectedFolder: function () {\n        return this.getUIState().selectedFolder;\n    },\n    setContextFolder: function (folder) {\n        this.getUIState().contextFolder = folder;\n\n        return folder;\n    },\n    getContextFolder: function () {\n        return this.getUIState().contextFolder;\n    },\n    setSelectedResources: function (resources) {\n        this.getUIState().selectedResources = resources;\n\n        return resources;\n    },\n    getSelectedResources: function () {\n        return this.getUIState().selectedResources;\n    }\n};    /////////////////////////////////////////\n// Repository search action model object\n/////////////////////////////////////////\n/////////////////////////////////////////\n// Repository search action model object\n/////////////////////////////////////////\nrepositorySearch.actionModel = {\n    bulkActions: {\n        RUN: {\n            buttonId: 'run',\n            action: invokeBulkAction,\n            actionArgs: 'Run',\n            test: canAllBeRun\n        },\n        EDIT: {\n            buttonId: 'edit',\n            action: invokeBulkAction,\n            actionArgs: 'Edit',\n            test: canAllBeEdited\n        },\n        OPEN: {\n            buttonId: 'open',\n            action: invokeBulkAction,\n            actionArgs: 'Open',\n            test: canAllBeOpened\n        },\n        COPY: {\n            buttonId: 'copy',\n            action: invokeBulkAction,\n            actionArgs: 'Copy',\n            test: canAllBeCopied\n        },\n        CUT: {\n            buttonId: 'cut',\n            action: invokeBulkAction,\n            actionArgs: 'Move',\n            test: canAllBeMoved\n        },\n        PASTE: {\n            buttonId: 'paste',\n            action: invokeFolderAction,\n            actionArgs: 'PasteResources',\n            test: canAllBePasted\n        },\n        REMOVE: {\n            buttonId: 'remove',\n            action: invokeBulkAction,\n            actionArgs: 'Delete',\n            test: canAllBeDeleted\n        }\n    },\n    _holderId: 'searchActionModel',\n    _folderMenu: 'folder_mutton',\n    _resourceMenu: 'resource_menu',\n    _resourceBulkMenu: 'resource_bulk_menu',\n    initialize: function () {\n        var page = jQuery('#' + layoutModule.PAGE_BODY_ID)[0];\n        page && page.observe(isSupportsTouch() ? 'touchstart' : 'click', function (event) {\n            if (isIPad()) {\n                !isRightClick(event) && event.touches.length == 1 && actionModel.hideMenu();\n            } else {\n                !isRightClick(event) && actionModel.hideMenu();\n            }\n        });    //var treeContainer = ($(repositorySearch.foldersPanel.getTreeId()).parent());\n        //treeContainer.observe('scroll', function(event) {!isRightClick(event) && actionModel.hideMenu()});\n    },\n    showFolderMenu: function (event, coordinates, label) {\n        actionModel.showDynamicMenu(this._folderMenu, event, null, coordinates, this._holderId, undefined, label);\n    },\n    showResourceBulkMenu: function (event, coordinates) {\n        actionModel.showDynamicMenu(this._resourceBulkMenu, event, null, coordinates, this._holderId);\n    },\n    showResourceMenu: function (event, coordinates) {\n        actionModel.showDynamicMenu(this._resourceMenu, event, null, coordinates, this._holderId);\n    },\n    refreshToolbar: function (event) {\n        repositorySearch.toolbar.refresh();\n    }\n};\nrepositorySearch.CopyMoveController = {\n    object: null,\n    _move: false,\n    _copy: false,\n    _dndMode: false,\n    onMove: function () {\n        repositorySearch.CursorManager.move();\n        repositorySearch.actionModel.refreshToolbar();\n    },\n    onCopy: function () {\n        repositorySearch.CursorManager.copy();\n        repositorySearch.actionModel.refreshToolbar();\n    },\n    onCancel: function () {\n        repositorySearch.CursorManager.none();\n        repositorySearch.actionModel.refreshToolbar();\n    },\n    isObjectInstanceOf: function (type) {\n        var object = this.object;\n        if (!object) {\n            return false;\n        }\n        if (this.isBulkAction()) {\n            return object.length == object.findAll(function (o) {\n                return o instanceof type;\n            }).length;\n        } else {\n            return object instanceof type;\n        }\n    },\n    isMoveResource: function () {\n        return this._move && this.isObjectInstanceOf(Resource);\n    },\n    isMoveFolder: function () {\n        return this._move && this.isObjectInstanceOf(Folder);\n    },\n    isCopyResource: function () {\n        return this._copy && this.isObjectInstanceOf(Resource);\n    },\n    isCopyFolder: function () {\n        return this._copy && this.isObjectInstanceOf(Folder);\n    },\n    isBulkAction: function () {\n        return Object.isArray(this.object);\n    },\n    move: function (object, isDnD) {\n        this.cancel();\n        this.object = object;\n        this._move = true;\n        this._copy = false;\n        this._dndMode = isDnD;\n        this.onMove();\n    },\n    copy: function (object, isDnD) {\n        this.cancel();\n        this.object = object;\n        this._move = false;\n        this._copy = true;\n        this._dndMode = isDnD;\n        this.onCopy();\n    },\n    cancel: function () {\n        this.object = null;\n        this._move = false;\n        this._copy = false;\n        this.onCancel();\n    },\n    //    dnd: function(dndMode) {\n    //        this._dndMode = dndMode;\n    //    },\n    //\n    isMove: function () {\n        return this._move;\n    },\n    isCopy: function () {\n        return this._copy;\n    },\n    isDnd: function () {\n        return this._dndMode;\n    }\n};\nrepositorySearch.CursorManager = {\n    container: null,\n    className: [\n        'copy_cursor',\n        'move_cursor'\n    ],\n    initialize: function () {\n        this.container = jQuery('#display')[0];\n    },\n    copy: function () {\n        this.none();\n        jQuery(this.container).addClass(this.className[0]);\n    },\n    move: function () {\n        this.none();\n        jQuery(this.container).addClass(this.className[1]);\n    },\n    none: function () {\n        this.className.each(function (name, index) {\n            jQuery(this.container).removeClass(this.className[index]);\n        }.bind(this));\n    }\n};    /////////////////////////////////////////\n// Repository search resource object\n/////////////////////////////////////////\n/////////////////////////////////////////\n// Repository search resource object\n/////////////////////////////////////////\nvar Resource = function (json) {\n    this._json = json;\n    this.name = json.name;\n    this.label = json.label;\n    this.description = json.description;\n    this.date = json.date;\n    this.dateTimestamp = json.dateTimestamp;\n    this.dateTime = json.dateTime;\n    this.updateDate = json.updateDate;\n    this.updateDateTimestamp = json.updateDateTimestamp;\n    this.updateDateTime = json.updateDateTime;\n    this.URI = json.URI;\n    this.URIString = json.URIString;\n    this.parentUri = json.parentUri;\n    this.parentFolder = json.parentFolder;\n    this.resourceType = json.resourceType;\n    this.type = json.type;\n    if (json.fileType) {\n        this.fileType = json.fileType;\n    }\n    this.isScheduled = json.scheduled;\n    this.isFavorite = json.favorite;\n    this._permissions = json.permissions;\n    this.hasChildren = json.hasChildren;\n    this.isChild = false;\n    this.parentResource = null;\n    this.isOpen = false;\n    this._children = [];\n};\nResource.addMethod('clone', function () {\n    return new Resource(this._json);\n});\nResource.addMethod('isReadable', function () {\n    return this._permissions.include('r');\n});\nResource.addMethod('isEditable', function () {\n    return this._permissions.include('e');\n});\nResource.addMethod('isRemovable', function () {\n    return this._permissions.include('d');\n});\nResource.addMethod('isAdministrable', function () {\n    return this._permissions.include('a');\n});\nResource.addMethod('typeEquals', function (type) {\n    return this.resourceType === type;\n});\nResource.addMethod('typeSuffix', function () {\n    return this.resourceType.split('.').last();\n});\nResource.addMethod('isLoaded', function () {\n    return this._children.size() > 0;\n});\nResource.addMethod('isFolder', function () {\n    return false;\n});\nResource.addMethod('getChildren', function (resource) {\n    return this._children;\n});\nResource.addMethod('addChild', function (resource) {\n    resource.isChild = true;\n    resource.parentResource = this;\n    this._children.push(resource);\n});\nResource.addMethod('updateChild', function (resource) {\n    resource.isChild = true;\n    resource.parentResource = this;\n    var childIndex = -1;\n    this._children.each(function (child, index) {\n        if (child.URIString == resource.URIString) {\n            childIndex = index;\n        }\n    });\n    if (childIndex > -1) {\n        this._children[childIndex] = resource;\n    } else {\n        this._children.push(resource);\n    }\n});\nResource.addMethod('permissionsToString', function () {\n    var result = '';\n    if (this.isEditable()) {\n        result += repositorySearch.messages['permission.modify'];\n    } else {\n        result += repositorySearch.messages['permission.readOnly'];\n    }\n    if (this.isRemovable()) {\n        result += ', ' + repositorySearch.messages['permission.delete'];\n    }\n    if (this.isAdministrable()) {\n        result += ', ' + repositorySearch.messages['permission.administer'];\n    }\n    return result;\n});    /////////////////////////////////////////\n// Repository search folder object\n/////////////////////////////////////////\n/////////////////////////////////////////\n// Repository search folder object\n/////////////////////////////////////////\nvar Folder = function (node) {\n    this.node = node;\n    this.name = node.param.id;\n    this.label = xssUtil.unescape(node.name);\n    this.desc = node.param.extra.desc ? xssUtil.unescape(node.param.extra.desc) : '';\n    this.description = xssUtil.unescape(this.desc);\n    this.date = node.param.extra.date ? xssUtil.unescape(node.param.extra.date) : '';\n    this.URI = node.param.uri;\n    this.URIString = node.param.uri;\n};\nFolder.prototype = deepClone(Resource.prototype);\nFolder.addMethod('clone', function () {\n    return new Folder(this.node);\n});\nFolder.addMethod('getParentFolder', function () {\n    return this.isRoot() ? null : new Folder(this.node.parent);\n});\nFolder.addMethod('getReadableUri', function () {\n    if (this.isRoot()) {\n        return '';\n    }\n    return this.getParentFolder().getReadableUri() + repositorySearch.model.getFolderSeparator() + this.label;\n});\nFolder.addMethod('isRoot', function () {\n    return this.URI == repositorySearch.model.getRootFolderUri() || this.node.parent == null;\n});\nFolder.addMethod('isPublic', function () {\n    return this.URI == repositorySearch.model.getPublicFolderUri();\n});\nFolder.addMethod('isTemp', function () {\n    return this.URI == repositorySearch.model.getTempFolderUri();\n});\nFolder.addMethod('isOrganization', function () {\n    return this.URI.match(repositorySearch.model.getOrganizationsFolderUri() + '/[^/]+$');\n});\nFolder.addMethod('isOrganizationsRoot', function () {\n    return this.URI.match(repositorySearch.model.getOrganizationsFolderUri() + '$');\n});\nFolder.addMethod('isReadable', function () {\n    return true;\n});\nFolder.addMethod('isEditable', function () {\n    return this.node.param.extra.isWritable;\n});\nFolder.addMethod('isRemovable', function () {\n    return this.node.param.extra.isRemovable;\n});\nFolder.addMethod('isAdministrable', function () {\n    return this.node.param.extra.isAdministrable;\n});\nFolder.addMethod('isSelected', function () {\n    return this.node.isSelected();\n});\nFolder.addMethod('equals', function (folder) {\n    return folder && this.URI == folder.URI;\n});\nFolder.addMethod('isThemeFolder', function () {\n    return this.node.param.extra && this.node.param.extra.isThemeFolder;\n});\nFolder.addMethod('isThemeRootFolder', function () {\n    return this.node.param.extra && this.node.param.extra.isThemeRootFolder;\n});\nFolder.addMethod('isActiveThemeFolder', function () {\n    return this.node.param.extra && this.node.param.extra.isActiveThemeFolder;\n});\nFolder.addMethod('isFolder', function () {\n    return true;\n});\nvar ResourcesUtils = {\n    getResourceUris: function (resources) {\n        var uriList = [];\n        resources.each(function (resource) {\n            uriList.push(resource.URIString ? resource.URIString : resource.URI);\n        });\n        return uriList;\n    },\n    getResourceUriAndTypeList: function (resources) {\n        var list = [];\n        resources.each(function (resource) {\n            var uri = resource.URIString ? resource.URIString : resource.URI;\n            list.push({\n                URIString: uri,\n                type: resource.type\n            });\n        });\n        return list;\n    },\n    getSelectedResourceUris: function (resources) {\n        return resources.map((resource)=>{\n            return {\n                uri: resource.URIString ? resource.URIString : resource.URI\n            };\n        });\n    },\n    checkNameLength: function (value) {\n        return !value.blank() && value.length <= repositorySearch.model.getConfiguration().resourceNameMaxLength;\n    },\n    checkDescriptionLength: function (value) {\n        return value.length <= repositorySearch.model.getConfiguration().resourceDescriptionMaxLength;\n    },\n    labelValidator: function (value) {\n        var isValid = true;\n        var errorMessage = '';\n        if (value.blank() || (value.length > repositorySearch.model.getConfiguration().resourceLabelMaxLength)) {\n            errorMessage = repositorySearch.messages['RE_INVALID_NAME_SIZE'].replace('{0}', repositorySearch.model.getConfiguration().resourceLabelMaxLength);\n            isValid = false;\n        }\n        return {\n            isValid: isValid,\n            errorMessage: errorMessage\n        };\n    },\n    descriptionValidator: function (value) {\n        var isValid = true;\n        var errorMessage = '';\n        if (value.length > repositorySearch.model.getConfiguration().resourceDescriptionMaxLength) {\n            errorMessage = repositorySearch.messages['RE_INVALID_DESC_SIZE'].replace('{0}', repositorySearch.model.getConfiguration().resourceDescriptionMaxLength);\n            isValid = false;\n        }\n        return {\n            isValid: isValid,\n            errorMessage: errorMessage\n        };\n    },\n    _fileTypeValidatorTemplate: function (value, expectedType) {\n        var isValid = true;\n        var errorMessage = '';\n        if (!value || value.blank()) {\n            errorMessage = repositorySearch.messages['RE_ENTER_FILE_NAME'];\n            isValid = false;\n        } else if (!value.toLowerCase().endsWith(expectedType)) {\n            errorMessage = repositorySearch.messages['RE_INVALID_FILE_TYPE'].replace('{0}', expectedType);\n            isValid = false;\n        }\n        return {\n            isValid: isValid,\n            errorMessage: errorMessage\n        };\n    },\n    zipFileTypeValidator: function (value) {\n        return ResourcesUtils._fileTypeValidatorTemplate(value, '.zip');\n    },\n    isCustomDataSource: function (resource) {\n        return _.contains(Utils.getInitConfiguration().customDataSources, resource.resourceType);\n    }\n};\nvar Utils = {\n    restOfString: function (str, fromStr) {\n        var from = str.lastIndexOf(fromStr) + fromStr.length;\n        return str.substring(from, str.length).trim();\n    },\n    getInitOptions: function () {\n        return window.localContext.rsInitOptions || __jrsConfigs__.repositorySearch['localContext'].rsInitOptions;\n    },\n    getInitConfiguration: function () {\n        return Utils.getInitOptions().configuration;\n    }\n};    ////////////////////////////////////\n// Repository Search Initialization\n////////////////////////////////////\n////////////////////////////////////\n// Repository Search Initialization\n////////////////////////////////////\ndocument.observe('element:contextmenu', repositorySearch.showContextMenu.bindAsEventListener(repositorySearch));\n/*document.observe('key:escape', function (event) {\n    actionModel.hideMenu();\n    Event.stop(event);\n});*/\ndocument.observe('key:delete', function (event) {\n    // for bug 25864 - to prevent warning message appearing when trying to delete text in any text input\n    if (event.target instanceof HTMLInputElement || event.target instanceof HTMLTextAreaElement) {\n        return;\n    }\n    if (canAllBeDeleted())\n        invokeBulkAction('Delete');\n});\n\n// expose to global scope\nwindow.canResourceBeCreated = canResourceBeCreated;\nwindow.invokeResourceAction = invokeResourceAction;\nwindow.invokeAction = invokeAction;\nwindow.invokeFolderAction = invokeFolderAction;\nwindow.invokeCreate = invokeCreate;\nwindow.invokeBulkAction = invokeBulkAction;\nwindow.invokeRedirectAction = invokeRedirectAction;\nwindow.isPropertiesChanged = isPropertiesChanged;\nwindow.isPermissionsChanged = isPermissionsChanged;\nwindow.isCopyOrMove = isCopyOrMove;\nwindow.isFolderCopyOrMove = isFolderCopyOrMove;\nwindow.isResourceCopyOrMove = isResourceCopyOrMove;\nwindow.isThemeFolder = isThemeFolder;\nwindow.isNonActiveThemeFolder = isNonActiveThemeFolder;\nwindow.isThemeRootFolder = isThemeRootFolder;\nwindow.canThemeBeReuploaded = canThemeBeReuploaded;\nwindow.canFolderBeCopied = canFolderBeCopied;\nwindow.canFolderBeDeleted = canFolderBeDeleted;\nwindow.canFolderBeEdited = canFolderBeEdited;\nwindow.canFolderBeMoved = canFolderBeMoved;\nwindow.canFolderBeCopiedOrMovedToFolder = canFolderBeCopiedOrMovedToFolder;\nwindow.canAllBeCopiedOrMovedToFolder = canAllBeCopiedOrMovedToFolder;\nwindow.canFolderBeExported = canFolderBeExported;\nwindow.canFolderPermissionsBeAssigned = canFolderPermissionsBeAssigned;\nwindow.canFolderPropertiesBeShowed = canFolderPropertiesBeShowed;\nwindow.canFolderPropertiesBeEdited = canFolderPropertiesBeEdited;\nwindow.canBeRun = canBeRun;\nwindow.canBeGenerated = canBeGenerated;\nwindow.canBeConverted = canBeConverted;\nwindow.canBeOpened = canBeOpened;\nwindow.canBeRunInBackground = canBeRunInBackground;\nwindow.canResourceBeEdited = canResourceBeEdited;\nwindow.canBeOpenedInDesigner = canBeOpenedInDesigner;\nwindow.canCreateFolder = canCreateFolder;\nwindow.canBeScheduled = canBeScheduled;\nwindow.canResourceBeCopied = canResourceBeCopied;\nwindow.canResourceBeMoved = canResourceBeMoved;\nwindow.canResourceBeDeleted = canResourceBeDeleted;\nwindow.canResourcePropertiesBeShowed = canResourcePropertiesBeShowed;\nwindow.canResourcePropertiesBeEdited = canResourcePropertiesBeEdited;\nwindow.canResourcePermissionsBeAssigned = canResourcePermissionsBeAssigned;\nwindow.canAllBeRun = canAllBeRun;\nwindow.canAllBeEdited = canAllBeEdited;\nwindow.canAllBeOpened = canAllBeOpened;\nwindow.canAllBeCopied = canAllBeCopied;\nwindow.canAllBeMoved = canAllBeMoved;\nwindow.canAllBePasted = canAllBePasted;\nwindow.canAllPropertiesBeShowed = canAllPropertiesBeShowed;\nwindow.canAllPropertiesBeEdited = canAllPropertiesBeEdited;\nwindow.canAllBeDeleted = canAllBeDeleted;\nwindow.canBeAddedToFavorites = canBeAddedToFavorites;\nwindow.canBeRemovedFromFavorites = canBeRemovedFromFavorites;\n\n\nexport {\n    repositorySearch,\n    ResourcesUtils,\n    invokeResourceAction,\n    invokeFolderAction,\n    isPropertiesChanged,\n    isPermissionsChanged,\n    Folder,\n    canFolderBeCopied,\n    canFolderBeMoved,\n    canFolderBeCopiedOrMovedToFolder,\n    canAllBeCopiedOrMovedToFolder,\n    canBeRun,\n    canBeOpened,\n    invokeBulkAction,\n    invokeRedirectAction,\n    canBeScheduled,\n    canBeAddedToFavorites,\n    canBeRemovedFromFavorites\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global alert, confirm*/\n/**\n * Asynchronous action class.\n */\n\nimport {Dialog} from 'js-sdk/src/common/component/dialog/Dialog';\nimport {LoadingDialog} from 'js-sdk/src/common/component/dialog/LoadingDialog'\nimport dialogs from '../components/components.dialogs';\nimport _ from 'underscore';\nimport {repositorySearch, ResourcesUtils, invokeResourceAction, isPropertiesChanged, isPermissionsChanged} from './repository.search.main';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport {JRS} from \"../namespace/namespace\";\nimport {ajax, ajaxTargettedUpdate, AjaxRequester} from \"../core/core.ajax\";\nimport {baseErrorHandler} from \"../core/core.ajax.utils\";\nimport {ajaxIframeDownload, doNothing, redirectToUrl, downloadFileByUrl} from \"../util/utils.common\";\nimport jQuery from 'jquery';\nimport layoutModule from '../core/core.layout';\nimport request from 'js-sdk/src/common/transport/request';\n\nrepositorySearch.Action = function (invokeFn) {\n    if (Object.isFunction(invokeFn)) {\n        this.invokeAction = invokeFn;\n    }\n};\nrepositorySearch.Action.DEFAULT = 'default-action';\nrepositorySearch.Action.addMethod('invokeAction', doNothing);\nrepositorySearch.folderActionFactory = {\n    'CreateFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showCreateFolderConfirm(folder);\n        });\n    },\n    'CopyFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.copy(folder);\n        });\n    },\n    'MoveFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.move(folder);\n        });\n    },\n    'PasteFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            let actionName,\n                toFolder = folder ? folder : repositorySearch.model.getContextFolder();\n            if (!toFolder) {\n                toFolder = repositorySearch.model.getSelectedFolder();\n            }\n            if (repositorySearch.CopyMoveController.isCopyFolder()) {\n                actionName = repositorySearch.FolderAction.COPY;\n            } else if (repositorySearch.CopyMoveController.isMoveFolder()) {\n                actionName = repositorySearch.FolderAction.MOVE;\n            } else {\n                return;\n            }\n            var action = new repositorySearch.ServerAction.createFolderAction(actionName, {\n                toFolder: toFolder,\n                folder: repositorySearch.CopyMoveController.object\n            });\n            action.invokeAction();\n        });\n    },\n    'PasteResources': function (folder) {\n        return new repositorySearch.Action(function () {\n            let actionName,\n                toFolder = repositorySearch.model.getSelectedFolder() ? repositorySearch.model.getSelectedFolder() : folder;\n            if (!toFolder) {\n                toFolder = repositorySearch.model.getContextFolder();\n            }\n            var object = repositorySearch.CopyMoveController.object;\n            var resources = repositorySearch.CopyMoveController.isBulkAction() ? [].concat(object) : [object];\n            if (repositorySearch.CopyMoveController.isCopyResource()) {\n                actionName = repositorySearch.ResourceAction.COPY;\n            } else if (repositorySearch.CopyMoveController.isMoveResource()) {\n                actionName = repositorySearch.ResourceAction.MOVE;\n            } else {\n                return;\n            }\n            for (var i = 0; i < resources.length; i++) {\n                if (resources[i].parentResource) {\n                    var uri = resources[i].parentResource.URI, contains = false;\n                    for (var j = 0; j < resources.length && !contains; j++) {\n                        contains |= resources[j].URI == uri;\n                    }\n                    contains || resources.push(resources[i].parentResource);\n                }\n            }\n            var action = new repositorySearch.ServerAction.createResourceAction(actionName, {\n                resources: resources,\n                folder: toFolder\n            });\n            action.invokeAction();\n        });\n    },\n    'DeleteFolder': function (folder, event) {\n        return new repositorySearch.Action(function () {\n            actionModel.hideMenu();\n            repositorySearch.showDeleteFolderConfirm(folder, event);\n        });\n    },\n    'ShowFolderProperties': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showFolderProperties(folder);\n        });\n    },\n    'EditFolderProperties': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.editFolderProperties(folder);\n        });\n    },\n    'AssignPermissions': function (folder, event) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.editFolderPermissions(folder, event);\n        });\n    },\n    'SetActiveThemeFolder': function (folder) {\n        return new repositorySearch.Action(function () {\n            var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME, { folder: folder });\n            action.invokeAction();\n        });\n    },\n    'DownloadTheme': function (folder) {\n        return new repositorySearch.Action(function () {\n            var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.DOWNLOAD_THEME, { folder: folder });\n            action.initDownload();\n        });\n    },\n    'UploadTheme': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showUploadThemeConfirm(folder, false);\n        });\n    },\n    'ReuploadTheme': function (folder) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showUploadThemeConfirm(folder, true);\n        });\n    },\n    'Export': function (folder, options) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.exportDialog.openRepoDialog(folder, options);\n        });\n    }\n};\nfunction parseRepoData(data) {\n    if (_.isArray(data)) {\n        return _.pluck(data, 'URIString');\n    } else {\n        return [data.URIString];\n    }\n}\nrepositorySearch.resourceActionFactory = {\n    'ResourceFavoriteAction': function () {\n        return new repositorySearch.Action((function () {\n            const resources = repositorySearch.model._uiState.selectedResources;\n            repositorySearch.addToFavorite(resources);\n        }));\n    },\n\n    'Copy': function (resource) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.copy(resource);\n        });\n    },\n    'Move': function (resource) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.move(resource);\n        });\n    },\n    'Delete': function (resource, event) {\n        return new repositorySearch.Action(function () {\n            actionModel.hideMenu();\n            repositorySearch.showDeleteResourceConfirm(resource, event);\n        });\n    },\n    'Export': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.exportDialog.openRepoDialog(resource, options);\n        });\n    },\n    'ShowProperties': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.showResourceProperties(resource, options);\n        });\n    },\n    'EditProperties': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.editResourceProperties(resource, options);\n        });\n    },\n    'AssignPermissionsToResourceAction': function (resource, event) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.editResourcePermissions(resource, event);\n        });\n    },\n    'GenerateResourceAction': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            JRS.CreateReport.selectGenerator(resource.URIString, options);\n        });\n    },\n    'ConvertResourceAction': function (resource, options) {\n        return new repositorySearch.Action(function () {\n            var action = new repositorySearch.ServerAction.createConvertAction(repositorySearch.ResourceAction.CONVERT, { reportUri: resource.URIString });\n            action.invokeAction();\n        });\n    }\n};\nrepositorySearch.bulkActionFactory = {\n    'Run': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                var action = repositorySearch.RedirectAction.createRunResourceAction(resource, index !== 0);\n                action.invokeAction();\n            });\n        });\n    },\n    'Edit': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                var action = repositorySearch.RedirectAction.createEditResourceAction(resource, index !== 0);\n                action.invokeAction();\n            });\n        });\n    },\n    'Open': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                var action = repositorySearch.RedirectAction.createOpenResourceAction(resource, resources.length > 1);\n                action.invokeAction();\n            });\n        });\n    },\n    'Copy': function (resources) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.copy(resources);\n        });\n    },\n    'Move': function (resources) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.CopyMoveController.move(resources);\n        });\n    },\n    'Delete': function (resources, event) {\n        return new repositorySearch.Action(function () {\n            actionModel.hideMenu();\n            resources.length == 1 ? repositorySearch.showDeleteResourceConfirm(resources[0], event) : repositorySearch.showBulkDeleteResourcesConfirm(resources, event);\n        });\n    },\n    'ShowProperties': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                invokeResourceAction('ShowProperties', resource, {\n                    cascade: true,\n                    position: index,\n                    number: resources.length\n                });\n            });\n        });\n    },\n    'EditProperties': function (resources) {\n        return new repositorySearch.Action(function () {\n            resources.each(function (resource, index) {\n                invokeResourceAction('EditProperties', resource, {\n                    cascade: true,\n                    position: index,\n                    number: resources.length\n                });\n            });\n        });\n    },\n    'Export': function (resources, options) {\n        return new repositorySearch.Action(function () {\n            repositorySearch.exportDialog.openRepoDialog(resources, options);\n        });\n    }\n};    /**\n * Server action class.\n */\n/**\n * Server action class.\n */\nrepositorySearch.ServerAction = function (eventId, options) {\n    this.actionURL = 'flow.html?_flowExecutionKey=' + repositorySearch.flowExecutionKey + '&_eventId=' + eventId;\n    this.data = Object.toQueryString(options.data);\n};    /**\n * Invokes server action.\n */\n/**\n * Invokes server action.\n */\nrepositorySearch.ServerAction.addMethod('invokeAction', function () {\n    ajaxTargettedUpdate(this.actionURL, {\n        postData: this.data,\n        callback: function (response) {\n            if (response.status == 'OK') {\n                this.onSuccess(response.data);\n            } else {\n                this.onError(response.data);\n            }\n        }.bind(this),\n        errorHandler: this._serverErrorHandler,\n        mode: AjaxRequester.prototype.EVAL_JSON\n    });\n});\nrepositorySearch.onFavoriteItem = function(url, favoriteList){\n    return request({\n        url: url,\n        type: 'POST',\n        headers: {\n            'Accept': 'application/json',\n            'content-type': 'application/json',\n        },\n        data: Object.toJSON({ favorites: favoriteList})\n    });\n};\nrepositorySearch.ServerAction.addMethod('initDownload', function () {\n    var url = this.actionURL + '&' + this.data;\n    ajaxIframeDownload(url, {\n        onload: function () {\n            var str = jQuery(jQuery('#ajax-download-iframe')[0].contentDocument.body).html();\n            try {\n                var json = str.evalJSON();\n                alert(json.data);\n            } catch (ex) {\n            }    // exception here means there is no JSON object\n            // which is a good thing, i.e. file did download!\n        }\n    });\n});\nrepositorySearch.ServerAction.addMethod('_serverErrorHandler', function (ajaxAgent) {\n    /* Login request is handled in baseErrorHandler */\n    /* TODO clean up this method, looks like need to completely remove it and use baseErrorHandler directly */\n    /* if (ajaxAgent.getResponseHeader(\"LoginRequested\")) {\n        var loginAndGoToSearch = new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            flowId: 'searchFlow'\n        });\n\n        loginAndGoToSearch.invokeAction();\n        return true;\n    } */\n    return baseErrorHandler(ajaxAgent);    /* Error 500 is handled in baseErrorHandler */\n    /* if (resolved && ajaxAgent.status == 500) {\n        var gotoError = new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            url: 'flow.html',\n            paramsMap: {\n                _flowExecutionKey: repositorySearch.flowExecutionKey,\n                _eventId: 'error'\n            }\n        });\n        gotoError.invokeAction();\n        return true;\n    } */\n});    /**\n * Handler for success response.\n *\n * @param data the data received from the server.\n */\n/**\n * Handler for success response.\n *\n * @param data the data received from the server.\n */\nrepositorySearch.ServerAction.addMethod('onSuccess', doNothing);    /**\n * Handler for error response.\n *\n * @param data the data received from the server.\n */\n/**\n * Handler for error response.\n *\n * @param data the data received from the server.\n */\nrepositorySearch.ServerAction.addMethod('onError', doNothing);    /*\n * Creates server action instance for repository search actions.\n *\n * @param actionName the name of the search action.\n * @param options {JSON object} - set of options for search action. The number of options and their names are different\n *      for different search actions.\n */\n/*\n * Creates server action instance for repository search actions.\n *\n * @param actionName the name of the search action.\n * @param options {JSON object} - set of options for search action. The number of options and their names are different\n *      for different search actions.\n */\nrepositorySearch.ServerAction.createSearchAction = function (actionName, options) {\n    options.mode = repositorySearch.mode;\n    var action = new repositorySearch.ServerAction(actionName, { data: options });\n    action.onSuccess = function (data) {\n        if (actionName == repositorySearch.SearchAction.NEXT) {\n            repositorySearch.fire(repositorySearch.Event.RESULT_NEXT, data);\n        } else if (actionName == repositorySearch.SearchAction.GET_RESOURCE_CHILDREN) {\n            repositorySearch.fire(repositorySearch.Event.CHILDREN_LOADED, {\n                inputData: options,\n                responseData: data\n            });\n        } else {\n            repositorySearch.fire(repositorySearch.Event.RESULT_CHANGED, data);\n            repositorySearch.fire(repositorySearch.Event.STATE_CHANGED, data);\n            if (repositorySearch.mode == repositorySearch.Mode.SEARCH) {\n                repositorySearch.fire(repositorySearch.Event.FILTER_PATH_CHANGED, data);\n            }\n        }\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(repositorySearch.Event.RESULT_ERROR, data);\n    };\n    return action;\n};    /*\n * Creates server action instance for folder actions.\n *\n * @param actionName the name of the folder action.\n * @param options {JSON object} - set of options for folder action. The number of options and their names are different\n *      for different folder actions.\n */\n/*\n * Creates server action instance for folder actions.\n *\n * @param actionName the name of the folder action.\n * @param options {JSON object} - set of options for folder action. The number of options and their names are different\n *      for different folder actions.\n */\nrepositorySearch.ServerAction.createFolderAction = function (actionName, options) {\n    var params;\n    var eventName;\n    var errorEventName;\n    if (repositorySearch.FolderAction.DELETE == actionName) {\n        params = { sourceFolderUri: options.folder.URI };\n        eventName = repositorySearch.FolderEvent.DELETED;\n        errorEventName = repositorySearch.FolderEvent.DELETE_ERROR;\n    } else if (repositorySearch.FolderAction.CREATE == actionName) {\n        params = {\n            destFolderUri: options.toFolder.URI,\n            folder: Object.toJSON({\n                URI: '',\n                label: options.label,\n                desc: options.desc\n            })\n        };\n        eventName = repositorySearch.FolderEvent.CREATED;\n        errorEventName = repositorySearch.FolderEvent.CREATE_ERROR;\n    } else if (repositorySearch.FolderAction.COPY == actionName) {\n        params = {\n            destFolderUri: options.toFolder.URI,\n            sourceFolderUri: options.folder.URI\n        };\n        eventName = repositorySearch.FolderEvent.COPIED;\n        errorEventName = repositorySearch.FolderEvent.COPY_ERROR;\n    } else if (repositorySearch.FolderAction.MOVE == actionName) {\n        params = {\n            destFolderUri: options.toFolder.URI,\n            sourceFolderUri: options.folder.URI\n        };\n        eventName = repositorySearch.FolderEvent.MOVED;\n        errorEventName = repositorySearch.FolderEvent.MOVE_ERROR;\n    } else if (repositorySearch.FolderAction.UPDATE == actionName) {\n        params = {\n            folder: Object.toJSON({\n                URI: options.folder.URI,\n                label: options.folder.label,\n                desc: options.folder.description\n            })\n        };\n        eventName = repositorySearch.FolderEvent.UPDATED;\n        errorEventName = repositorySearch.FolderEvent.UPDATE_ERROR;\n    } else if (repositorySearch.ThemeAction.SETTHEME == actionName) {\n        if (options.folder) {\n            params = { folderUri: options.folder.URI };\n        } else if (options.folderUri) {\n            params = { folderUri: options.folderUri };\n        }\n        eventName = repositorySearch.ThemeEvent.UPDATED;\n    } else if (repositorySearch.ThemeAction.DOWNLOAD_THEME == actionName) {\n        params = { folderUri: options.folder.URI };\n        errorEventName = repositorySearch.ThemeEvent.THEME_ERROR;\n    } else if (repositorySearch.ThemeAction.REUPLOAD == actionName) {\n        params = {\n            themeName: options.themeName,\n            folderUri: options.folderUri\n        };\n        eventName = repositorySearch.ThemeEvent.REUPLOADED;\n        errorEventName = repositorySearch.ThemeEvent.THEME_ERROR;\n    }\n    if (!params || !eventName || !errorEventName) {\n        new Error('Unsupported folder action.');\n    }\n    var action = new repositorySearch.ServerAction(actionName, { data: params });\n    action.onSuccess = function (data) {\n        repositorySearch.fire(eventName, {\n            responseData: data,\n            inputData: options\n        });\n        dialogs.popup.hide(options.dialog);\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(errorEventName, {\n            responseData: data,\n            inputData: options\n        });\n        dialogs.popup.hide(options.dialog);\n    };\n    return action;\n};    /*\n * Creates server action instance for folder actions.\n *\n * @param actionName the name of the folder action.\n * @param options {JSON object} - set of options for folder action. The number of options and their names are different\n *      for different folder actions.\n */\n/*\n * Creates server action instance for folder actions.\n *\n * @param actionName the name of the folder action.\n * @param options {JSON object} - set of options for folder action. The number of options and their names are different\n *      for different folder actions.\n */\nrepositorySearch.ServerAction.createResourceAction = function (actionName, options) {\n    var params;\n    var eventName;\n    var errorEventName;\n    if (repositorySearch.ResourceAction.DELETE == actionName) {\n        var list = ResourcesUtils.getResourceUriAndTypeList(options.resources);\n        params = { selectedResources: Object.toJSON(list) };\n        eventName = repositorySearch.ResourceEvent.DELETED;\n        errorEventName = repositorySearch.ResourceEvent.DELETE_ERROR;\n    } else if (repositorySearch.ResourceAction.COPY == actionName) {\n        var copyUris = ResourcesUtils.getResourceUris(options.resources);\n        params = {\n            selectedResources: Object.toJSON(copyUris),\n            destFolderUri: options.folder.URI\n        };\n        eventName = repositorySearch.ResourceEvent.COPIED;\n        errorEventName = repositorySearch.ResourceEvent.COPY_ERROR;\n    } else if (repositorySearch.ResourceAction.MOVE == actionName) {\n        var moveUris = ResourcesUtils.getResourceUris(options.resources);\n        params = {\n            selectedResources: Object.toJSON(moveUris),\n            destFolderUri: options.folder.URI\n        };\n        eventName = repositorySearch.ResourceEvent.MOVED;\n        errorEventName = repositorySearch.ResourceEvent.MOVE_ERROR;\n    } else if (repositorySearch.ResourceAction.UPDATE == actionName) {\n        params = { selectedResource: Object.toJSON(options.resource) };\n        eventName = repositorySearch.ResourceEvent.UPDATED;\n        errorEventName = repositorySearch.ResourceEvent.UPDATE_ERROR;\n    }\n    if (!params || !eventName || !errorEventName) {\n        new Error('Unsupported resource action.');\n    }\n    var action = new repositorySearch.ServerAction(actionName, { data: params });\n    action.onSuccess = function (data) {\n        if (repositorySearch.ResourceAction.MOVE == actionName) {\n            repositorySearch.CopyMoveController.cancel();\n        }\n        repositorySearch.fire(eventName, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    function promptFilteredRetry(existingLabels, filteredResources) {\n        dialogs.dependentResources.show(existingLabels, {\n            dependenciesBtnOk: function () {\n                var resourceAction = new repositorySearch.ServerAction.createResourceAction(actionName, {\n                    resources: filteredResources,\n                    folder: options.folder\n                });\n                resourceAction.invokeAction();\n            }\n        }, {\n            buttons: [\n                'ok',\n                'cancel'\n            ],\n            dialogTitle: repositorySearch.getMessage('dialog.resources.exist.title'),\n            topMessage: repositorySearch.getMessage('dialog.resources.exist'),\n            bottomMessage: repositorySearch.getMessage('dialog.resources.exist.confirm.skip')\n        });\n    }\n    function convertErrorResponse(data) {\n        var dataObj;\n        if (repositorySearch.ResourceAction.COPY != actionName && repositorySearch.ResourceAction.MOVE != actionName) {\n            return data;\n        }\n        try {\n            dataObj = JSON.parse(data);\n        } catch (e) {\n            return data;\n        }\n        if (!dataObj || !dataObj.existingLabels) {\n            return data;\n        }\n        var filteredResources = _.filter(options.resources, function (item) {\n            return dataObj.existingLabels.indexOf(item.label) == -1;\n        });\n        if (filteredResources.length === 0) {\n            return (dataObj.existingLabels.length == 1 ? repositorySearch.getMessage('dialog.resources.one.exists') : repositorySearch.getMessage('dialog.resources.all.exist')) + ' ' + options.folder.URIString;\n        }\n        promptFilteredRetry(dataObj.existingLabels, filteredResources);\n        return null;\n    }\n    action.onError = function (data) {\n        var resp = convertErrorResponse(data);\n        if (resp) {\n            repositorySearch.fire(errorEventName, {\n                responseData: resp,\n                inputData: options\n            });\n        }\n    };\n    return action;\n};    /*\n * Creates server action instance for permissions actions.\n *\n * @param actionName the name of the permission action.\n * @param options {JSON object} - set of options for permission action. The number of options and their names are different\n *      for different permission actions.\n */\n/*\n * Creates server action instance for permissions actions.\n *\n * @param actionName the name of the permission action.\n * @param options {JSON object} - set of options for permission action. The number of options and their names are different\n *      for different permission actions.\n */\nrepositorySearch.ServerAction.createPermissionAction = function (actionName, options) {\n    var action = new repositorySearch.ServerAction(actionName, { data: options });\n    var successEvent = actionName == repositorySearch.PermissionAction.UPDATE ? repositorySearch.PermissionEvent.UPDATED : repositorySearch.PermissionEvent.LOADED;\n    action.onSuccess = function (data) {\n        repositorySearch.fire(successEvent, {\n            responseData: data,\n            inputData: options,\n            doSet: actionName != repositorySearch.PermissionAction.NEXT\n        });\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(repositorySearch.PermissionEvent.ERROR, data);\n    };\n    return action;\n};    /*\n * Creates server action instance for permissions actions.\n *\n * @param actionName the name of the permission action.\n * @param options {JSON object} - set of options for permission action. The number of options and their names are different\n *      for different permission actions.\n */\n/*\n * Creates server action instance for permissions actions.\n *\n * @param actionName the name of the permission action.\n * @param options {JSON object} - set of options for permission action. The number of options and their names are different\n *      for different permission actions.\n */\nrepositorySearch.ServerAction.createGenerateAction = function (actionName, options) {\n    var action = new repositorySearch.ServerAction(actionName, { data: { data: Object.toJSON(options) } });\n    action.actionURL = 'reportGenerator.html?action=' + actionName;\n    action.onSuccess = function (data) {\n        repositorySearch.fire(repositorySearch.ResourceEvent.GENERATED, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(repositorySearch.ResourceEvent.GENERATE_ERROR, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    return action;\n};\nrepositorySearch.ServerAction.createConvertAction = function (actionName, options) {\n    var action = new repositorySearch.ServerAction(actionName, { data: options });\n    action.actionURL = 'dataViewConverter.html?action=' + actionName;\n    action.onSuccess = function (data) {\n        repositorySearch.fire(repositorySearch.ResourceEvent.CONVERTED, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    action.onError = function (data) {\n        repositorySearch.fire(repositorySearch.ResourceEvent.CONVERT_ERROR, {\n            responseData: data,\n            inputData: options\n        });\n    };\n    return action;\n};    /**\n * Creates server action instance for folder actions.\n *\n * @param type {} type of redirect. All supported types defined in {@see repositorySearch.RedirectType} map.\n * @param options Set of options for action:\n * <ul>\n * <li>url {String} URL</li>\n * <li>flowId {String} ID of the flow</li>\n * <li>paramsMap {JSON Object} map of parameters</li>\n * <li>encode {Boolean} </li>\n * </ul>\n */\n/**\n * Creates server action instance for folder actions.\n *\n * @param type {} type of redirect. All supported types defined in {@see repositorySearch.RedirectType} map.\n * @param options Set of options for action:\n * <ul>\n * <li>url {String} URL</li>\n * <li>flowId {String} ID of the flow</li>\n * <li>paramsMap {JSON Object} map of parameters</li>\n * <li>encode {Boolean} </li>\n * </ul>\n */\nrepositorySearch.RedirectAction = function (type, options) {\n    this.DIMMER_TIMEOUT = 400;\n    this.type = type;\n    this.flowId = options.flowId;\n    this.url = options.url ? options.url : this.flowId ? this.FLOW_URL : undefined;\n    this.paramsMap = options.paramsMap || {};\n    this.hash = options.hash ? '#' + options.hash : '';    //part of the url which may come after parameters: \"#someHash\"\n    //part of the url which may come after parameters: \"#someHash\"\n    this.encode = options.encode;\n    if (this.type !== repositorySearch.RedirectType.FLOW_REDIRECT && this.url === this.FLOW_URL) {\n        this.paramsMap['_flowId'] = this.flowId;\n    }\n};\nrepositorySearch.RedirectAction.addMethod('FLOW_URL', 'flow.html');\nrepositorySearch.RedirectAction.addMethod('_serializeParams', function (paramsMap, encode) {\n    if (paramsMap) {\n        var result = '';\n        for (var name in paramsMap) {\n            if (!Object.isUndefined(name)) {\n                result += '&' + name + '=' + (encode ? encodeURIComponent(paramsMap[name]) : paramsMap[name]);\n            }\n        }\n        return result && result.length > 0 ? result.substring(1) : '';\n    } else {\n        return '';\n    }\n});\nrepositorySearch.RedirectAction.addMethod('invokeAction', function (options) {\n    options = options || {};\n    var ajaxLoading = jQuery('#' + ajax.LOADING_ID);\n\n    if (ajaxLoading.length > 0) {\n        ajaxLoading.addClass(layoutModule.CANCELLABLE_CLASS);\n        ajaxLoading.find(\"#cancel\").click(function () {\n            jQuery(this).addClass('disabled');\n            ajaxLoading.addClass('cancelCalled');\n            window.location.reload();\n        });\n    }\n    if (this.type === repositorySearch.RedirectType.FLOW_REDIRECT) {\n        var form = jQuery('#redirectForm')[0];\n        var flowParams = jQuery('#flowParams')[0];\n        flowParams.setValue(this.flowId + '?' + this._serializeParams(this.paramsMap, this.encode));\n\n        var action = new repositorySearch.ServerAction('isServerAvailable', { data: {} });\n        // // show loading popup. It will be shown till new page appears as a response for form submit below\n        var timeout = setTimeout(function () {\n            dialogs.popup.show(ajax.LOADING_ID, true);\n        }, this.DIMMER_TIMEOUT);\n\n        action.onSuccess = function (data) {\n            if (data.strip() == 'Yes') {\n                // increment ajax request counter to avoid closing of a loading dialogue by common ajax response handler\n                ++ajax.ajaxRequestCount;\n                if(ajaxLoading.hasClass('cancelCalled')){\n                    ajaxLoading.removeClass('cancelCalled');\n                }else{\n                    form.submit();\n                }\n                repositorySearch.fire(repositorySearch.Event.FLOW_REDIRECT_RUNNING, data);\n            } else {\n                hidePopup();\n                repositorySearch.fire(repositorySearch.Event.REDIRECT_ERROR, data);\n            }\n        };\n        action.onError = function (data) {\n            hidePopup();\n            repositorySearch.fire(repositorySearch.Event.REDIRECT_ERROR, data);\n        };\n\n        var hidePopup = function (){\n            clearTimeout(timeout);\n            dialogs.popup.hide(ajax.LOADING_ID);\n        }\n\n        action.invokeAction();\n    } else if (this.type === repositorySearch.RedirectType.LOCATION_REDIRECT) {\n        var url = this.url + (jQuery.isEmptyObject(this.paramsMap) ? '' : '?' + this._serializeParams(this.paramsMap, this.encode)) + this.hash;    // because of this bug: http://stackoverflow.com/questions/13681156\n        // because of this bug: http://stackoverflow.com/questions/13681156\n        // so, we do this to overcome this issue\n        if (options.isContentResource) {\n            downloadFileByUrl(url);\n        } else {\n            redirectToUrl(url);\n        }\n    } else if (this.type === repositorySearch.RedirectType.WINDOW_REDIRECT) {\n        var w = window.open(), params = this._serializeParams(this.paramsMap, this.encode);\n        w.opener = null;\n        w.document.location = this.url + (params ? '?' + params : '') + this.hash;\n    }\n});\nrepositorySearch.runActionFactory = {\n    'ReportUnit': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'flow.html',\n            flowId: 'viewReportFlow',\n            paramsMap: {\n                _flowId: 'viewReportFlow',\n                reportUnit: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString,\n                standAlone: true,\n                ParentFolderUri: inNewTab ? encodeURIComponent(resource.parentFolder) : resource.parentFolder\n            }\n        });\n    },\n    'AdhocReportUnit': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'flow.html',\n            flowId: 'viewAdhocReportFlow',\n            paramsMap: {\n                reportUnit: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString,\n                standAlone: true,\n                ParentFolderUri: inNewTab ? encodeURIComponent(resource.parentFolder) : resource.parentFolder\n            }\n        });\n    },\n    'OlapUnit': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.LOCATION_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'olap/viewOlap.html',\n            paramsMap: {\n                name: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString,\n                'new': true,\n                parentFlow: 'searchFlow',\n                ParentFolderUri: inNewTab ? encodeURIComponent(resource.parentFolder) : resource.parentFolder\n            }\n        });\n    },\n    'DashboardResource': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'flow.html',\n            flowId: 'dashboardRuntimeFlow',\n            paramsMap: { dashboardResource: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString }\n        });\n    },\n    'DashboardModelResource': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.LOCATION_REDIRECT;\n        return new repositorySearch.RedirectAction(type, { url: 'dashboard/viewer.html#' + encodeURIComponent(resource.URIString) });\n    },\n    'ReportOptions': function (resource, inNewTab) {\n        var params = {\n            reportOptionsURI: inNewTab ? encodeURIComponent(resource.URIString) : resource.URIString,\n            standAlone: true,\n            ParentFolderUri: inNewTab ? encodeURIComponent(resource.parentFolder) : resource.parentFolder\n        };\n        var flow;\n        var parentResource = resource.parentResource;\n        if (parentResource && parentResource.typeEquals(repositorySearch.ResourceType.ADHOC_REPORT_UNIT)) {\n            flow = 'viewAdhocReportFlow';\n            params.reportUnit = inNewTab ? encodeURIComponent(parentResource.URIString) : parentResource.URIString;\n        } else {\n            flow = 'viewReportFlow';\n        }\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n        return new repositorySearch.RedirectAction(type, {\n            url: 'flow.html',\n            flowId: flow,\n            paramsMap: params\n        });\n    }\n};    /**\n * Creates server action instance for folder actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n * Creates server action instance for folder actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createRunResourceAction = function (resource, inNewTab) {\n    if (!resource) {\n        resource = resource ? resource : repositorySearch.model.getSelectedResources()[0];\n    }\n    var factoryMethod = repositorySearch.runActionFactory[resource.typeSuffix()];\n    if (factoryMethod) {\n        return factoryMethod(resource, inNewTab);\n    } else {\n        return new repositorySearch.Action(function () {\n            alert('Run action for resource type \\'' + resource.resourceType + '\\' is not implemented!');\n        });\n    }\n};    /**\n *\n *  Run resource in a new tab\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n *\n *  Run resource in a new tab\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createRunResourceInNewTabAction = function (resource, inNewTab) {\n    return repositorySearch.RedirectAction.createRunResourceAction(resource, true);\n};\nrepositorySearch.editActionFactory = {\n    'default-action': function (resource, actionType) {\n        if (ResourcesUtils.isCustomDataSource(resource)) {\n            return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n        } else {\n            return new repositorySearch.Action(function () {\n                alert('Edit action for resource type \\'' + resource.resourceType + '\\' is not implemented!');\n            });\n        }\n    },\n    'ReportUnit': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'reportUnitFlow',\n            paramsMap: {\n                selectedResource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'AdhocReportUnit': function (resource, actionType) {\n        return repositorySearch.editActionFactory['ReportUnit'](resource, actionType);\n    },\n    'DataDefinerUnit': function (resource, actionType) {\n        // Going into the report unit edit flow is useless for domain topic.\n        // Edit will go to the data chooser flow, and \"Open in designer\", which used to go to data chooser,\n        // is disabled.\n        // see JRS-3395\n        //        return repositorySearch.editActionFactory[\"ReportUnit\"](resource, actionType);\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'queryBuilderFlow',\n            paramsMap: {\n                uri: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'OlapUnit': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'olapUnitFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'DashboardResource': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'dashboardRuntimeFlow',\n            paramsMap: { dashboardResource: resource.URIString }\n        });\n    },\n    'ReportOptions': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'reportOptionsEditFlow',\n            paramsMap: {\n                reportOptionsURI: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'JdbcReportDataSource': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'addDataSourceFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'JndiJdbcReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'CustomReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'BeanReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'VirtualReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'HiveDataSourceService': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'CassandraDataSourceService': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'DiagnosticCustomDataSourceService': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'MongoDbDataSourceService': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'AwsReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'AzureSqlReportDataSource': function (resource, actionType) {\n        return repositorySearch.editActionFactory['JdbcReportDataSource'](resource, actionType);\n    },\n    'Query': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'queryFlow',\n            paramsMap: {\n                currentQuery: resource.URIString,\n                isEdit: true,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'InputControl': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'addInputControlFlow',\n            paramsMap: {\n                isEdit: true,\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'ListOfValues': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'addListOfValuesFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'DataType': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'dataTypeFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'MondrianConnection': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'olapClientConnectionFlow',\n            paramsMap: {\n                selectedResource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'SecureMondrianConnection': function (resource, actionType) {\n        return repositorySearch.editActionFactory['MondrianConnection'](resource, actionType);\n    },\n    'XMLAConnection': function (resource, actionType) {\n        return repositorySearch.editActionFactory['MondrianConnection'](resource, actionType);\n    },\n    'MondrianXMLADefinition': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'mondrianXmlaSourceFlow',\n            paramsMap: {\n                selectedResource: resource.URIString,\n                isEdit: 'edit',\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'FileResource': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'addFileResourceFlow',\n            paramsMap: {\n                selectedResource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n\n    'SemanticLayerDataSource': function(resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            url: 'domaindesigner.html',\n            paramsMap: {\n                uri: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    }\n};\n\nrepositorySearch.resourceTypeToDefaultRedirectTypeMap = {};\n\nrepositorySearch.resourceTypeToDefaultRedirectTypeMap[\n    repositorySearch.ResourceType.SEMANTIC_LAYER_DATA_SOURCE] = repositorySearch.RedirectType.LOCATION_REDIRECT;\n\nrepositorySearch.getDefaultRedirectTypeByResourceType = function(resourceType) {\n    var defaultRedirectType = repositorySearch.resourceTypeToDefaultRedirectTypeMap[resourceType];\n\n    if (!defaultRedirectType) {\n        defaultRedirectType = repositorySearch.RedirectType.FLOW_REDIRECT;\n    }\n\n    return defaultRedirectType;\n};\n\n/**\n * Creates edit resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createEditResourceAction = function (resource, inNewTab) {\n    if (!resource) {\n        resource = repositorySearch.model.getSelectedResources()[0];\n    }\n\n    var type;\n\n    if (inNewTab) {\n        type = repositorySearch.RedirectType.WINDOW_REDIRECT;\n    } else {\n        type = repositorySearch.getDefaultRedirectTypeByResourceType(resource.resourceType);\n    }\n\n    var factoryMethod = repositorySearch.editActionFactory[resource.typeSuffix()];\n    if (factoryMethod) {\n        return factoryMethod(resource, type);\n    } else {\n        return repositorySearch.editActionFactory[repositorySearch.Action.DEFAULT](resource, type);\n    }\n};\n\nrepositorySearch.openActionFactory = {\n    'ContentResource': function (resource, actionType) {\n        if (actionType === repositorySearch.RedirectType.FLOW_REDIRECT) {\n            actionType = repositorySearch.RedirectType.LOCATION_REDIRECT;\n        }\n        return new repositorySearch.RedirectAction(actionType, {\n            url: 'fileview/fileview' + resource.URIString,\n            paramsMap: {}\n        });\n    },\n    'DashboardResource': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'dashboardDesignerFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'DashboardModelResource': function (resource, inNewTab) {\n        var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.LOCATION_REDIRECT;\n        return new repositorySearch.RedirectAction(type, { url: 'dashboard/designer.html#' + encodeURIComponent(resource.URIString) });\n    },\n    'DataDefinerUnit': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'queryBuilderFlow',\n            paramsMap: {\n                uri: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'AdhocReportUnit': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'adhocFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    },\n    'AdhocDataView': function (resource, actionType) {\n        return new repositorySearch.RedirectAction(actionType, {\n            flowId: 'adhocFlow',\n            paramsMap: {\n                resource: resource.URIString,\n                ParentFolderUri: resource.parentFolder\n            }\n        });\n    }\n};    /**\n * Creates open action instance for resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n * Creates open action instance for resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createOpenResourceAction = function (resource, inNewTab) {\n    if (!resource) {\n        resource = repositorySearch.model.getSelectedResources()[0];\n    }\n    var type = inNewTab ? repositorySearch.RedirectType.WINDOW_REDIRECT : repositorySearch.RedirectType.FLOW_REDIRECT;\n    var factoryMethod = repositorySearch.openActionFactory[resource.typeSuffix()];\n    if (factoryMethod) {\n        return factoryMethod(resource, type);\n    } else {\n        return new repositorySearch.Action(function () {\n            alert('Open action for resource type \\'' + resource.resourceType + '\\' is not implemented!');\n        });\n    }\n};    /**\n * Creates run in background action instance for resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n * Creates run in background action instance for resource actions.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createRunInBackgroundResourceAction = function () {\n    var resource = repositorySearch.model.getSelectedResources()[0];\n    var reportUnitParentURI = '';\n    if (resource.resourceType.endsWith('.ReportUnit') || resource.resourceType.endsWith('.AdhocReportUnit') || resource.resourceType.endsWith('.DashboardModelResource') || resource.resourceType.endsWith('.ReportOptions')) {\n        if (resource.parentResource) {\n            reportUnitParentURI = '@@parentReportURI=' + resource.parentResource.URIString + '@@';\n        }\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            url: JRS.vars.contextPath + '/scheduler/main.html',\n            //paramsMap is necessary for backend controller\n            //while hash is necessary for UI scheduler application\n            paramsMap: {\n                'reportUnitURI': resource.URIString,\n                'parentReportUnitURI': resource.parentResource ? resource.parentResource.URIString : '',\n                'resourceType': resource.resourceType.substring(resource.resourceType.lastIndexOf('.') + 1)\n            },\n            hash: 'runInBackground@' + resource.URIString + reportUnitParentURI,\n            encode: true\n        });\n    }\n};    /**\n * Creates run in background action instance for resource.\n *\n * @param resource {Resource} the name of the folder action.\n */\n/**\n * Creates run in background action instance for resource.\n *\n * @param resource {Resource} the name of the folder action.\n */\nrepositorySearch.RedirectAction.createScheduleAction = function () {\n    var resource = repositorySearch.model.getSelectedResources()[0];\n    var reportUnitParentURI = '';\n    if (resource.resourceType.endsWith('.ReportUnit') || resource.resourceType.endsWith('.AdhocReportUnit') || resource.resourceType.endsWith('.DashboardModelResource') || resource.resourceType.endsWith('.ReportOptions')) {\n        if (resource.parentResource) {\n            reportUnitParentURI = '@@parentReportURI=' + resource.parentResource.URIString + '@@';\n        }\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            url: JRS.vars.contextPath + '/scheduler/main.html',\n            //paramsMap is necessary for backend controller\n            //while hash is necessary for UI scheduler application\n            paramsMap: {\n                'reportUnitURI': resource.URIString,\n                'resourceType': resource.resourceType.substring(1 + resource.resourceType.lastIndexOf('.')),\n                'parentReportUnitURI': resource.parentResource ? resource.parentResource.URIString : ''\n            },\n            hash: resource.URIString + reportUnitParentURI,\n            encode: true\n        });\n    }\n};\nrepositorySearch.createActionFactory = {\n    'OlapClientConnection': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'olapClientConnectionFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'OlapUnit': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'olapUnitFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'ReportDataSource': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'addDataSourceFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'SemanticLayerDataSource': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.LOCATION_REDIRECT, {\n            url: 'domaindesigner.html',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'FileResource': function (folder, fileType) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            //            flowId: 'fileResourceFlow', // old\n            flowId: 'addFileResourceFlow',\n            // new\n            paramsMap: {\n                expectedFileType: fileType,\n                parentFolder: folder.URI\n            }\n        });\n    },\n    'ReportUnit': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'reportUnitFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'Query': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'queryFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'InputControl': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'addInputControlFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'DataType': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'dataTypeFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'ListOfValues': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'addListOfValuesFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    },\n    'XMLAConnection': function (folder) {\n        return new repositorySearch.RedirectAction(repositorySearch.RedirectType.FLOW_REDIRECT, {\n            flowId: 'mondrianXmlaSourceFlow',\n            paramsMap: { ParentFolderUri: folder.URI }\n        });\n    }\n};\nrepositorySearch.RedirectAction.createCreateResourceAction = function (resourceTypeSuffix, fileType) {\n    var folder = repositorySearch.model.getContextFolder();\n    var factoryMethod = repositorySearch.createActionFactory[resourceTypeSuffix];\n    if (factoryMethod) {\n        return factoryMethod(folder, fileType);\n    } else {\n        return new repositorySearch.Action(function () {\n            alert('Create action for resource type suffix \\'' + resourceTypeSuffix + '\\' is not implemented!');\n        });\n    }\n};\nrepositorySearch.confirmAndLeave = function () {\n    return new repositorySearch.Action(function () {\n        return !isPropertiesChanged() && !isPermissionsChanged() || confirm(repositorySearch.getMessage('RM_CANCEL_EDIT_MESSAGE'));\n    }).invokeAction();\n};\n\nexport default repositorySearch;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport Dialog from 'js-sdk/src/common/component/dialog/Dialog';\nimport ExportView from './ExportView';\nimport i18n from 'js-sdk/src/i18n/CommonBundle.properties';\nimport i18n2 from '../../../i18n/ImportExportBundle.properties';\nimport exportTypesEnum from '../enum/exportTypesEnum';\n\nfunction parseRepoData(data) {\n    if (_.isArray(data)) {\n        return _.pluck(data, 'URIString');\n    } else {\n        return [data.URIString];\n    }\n}\nfunction hasReports(data) {\n    _.isArray(data) || (data = [data]);\n    return !!_.reduce(data, function (memo, item) {\n        return memo || !item.resourceType || item.resourceType.indexOf('ReportUnit') + 1 || item.resourceType.indexOf('ReportOptions') + 1;\n    }, false);\n}\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.options = options;\n        Dialog.prototype.constructor.call(this, {\n            model: this.model,\n            resizable: true,\n            modal: true,\n            content: '',\n            buttons: [\n                {\n                    label: i18n['button.export'],\n                    action: 'export',\n                    primary: true\n                },\n                {\n                    label: i18n['button.cancel'],\n                    action: 'cancel',\n                    primary: false\n                }\n            ]\n        });\n        this.on('button:export', _.bind(this._onExportButtonClick, this));\n        this.on('button:cancel', _.bind(this._closeExportDialog, this));\n    },\n    initialize: function (options) {\n        this.exportView = new ExportView();\n        this.listenTo(this.exportView.model, 'validated', function (isValid) {\n            isValid ? this.buttons.enable('export') : this.buttons.disable('export');\n        }, this);\n        Dialog.prototype.initialize.apply(this, arguments);\n    },\n    openRepoDialog: function (repoData, event) {\n        let eventTarget = event\n            && ((event.type === 'mouseup' && event.target.ancestors().filter(element => element.hasClassName(\"selected\"))[0])\n                || (event.type === 'dataavailable' && event.target));\n        var uris = parseRepoData(repoData);\n        var organizationsFolderUri = jrsConfigs.organizationsFolderUri || '/organizations';\n        var orgTemplateFolderUri = jrsConfigs.orgTemplateFolderUri || '/org_template';\n        var subOrgRegExp = new RegExp('^(' + organizationsFolderUri + '/([^/]+))+');\n        var rootOrgTemplateRegExp = new RegExp('^' + organizationsFolderUri + orgTemplateFolderUri + '(/.*)?');\n        var isSubOrgLevel = !!subOrgRegExp.exec(uris[0]) && !rootOrgTemplateRegExp.exec(uris[0]);\n        var renderOptions = {\n                type: exportTypesEnum.REPOSITORY,\n                isSubOrgLevel: isSubOrgLevel\n            }, subtitle = ' ' + i18n2['export.dialog.repository.title'];\n        this.addCssClasses('repository-export-dialog');\n        this._openExportDialog(renderOptions, subtitle, eventTarget);\n        this.exportView.model.set({\n            'uris': uris,\n            'includeScheduledReportJobs': hasReports(repoData)\n        });\n    },\n    openTenantDialog: function (tenant) {\n        var tenantName = ' ' + tenant.name, exportType = !tenant.isRoot() ? exportTypesEnum.TENANT : exportTypesEnum.ROOT_TENANT, renderOptions = {\n            type: exportType,\n            tenantId: tenant.id\n        };\n        this.addCssClasses('tenant-export-dialog');\n        this._openExportDialog(renderOptions, tenantName);\n    },\n    // block default validation handlers\n    fieldIsValid: function () {\n    },\n    fieldIsInvalid: function (error) {\n    },\n    _onExportButtonClick: function () {\n        this.exportView.doExport();\n        this._closeExportDialog();\n    },\n    _closeExportDialog: function () {\n        this.$el.css({ width: this.width });\n        this.close();\n        this.$el.find('.export-view').html('');\n    },\n    _openExportDialog: function (renderOptions, subtitle, focusElement) {\n        var title = i18n2['export.dialog.title'] + (subtitle ? subtitle : '');\n        this.setContent(this.exportView.render(renderOptions).$el);\n        this.setTitle(title);\n        this.setReturnFocus(focusElement);\n        //TODO: Find out why applyEpoxyBindings and delegateEvents should be called after new content is set.\n        this.exportView.applyEpoxyBindings();\n        this.exportView.delegateEvents();\n        Dialog.prototype.open.apply(this, arguments);\n        this.$el.css({ minHeight: this.$el.outerHeight() });\n        this.width = this.$el.outerWidth();\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global alert, confirm*/\nimport {Droppables, Draggables} from 'dragdropextra';\nimport {$break} from 'prototype';\nimport buttonManager from '../core/core.events.bis';\nimport orgModule from '../manage/mng.common';\nimport {dynamicList, baseList} from '../components/list.base';\nimport {\n    repositorySearch,\n    Folder,\n    canFolderBeCopied,\n    invokeFolderAction,\n    canFolderBeMoved,\n    canFolderBeCopiedOrMovedToFolder,\n    canAllBeCopiedOrMovedToFolder,\n    invokeBulkAction,\n    invokeRedirectAction,\n    ResourcesUtils\n} from \"./repository.search.main\";\nimport SearchBox from '../components/components.searchBox';\nimport dialogs from '../components/components.dialogs';\nimport toolbarButtonModule from '../components/components.toolbarButtons.events';\nimport {\n    isMetaHeld,\n    getBoxOffsets,\n    toFunction,\n    getAsFunction,\n    isArray,\n    disableSelectionWithoutCursorStyle,\n    isIPad,\n    isSupportsTouch,\n    matchAny,\n    centerElement,\n    ValidationModule,\n    fileSender\n} from \"../util/utils.common\";\nimport dynamicTree from '../dynamicTree/dynamicTree.utils';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport layoutModule from '../core/core.layout';\nimport TouchController from '../util/touch.controller';\nimport InfiniteScroll from '../util/tools.infiniteScroll';\nimport ConfirmationDialog from 'js-sdk/src/common/component/dialog/ConfirmationDialog';\nimport {JSTooltip, tooltipModule} from '../components/components.tooltip';\nimport ExportDialogView from '../tenantImportExport/export/view/ExportDialogView';\nimport exportTypesEnum from '../tenantImportExport/export/enum/exportTypesEnum';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport _ from 'underscore';\nimport jQuery from 'jquery';\nimport 'js-sdk/src/common/extension/customEventExtension';\nimport __jrsConfigs__ from 'js-sdk/src/jrs.configs';\nimport i18n from '../i18n/jasperserver_messages.properties';\n\n// Get functions from the global scope in order to fix JRS-20092\n// in fact they are declared in repository.search.main for CE or in\n// jrs-ui-pro/src/repository/repository.search.js for PRO\n// Functions from PRO override same functions from CE\nconst canBeRun = function(...args) {\n    return window.canBeRun(...args)\n};\nconst canBeOpened = function(...args) {\n    return window.canBeOpened(...args);\n}\nconst canBeScheduled = function(...args) {\n    return window.canBeScheduled(...args);\n}\n\n///////////////////////////////\n// Export dialog\n///////////////////////////////\nrepositorySearch.exportDialog = new ExportDialogView();\nrepositorySearch.exportDialog.render({ type: exportTypesEnum.REPOSITORY });\n\n///////////////////////////////\n// Secondary search box object\n///////////////////////////////\nrepositorySearch.secondarySearchBox = {\n    _searchBox: null,\n    initialize: function (text) {\n        this._searchBox = new SearchBox({ id: 'secondarySearchBox' });\n        this._searchBox.onSearch = function (text) {\n            repositorySearch.fire(repositorySearch.Event.SEARCH_SEARCH, { text: text });\n        };\n\n        this.setText(text);\n    },\n    setText: function (text) {\n        this._searchBox.setText(text);\n    }\n};\n///////////////////////////////\n// Toolbar object\n///////////////////////////////\nrepositorySearch.favoriteSwitchControl = {\n    _containerId: 'favorites-only',\n    initialize: function (options) {\n        this._container = jQuery('#' + this._containerId)[0];\n        if ( options.state?.customFilters?.favoriteFilter === repositorySearch.ResourcesFavoriteAction.FAVORITE_RESOURCES ) {\n            this._container.checked = true\n        }\n        this._container.onclick= function(){\n            repositorySearch.fire(repositorySearch.Event.SEARCH_FILTER, {\n                filterId: repositorySearch.ResourcesFavoriteAction.FILTER_ID,\n                optionId: this.checked ? repositorySearch.ResourcesFavoriteAction.FAVORITE_RESOURCES : repositorySearch.ResourcesFavoriteAction.ALL_RESOURCES\n            });\n        };\n    }\n};\nrepositorySearch.toolbar = {\n    _bulkActions: {},\n    initialize: function (bulkActions) {\n        this._bulkActions = bulkActions;\n        toolbarButtonModule.initialize(this._toActionMap(this._bulkActions));\n        this.refresh();\n    },\n    refresh: function () {\n        for (var name in this._bulkActions) {\n            var id = this._bulkActions[name].buttonId;\n            var testFn = toFunction(this._bulkActions[name].test);\n\n            toolbarButtonModule.setButtonState(jQuery('#' + id)[0], testFn());\n        }\n    },\n    _toActionMap: function (bulkActionModel) {\n        var actionMap = {};\n        for (var name in bulkActionModel) {\n            var bulkAction = bulkActionModel[name];\n            var id = bulkAction.buttonId;\n            actionMap[id] = function (action, actionArgs) {\n                return function () {\n                    var myAction = getAsFunction(action);\n                    var args = actionArgs;\n                    var belongsToLocalContext = window.localContext && window.localContext[action];\n                    if (args && isArray(args)) {\n                        myAction.apply(belongsToLocalContext ? window.localContext : null, args);\n                    } else {\n                        myAction.call(belongsToLocalContext ? window.localContext : null, args);\n                    }\n                };\n            }(bulkAction.action, bulkAction.actionArgs);\n        }\n        return actionMap;\n    }\n};\n///////////////////////////////\n// Folder panel object\n///////////////////////////////\nrepositorySearch.foldersPanel = {\n    _treeId: 'foldersTree',\n    _uri: '/',\n    _cookieName: 'lastFolderUri',\n    _canDoBrowse: true,\n    _touchController: null,\n    _browseRepoTimer:null,\n    initialize: function (options) {\n        if (options.isFolderSet) {\n            this._uri = options.state.folderUri;\n        } else {\n            var storedUri = window.localStorage ? localStorage.getItem(this._cookieName) : undefined;\n            this._uri = storedUri && storedUri.length > 0 ? storedUri : '/';\n        }\n        this._container = jQuery('#' + this.getTreeId()).parents().eq(1);\n        this.tree = new dynamicTree.createRepositoryTree(this.getTreeId(), {\n            providerId: 'repositoryExplorerTreeFoldersProvider',\n            rootUri: repositorySearch.model.getRootFolderUri(),\n            organizationId: options.organizationId,\n            publicFolderUri: options.publicFolderUri,\n            urlGetNode: 'flow.html?_flowId=searchFlow&method=getNode',\n            urlGetChildren: 'flow.html?_flowId=searchFlow&method=getChildren',\n            dragPattern: '.draggable',\n            selectOnMousedown: false,\n            escapeHyperlinks: true\n        });\n        disableSelectionWithoutCursorStyle(jQuery('#' + this.getTreeId()).parents().eq(1));\n        this.tree.observe('tree:contextMenu', function (event) {\n            var node = event.memo.node;\n            var label = jQuery(node).closest('li').find('p').text();\n            var nodePosition = getBoxOffsets(event.memo.focused, true);\n            repositorySearch.model.setContextFolder(new Folder(event.memo.node));\n            repositorySearch.actionModel.showFolderMenu(event, {\n                menuLeft: nodePosition[0] + 100,\n                //TODO: use constants for offsets\n                menuTop: nodePosition[1] + 20    //TODO: use constants for offsets\n            }, label);\n            Event.stop(event);\n            actionModel.focusMenu();\n        });\n        /*this.tree.observe('key:escape', function (event) {\n            actionModel.hideMenu();\n            Event.stop(event);\n        });*/\n        this.tree.observe('tree:mouseover', function (event) {\n            this.tree._overNode = event.memo.node;\n        }.bindAsEventListener(this));\n        this.tree.observe('tree:mouseout', function (event) {\n            this.tree.refreshDropTarget(false);\n            this.tree._overNode == event.memo.node && (this.tree._overNode = null);\n        }.bindAsEventListener(this));\n        this.tree.setDragStartState = function (node, draggable, event) {\n            dynamicTree.Tree.prototype.setDragStartState.call(this, node, draggable, event);\n            var folder = new Folder(node);\n            if (isMetaHeld(event, true)) {\n                canFolderBeCopied(folder) && invokeFolderAction('CopyFolder', folder);\n                jQuery(document.body).addClass(layoutModule.COPY_CLASS);\n            } else {\n                canFolderBeMoved(folder) && invokeFolderAction('MoveFolder', folder);\n            }\n        };\n        this.tree.setDragEndState = function (node, draggable, event) {\n            repositorySearch.CopyMoveController.cancel();\n            this.refreshDropTarget(false);\n            jQuery(document.body).removeClass(layoutModule.COPY_CLASS);\n            dynamicTree.Tree.prototype.setDragEndState.call(this, node, draggable, event);\n        };\n        this.tree.refreshDropTarget = function (allowed) {\n            if (this._overNode) {\n                this._overNode.isDropTarget = allowed;\n                this._overNode.refreshStyle();\n            }\n        };\n        Droppables.remove(this.getTreeId());\n        Droppables.add(this.getTreeId(), {\n            accept: [\n                'dragging',\n                'wrap'\n            ],\n            onHover: function (dragged, dropped, event) {\n                if (this.tree._overNode) {\n                    var toFolder = new Folder(this.tree._overNode);\n                    var hover = dragged.node && canFolderBeCopiedOrMovedToFolder(toFolder) || dragged.items && canAllBeCopiedOrMovedToFolder(toFolder);\n                    this.tree.refreshDropTarget(hover);\n                }\n            }.bind(this),\n            onDrop: function (dragged, dropped, event) {\n                var node;\n                if (Draggables.supportsTouch) {\n                    var touch = event.changedTouches[0];\n                    node = this.tree.getTreeNodeByElement(jQuery('#' + document.elementFromPoint(touch.pageX, touch.pageY))[0]);\n                } else {\n                    node = this.tree.getTreeNodeByEvent(event);\n                }\n                node && (this.tree._overNode = node);\n                if (this.tree._overNode) {\n                    var toFolder = new Folder(this.tree._overNode);\n                    dragged.node && canFolderBeCopiedOrMovedToFolder(toFolder) && invokeFolderAction('PasteFolder', toFolder);\n                    dragged.items && canAllBeCopiedOrMovedToFolder(toFolder) && invokeFolderAction('PasteResources', toFolder);\n                }\n            }.bind(this)\n        });\n        this.tree.observe('server:error', function () {\n            if (window.console) {\n                alert('Tree load error.');\n            }\n        });\n        this.tree.observe('childredPrefetched:loaded', function (event) {\n            this.tree.openAndSelectNode(this._uri);\n        }.bindAsEventListener(this));\n        this.tree.observe('tree:loaded', function (event) {\n            this._canDoBrowse = false;\n            // Forbid do browse to prevent initial browsing for each folder in the uri.\n            if (this._uri === '/') {\n                this.tree.rootNode.name ? jQuery(this.tree.rootNode).select() : jQuery(this.tree.rootNode.getFirstChild()).select();\n            } else {\n                this.tree.openAndSelectNode(this._uri);\n            }\n            this._canDoBrowse = true;\n            var node = this.tree.getSelectedNode();\n            if (node) {\n                node.scroll(jQuery('#' + this._treeId)[0].parentNode);\n            }\n            this.doBrowse();    // Do initial browse.\n        }.bindAsEventListener(this));\n        this.tree.observe('node:selected', function (event) {\n            this._uri = event.memo.node.param.uri;\n            window.localStorage && localStorage.setItem(this._cookieName, this._uri);\n            repositorySearch.model.setSelectedFolder(new Folder(event.memo.node));\n            this.doBrowse();\n        }.bindAsEventListener(this));\n        this.tree.observe('node:mouseup', function (event) {\n            repositorySearch.model.setContextFolder(new Folder(event.memo.node));\n        });\n        this.tree.showTreePrefetchNodes(this._uri);\n        return this;\n    },\n    doBrowse: function () {\n        let self = this;\n        if (this._canDoBrowse) {\n            clearTimeout(this._browseRepoTimer);\n            this._browseRepoTimer = setTimeout(()=>{\n                this._browseRepoTimer=undefined;\n                repositorySearch.fire(repositorySearch.Event.SEARCH_BROWSE, { uri: self._uri });\n            },0);\n        }\n    },\n    getSelectedUri: function () {\n        return this._uri;\n    },\n    getTreeId: function () {\n        return this._treeId;\n    },\n    selectFolder: function (folder) {\n        this.tree.openAndSelectNode(folder.URI, null, null, { shouldFocus: true });\n    },\n    reselectFolder: function (folder) {\n        if (folder.node.isSelected()) {\n            folder.node.deselect();\n            folder.node.select();\n        }\n    },\n    refreshFolder: function (folder) {\n        this.selectFolder(folder);\n        this.updateSubFolders(folder);\n    },\n    createAndSelectFolder: function (targetFolder, toFolder) {\n        return this.tree.getTreeNodeChildren(toFolder.node, function (result) {\n            if (result) {\n                this.tree.openAndSelectNode(targetFolder.URI, null, null, { shouldFocus: true });\n            }\n        }.bind(this));\n    },\n    updateFolder: function (folder, label, description) {\n        folder.label = label;\n        folder.description = description;\n        folder.node.changeName(folder.label);\n        folder.node.param.extra.desc = folder.description;\n        this.tree.resortSubtree(folder.node.parent);\n        folder.node.parent.refreshNode();    //        folder.node.param.extra.date = folder.date;\n    },\n    updateSubFolders: function (folder) {\n        if (!folder.node.hasChilds()) {\n            folder.node.setHasChilds(true);\n        }\n        if (folder.node.isOpen()) {\n            folder.node.handleNode();\n        }\n        folder.node.isloaded = false;\n        folder.node.handleNode();\n    },\n    isFolderContextMenu: function (event) {\n        return this.tree.getTreeNodeByEvent(event) && !this.tree.isIconEvent(event);\n    },\n    moveOrCopyFolder: function (targetFolder, toFolder, copy) {\n        var parent = targetFolder.getParentFolder().node;\n        copy || parent.removeChild(targetFolder.node);\n        return this.tree.getTreeNodeChildren(toFolder.node, function (result) {\n            if (result) {\n                var node = result.detect(function (n) {\n                    return n.param.id == targetFolder.name;\n                });\n                node && this.tree.openAndSelectNode(node.param.uri, null, null, { shouldFocus: true });\n            }\n        }.bind(this));\n    }\n};\n///////////////////////////////\n// Results panel object\n///////////////////////////////\nrepositorySearch.resultsPanel = {\n    _list: null,\n    _infiniteScroll: null,\n    _resultListHeaderId: 'resultsListHeader',\n    _resultListId: 'resultsList',\n    _resultsContainerId: 'resultsContainer',\n    _touchScroller: null,\n    _folderDisplayPathCache: {},\n    NOTHING_TO_DISPLAY_ID: 'nothingToDisplay',\n    RESOURCE_NAME_TOOLTIP_ID: 'resourceNameTooltip',\n    NAME_PATTERN: '.resourceName',\n    LINK_NAME_PATTERN: '.resourceName > a',\n    DISCLOSURE_PATTERN: '.disclosure',\n    SCHEDULED_PATTERN: '.scheduled',\n    FAVORITE_PATTERN: '.favorite',\n    LOADING_CLASS_NAME: 'loading',\n    initialize: function (options) {\n        var it = this;\n        this._container = jQuery('#' + this._resultListId).parents();\n        this._header = jQuery('#' + this._resultListHeaderId)[0];\n        this._list = new dynamicList.List(this._resultListId, {\n            listTemplateDomId: 'tabular_fourColumn_resources',\n            itemTemplateDomId: 'tabular_fourColumn_resources:leaf',\n            //dragPattern: '.selected>.wrap',\n            dragPattern: options.enableDnD ? '.draggable' : '',\n            multiSelect: true,\n            selectOnMousedown: !isIPad()\n        });\n        this._intiListEvents();\n        this._initDnD();\n        this.getList().show();\n        if (isSupportsTouch()) {\n            this._touchController = new TouchController(document.getElementById(this._resultListId), document.getElementById(this._resultsContainerId), { scrollbars: true });\n            jQuery('#' + this._resultListId).on('layout_update orientationchange', function () {\n                jQuery('#' + it._resultListId).css('min-width', jQuery('#' + it._resultsContainerId).width() + 'px');\n                jQuery('#' + it._resultListId).width(jQuery('#' + it._resultsContainerId).width());\n            });\n        }\n        if (isIPad()) {\n            this._infiniteScroll = new InfiniteScroll({\n                id: this._container[0].identify(),\n                contentId: this._resultListId,\n                scroll: this._touchController\n            });\n        } else {\n            this._infiniteScroll = new InfiniteScroll({\n                id: this._container[0].identify(),\n                contentId: this._resultListId\n            });\n        }\n        this._infiniteScroll.onLoad = function () {\n            repositorySearch.fire(repositorySearch.Event.SEARCH_NEXT);\n        };\n        disableSelectionWithoutCursorStyle(this._container);\n\n        const resizeHandler = this._toggleInfiniteScrollBasedOnViewportHeight.bind(this);\n        // call the handler only after 250ms would pass after last resize event\n        Event.observe(jQuery(window)[0], 'resize', _.debounce(resizeHandler, 250));\n\n        this._fixHeaderWidth();\n        return this;\n    },\n    _fixHeaderWidth: function () {\n        if (!isIPad()) {\n            this._header.setStyle({ 'marginRight': this._container[0].getWidth() - jQuery('#' + this._resultListId)[0].getWidth() + 'px' });\n        }\n    },\n    _createResourceItem: function (value) {\n        var resourceItem;\n        if (value.hasChildren) {\n            resourceItem = new dynamicList.CompositeItem({\n                cssClassName: layoutModule.NODE_CLASS,\n                label: value.label,\n                value: value,\n                openHandlerPattern: '.disclosure.icon',\n                closeHandlerPattern: '.disclosure.icon',\n                favoriteIconPattern: '.favorite.icon',\n                scheduleIconPattern: '.scheduled.icon',\n                //respondOnItemEvents: false,\n                excludeFromSelectionTriggers: ['.disclosure.icon','.favorite.icon'],\n                listOptions: {\n                    listTemplateDomId: 'tabular_fourColumn_resources_sublist',\n                    itemTemplateDomId: 'tabular_fourColumn_resources_sublist:leaf',\n                    multiSelect: true\n                }\n            });\n            resourceItem.setLoading = function (b) {\n                this.isLoading = b;\n                this.refreshStyle();\n                repositorySearch.resultsPanel.refresh();\n            };\n        } else {\n            resourceItem = new dynamicList.ListItem({\n                cssClassName: layoutModule.LEAF_CLASS,\n                label: value.label,\n                value: value,\n                favoriteIconPattern: '.favorite.icon',\n                scheduleIconPattern: '.scheduled.icon',\n                excludeFromSelectionTriggers: ['.favorite.icon'],\n            });\n        }\n        resourceItem.processTemplate = function (element) {\n            var isRunnable = canBeRun(this.getValue()) || canBeOpened(this.getValue());\n            var nameSelector = isRunnable ? repositorySearch.resultsPanel.LINK_NAME_PATTERN : repositorySearch.resultsPanel.NAME_PATTERN;\n            var name = jQuery(element).find(nameSelector)[0];\n            var nameTitleElement = element.select(repositorySearch.resultsPanel.NAME_PATTERN)[0];\n            var desc = jQuery(element).find('.resourceDescription')[0];\n            name.update(xssUtil.hardEscape(this.getValue().label));\n            var that = this;\n            new JSTooltip(nameTitleElement, {\n                text: [\n                    xssUtil.hardEscape(this.getValue().label),\n                    xssUtil.hardEscape(repositorySearch.messages['loading'])\n                ],\n                templateId: repositorySearch.resultsPanel.RESOURCE_NAME_TOOLTIP_ID,\n                loadTextCallback: function (tooltip) {\n                    var folderPath = that.getValue().parentFolder;\n                    var folderDisplayPath = repositorySearch.resultsPanel._folderDisplayPathCache[folderPath];\n                    var label, uri;\n                    function getUri(parentUri, name) {\n                        var separator = repositorySearch.model.getFolderSeparator();\n                        if (parentUri === separator) {\n                            return parentUri + name;\n                        } else {\n                            return parentUri + separator + name;\n                        }\n                    }\n                    function updateTooltip(parentUri, label, name) {\n                        label = xssUtil.hardEscape(label);\n                        uri = xssUtil.hardEscape(getUri(parentUri, name));\n                        tooltip.updateText([\n                            label,\n                            uri\n                        ]);\n                    }\n                    if (folderDisplayPath) {\n                        updateTooltip(folderDisplayPath, that.getValue().label, that.getValue().name);\n                    } else {\n                        var action = new repositorySearch.ServerAction(repositorySearch.InfoAction.GET_DISPLAY_PATH, {\n                            data: {\n                                resourceUri: folderPath,\n                                isFolder: true\n                            }\n                        });\n                        action.onSuccess = function (data) {\n                            // Cache the display path of the folder.\n                            repositorySearch.resultsPanel._folderDisplayPathCache[folderPath] = data;\n                            updateTooltip(data, that.getValue().label, that.getValue().name);\n                        };\n                        action.onError = repositorySearch.defaultErrorHandler;\n                        action.invokeAction();\n                    }\n                }\n            });\n            let descriptionValue = this.getValue().description;\n            desc.update(xssUtil.hardEscape(descriptionValue));\n            if (!descriptionValue) {\n                desc.jsTooltip && desc.jsTooltip.disable();\n            } else {\n                new JSTooltip(desc, { text: descriptionValue });\n            }\n            let type = element.select('.resourceType')[0];\n            let modifiedDate = jQuery(element).find('.modifiedDate')[0];\n            let createdDate = jQuery(element).find('.createdDate')[0];\n            let scheduleIcon = jQuery(element).find('.scheduled')[0];\n            let favoriteIcon = jQuery(element).find('.favorite')[0];\n            type.update(this.getValue().type);\n            modifiedDate.update(this.getValue().updateDate);\n            new JSTooltip(modifiedDate, { text: this.getValue().updateDateTime });\n            createdDate.update(this.getValue().date);\n            new JSTooltip(createdDate, { text: this.getValue().dateTime });\n            new JSTooltip(scheduleIcon, { text: i18n['schedule.tooltip'] });\n            new JSTooltip(favoriteIcon, { text: i18n['favorite.tooltip'] });\n\n            jQuery(name).attr(\"aria-label\", xssUtil.hardEscape(this.getValue().label));\n            jQuery(createdDate).attr(\"aria-label\", xssUtil.hardEscape(this.getValue().date +' '+ this.getValue().dateTime));\n            jQuery(modifiedDate).attr(\"aria-label\", xssUtil.hardEscape(this.getValue().updateDate + ' ' + this.getValue().updateDateTime));\n\n            return element;\n        };\n        var baseRefreshStyle = resourceItem.refreshStyle;\n        resourceItem.refreshStyle = function () {\n            baseRefreshStyle.call(this);\n            var element = this._getElement(),\n                ariaLabel = this.getValue().label + \", \" + this.getValue().type;\n\n            if (this.getValue().isScheduled) {\n                jQuery(element).addClass(layoutModule.SCHEDULED_CLASS);\n                ariaLabel = ariaLabel + \", \" + i18n['schedule.tooltip'];\n            }\n            if (this.getValue().isFavorite) {\n                jQuery(element).addClass(layoutModule.FAVORITE_CLASS).find('[role=\"checkbox\"]').first().attr(\"aria-checked\", true);\n                ariaLabel = ariaLabel + \", \" + i18n['favorite.tooltip'];\n            }\n            if (this.isLoading) {\n                jQuery(element).addClass(layoutModule.LOADING_CLASS);\n            }\n\n            jQuery(element).attr(\"aria-label\", xssUtil.hardEscape(ariaLabel));\n        };\n        return resourceItem;\n    },\n    _initDnD: function () {\n        var list = this.getList();\n        list.setDragStartState = function (item, draggable, event) {\n            dynamicList.List.prototype.setDragStartState.call(this, item, draggable, event);\n            isMetaHeld(event, true) && jQuery(document.body).addClass(layoutModule.COPY_CLASS).setStyle({ cursor: null });\n            invokeBulkAction(isMetaHeld(event, true) ? 'Copy' : 'Move');\n        };\n        list.setDragEndState = function (item, draggable, event) {\n            repositorySearch.CopyMoveController.cancel();\n            repositorySearch.foldersPanel.tree.refreshDropTarget(false);\n            jQuery(document.body).removeClass(layoutModule.COPY_CLASS);\n            dynamicList.List.prototype.setDragEndState.call(this, item, draggable, event);\n        };\n    },\n    _intiListEvents: function () {\n        this.getList().observe('item:click', function (event) {\n            var item = event.memo.item;\n            var e = event.memo.targetEvent;\n            var resource = item.getValue();\n            if (this._isLinkEvent(e)) {\n                if (canBeRun(resource)) {\n                    invokeRedirectAction('RunResourceAction');\n                } else {\n                    if(__jrsConfigs__.isProVersion) {\n                        canBeOpened(resource) && invokeRedirectAction('OpenResourceAction', {\n                            isContentResource: window.isContentResource(resource)\n                        });\n                    } else {\n                        canBeOpened(resource) && invokeRedirectAction('OpenResourceAction');\n                    }\n                }\n            }\n            if (this._isScheduleIconEvent(e) && canBeScheduled(resource)) {\n                invokeRedirectAction('ScheduleAction');\n            }\n\n            if (this._isFavoriteIconClicked(e) ) {\n                const selectedItem = jQuery(item._element);\n                repositorySearch.addToFavorite([resource], selectedItem);\n            }\n        }.bindAsEventListener(this));\n        this.getList().observe('item:selected', function (event) {\n            this._selectOrUnselectResources(event);\n        }.bindAsEventListener(this));\n        this.getList().observe('item:unselected', function (event) {\n            this._selectOrUnselectResources(event);\n        }.bindAsEventListener(this));\n        this.getList().observe('item:mouseup', function (event) {\n        }    //            var item = event.memo.item;\n            //            var resource = item.getValue();\n            //            repositorySearch.model.setContextResource(resource);\n        );\n        this.getList().observe('item:open', function (event) {\n            var item = event.memo.item;\n            let resource = item.getValue();\n            if (!resource.isLoaded()) {\n                item.setLoading(true);\n                repositorySearch.fire(repositorySearch.Event.SEARCH_CHILDREN, {\n                    resource: resource,\n                    item: item\n                });\n            }\n            this.refresh();\n        }.bindAsEventListener(this));\n        this.getList().observe('item:closed', function (event) {\n            this.refresh();\n        }.bindAsEventListener(this));\n        this.getList().observe('key:contextMenu', function (event) {\n            var item = event.memo.node;\n            var itemPosition = getBoxOffsets(item, true);\n            var menuPosition = {\n                menuLeft: itemPosition[0] + 100,\n                //TODO: use constants for offsets\n                menuTop: itemPosition[1] + 20    //TODO: use constants for offsets\n            };\n            if (this.getList().getSelectedItems().length > 1) {\n                repositorySearch.actionModel.showResourceBulkMenu(event, menuPosition);\n            } else {\n                repositorySearch.actionModel.showResourceMenu(event, menuPosition);\n            }\n            Event.stop(event);\n            actionModel.focusMenu();\n        }.bindAsEventListener(this));\n        /*this.getList().observe('key:escape', function (event) {\n            actionModel.hideMenu();\n            Event.stop(event);\n        });*/\n    },\n    _selectOrUnselectResources:function(event){\n        const item = event.memo.item;\n        const resourceVal = item.getValue();\n        const selectedElement = jQuery(item._element);\n        const resources = this.getList().getSelectedItems().collect(function (lItem) {\n            return lItem.getValue();\n        });\n        resourceVal.isFavorite && selectedElement.addClass(layoutModule.FAVORITE_CLASS)\n        repositorySearch.model.setSelectedResources(resources);\n        repositorySearch.actionModel.refreshToolbar();\n    },\n    _isLinkEvent: function (event) {\n        var element = Event.element(event);\n        return matchAny(element, [this.LINK_NAME_PATTERN]) != null;\n    },\n    _isScheduleIconEvent: function (event) {\n        var element = Event.element(event);\n        return jQuery(element).is(this.SCHEDULED_PATTERN);\n    },\n    _isFavoriteIconClicked: function (event) {\n        let element = Event.element(event);\n        return jQuery(element).is(this.FAVORITE_PATTERN);\n    },\n    _isDisclosureEvent: function (event) {\n        var element = Event.element(event);\n        return matchAny(element, [this.DISCLOSURE_PATTERN]) != null;\n    },\n    _refreshEmptyListMessage: function () {\n        var nothingToDisplay = jQuery('#' + this.NOTHING_TO_DISPLAY_ID)[0];\n        if (this._list.getItems().length === 0) {\n            jQuery(nothingToDisplay).removeClass(layoutModule.HIDDEN_CLASS);\n            centerElement(nothingToDisplay, {\n                horz: true,\n                vert: true\n            });\n        } else {\n            jQuery(nothingToDisplay).addClass(layoutModule.HIDDEN_CLASS);\n        }\n    },\n    _toggleInfiniteScrollBasedOnViewportHeight: function() {\n        if (this._isListHeightLessThanViewport()) {\n            this._infiniteScroll.onLoad();\n        } else {\n            this.refresh();\n            this._infiniteScroll.stopWaiting();\n        }\n    },\n\n    _isListHeightLessThanViewport: function() {\n        return this.getList()._element.clientHeight < document.body.clientHeight;\n    },\n    getList: function () {\n        return this._list;\n    },\n    removeResources: function (resources) {\n        var children = resources.findAll(function (r) {\n            return r.isChild;\n        });\n        var other = resources.findAll(function (r) {\n            return !r.isChild;\n        });\n        var items = this.getList().getItems();\n        var removedItems = [];\n        var compositeItems = [];\n        items.each(function (item) {\n            item.isComposite && compositeItems.push(item);\n            other.include(item.getValue()) && removedItems.push(item);\n        });\n        compositeItems.each(function (item) {\n            if (item.getItems()) {\n                item.removeItems(item.getItems().findAll(function (item) {\n                    return children.include(item.getValue());\n                }));\n            }\n        });\n        this.getList().removeItems(removedItems);\n        this._refreshEmptyListMessage();\n        this.refresh();\n    },\n    _renderHeader: function () {\n        // For simplicity we do not render header as resource item\n        // instead we clone template node and insert it as a first element in the list\n        const headerClone = jQuery(this._header).find(\"li\").clone();\n        jQuery('#' + this._resultListId).prepend(headerClone);\n    },\n    setResources: function (resources, toItem) {\n        var items = resources.collect(this._createResourceItem);\n        var list = this.getList();\n\n        if (toItem) {\n            toItem.setItems(items);\n            toItem.refresh();\n        } else {\n            this._infiniteScroll && this._infiniteScroll.reset();\n            list.setItems(items);\n            list.show();\n            this._renderHeader();\n            this._refreshEmptyListMessage();\n        }\n\n        if (this._isListHeightLessThanViewport()) {\n            tooltipModule.disableTooltips();\n        }\n\n        if (items.length > 0) {\n            this._toggleInfiniteScrollBasedOnViewportHeight();\n        }\n\n        //custom event is necessary for QAA so they will know\n        //when list is loaded\n        var event = new CustomEvent(`${list._id}:loaded`);\n        list._element.dispatchEvent(event);\n    },\n    addResources: function (resources) {\n        var items = resources.collect(this._createResourceItem);\n\n        tooltipModule.disableTooltips();\n\n        this.getList().addItems(items);\n        this.getList().refresh();\n        this._renderHeader();\n        if (items.length > 0) {\n            this._toggleInfiniteScrollBasedOnViewportHeight();\n            tooltipModule.enableTooltips();\n        }\n    },\n    isResourceContextMenu: function (event) {\n        return this.getList().getItemByEvent(event);\n    },\n    updateResource: function (resource) {\n        var items = this.getList().getItems();\n        items.each(function (item) {\n            if (item.getValue().URIString == resource.URIString) {\n                item.setValue(resource);\n                item.refresh();\n                if (this.getList().isItemSelected(item)) {\n                    // Reselecting to update item in selected list.\n                    this.getList().selectItem(item);\n                }\n            }\n        }.bind(this));\n    },\n    findResource: function (uri) {\n        var items = this.getList().getItems();\n        var item = items.detect(function (item) {\n            return item.getValue().URIString === uri;\n        });\n        return item ? item.getValue() : null;\n    },\n    refresh: function () {\n        this._fixHeaderWidth();\n        tooltipModule.cleanUp();\n    }\n};\n///////////////////////////////\n// Filter panel object\n///////////////////////////////\nrepositorySearch.filtersPanel = {\n    _id: 'filtersPanel',\n    _container: undefined,\n    _filtersLists: {},\n    _cookieName: 'filtersPopularity',\n    _ignoreFilterEvent: false,\n    initialize: function (filtersMetaData, selectedFilters) {\n        //this._getContainer().update();\n        // Process filters configuration\n        filtersMetaData.each(function (filter, index) {\n            var element= jQuery(this._getContainer().childElements()[index]);\n            element.find('.subcontainer.ui-resizable')[0].insert(new Element('ul', {\n                id: filter.id,\n                'data-tab-index': 5 + index,\n                'data-component-type': 'list'\n            }));\n            var list = this._createFiltersList(filter.id, filter);\n            list.show();\n            this._filtersLists[filter.id] = list;\n            (element.find('.buttonIconToggle')).on('click', this._buttonToggleListener.bindAsEventListener(this._container.children[index]))[0];\n\n        }.bind(this));\n        for (var filterId in selectedFilters) {\n            this.select(filterId, selectedFilters[filterId]);\n        }\n        if (isSupportsTouch()) {\n            this._touchController = new TouchController(document.getElementById(this._id), jQuery('#' + this._id).parents());\n        }\n        return this;\n    },\n    _buttonToggleListener: function(element){\n        if(jQuery(this).hasClass('open')){\n            jQuery(this).addClass('closed').removeClass('open');\n            jQuery(this).find('.subcontainer.ui-resizable')[0].hide();\n        }else{\n            jQuery(this).addClass('open').removeClass('closed');\n            jQuery(this).find('.subcontainer.ui-resizable')[0].show();\n        }\n    },\n    _refreshScroll: function () {\n        var scroll = layoutModule.scrolls.get(this._id);\n        scroll && scroll.refresh();\n    },\n    _createItemsList: function (filterMetaData) {\n        var optionsMetaData = filterMetaData.options;\n        var index = 0;\n        var allItems = optionsMetaData.collect(function (optionMetaData) {\n            return new dynamicList.ListItem({\n                value: optionMetaData,\n                cssClassName: layoutModule.LEAF_CLASS,\n                label: repositorySearch.getMessage(optionMetaData.labelId)\n            });\n        }).partition(function () {\n            index++;\n            return filterMetaData.showCount === -1 || filterMetaData.showCount > index;\n        });\n        if (allItems[1].length > 0) {\n            allItems[0].push(new dynamicList.CompositeItem({\n                value: { isMore: true },\n                templateDomId: 'list_responsive_filters:node',\n                openUp: true,\n                openHandlerPattern: '.more.launcher',\n                closeHandlerPattern: '.fewer.launcher',\n                respondOnItemEvents: false,\n                items: allItems[1]\n            }));\n        }\n        return allItems[0];\n    },\n    _createFiltersList: function (filterId, filterMetaData) {\n        var list = new dynamicList.List(filterId, {\n            listTemplateDomId: 'list_responsive_filters',\n            itemTemplateDomId: 'list_responsive_filters:leaf',\n            items: this._createItemsList(filterMetaData)\n        });\n        // When item is selected fire filter event\n        list.observe('item:selected', function (event) {\n            var item = event.memo.item;\n            if (item.getValue().isSeparator || item.getValue().isMore || this._ignoreFilterEvent) {\n                return;\n            }\n            repositorySearch.fire(repositorySearch.Event.SEARCH_FILTER, {\n                filterId: list.getId(),\n                optionId: item.getValue().id\n            });\n        }.bindAsEventListener(this));\n        return list;\n    },\n    select: function (filterId, optionId, isRestore) {\n        var list = this._filtersLists[filterId];\n        var filterOptionSelector = function (item) {\n            if (item.getValue().id == optionId) {\n                if (!item.isSelected()) {\n                    this._ignoreFilterEvent = isRestore;\n                    item.select();\n                    this._ignoreFilterEvent = false;\n                }\n                throw $break;\n            }\n            if (item.isComposite) {\n                var element = item._getElement();\n                if (!baseList.isItemOpen(element)) {\n                    baseList.openItem(element);\n                }\n                if (item.getItems()) {\n                    item.getItems().each(filterOptionSelector);\n                }\n            }\n        }.bind(this);\n        list.getItems().each(filterOptionSelector);\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = jQuery('#' + this._id)[0];\n            jQuery(this._container).hasClass(layoutModule.SWIPE_SCROLL_PATTERN) && (this._container = this._container.children());\n        }\n        return this._container;\n    }\n};\n///////////////////////////////\n// Filter path object\n///////////////////////////////\nrepositorySearch.filterPath = {\n    _containerId: 'filterPath',\n    _contentBodySelector: '.primary.column>.content>.body',\n    initialize: function () {\n        this._filterPathList = new dynamicList.List(this._containerId, {\n            listTemplateDomId: 'list_control_path',\n            itemTemplateDomId: 'list_control_path:step'\n        });    // When item is selected fire rollback event\n        // When item is selected fire rollback event\n        this._filterPathList.observe('item:selected', function (event) {\n            var item = event.memo.item;\n            if (!item.getValue().isLast) {\n                repositorySearch.fire(repositorySearch.Event.SEARCH_ROLLBACK, { position: item.getValue().position });\n            }\n        });\n        return this;\n    },\n    setPathItems: function (pathItems) {\n        if (pathItems.length > 1) {\n            var lastIndex = pathItems.length - 1;\n            var listItems = pathItems.collect(function (pathItem, index) {\n                pathItem.isLast = index == lastIndex;\n                return new dynamicList.ListItem({\n                    label: pathItem.label,\n                    value: pathItem\n                });\n            });\n            this._filterPathList.setItems(listItems);\n            this._filterPathList.show();\n            jQuery('#' + this._containerId).parent().removeClass('hidden');\n            jQuery(document.body).find(this._contentBodySelector).addClass('showingSubHeader');\n        } else {\n            this._filterPathList.setItems([]);\n            this._filterPathList.show();\n            jQuery('#' + this._containerId).parent().addClass('hidden');\n            jQuery(document.body).find(this._contentBodySelector).removeClass('showingSubHeader');\n        }\n    }\n};\n///////////////////////////////\n// Sorters panel object\n///////////////////////////////\nrepositorySearch.sortersPanel = {\n    _LABEL_TEMPLATE_DOM_ID: 'sortPanelLabelTemplate',\n    _containerId: 'sortMode',\n    _ignoreSortEvent: false,\n    sortersList: null,\n    initialize: function (sortersMetaData, selectedSorter) {\n        this.labelItem = new dynamicList.ListItem({\n            label: repositorySearch.getMessage(\"SEARCH_SORT_BY\") + \":\",\n            value: {isLabel: true},\n            templateDomId: \"tabSet_control_horizontal_responsive:label\",\n            respondOnItemEvents: false\n        });\n\n        var sortItems = sortersMetaData.collect(function(sorterMetaData, index) {\n            return new dynamicList.ListItem({\n                label: repositorySearch.getMessage(sorterMetaData.labelId),\n                value: sorterMetaData\n            });\n        });\n\n        this.sortersList = new dynamicList.List(this._containerId, {\n            listTemplateDomId: \"tabSet_control_horizontal_responsive\",\n            itemTemplateDomId: \"tabSet_control_horizontal_responsive:tab\",\n            items: [this.labelItem].concat(sortItems),\n            listOrientation: \"horizontal\"\n        });\n\n        var self = this;\n\n        // When item is selected fire sort event\n        this.sortersList.observe(this.sortersList.Event.ITEM_SELECTED, function(event) {\n            var item = event.memo.item;\n\n            if (item.getValue().isLabel || self._ignoreSortEvent) { return; }\n\n            repositorySearch.sortersPanel.disableItems();\n\n            repositorySearch.fire(repositorySearch.Event.SEARCH_SORT, {\n                sorterId: item.getValue().id\n            });\n        });\n\n        this.sortersList.show();\n\n        this.labelItem.disable();\n\n        this.select(selectedSorter);\n\n        return this;\n    },\n    select: function (sorterId, isRestore) {\n        this.sortersList.getItems().each(function(item) {\n            if (item.getValue().id === sorterId && !item.isSelected()) {\n                this._ignoreSortEvent = isRestore;\n                this.sortersList.selectItem(item);\n                this._ignoreSortEvent = false;\n\n                return;\n            }\n        }.bind(this));\n    },\n    disableItems: function() {\n        var self = this;\n\n        this.sortersList.getItems().each(function(item) {\n            if (item !== self.labelItem) {\n                item.disable();\n                item.refresh();\n            }\n        });\n    },\n\n    enableItems: function() {\n        var self = this;\n\n        this.sortersList.getItems().each(function(item) {\n            if (item !== self.labelItem) {\n                item.enable();\n                item.refresh();\n            }\n        });\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = jQuery('#' + this._containerId)[0];\n        }\n        return this._container;\n    },\n    _getLabelTemplate: function () {\n        var e = jQuery('#' + this._LABEL_TEMPLATE_DOM_ID).clone(true);\n        e.removeAttribute('id');\n        return e;\n    }\n};\n/////////////////////////////////\n// Repository permissions dialog\n/////////////////////////////////\nvar ResourcePermissions = function (resource, event) {\n    this._resource = resource;\n    this._eventSourceFocusableElement = event && ((event.memo && event.memo.focused) || event.findElement('[tabindex=-1]'));\n    this._isVisible = false;\n    this._listId = this.ENTITY_LIST_ID;\n    this._listContainerId = this.LIST_CONTAINER_ID;\n    this._searchBoxId = this.SEARCH_BOX_ID;\n    this.viewBy = 'USER';\n    this._processTemplate();\n};\nResourcePermissions.addVar('TEMPLATE_DOM_ID', 'permissions');\nResourcePermissions.addVar('TOOLTIP_TEMPLATE_DOM_ID', 'orgTooltip');\nResourcePermissions.addVar('LIST_TEMPLATE_ID', 'tabular_twoColumn_setLeft');\nResourcePermissions.addVar('ITEM_TEMPLATE_ID', 'tabular_twoColumn_setLeft:leaf');\nResourcePermissions.addVar('WAIT_ITEM_TEMPLATE_ID', 'tabular_twoColumn_setLeft:loading');\nResourcePermissions.addVar('ENTITY_LIST_ID', 'permissionsList');\nResourcePermissions.addVar('LIST_CONTAINER_ID', 'permissionsListContainer');\nResourcePermissions.addVar('SEARCH_BOX_ID', 'searchPermissionsBox');\nResourcePermissions.addVar('SEARCH_BOX_INPUT_PATTERN', '#permissionsSearchInput');\nResourcePermissions.addVar('NAME_TOOLTIP_PATTERN', '.one');\nResourcePermissions.addVar('NAME_PATTERN', '.one>a.launcher');\nResourcePermissions.addVar('PERMISSIONS_PATTERN', '.two>select');\nResourcePermissions.addVar('VIEW_BY_TAB_SET_PATTERN', '#viewMode');\nResourcePermissions.addVar('TAB_PATTERN', '.tab>p');\nResourcePermissions.addVar('PATH_PATTERN', '.path');\nResourcePermissions.addVar('SUBMIT_BUTTON', '#permissionsOk');\nResourcePermissions.addVar('APPLAY_BUTTON', '#permissionsApply');\nResourcePermissions.addVar('CANCEL_BUTTON', '#permissionsCancel');\nResourcePermissions.addVar('BODY_PATTERN', 'div.body');\nResourcePermissions.addMethod('_processTemplate', function () {\n    this._dom = jQuery('#' + this.TEMPLATE_DOM_ID).clone(true)[0];\n    jQuery(this._dom).attr('id',\"permissionDialog\");\n    jQuery(this._dom).find(this.BODY_PATTERN).attr('id', '');\n    var path = jQuery(this._dom).find(this.PATH_PATTERN)[0];\n    path.update(xssUtil.hardEscape(this._resource.URIString.truncate(80)));\n    jQuery(path).attr('title', this._resource.URIString);\n    jQuery(path).closest('.title').attr('id', \"permissionDialogTitle\");\n    jQuery(path).attr('role', \"heading\");\n    jQuery(path).attr('aria-level', \"1\");\n    this._viewByTabSet = jQuery(this._dom).find(this.VIEW_BY_TAB_SET_PATTERN)[0];\n    this._searchBoxInput = jQuery(this._dom).find(this.SEARCH_BOX_INPUT_PATTERN)[0];\n    this._byUsersButton = jQuery(this._dom).find(this.TAB_PATTERN)[0];\n    this._byRolesButton = jQuery(this._dom).find(this.TAB_PATTERN)[1];\n    this._submitButton = jQuery(this._dom).find(this.SUBMIT_BUTTON)[0];\n    this._applyButton = jQuery(this._dom).find(this.APPLAY_BUTTON)[0];\n    this._cancelButton = jQuery(this._dom).find(this.CANCEL_BUTTON)[0];\n    this._byUsersButton.viewType = 'USER';\n    this._byRolesButton.viewType = 'ROLE';\n    jQuery(this._searchBoxInput).attr('id', null);\n    jQuery(this._submitButton).attr('id', null);\n    jQuery(this._applyButton).attr('id', null);\n    jQuery(this._cancelButton).attr('id', null);\n    var list = jQuery(this._dom).find('#' + this.ENTITY_LIST_ID)[0];\n    var listContainer = jQuery(this._dom).find('#' + this.LIST_CONTAINER_ID)[0];\n    var searchBox = jQuery(this._dom).find('#' + this.SEARCH_BOX_ID)[0];\n    this._listId = jQuery(list).attr('id', null)[0].identify();\n    this._listContainerId = jQuery(listContainer).attr('id', null)[0].identify();\n    this._searchBoxId = jQuery(searchBox).attr('id', null)[0].identify();\n});\nResourcePermissions.addMethod('_updateValueAndLabel', function (element, veSelector, value, leSelector) {\n    var valueElement = jQuery(element).find(veSelector)[0];\n    valueElement.writeAttribute('id', null);\n    valueElement.setValue(value);\n    jQuery(element).find(leSelector).attr('for', valueElement.identify());\n    return valueElement;\n});\nResourcePermissions.addMethod('_updateContentAndLabel', function (element, veSelector, content, leSelector) {\n    var valueElement = jQuery(element).find(veSelector)[0];\n    valueElement.writeAttribute('id', null);\n    valueElement.update(content);\n    jQuery(element).find(leSelector).attr('for', valueElement.identify());\n    return valueElement;\n});\nResourcePermissions.addMethod('_buttonClickHandler', function (e) {\n    var element = e.target;\n    if (!this._waiting) {\n        var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n        var uri = this._resource.URIString;\n        if ([\n            this._submitButton,\n            this._applyButton\n        ].include(button)) {\n            this._hideWarning();\n            repositorySearch.fire(repositorySearch.PermissionEvent.UPDATE, {\n                uri: uri,\n                entities: this.getChangedEntities(),\n                finishEdit: button == this._submitButton\n            });\n        }\n        if ([\n            this._byUsersButton,\n            this._byRolesButton\n        ].include(button)) {\n            if (this.isChanged()) {\n                this._showWarning();\n                e.stopPropagation();\n            } else {\n                this._hideWarning();\n                this.viewBy = button.viewType;\n                repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE, {\n                    uri: uri,\n                    type: this.viewBy\n                });\n            }\n        }\n        [this._cancelButton].include(button) && this.hide();\n    }\n});\nResourcePermissions.addMethod('_keyDownHandler', function (e) {\n    var element = e.target;\n    //on esc key should hide dialog\n    if (e.key === \"Escape\" || e.keyCode === 27) {\n        this.hide();\n    }\n    if (!this._waiting) {\n        let button;\n        var tab = matchAny(element, [layoutModule.TABSET_TAB_PATTERN], true);\n        //If we have focus on role-user TabList section below condition get executed\n        if(tab){\n            let elementTarget;\n            if(e.keyCode === 37){\n                elementTarget = jQuery(element).prev(layoutModule.TABSET_TAB_PATTERN);\n            }else if(e.keyCode === 39){\n                elementTarget = jQuery(element).next(layoutModule.TABSET_TAB_PATTERN);\n            }\n            if(elementTarget && elementTarget.length){\n                let buttonEl = jQuery(elementTarget).find(layoutModule.BUTTON_PATTERN);\n                button = (buttonEl.length) ? buttonEl[0] : null;\n            }\n        }\n        var selectElement = matchAny(element, ['select'], true);\n        //If we have focus on select/dropdown element don't allow default left/right key for option changes\n        if(selectElement) {\n            if(e.keyCode === 37 || e.keyCode === 39){\n                e.preventDefault();\n            }\n        }\n        var uri = this._resource.URIString;\n        if ([\n            this._byUsersButton,\n            this._byRolesButton\n        ].include(button)) {\n            if (this.isChanged()) {\n                this._showWarning();\n                e.stopPropagation();\n            } else {\n                this._hideWarning();\n                this.viewBy = button.viewType;\n                repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE, {\n                    uri: uri,\n                    type: this.viewBy\n                });\n            }\n        }\n    }\n});\nResourcePermissions.addMethod('_showWarning', function () {\n    jQuery(this._dom).find(this.BODY_PATTERN).addClass(layoutModule.ERROR_CLASS);\n    jQuery(layoutModule.MESSAGE_WARNING_PATTERN).focus();\n    jQuery(layoutModule.MESSAGE_WARNING_PATTERN).on({\n        'focus': ()=>{jQuery(layoutModule.MESSAGE_WARNING_PATTERN).addClass('focus-visible')},\n        'blur': ()=>{jQuery(layoutModule.MESSAGE_WARNING_PATTERN).removeClass('focus-visible')}\n    });\n});\nResourcePermissions.addMethod('_hideWarning', function () {\n    jQuery(this._dom).find(this.BODY_PATTERN).removeClass(layoutModule.ERROR_CLASS);\n    jQuery(layoutModule.MESSAGE_WARNING_PATTERN).off('focus blur')\n});\nResourcePermissions.addMethod('_launcherClickHandler', function (e) {\n    var element = e.element();\n    if (!this._waiting) {\n        var launcher = matchAny(element, [this.NAME_PATTERN], true);\n        if (launcher) {\n            var li = jQuery(element).parent('li');\n            if (li && li.listItem) {\n                var value = li.listItem.getValue();\n                value.navigateToManager();\n            }\n        }\n    }\n    e.preventDefault();\n    e.stopPropagation();\n});\nResourcePermissions.addMethod('_selectFocusInHandler', function (e) {\n    var element = e.target;\n    if (this._waiting) {\n        return;\n    }else{\n        //if element or its children has select then make it focusable\n        if (element.tagName === 'SELECT'){\n            element.setAttribute('tabindex', 0);\n            element.focus();\n        }else if(element.children.length && element.children[0].tagName === 'SELECT'){\n            if(element.children[0].hasAttribute('disabled')){\n                element.setAttribute('aria-label', i18n['permissionsDialog.permission.selectDisabledAriaLabel']);\n            }else{\n                element.children[0].setAttribute('tabindex', 0);\n                element.children[0].focus();\n            }\n        }\n    }\n});\n\nResourcePermissions.addMethod('_selectFocusOutHandler', function (e) {\n    var element = e.target;\n    if (this._waiting) {\n        return;\n    }else{\n        if (element.tagName === 'SELECT'){\n            element.setAttribute('tabindex', -1);\n        }else if(element.children.length && element.children[0].tagName === 'SELECT'){\n            element.children[0].setAttribute('tabindex', -1);\n        }\n    }\n});\n\nResourcePermissions.addMethod('_selectChangeHandler', function (e) {\n    var element = e.target;\n    e.stopPropagation();\n    if (this._waiting) {\n        return;\n    }\n    if (element.tagName.toLowerCase() == 'select') {\n        var newPermission = element.options[element.selectedIndex].value;\n        var li = jQuery(element).parents('li')[0];\n        if (li && li.listItem) {\n            var value = li.listItem.getValue();\n            li.listItem.getValue().permission.newPermission = newPermission != value.permission.getResolvedPermission() ? newPermission : undefined;\n            li.listItem.refresh();\n        }\n    }\n});\nResourcePermissions.addMethod('_selectMouseOverHandler', function (e) {\n    var element = matchAny(e.target, [this.PERMISSIONS_PATTERN], true);\n    element && e.stopPropagation()  ;\n});\nResourcePermissions.addMethod('_initControls', function () {\n    this.list = new dynamicList.List(this._listId, {\n        listTemplateDomId: this.LIST_TEMPLATE_ID,\n        itemTemplateDomId: this.ITEM_TEMPLATE_ID\n    });\n    var container = jQuery('#' + this._listId).parents();\n    if (isSupportsTouch()) {\n        if (!this._touchController) {\n            this._touchController = new TouchController(jQuery('#' + this._listId)[0], jQuery('#' + this._listId).parents(), { forceLayout: true });\n        }\n    }\n    this._infiniteScroll = new InfiniteScroll({\n        id: container[0].identify(),\n        contentId: this._listId,\n        scroll: this._touchController || undefined\n    });\n    this._searchBox = new SearchBox({ id: this._searchBoxId });\n    var uri = this._resource.URIString;\n    this._infiniteScroll.onLoad = function () {\n        if (!this._waiting) {\n            repositorySearch.fire(repositorySearch.PermissionEvent.NEXT, {\n                text: this._searchBox.getText(),\n                uri: uri,\n                type: this.viewBy\n            });\n        }\n    }.bind(this);\n    this._searchBox.onSearch = function (text) {\n        if (!this._waiting) {\n            if (this.isChanged()) {\n                this._showWarning();\n            } else {\n                this._hideWarning();\n                repositorySearch.fire(repositorySearch.PermissionEvent.SEARCH, {\n                    text: text,\n                    uri: uri,\n                    type: this.viewBy\n                });\n            }\n        }\n    }.bind(this);\n});\nResourcePermissions.addMethod('show', function () {\n    if (!this._isVisible) {\n        document.body.insert(this._dom);\n        this._initControls();\n        this.list.setItems([]);\n        this.list.show();\n        orgModule.entityList._createEntityItem = this._createEntityItem;\n        this.viewBy = 'ROLE';\n        repositorySearch.fire(repositorySearch.PermissionEvent.BROWSE, {\n            initialize: true,\n            uri: this._resource.URIString,\n            type: this.viewBy,\n            isFolder: this._resource.isFolder()\n        });\n        this._isVisible = true;\n        dialogs.popup.show(this._dom, true);\n        this._clearPositionStyles(this._dom);\n        this._dom.observe('click', this._buttonClickHandler.bindAsEventListener(this));\n        this._dom.observe('keydown', this._keyDownHandler.bindAsEventListener(this));\n        this._dom.observe('focusin', this._selectFocusInHandler.bindAsEventListener(this));\n        this._dom.observe('focusout', this._selectFocusOutHandler.bindAsEventListener(this));\n        if (isSupportsTouch()) {\n            this._viewByTabSet.observe('touchstart', this._buttonClickHandler.bindAsEventListener(this));\n        }\n        this._dom.observe('click', this._launcherClickHandler.bindAsEventListener(this));\n        // Change event not bubbled up in IE\n        //        this._dom.observe('change', this._selectChangeHandler.bindAsEventListener(this));\n        this._dom.observe('mouseover', this._selectMouseOverHandler.bindAsEventListener(this));\n    }\n});\n// Removes positioning styles set by centerElement in dialogs.popup.show method to instead rely on CSS\nResourcePermissions.addMethod('_clearPositionStyles', (element) => {\n    element.style.marginLeft = null;\n    element.style.marginTop = null;\n    element.style.top = null;\n    element.style.left = null;\n});\nResourcePermissions.addMethod('showAndWait', function () {\n    if (!this._isVisible) {\n        this._waiting = true;\n        this.show();\n        this._waitingItem = new dynamicList.ListItem({ templateDomId: this.WAIT_ITEM_TEMPLATE_ID });\n        this.list.addItems([this._waitingItem]);\n        this.list.refresh();\n        this.disable();\n    }\n});\nResourcePermissions.addMethod('stopWaiting', function () {\n    if (this._waiting) {\n        this._waiting = false;\n        this.list.removeItems([this._waitingItem]);\n        this.enable();\n    }\n});\nResourcePermissions.addMethod('hide', function () {\n    dialogs.popup.hide(this._dom);\n    this._dom.remove();\n    this._dom.stopObserving('click');\n    this._dom.stopObserving('change');\n    this._dom.stopObserving('mouseover');\n    if (isSupportsTouch()) {\n        this._viewByTabSet.stopObserving('touchstart');\n    }\n    repositorySearch.dialogsPool.removePermissionsDialog(this._resource);\n    this._eventSourceFocusableElement && this._eventSourceFocusableElement.focus();\n});\nResourcePermissions.addMethod('enable', function () {\n    this._searchBox.enable();\n    buttonManager.enable(this._byUsersButton);\n    buttonManager.enable(this._byRolesButton);\n});\nResourcePermissions.addMethod('disable', function () {\n    this._searchBox.disable();\n    buttonManager.disable(this._byUsersButton);\n    buttonManager.disable(this._byRolesButton);\n});\nResourcePermissions.addMethod('_createItem', function (value) {\n    var item = new dynamicList.ListItem({\n        label: value.getDisplayName(),\n        value: value\n    });\n    var nameTooltipSelector = this.NAME_TOOLTIP_PATTERN;\n    var nameSelector = this.NAME_PATTERN;\n    var permissionsSelector = this.PERMISSIONS_PATTERN;\n    var template = this.TOOLTIP_TEMPLATE_DOM_ID;\n    var _this = this;\n    item.processTemplate = function (element) {\n        var nameTooltip = jQuery(element).find(nameTooltipSelector)[0];\n        var name = jQuery(element).find(nameSelector)[0];\n        var permissions = jQuery(element).find(permissionsSelector)[0];\n        var permission = this.getValue().permission;\n        var tenantId = this.getValue().tenantId;\n        if (permission.newPermission) {\n            jQuery(name).addClass(layoutModule.EMPHASIS_CLASS);\n        } else {\n            jQuery(name).removeClass(layoutModule.EMPHASIS_CLASS);\n        }\n        name.update(xssUtil.hardEscape(this.getValue().getDisplayName()));\n        if (tenantId && tenantId.length > 0) {\n            new JSTooltip(nameTooltip, {\n                text: xssUtil.hardEscape(tenantId),\n                templateId: template\n            });\n            jQuery(nameTooltip).attr('aria-description', `${i18n['tooltip.organization']} ${xssUtil.hardEscape(tenantId)}`);\n            var origRemove = element.remove;\n            element.remove = function () {\n                tooltipModule.hideJSTooltip(nameTooltip);\n                tooltipModule.cleanUp();\n                origRemove.apply(this);\n            };\n        }\n        permissions.update('');\n        var index = 0, permissionsConfig = repositorySearch.model.getConfiguration().permissions;\n        permissionsConfig = _.uniq(permissionsConfig, false, function (p) {\n            return p.labelId;\n        });\n        for (var i = 0; i < permissionsConfig.length; i++) {\n            if (permissionsConfig[i].name === 'REAL_READ_WRITE_DELETE') {\n                permissionsConfig[i].name = \"READ_WRITE_DELETE\";\n            }\n            var label = repositorySearch.getMessage(permissionsConfig[i].labelId);\n            var option = new Element('option', { value: permissionsConfig[i].name });\n            permissions.insert(option.update(permission.inheritedPermission == permissionsConfig[i].name ? xssUtil.hardEscape(label + ' *') : xssUtil.hardEscape(label)));\n            if (permission.newPermission) {\n                permission.newPermission == permissionsConfig[i].name && (index = i);\n            } else {\n                permission.getResolvedPermission() == permissionsConfig[i].name && (index = i);\n            }\n        }\n        permissions.observe('change', _this._selectChangeHandler.bindAsEventListener(_this));\n        permissions.selectedIndex = index;\n        if (this.getValue().permission.isDisabled) {\n            jQuery(permissions).attr('disabled', 'disabled');\n        }\n        return element;\n    };\n    return item;\n});\nResourcePermissions.addMethod('addEntities', function (entities) {\n    var items = entities.collect(this._createItem.bind(this));\n    this.list.addItems(items);\n    this.list.refresh();\n    this._infiniteScroll.stopWaiting();\n});\nResourcePermissions.addMethod('resetList', function (listId) {\n    // removes stdNav(508c) behavior for permissions list\n    // to correct a firefox-only issue with select elements in permissions list\n    // see http://jira.jaspersoft.com/browse/JRS-8471\n    var listUl = jQuery('#' + listId);\n    jQuery(listUl).find('[js-nonmodal-tabindex]').removeAttr('js-nonmodal-tabindex');\n    //jQuery(listUl).find('[js-navtype]').attr('js-navtype', false);\n    //jQuery(listUl).find('[tabindex]').removeAttr('tabindex');\n});\nResourcePermissions.addMethod('scrollReset', function () {\n    var listId = this._listId;\n    var resetList = this.resetList;\n    var scrollBody = jQuery('#' + this._listContainerId).find('.content').find('.body');\n    scrollBody.on('scroll', _.debounce(function () {\n        resetList(listId);\n    }, 100));\n});\nResourcePermissions.addMethod('setEntities', function (entities) {\n    this.list.setItems([]);\n    this._touchController && this._touchController.reset();\n    this.addEntities(entities);\n    this.resetList(this._listId);\n    this.scrollReset();\n});\nResourcePermissions.addMethod('getChangedEntities', function () {\n    var items = this.list.getItems();\n    var changed = [];\n    items.each(function (item) {\n        var value = item.getValue();\n        if (value.permission && value.permission.newPermission) {\n            changed.push(value);\n        }\n    });\n    return changed;\n});\nResourcePermissions.addMethod('updateEntities', function (entities) {\n    var items = this.list.getItems();\n    items.each(function (item) {\n        var value = item.getValue();\n        var updated = entities.detect(function (entity) {\n            return entity.equals(value);\n        });\n        if (updated) {\n            item.setValue(updated);\n            item.refresh();\n        }\n    });\n});\nResourcePermissions.addMethod('isChanged', function () {\n    return this.getChangedEntities().length > 0;\n});\n\nrepositorySearch.resourcePermissionsObj = {\n    ResourcePermissions\n};\n\n/////////////////////////////////////////////////////////////////\n// Poll with all properties and permissions dialogs.\n// Use this pool object to create instances of those dialogs.\n/////////////////////////////////////////////////////////////////\nrepositorySearch.dialogsPool = {\n    POOL_NOT_FOUND_EXCEPTION: 'PoolNotFoundException',\n    DIALOD_EXIST_EXCEPTION: 'DialodExistException',\n    NULL_RESOURCE_EXCEPTION: 'NullResourceException',\n    _permissionsDialogPool: {},\n    _propertiesDialogPool: {},\n    _getPool: function (clazz) {\n        var pool;\n        clazz == ResourcePermissions && (pool = this._permissionsDialogPool);\n        clazz == ResourceProperties && (pool = this._propertiesDialogPool);\n        if (pool) {\n            return pool;\n        } else {\n            throw {\n                name: this.POOL_NOT_FOUND_EXCEPTION,\n                message: 'Can\\'t find pool for ' + clazz.toString()\n            };\n        }\n    },\n    _createDialog: function (clazz, resource, options) {\n        var uri = resource.URIString;\n        var pool = this._getPool(clazz);\n        if (resource == null) {\n            throw {\n                name: this.NULL_RESOURCE_EXCEPTION,\n                message: 'Resource is null.'\n            };\n        }\n        if (!pool[uri]) {\n            pool[uri] = new clazz(resource, options);\n        } else {\n            throw {\n                name: this.DIALOD_EXIST_EXCEPTION,\n                message: clazz.toString() + ' dilaog for resource \\'' + uri + '\\' arleady exist.'\n            };\n        }\n        return pool[uri];\n    },\n    _createOrGetDialog: function (clazz, resource, options) {\n        try {\n            return this._createDialog(clazz, resource, options);\n        } catch (e) {\n            if (e.name == this.DIALOD_EXIST_EXCEPTION) {\n                return this._getDialog(clazz, resource);\n            } else {\n                throw e;\n            }\n        }\n    },\n    _getDialog: function (clazz, resourceOrUri) {\n        var uri = Object.isString(resourceOrUri) ? resourceOrUri : resourceOrUri.URIString;\n        return this._getPool(clazz)[uri];\n    },\n    _getAllDialogs: function (clazz) {\n        var pool = this._getPool(clazz), dialogs = [];\n        for (var uri in pool) {\n            pool[uri] && dialogs.push(pool[uri]);\n        }\n        return dialogs;\n    },\n    _removeDialog: function (clazz, resourceOrUri) {\n        var uri = Object.isString(resourceOrUri) ? resourceOrUri : resourceOrUri.URIString;\n        this._getPool(clazz)[uri] = undefined;\n    },\n    createPermissionsDialog: function (resource) {\n        return this._createDialog(ResourcePermissions, resource);\n    },\n    createPropertiesDialog: function (resource) {\n        return this._createDialog(ResourceProperties, resource);\n    },\n    createOrGetPermissionsDialog: function (resource, event) {\n        return this._createOrGetDialog(ResourcePermissions, resource, event);\n    },\n    createOrGetPropertiesDialog: function (resource, options) {\n        return this._createOrGetDialog(ResourceProperties, resource, options);\n    },\n    getAllPermissionsDialogs: function () {\n        return this._getAllDialogs(ResourcePermissions);\n    },\n    getAllPropertiesDialogs: function () {\n        return this._getAllDialogs(ResourceProperties);\n    },\n    getPermissionsDialog: function (resourceOrUri) {\n        return this._getDialog(ResourcePermissions, resourceOrUri);\n    },\n    getPropertiesDialog: function (resourceOrUri) {\n        return this._getDialog(ResourceProperties, resourceOrUri);\n    },\n    removePermissionsDialog: function (resourceOrUri) {\n        return this._removeDialog(ResourcePermissions, resourceOrUri);\n    },\n    removePropertiesDialog: function (resourceOrUri) {\n        return this._removeDialog(ResourceProperties, resourceOrUri);\n    }\n};    /////////////////////////////////\n// Repository properties dialog\n/////////////////////////////////\n/////////////////////////////////\n// Repository properties dialog\n/////////////////////////////////\nvar ResourceProperties = function (resource, options) {\n    this._resource = resource;\n    this._changedCallback = options.changedCallback;\n    this._showMode = options.showMode;\n    this._processTemplate();\n};\nResourceProperties.addVar('TEMPLATE_DOM_ID', 'propertiesResource');\nResourceProperties.addMethod('_processTemplate', function () {\n    this._dom = jQuery('#' + this.TEMPLATE_DOM_ID).clone(true)[0];;\n    jQuery(this._dom).attr('id', null);\n    jQuery(this._dom).addClass('_activeResourcePropertiesDialog');\n    var title = jQuery(this._dom).find('.title')[0];\n    title.update(jQuery(title).html().strip() + ': ' + xssUtil.hardEscape(this._resource.label).truncate(50));\n    this._label = this._updateValueAndLabel(this._dom, 'input#displayName', this._resource.label, 'label[for=\"displayName\"]');\n    this._description = this._updateContentAndLabel(this._dom, 'textarea#description', xssUtil.hardEscape(this._resource.description), 'label[for=\"description\"]');\n    this._path = this._updateValueAndLabel(this._dom, 'input#path', xssUtil.hardEscape(this._resource.URIString), 'label[for=\"path\"]');\n    if (this._showMode) {\n        jQuery(this._dom).addClass('showMode');\n        jQuery(this._label).attr('readonly', 'readonly');\n        jQuery(this._description).attr('readonly', 'readonly');\n    }\n    this._updateValueAndLabel(this._dom, 'div#resourceID', xssUtil.hardEscape(this._resource.name), 'label[for=\"resourceID\"]');\n    this._updateValueAndLabel(this._dom, 'input#type', xssUtil.hardEscape(this._resource.type), 'label[for=\"type\"]');\n    this._updateValueAndLabel(this._dom, 'input#createdDate', xssUtil.hardEscape(this._resource.date), 'label[for=\"createdDate\"]');\n    this._updateValueAndLabel(this._dom, 'input#userAccess', xssUtil.hardEscape(this._resource.permissionsToString()), 'label[for=\"userAccess\"]');\n    this._submitButton = jQuery(this._dom).find('button.submit')[0];\n    this._cancelButton = jQuery(this._dom).find('button.cancel')[0];\n    this._okButton = jQuery(this._dom).find('button.ok')[0];\n});\nResourceProperties.addMethod('_updateValueAndLabel', function (element, veSelector, value, leSelector) {\n    var valueElement = jQuery(element).find(veSelector)[0];\n    jQuery(valueElement).attr('id', null);\n    jQuery(valueElement).attr('value', value);\n    valueElement.setValue ? valueElement.setValue(value) : valueElement.update(value);\n    jQuery(element).find(leSelector).attr('for', valueElement.identify());\n    return valueElement;\n});\nResourceProperties.addMethod('_updateContentAndLabel', function (element, veSelector, content, leSelector) {\n    var valueElement = jQuery(element).find(veSelector)[0];\n    jQuery(valueElement).attr('id', null);\n    valueElement.update(content);\n    jQuery(element).find(leSelector).attr('for', valueElement.identify());\n    return valueElement;\n});\nResourceProperties.addMethod('_buttonClickHandler', function (e) {\n    var button = matchAny(e.target, [layoutModule.BUTTON_PATTERN], true);\n    if (button == this._submitButton) {\n        if (this._showMode) {\n            this._hide();\n        } else {\n            if (this._isDataValid()) {\n                if (this._changedCallback) {\n                    var resource = this._resource.clone();\n                    resource.label = this._label.getValue();\n                    resource.description = this._description.getValue();\n                    this._changedCallback(resource);\n                }\n                this._hide();\n            }\n        }\n    } else if (button == this._cancelButton || button == this._okButton) {\n        this._hide();\n    }\n});\nResourceProperties.addMethod('_isDataValid', function (e) {\n    return ValidationModule.validate([\n        {\n            validator: ResourcesUtils.labelValidator,\n            element: this._label\n        },\n        {\n            validator: ResourcesUtils.descriptionValidator,\n            element: this._description\n        }\n    ]);\n});\nResourceProperties.addMethod('show', function (options) {\n    document.body.insert(this._dom);\n    if (options && options.cascade) {\n        dialogs.popup.show(this._dom, false, options);\n    } else {\n        dialogs.popup.show(this._dom);\n    }\n    this._dom.observe('click', this._buttonClickHandler.bindAsEventListener(this));\n});\nResourceProperties.addMethod('_hide', function () {\n    dialogs.popup.hide(this._dom);\n    this._dom.remove();\n    this._dom.stopObserving('click');\n    repositorySearch.dialogsPool.removePropertiesDialog(this._resource);\n});\nResourceProperties.addMethod('isChanged', function () {\n    return this._resource.label != this._label.getValue() || this._resource.description != this._description.getValue();\n});\nrepositorySearch.showCreateFolderConfirm = function (folder) {\n    var toFolder;\n    var dialog = jQuery('#addFolder')[0], name = jQuery('#addFolderInputName')[0], description = jQuery('#addFolderInputDescription')[0], add = jQuery('#addFolderBtnAdd')[0], cancel = jQuery('#addFolderBtnCancel')[0];\n    var doShow = function (folder) {\n        toFolder = folder;\n        dialogs.popup.show(dialog, true, {closable: true});\n        name.setValue(repositorySearch.messages['action.create.folder.name']);\n        setTimeout(function () {\n            name.focus();\n            name.select();\n        }, 500);\n    };\n    var doHide = function (event) {\n        name.clear();\n        description.clear();\n        ValidationModule.hideError(name);\n        ValidationModule.hideError(description);\n        dialogs.popup.hide(dialog);\n        event.stopPropagation();\n    };\n    var doValidate = function () {\n        var isLabelValid = ValidationModule.validate([\n            {\n                validator: ResourcesUtils.labelValidator,\n                element: name\n            }\n        ]);\n        const isDescriptionValid = ValidationModule.validate([\n            {\n                validator: ResourcesUtils.descriptionValidator,\n                element: description\n            }\n        ]);\n\n        if (!isLabelValid) {\n            jQuery('#addFolderInputName').focus();\n        } else if (!isDescriptionValid) {\n            jQuery('#addFolderInputDescription').focus();\n        }\n        return isLabelValid && isDescriptionValid;\n    };\n    var doAdd = function (event) {\n        if (jQuery(add).attr('disabled') === 'disabled') {\n            return;\n        }\n        new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.CREATE, {\n            toFolder: toFolder,\n            label: name.getValue(),\n            desc: description.getValue(),\n            dialog: dialog\n        }).invokeAction();\n        doHide(event);\n    };\n    add.observe('click', function (event) {\n        if (doValidate()) {\n            doAdd(event);\n        }\n        event.stopPropagation();\n    });\n    cancel.observe('click', (event) => {\n        doHide(event);\n        dialogs.popup.hide(dialog);\n    });\n    repositorySearch.showCreateFolderConfirm = doShow;\n    doShow(folder);\n};\nrepositorySearch.DeleteConfirmation = {\n    ID_DELETE_DIALOG_CONTAINER: 'standardConfirm',\n    ID_DELETE_DIALOG_OK_BUTTON: 'deleteResourceOK',\n    ID_DELETE_DIALOG_CANCEL_BUTTON: 'deleteResourceCancel'\n};\nrepositorySearch.showDeleteFolderConfirm = function (folder, event) {\n    var message = repositorySearch.getMessage('SEARCH_DELETE_FOLDER_CONFIRM_MSG', { folderUri: folder.URI });\n    var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.DELETE, { folder: folder });\n    repositorySearch._showDeleteDialog(message, action, event);\n};\nrepositorySearch.showDeleteResourceConfirm = function (resource, event) {\n    var message = repositorySearch.getMessage('SEARCH_DELETE_CONFIRM_MSG', { resourceUri: resource.URIString });\n    var action = new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.DELETE, { resources: [resource] });\n    repositorySearch._showDeleteDialog(message, action, event);\n};\nrepositorySearch.showBulkDeleteResourcesConfirm = function (resources, event) {\n    var message = repositorySearch.getMessage('SEARCH_BULK_DELETE_CONFIRM_MSG', { count: resources.length });\n    var action = new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.DELETE, { resources: resources });\n    repositorySearch._showDeleteDialog(message, action, event);\n};\nrepositorySearch._showDeleteDialog = function (message, action, event) {\n    let dialogText = xssUtil.hardEscape(message),\n        focusTarget = event\n            && ((event.type === 'mouseup' && event.target.ancestors().filter(element => element.hasClassName(\"selected\"))[0])\n                || (event.type === 'dataavailable' && event.target)),\n        confirmDialogOpts = {\n            title: i18n['DIALOG_CONFIRM_TITLE'],\n            text: dialogText,\n            buttons: [\n                {\n                    label: i18n['DIALOG_CONFIRM_BUTTON_LABEL_OK'],\n                    action: 'yes',\n                    primary: true\n                },\n                {\n                    label: i18n['DIALOG_CONFIRM_BUTTON_LABEL_CANCEL'],\n                    action: 'no',\n                    primary: false\n                }\n            ],\n            returnFocusTo: focusTarget\n        },\n        confirmDialog = new ConfirmationDialog(confirmDialogOpts);\n\n    confirmDialog.setReturnFocus(focusTarget);\n\n    confirmDialog.on(\"button:yes\", () => action.invokeAction());\n    confirmDialog.on(\"button:no\", () => confirmDialog.close());\n\n    confirmDialog.open();\n};\nrepositorySearch.showResourceProperties = function (resource, options) {\n    var resourceProperties = repositorySearch.dialogsPool.createOrGetPropertiesDialog(resource, { showMode: true });\n    resourceProperties.show(options);\n};\nrepositorySearch.editResourceProperties = function (resource, options) {\n    var resourceProperties = repositorySearch.dialogsPool.createOrGetPropertiesDialog(resource, {\n        changedCallback: function (resource) {\n            var action = new repositorySearch.ServerAction.createResourceAction(repositorySearch.ResourceAction.UPDATE, { resource: resource });\n            action.invokeAction();\n        }\n    });\n    resourceProperties.show(options);\n};\nrepositorySearch.showFolderProperties = function (folder) {\n    var folderProperties = repositorySearch.dialogsPool.createOrGetPropertiesDialog(folder, { showMode: true });\n    folderProperties.show();\n};\nrepositorySearch.editFolderProperties = function (folder) {\n    var folderProperties = repositorySearch.dialogsPool.createOrGetPropertiesDialog(folder, {\n        changedCallback: function (folder) {\n            var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.FolderAction.UPDATE, { folder: folder });\n            action.invokeAction();\n        }\n    });\n    folderProperties.show();\n};\nrepositorySearch.addToFavorite = function (resources, itemHovered) {\n    const resourceSelectedElement = jQuery(this._container).find('.resources.selected'),\n        selectedElem = itemHovered? itemHovered : resourceSelectedElement;\n    let url = __jrsConfigs__.contextPath + '/rest_v2/favorites';\n    const selectedResourceList = ResourcesUtils.getSelectedResourceUris(resources);\n    const isItemMarkedAsFav = resources.every((resource)=>{\n        return resource.isFavorite;\n    });\n    if ( !isItemMarkedAsFav ) {\n        repositorySearch.onFavoriteItem(url, selectedResourceList).then(()=>{\n            selectedElem.addClass(layoutModule.FAVORITE_CLASS).find('[role=\"checkbox\"]').first().attr(\"aria-checked\", true);\n            repositorySearch.setFavorite(resources);\n        });\n    } else {\n        url = url+ '/delete';\n        repositorySearch.onFavoriteItem(url, selectedResourceList).then(()=>{\n            selectedElem.removeClass(layoutModule.FAVORITE_CLASS).find('[role=\"checkbox\"]').first().attr(\"aria-checked\", false);\n            repositorySearch.setFavorite(resources);\n        });\n    }\n};\n\nrepositorySearch.setFavorite = function(resources){\n    resources.forEach((resource)=>{\n        resource.isFavorite = ! resource.isFavorite\n    });\n};\nrepositorySearch.editResourcePermissions = function (resource, event) {\n    var dialog = repositorySearch.dialogsPool.createOrGetPermissionsDialog(resource, event);\n    dialog.showAndWait();\n};\nrepositorySearch.editFolderPermissions = function (folder, event) {\n    var dialog = repositorySearch.dialogsPool.createOrGetPermissionsDialog(folder, event);\n    dialog.showAndWait();\n};\nrepositorySearch.showUploadThemeConfirm = function (folder, reupload) {\n    var toFolder;\n    var isReupload;\n    var dialog = jQuery('#uploadTheme')[0], themeName =jQuery('#themeName')[0], zip = jQuery('#themeZip')[0], upload = jQuery('#uploadThemeBtnUpload')[0], cancel = jQuery('#uploadThemeBtnCancel')[0];\n    var doShow = function (folder, reupload) {\n        toFolder = folder;\n        isReupload = reupload;\n        dialogs.popup.show(dialog);\n        themeName.removeAttribute('disabled');\n        themeName.setValue(repositorySearch.messages['RM_NEW_THEME_NAME']);\n        if (isReupload) {\n            jQuery(themeName).attr('disabled');\n            themeName.setValue(toFolder.name);\n        }\n        themeName.select();\n        themeName.focus();\n    };\n    var doHide = function (event) {\n        themeName.clear();\n        zip.clear();\n        dialogs.popup.hide(dialog);\n        event.stopPropagation();\n    };\n    var doValidate = function () {\n        var isValid = ValidationModule.validate([\n            {\n                validator: ResourcesUtils.labelValidator,\n                element: themeName\n            },\n            {\n                validator: ResourcesUtils.zipFileTypeValidator,\n                element: zip\n            }\n        ]);\n        return isValid;\n    };\n    var doUpload = function (event) {\n        var options = {};\n        options.themeName = themeName.getValue();\n        options._eventId = 'uploadTheme';\n        options._flowExecutionKey = repositorySearch.flowExecutionKey;\n        options.folderUri = toFolder.URI;\n        options.folderUri = toFolder.URI;\n\n        if (isReupload) {\n            var basicURI = toFolder.URI;\n            options.folderUri = basicURI.slice(0, basicURI.lastIndexOf('/'));\n            options.reuploadAction = isReupload;\n            options._eventId = 'reuploadTheme';\n        }\n        var callback = function (responseBody) {\n            var respObj;    //zip var should be refreshed to point to correct file input\n            //zip var should be refreshed to point to correct file input\n            zip = jQuery('#themeZip')[0];\n            if (responseBody) {\n                try {\n                    respObj = responseBody.evalJSON();\n                    if (respObj && respObj.status == 'OK') {\n                        if (respObj.data.themeExist) {\n                            var msg = repositorySearch.messages[\"SEARCH_OVERWRITE_THEME_CONFIRM_MSG\"];\n\n                            var dialog = new ConfirmationDialog({ text: msg} );\n                            dialog.on(\"button:yes\", function() {\n                                var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.REUPLOAD, options);\n                                action.invokeAction();\n                                self.close() && self.remove();\n                            });\n\n                            dialog.on(\"button:no\", function(){\n                                self.close() && self.remove();\n                            });\n                            dialog.open();\n                        } else if (respObj.data.isActiveTheme) {\n                            var uri = respObj.data.themeUri;\n                            var action = new repositorySearch.ServerAction.createFolderAction(repositorySearch.ThemeAction.SETTHEME, { folderUri: uri });\n                            action.invokeAction();\n                        }\n                    } else if (respObj && respObj.status == 'ERROR') {\n                        alert(respObj.data);\n                    } else {\n                        alert(repositorySearch.messages['RM_UPLOAD_THEME_ERROR']);\n                    }\n                } catch (ex) {\n                    alert(ex);\n                }\n            }    //for all cases, except active theme re-uploade (for this action handler of \"theme:updated\" event will reload window)\n            //for all cases, except active theme re-uploade (for this action handler of \"theme:updated\" event will reload window)\n            if (!isReupload || !respObj.data.isActiveTheme) {\n                repositorySearch.foldersPanel.refreshFolder(toFolder);\n            }\n        };\n\n        fileSender.upload(zip, 'searchFlow', options, callback);\n        doHide(event);\n    };\n    upload.observe('click', function (event) {\n        if (doValidate()) {\n            doUpload(event);\n        }\n        event.stopPropagation();\n    });\n    cancel.observe('click', doHide);\n    repositorySearch.showUploadThemeConfirm = doShow;\n    doShow(folder, reupload);\n};\n\nexport default repositorySearch;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport repositorySearchActions from './repository.search.actions';\nimport repositorySearchComponents from './repository.search.components';\nimport {repositorySearch} from './repository.search.main';\n\nlet repositorySearchRoot = Object.assign(repositorySearch, repositorySearchActions, repositorySearchComponents);\n\n// expose to global scope\nwindow.repositorySearch = repositorySearchRoot;\n\nexport default repositorySearchRoot;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\nimport dialogs from './components.dialogs';\nimport _ from 'underscore';\nimport layoutModule from '../core/core.layout';\nimport {dynamicList} from './list.base';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport jQuery from 'jquery';\n\ndialogs.dependentResources = {\n    dependenciesPanel: null,\n\n    show: function(resources, actionsMap, options) {\n        this.dependenciesPanel = jQuery(\"#dependencies\");\n        this._$title = this.dependenciesPanel.find(\".content .header .title\");\n        if(options.dialogTitle) {\n            this._titleBackup = this._$title.html();\n            this._$title.html(options.dialogTitle);\n        }\n        dialogs.popup.show(this.dependenciesPanel[0]);\n\n        this._changeMessage(options);\n        this._switchButtons(options);\n        var list =\n            this._initList(resources);\n\n        ///////////////////////////////////////////////////////////\n        // Observe buttons\n        //////////////////////////////////////////////////////////\n        this.dependenciesPanel.on(\"click\", function(event){\n            var buttonId = jQuery(event.target).closest('button').attr('id');\n            var action = actionsMap && actionsMap[buttonId];\n            if (_.include([\"dependenciesBtnSave\", \"dependenciesBtnSaveAs\", \"dependenciesBtnOk\", \"dependenciesBtnCancel\"], buttonId)) {\n                dialogs.dependentResources.hide();\n                list.setItems([]);\n\n                event.stopPropagation();\n\n                action && action();\n            }\n        });\n        //        designerBase.enableSelection();\n    },\n\n    hide: function () {\n        if (this.dependenciesPanel) {\n            this.dependenciesPanel.off(\"click\");\n            dialogs.popup.hide(this.dependenciesPanel[0]);\n            this.dependenciesPanel = null;\n        }\n        if (this._titleBackup && this._$title) {\n            this._$title.html(this._titleBackup);\n            this._titleBackup = null;\n        }\n    },\n\n    /**\n     * Show message\n     *\n     * @param canSave\n     * @private\n     */\n    _changeMessage: function(options) {\n        jQuery(\"#topMessage\").html(options.topMessage);\n        jQuery(\"#bottomMessage\").html(options.bottomMessage);\n    },\n\n    _initList: function(resources) {\n        var list = new dynamicList.List(\"dependenciesList\", {\n            listTemplateDomId: \"tabular_oneColumn\",\n            itemTemplateDomId: \"tabular_oneColumn:leaf\"\n        });\n\n        var items = [];\n        if(resources) {\n            items = resources.collect(function(resource) {\n                var resourceItem = new dynamicList.ListItem({\n                    cssClassName: layoutModule.LEAF_CLASS,\n                    value: resource\n                });\n\n                resourceItem.processTemplate = function(element) {\n                    var uriElement = jQuery(element).find(\".uri\");\n                    var uri;\n                    if(typeof this.getValue() == \"string\") {\n                        uri = this.getValue();\n                    } else if(this.getValue().uristring) {\n                        uri = this.getValue().uristring;\n                    } else {\n                        uri = this.getValue().URIString;\n                    }\n\n                    uriElement.html(xssUtil.hardEscape(uri));\n                    return element;\n                };\n                return resourceItem;\n            });\n        }\n\n        list.setItems(items);\n        list.show();\n\n        return list;\n    },\n\n    _switchButtons: function(options) {\n        var $buttonElements = {\n            save:  jQuery(\"#dependenciesBtnSave\"),\n            saveAs: jQuery(\"#dependenciesBtnSaveAs\"),\n            ok: jQuery(\"#dependenciesBtnOk\"),\n            cancel: jQuery(\"#dependenciesBtnCancel\")\n        };\n\n        var buttons;\n        if(options.buttons) {\n            buttons = options.buttons;\n        } else {\n            if(options.okOnly) {\n                buttons = [\"ok\"];\n            } else if (options.canSave) {\n                buttons = [\"save\", \"saveAs\", \"cancel\"];\n            } else {\n                buttons = [\"ok\", \"cancel\"];\n            }\n        }\n\n        _.each($buttonElements, function($button, key) {\n            if(buttons.indexOf(key) < 0 ) {\n                $button.addClass(\"hidden\");\n            } else {\n                $button.removeClass(\"hidden\");\n            }\n        });\n\n    }\n};\n\nexport default dialogs.dependentResources;","/*\n * Copyright (C) 2005 - 2019 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport repositorySearch from '../repository/repository.search.root';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport {dynamicList} from '../components/list.base';\nimport _ from 'underscore';\n\nimport 'backbone';\n\nimport '../components/components.dependent.dialog';\nimport '../components/components.toolbarButtons.events';\nimport '../components/components.tooltip';\n\nimport '../util/tools.infiniteScroll';\nimport '../manage/mng.common';\n\n_.extend(repositorySearch.messages, jrsConfigs.repositorySearch.i18n);\n_.extend(dynamicList.messages, jrsConfigs.dynamicList.i18n);\n_.extend(window.localContext, jrsConfigs.repositorySearch.localContext);\nrepositorySearch.initialize(window.localContext);\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n// This settings store will be filled with the actual settings loaded from the server\n\nexport default {};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {doNothing, isSupportsTouch, isIPad} from \"./utils.common\";\nimport jQuery from 'jquery';\n\nvar InfiniteScroll = function (options) {\n    this._id = options.id;\n    this._contentId = options.contentId ? options.contentId : undefined;\n    this._scroll = options.scroll;\n    this._loadFactor = options.loadFactor ? options.loadFactor : 0.95;\n    this._lastContentHeight = 0;\n    this._loading = false;    // getting control from 'id' of jquery object or from DOM element\n    // getting control from 'id' of jquery object or from DOM element\n    if (options.control) {\n        if (options.control.length !== undefined && options.control.length > 1) {\n            this._control = jQuery(options.control[0]);\n        } else {\n            this._control = jQuery(options.control)[0];\n        }\n    } else {\n        this._control = this._scroll ? this._scroll.parent : jQuery('#' + this._id)[0];\n    }\n    if (this._scroll) {\n        this._content = this._scroll.element;\n    } else {\n        // getting content from 'id' of jquery object or from DOM element\n        if (options.content) {\n            if (options.content.length !== undefined && options.content.length > 1) {\n                this._content = jQuery(options.content[0]);\n            } else {\n                this._content = jQuery(options.content)[0];\n            }\n        } else {\n            this._content = this._contentId ? jQuery('#' + this._contentId)[0] : this._control.childElements()[0];\n        }\n    }\n    this._eventType = isSupportsTouch() ? 'touchmove' : 'scroll';\n    this._control.observe(this._eventType, this._onScrollHandler.bind(this));\n};\n/**\n\t * Destroys the infinite scroll.\n\t */\nInfiniteScroll.addMethod('destroy', function () {\n    if (this._control) {\n        this._control.stopObserving(this._eventType, this._handler);\n    }\n});    /**\n\t * Handler for scroll event on the control element.\n\t */\n/**\n\t * Handler for scroll event on the control element.\n\t */\nInfiniteScroll.addMethod('_onScrollHandler', function (e) {\n    var controlScrollTop = this._scroll ? this._scroll.y * -1 : this._control.scrollTop;\n    var contentHeight = this._content.getHeight();\n    var controlHeight = this._control.getHeight();\n    if (contentHeight != this._lastContentHeight) {\n        this._loading = false;\n    }\n    var allowLoad = !this._loading && contentHeight != 0;\n    if (this._scroll) {\n        allowLoad = allowLoad && this._scroll.isBottom();\n    } else {\n        allowLoad = allowLoad && (controlHeight + controlScrollTop) / contentHeight > this._loadFactor;\n    }\n    if (allowLoad) {\n        this._loading = true;\n        this._lastContentHeight = contentHeight;\n        isIPad() && this.wait();\n        this.onLoad();\n    }\n});    /**\n\t * This method is invoked when new data should be loaded. Actually it should load new data. The method should be\n\t * replaced in the instance of InfiniteScroll class. Next invocation of onLoad method will not occur till the content\n\t * element height changed.\n\t */\n/**\n\t * This method is invoked when new data should be loaded. Actually it should load new data. The method should be\n\t * replaced in the instance of InfiniteScroll class. Next invocation of onLoad method will not occur till the content\n\t * element height changed.\n\t */\nInfiniteScroll.addMethod('onLoad', doNothing);    /**\n\t * Resets the infinite scroll for totally new content. This method should be invoked in case the old data is cleaned\n\t * and the new data is set to the content element. Do not invoke this method in case new data is added in onLoad\n\t * method - this case is processed automatically.\n\t *\n\t * The method also moves the slider of the scroll in control element to top position.\n\t */\n/**\n\t * Resets the infinite scroll for totally new content. This method should be invoked in case the old data is cleaned\n\t * and the new data is set to the content element. Do not invoke this method in case new data is added in onLoad\n\t * method - this case is processed automatically.\n\t *\n\t * The method also moves the slider of the scroll in control element to top position.\n\t */\nInfiniteScroll.addMethod('reset', function () {\n    isIPad() ? this._scroll.reset() : this._control.scrollTop = 0;\n    this._loading = false;\n});\nInfiniteScroll.addMethod('wait', function () {\n    if (!this._waitIndicator) {\n        this._waitIndicator = new Element('div', { 'class': 'dimmer resultsOverlay' });\n        var dimensions = this._control.getDimensions();\n        var offsets = this._control.positionedOffset();\n        this._waitIndicator.setStyle({\n            zIndex: '4000',\n            top: offsets.top + 'px',\n            left: offsets.left + 'px',\n            height: dimensions.height + 'px',\n            width: dimensions.width + 'px'\n        });\n        this._control.insert({ after: this._waitIndicator });\n    }\n    this._waitIndicator.show();\n});\nInfiniteScroll.addMethod('stopWaiting', function () {\n    this._waitIndicator && this._waitIndicator.hide();\n});    // TODO: remove it when we move Repository Search into AMD style\n// Make it global due to RepositorySearch modules\n// TODO: remove it when we move Repository Search into AMD style\n// Make it global due to RepositorySearch modules\nwindow.InfiniteScroll = InfiniteScroll;\nexport default InfiniteScroll;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n* @author: Zakhar Tomchenko, Kostiantyn Tsaregradskyi\n* @version: $Id$\n*/\n\nimport _ from 'underscore';\nimport $ from 'jquery';\nimport Dimmer from '../base/Dimmer';\nimport Panel from '../panel/Panel';\nimport OptionContainer from '../base/OptionContainer';\n\nimport resizablePanelTrait from '../panel/trait/resizablePanelTrait';\nimport dialogTemplate from './template/dialogTemplate.htm';\nimport dialogButtonTemplate from './template/dialogButtonTemplate.htm';\nimport 'jquery-ui/ui/widgets/draggable';\nimport stdnav from \"../../stdnav/stdnav\";\n\nvar Dialog = Panel.extend(/** @lends Dialog.prototype */{\n    defaultTemplate: dialogTemplate,\n\n    events: {\n        \"mousedown\": \"_focus\",\n        \"touchstart\": \"_focus\",\n        \"keydown\": \"_onKeyDown\",\n        \"keyup\": \"_onKeyboardEvent\",\n        \"keypress\": \"_onKeyboardEvent\",\n        \"resize\": \"_onDialogResize\"\n    },\n\n    /**\n     * @constructor Dialog\n     * @classdesc Base Dialog component\n     * @extends Panel\n     * @param {object} [options] Options for Dialog. For panel-specfic options see {@link Panel#constructor}\n     * @param {boolean} [options.resizable=false] If dialog is resizable\n     * @param {boolean} [options.modal=false] If dialog is modal\n     * @param {object[]} [options.buttons] Buttons for dialog\n     * @param {string} options.buttons[].action Button action\n     * @param {string} options.buttons[].label Button label\n     * @param {boolean} options.buttons[].primary If button is primary\n     * @fires Dialog#button:ACTION\n     */\n    constructor: function(options) {\n        options || (options = {});\n        options.traits || (options.traits = []);\n\n        this.resizable = options.resizable || false;\n        this.modal = options.modal || false;\n        this.id = options.id;\n        this.titleContainerId = options.titleContainerId;\n        this.bodyContainerId = options.bodyContainerId;\n        this.additionalBodyCssClasses = options.additionalBodyCssClasses || \"\";\n        this.returnFocusTo = options.returnFocusTo || false;\n\n        if (this.resizable && _.indexOf(options.traits, resizablePanelTrait) === -1) {\n            options.traits.push(resizablePanelTrait);\n        }\n\n        Panel.call(this, options);\n    },\n\n    initialize: function(options) {\n        this.dialogOptions = _.extend({}, options);\n        this.collapsed = !this.collapsed;\n        this.resetSizeOnOpen = _.isUndefined(options.resetSizeOnOpen) ? true : options.resetSizeOnOpen;\n\n        if(!_.isEmpty(options.buttons)) {\n            this.buttons = new OptionContainer({\n                options:options.buttons,\n                el: this.$(\".jr-mDialog-footer\")[0] || this.$(\".footer\")[0],\n                contextName:\"button\",\n                optionTemplate: options.dialogButtonTemplate || dialogButtonTemplate\n            });\n        }\n\n        Panel.prototype.initialize.apply(this, arguments);\n\n        /**\n         * @event Dialog#button:ACTION\n         */\n        // re-trigger button events on dialog itself\n        this.buttons && this.listenTo(\n            this.buttons,\n            _.map(options.buttons, function(button) { return \"button:\" + button.action; }).join(\" \"),\n            _.bind(function(buttonView, buttonModel) { this.trigger(\"button:\" + buttonModel.get(\"action\"), buttonView, buttonModel); }, this));\n\n        this.render();\n    },\n\n    getTemplateArguments: function () {\n        var\n            templateArguments = Panel.prototype.getTemplateArguments.apply(this, arguments);\n\n        return _.extend(templateArguments, {\n            id: this.id,\n            titleContainerId: this.titleContainerId,\n            bodyContainerId: this.bodyContainerId,\n            additionalBodyCssClasses: this.additionalBodyCssClasses\n        });\n    },\n\n    setElement: function(el) {\n        var res = Panel.prototype.setElement.apply(this, arguments);\n\n        this.buttons && this.buttons.setElement(this.$(\".jr-mDialog-footer\")[0] || this.$(\".footer\")[0]);\n\n        return res;\n    },\n\n    /**\n     * @description Set panel title.\n     * @param {string} title Panel title\n     */\n    setTitle: function(title) {\n        this.$(\".jr-mDialog-header > .jr-mDialog-header-title\").text(title);\n        this.$el.attr(\"aria-label\", title);\n    },\n\n    /**\n     * @description Set element to return focus to when closing\n     * @param {element} element Element to return focus to\n     */\n    setReturnFocus: function(element) {\n        this.returnFocusTo = element;\n    },\n\n    render: function() {\n        this.$el.hide();\n\n        if (this.modal) {\n            this.dimmer = new Dimmer({zIndex: 900});\n        }\n\n        $(\"body\").append(this.$el);\n\n        this.$el.draggable({ handle: \".mover\", addClasses: false, containment: \"document\"});\n\n        return this;\n    },\n\n    /**\n     * @description Open dialog.\n     * @param {object} [coordinates] Position to open dialog.\n     * @param {number} [coordinates.top] Top position to open dialog.\n     * @param {number} [coordinates.left] Left position to open dialog.\n     * @fires Dialog#dialog:visible\n     * @returns {Dialog}\n     */\n    open: function(coordinates) {\n        if (this.isVisible()) {\n            return this;\n        }\n\n        if (this.resetSizeOnOpen) {\n            this.$el.css({\n                height: \"\",\n                width: \"\"\n            });\n\n            this.$el.find(\"textarea\").css({\n                height: \"\",\n                width: \"\"\n            });\n        }\n\n        Panel.prototype.open.apply(this, arguments);\n\n        // increase the dimmer zIndex to hide the dialog which already might be on the page\n        this.modal && this.dimmer.css({zIndex: ++Dialog.highestIndex}).show();\n\n        this._setMinSize();\n\n        var position = this._position(coordinates);\n\n        this.$el.css({\n            top: position.top,\n            left: position.left,\n            position: \"absolute\"\n        });\n\n        // make this dialog be above any other pre-opened dialog and above the dimmer\n        this._increaseZIndex();\n\n        // Class \"over\" is added to buttons on mouseover by some old prototype code.\n        // Button may remain overed when dialog is closed and it will be displayed as overed when we will open\n        // dialog again. That's why we need to remove class \"over\" when dialog is opened.\n        this.buttons && this.buttons.$(\".over\").removeClass(\"over\");\n\n        this.$el.show();\n\n        this.lastFocusedElement = this.returnFocusTo || document.activeElement;\n        let firstFocusable = stdnav.getFirstFocusableElement(this.$el[0]);\n        firstFocusable && _.defer(() => firstFocusable.focus());\n\n        this._onDialogResize();\n\n        /**\n         * @event Dialog#dialog:visible\n         */\n        this.trigger(\"dialog:visible\");\n        stdnav.beginModalFocus(this.$el[0]);\n        return this;\n    },\n\n    /**\n     * @description Close dialog.\n     * @returns {Dialog|undefined}\n     */\n    close: function() {\n        if (this.isVisible()) {\n            stdnav.endModalFocus(this.$el[0]);\n\n            // lower the z-index of the current dialog which going to be closed\n            this.$el.css({ zIndex: --Dialog.highestIndex });\n\n            // and lower the dimmer's zIndex to show the dialog which was previously hidden by this dimmer\n            this.modal && this.dimmer.css({ zIndex: --Dialog.highestIndex }).hide();\n\n            this.$el.hide();\n            this.lastFocusedElement && this.lastFocusedElement.focus();\n\n            Panel.prototype.close.apply(this, arguments);\n\n            return this;\n        }\n    },\n\n    /**\n     * @description Adds additional css classes to Panel\n     * @param {string} classNames Panel css class names\n     */\n    addCssClasses: function(classNames) {\n        this.$el.addClass(classNames);\n    },\n\n    /**\n     * @description Overrides {@link Panel#toggleCollapsedState} to do nothing.\n     * @returns {Dialog}\n     */\n    toggleCollapsedState: function() {\n        return this;\n    },\n\n    /**\n     * @description Enable specific dialog button.\n     * @param {string} action Button action\n     */\n    enableButton: function(action) {\n        this.buttons.enable(action);\n    },\n\n    /**\n     * @description Disable specific dialog button.\n     * @param {string} action Button action\n     */\n    disableButton: function(action) {\n        this.buttons.disable(action);\n    },\n\n    /**\n     * @description Check if dialog is visible.\n     * @returns {boolean}\n     */\n    isVisible: function() {\n        return this.$el.is(\":visible\");\n    },\n\n    _setMinSize: function() {\n        if (this.dialogOptions.minWidth) {\n            this.$el.css({\n                minWidth: this.dialogOptions.minWidth\n            });\n        }\n\n        if (this.dialogOptions.minHeight) {\n            this.$el.css({\n                minHeight: this.dialogOptions.minHeight\n            });\n        }\n\n        if (this.dialogOptions.setMinSizeAsSize) {\n            this.$el.css({\n                width: this.dialogOptions.minWidth,\n                height: this.dialogOptions.minHeight\n            });\n        }\n    },\n\n    _position: function(coordinates) {\n        var top, left;\n        var body = $(\"body\"),\n            elHeight = this.$el.height(),\n            elWidth = this.$el.width();\n\n        if (coordinates && typeof coordinates.top != \"undefined\" && typeof coordinates.left != \"undefined\") {\n            top = coordinates.top;\n            left = coordinates.left;\n\n            var bodyHeight = body.height();\n            var bodyWidth = body.width();\n\n            var fitByHeight = bodyHeight - coordinates.top;\n            var fitByWidth =  bodyWidth - coordinates.left;\n\n            if (fitByHeight < elHeight) {\n                top = coordinates.top - elHeight;\n                top = (top < 0) ? (bodyHeight/2 - elHeight/2) : top\n            }\n            if (fitByWidth < elWidth) {\n                left = coordinates.left - elWidth;\n                left = (left < 0) ? (bodyWidth/2 - elWidth/2) : left\n            }\n\n        } else {\n            top = $(window).height() / 2 - elHeight / 2;\n            left = $(window).width() / 2 - elWidth / 2;\n        }\n\n        return {\n            top: Math.max(0, top),\n            left: Math.max(0, left)\n        };\n    },\n\n    _focus: function() {\n        !this.modal && this._increaseZIndex();\n    },\n\n    _increaseZIndex: function() {\n        this.$el.css({ zIndex : ++Dialog.highestIndex });\n    },\n\n    _onKeyDown: function(e) {\n        // ARIA requirements are that the ESC key will close modal dialogs\n        // However... buttonless dialog can't be closed (e.g: loading dialog)\n        if ((e.key === \"Escape\" || e.keyCode === 27)\n            && (this.buttons\n                && this.dialogOptions.buttons.length > 0)) {\n            this.close();\n        }\n\n        this.buttons && this.buttons._onKeyDown(e);\n\n        // We don't want to let any keyboard event go outside of our dialog.\n        // (for details see ticket http://jira.jaspersoft.com/browse/JRS-12262)\n        e.stopPropagation();\n    },\n\n    _onKeyboardEvent: function(e) {\n        // We don't want to let any keyboard event go outside of our dialog.\n        // (for details see ticket http://jira.jaspersoft.com/browse/JRS-12262)\n        e.stopPropagation();\n    },\n\n    _onDialogResize: function () {\n        // re-define your own resize logic here\n    },\n\n    /**\n     * @description Remove dialog from DOM\n     */\n    remove: function() {\n        this.buttons && this.buttons.remove();\n\n        this.dimmer && this.dimmer.remove();\n\n        try {\n            this.$el.draggable(\"destroy\");\n        } catch (e) {\n            // destroyed already, skip\n        }\n\n        Panel.prototype.remove.call(this);\n    }\n}, {\n    // this value is based on the same value taken from CSS file jasper-ui.css (see selector '.jr-mDialog.jr')\n    highestIndex: 5000,\n    resetHighestIndex: function(index){\n        Dialog.highestIndex = index || 5000;\n    }\n});\n\nexport default Dialog;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Validation from 'backbone-validation';\nimport _ from 'underscore';\nimport NumberUtils from '../util/parse/NumberUtils';\n\nvar numberUtils = new NumberUtils();\nvar originalValidate = Validation.mixin.validate;\n\nValidation.mixin.validate = function (attrs, options) {\n    options || (options = {});\n    var self = this;\n    return originalValidate.call(this, attrs, _.extend({\n        valid: function (view, attr) {\n            self.trigger('validate:' + attr, self, attr);\n        },\n        invalid: function (view, attr, error) {\n            self.trigger('validate:' + attr, self, attr, error);\n        }\n    }, options));\n};\n_.extend(Validation.validators, {\n    doesNotContainSymbols: function (value, attr, forbiddenSymbols) {\n        if (new RegExp('[' + forbiddenSymbols + ']', 'g').test(value)) {\n            return 'Attribute \\'' + attr + '\\' contains forbidden symbols';\n        }\n    },\n    integerNumber: function (value) {\n        if (!numberUtils.isNumberInt(value)) {\n            return 'Value is not a valid integer number';\n        }\n    },\n    type: function (value, attr, types) {\n        function typeFn(type) {\n            var fn;\n            if ('string' == type) {\n                fn = _.isString;\n            } else if ('number' === type) {\n                fn = _.isNumber;\n            } else if ('object' === type) {\n                fn = _.isObject;\n            } else if ('boolean' === type) {\n                fn = _.isBoolean;\n            } else if ('null' === type) {\n                fn = _.isNull;\n            } else if ('undefined' === type) {\n                fn = _.isUndefined;\n            }\n            return fn;\n        }\n        if (!_.isArray(types)) {\n            types = [types];\n        }\n        var isValueOneOfTypes = types.some(function (type) {\n            return typeFn(type)(value);\n        });\n        if (!isValueOneOfTypes) {\n            return '\\'{attr}\\' is not {type}'.replace('{attr}', attr).replace('\\'{type}\\'', types.join(' '));\n        }\n    },\n    url: function (value) {\n        if (!/(http|https):\\/\\/.*\\..*./.test(value)) {\n            return 'Value is not a valid url';\n        }\n    },\n    hexColor: function (value) {\n        if (!/^#[0-9a-f]{3,6}$/i.test(value)) {\n            return 'Value is not a valid hex color';\n        }\n    },\n    xRegExpPattern: function (value, attr, customValue, model) {\n        if (!customValue.test(value)) {\n            return 'Value does not match pattern';\n        }\n    },\n    startsWithLetter: function (value, attr, customValue, model) {\n        if (!value.substr(0, 1).match(/[A-Za-z]/)) {\n            return 'Value should start with letter';\n        }\n    },\n    containsOnlyWordCharacters: function (value, attr, customValue, model) {\n        if (value.search(/\\W/) >= 0) {\n            return 'Value should contain only word characters (letters, digits and underscore)';\n        }\n    },\n    arrayMinLength: function (value, attr, minLength, model) {\n        if (_.isArray(value) && value.length < minLength) {\n            return 'Array length is less than ' + minLength;\n        }\n    }\n});\nexport default Validation;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nif (typeof window.CustomEvent !== \"function\") {\n    // JRS-20985: For IE11 we have to polyfill CustomEvent\n\n    function CustomEvent(event, params) {\n        params = params || {bubbles: false, cancelable: false, detail: undefined};\n\n        var evt = document.createEvent('CustomEvent');\n\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n\n        return evt;\n    }\n\n    CustomEvent.prototype = window.Event.prototype;\n\n    window.CustomEvent = CustomEvent;\n}"],"sourceRoot":""}