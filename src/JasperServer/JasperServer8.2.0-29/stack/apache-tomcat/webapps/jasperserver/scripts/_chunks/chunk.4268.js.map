{"version":3,"sources":["webpack://jrs-ui/./src/components/components.about.js","webpack://jrs-ui/./src/components/components.heartbeat.js","webpack://jrs-ui/./src/components/components.toolbarButtons.js","webpack://jrs-ui/./src/config/dateAndTimeSettings.js","webpack://jrs-ui/./src/settings/settingsStore.js","webpack://jrs-ui/./src/stdnav/plugins/stdnavPluginActionMenu.js","webpack://jrs-ui/./src/stdnav/plugins/stdnavPluginActionMenuTrap.js","webpack://jrs-ui/./src/stdnav/plugins/stdnavPluginDynamicList.js","webpack://jrs-ui/./src/stdnav/plugins/stdnavPluginForms.js","webpack://jrs-ui/./src/stdnav/plugins/stdnavPluginMainMenu.js","webpack://jrs-ui/./src/stdnav/plugins/stdnavPluginToolbar.js","webpack://jrs-ui/./src/stdnav/plugins/stdnavPluginToolbarV2.js","webpack://jrs-ui/./src/stdnav/plugins/stdnavTabList.js","webpack://jrs-ui/../js-sdk/src/common/extension/jQueryDatepickerExtension.js","webpack://jrs-ui/../js-sdk/src/common/extension/jQueryTimepickerExtension.js","webpack://jrs-ui/../js-sdk/src/common/stdnav/plugins/stdnavPluginAnchor.js","webpack://jrs-ui/../js-sdk/src/common/stdnav/plugins/stdnavPluginButton.js","webpack://jrs-ui/../js-sdk/src/common/stdnav/plugins/stdnavPluginGrid.js","webpack://jrs-ui/../js-sdk/src/common/stdnav/plugins/stdnavPluginList.js","webpack://jrs-ui/../js-sdk/src/common/stdnav/plugins/stdnavPluginModalTrap.js","webpack://jrs-ui/../js-sdk/src/common/stdnav/plugins/stdnavPluginTable.js","webpack://jrs-ui/../js-sdk/src/common/stdnav/plugins/stdnavPluginWorkflowCard.js","webpack://jrs-ui/../js-sdk/src/common/util/accessibility/waiAriaConstants.ts","webpack://jrs-ui/../js-sdk/src/common/util/eventAutomation.js","webpack://jrs-ui/../js-sdk/src/components/dateAndTime/DateAndTimePicker.js","webpack://jrs-ui/../js-sdk/src/components/dateAndTime/template/dateTimePopupContainer.htm","webpack://jrs-ui/./src/settings/dateTimeSettings.settings.js"],"names":["about","initialize","aboutBox","registerListeners","show","dom","jQuery","hasClass","dialogs","closable","_hide","$about","$aboutBoxCloseButton","on","e","preventDefault","stopPropagation","init","DOM_ID","PERMIT_CHECKBOX_ID","options","this","_baseUrl","baseUrl","_showDialog","showDialog","_sendClientInfo","sendClientInfo","_dom","_permit","_okButton","find","layoutModule","_okHandler","bind","url","checked","ajaxNonReturningUpdate","errorHandler","baseErrorHandler","start","focus","_doSendClientInfo","params","navigator","appName","appVersion","screen","width","height","colorDepth","postData","appendPostData","UP","DOWN","OVER","DISABLED","PRESSED","CONTENT_PREFIX","MenuClass","TOOLBAR_MENU_CLASS","ACTION_MODEL_TAG","CAPSULE_PATTERN","showButtonMenu","event","object","context","attr","model","actionModel","setActionModel","newActionModel","isToolBarButton","button","enable","buttonManager","disable","setButtonState","userLocale","availableLocales","postfix","locale","jrsConfigs","_","substring","replace","DateAndTimePicker","date","dateTimeSettings","time","MENU_TRAP_ELEMENT_TEMPLATE","log","stdnavPluginActionMenu","prototype","zinit","selector","activate","behavior","_onEnter","_onExit","_fixFocus","_fixSuperfocus","_onFocusIn","_onFocusOut","_onSubfocusIn","_onLeft","_onRight","_onSuperfocusIn","_onSuperfocusOut","_onUp","_onDown","_onHome","_onEnd","stdnav","navtype","navtype_tags","deactivate","element","newFocus","$el","$","is","insertBefore","insertAfter","pressedItem","length","closest","$li","_openChildMenu","_setAriaAttributes","$p","AriaProps","open","isMenuShowing","$thisItem","nodeName","subel","$parentMenu","parentMenuItem","$subMenuItem","first","$lastItem","last","$prev","prev","$firstItem","$next","next","logger","stdnavPluginModalTrap","error","modalFocusableElement","lastFocused","gserial","stdnavPluginDynamicList","serial","debug","_ariaPrep","_ariaRefresh","el","$links","isButtonLink","eventAutomation","findRow","querySelector","$listEl","warn","listObj","dynamicList","focusableEl","addClass","getCursorElement","_fixSubfocus","$closestList","ghosts","children","removeClass","items","stdnavPluginForms","parent","ActiveTopLevelMenuAttribute","$mainMenu","$homeMenu","$libraryMenu","stdnavPluginMainMenu","menu_item_callbacks","click","_onToggle","_onClick","_onSubfocusOut","_setHasSubMenuAriaAttributes","_setOpenSubMenuAriaAttributeState","p","mute","$activeToplevelMenu","role","_closeSubMenu","_showSubMenu","$menuWithSubmenu","allExpandedMenuItems","primaryNavigation","text","trim","_getActiveTopLevelMenu","activeToplevelMenuId","activeTopLevelMenuId","menuItem","elementId","$activeTopLevelMenu","_getNextActiveDescendant","activeDescendantId","$menuItems","_getPreviousActiveDescendant","$previous","activeDescendant","StdnavPluginToolbar","_onEnterOrEntered","$items","not","key","item","$item","$labeledEl","lis","prop","$root","$elem","$parentList","$currentList","_parentTabindex","$ul","$matched","$selected","hide","lastMenuBarItem","removeAttr","$toolbar","document","activeElement","_onExitHandler","prevAll","each","elem","nextAll","$menu","$button","$input","_setParentElem","simulateEl","select","StdnavPluginToolbarV2","$btnItems","$icons","iconEl","elementWithSuperfocus","filter","index","siblings","$btn","trigger","$firstEl","$lastEl","StdnavTabList","$tabItems","$element","_jasperPrefix","_mainDivId","_jasperPopupClass","originalNewInst","result","apply","arguments","dpDiv","originalGoToToday","id","call","_selectDate","opts","onChangeMonthYear","year","month","datepicker","timepicker","currentYear","selectedYear","currentMonth","selectedMonth","currentDay","selectedDay","_updateDateTime","instance","originalOnTimeChange","_onTimeChange","$timeObj","setSelectionRange","stdnavPluginAnchor","_onLeftOrUp","_onRightOrDown","newSubfocus","undefined","stdnavPluginButton","localLogger","stdnavPluginGrid","_onHover","_findSubfocus","sfels","rows","cells","sfel","newsf","row","newrow","iter","col","stdnavPluginList","firstLink","$list","$newFocus","currentModalDialogRoot","DIALOG_REFERENCE_ATTRIBUTE","stdnavPluginTable","$table","label","labelledBy","itemLabel","itemLabelledBy","_getPreviousSection","prevSection","thisSection","_getNextSection","nextSection","$closestTable","fixedSubfocus","StdnavPluginWorkflowCard","_onEnterOrToggle","eq","parents","isButtonOrChild","isMainUl","_navigationCallbackHandler","listCallback","buttonCallback","currentFocus","newPosition","newSelectedButton","visibleButtonList","closestLi","liList","previousItem","closestLiParent","liParentList","nextItem","mouseEventOptions","bubbles","cancelable","view","defaultView","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","relatedTarget","srcElement","triggerNativeEvent","eventName","target","ev","ie","browserDetection","documentElement","window","createEvent","MouseEvent","initMouseEvent","eventOptions","initEvent","bubble","dispatchEvent","createEventObject","fireEvent","simulateClickSequence","simulateDoubleClickSequence","DATE_TIME_DEFAULTS","stepHour","stepMinute","stepSecond","showSecond","changeMonth","changeYear","showButtonPanel","constrainInput","TIME_DEFAULTS","err","Backbone","constructor","pickerOptions","hasOwnProperty","dateFormat","timeFormat","inline","skipMoving","pickerType","discoverPickerType","provideDefaultPickerOptions","fixPopupPositionAndStyling","self","_callPickerAction","getDate","getTime","setDate","remove","empty","off","stopListening","setDefaults","configs","Helpers","movePickerRelativelyToTriggerIcon","stylePopupContainer","type","originalBeforeShowFn","beforeShow","afterInject","inst","input","offset","left","parseFloat","css","move","offsetWidth","marginLeft","$dpDiv","$popupContainer","$parent","detach","append"],"mappings":"qMA2BIA,EAAQ,CAIRC,WAAY,WACRD,EAAME,SAASC,sBAMvBH,EAAME,SAAW,CAIbE,KAAM,WACF,IAAIC,EAAMC,IAAO,aACbD,EAAIE,SAAS,WACbC,eAAmBH,EAAI,IAAI,EAAM,CAACI,UAAU,KAGpDC,MAAO,WACH,IAAIL,EAAMC,IAAO,aACZD,EAAIE,SAAS,WACdC,eAAmBH,EAAI,KAI/BF,kBAAoB,WAChB,IAAIQ,EAASL,IAAO,UAChBM,EAAuBN,IAAO,oBAElCK,EAAOE,GAAG,SAAS,SAASC,GACxBA,EAAEC,iBACFf,EAAME,SAASE,UAGnBQ,EAAqBC,GAAG,SAAS,SAASC,GACtCd,EAAME,SAASQ,QACfI,EAAEE,uBAMd,W,+GCuBA,QA/DgB,CACZC,MAAM,EACNC,OAAQ,iBACRC,mBAAoB,iBAEpBlB,WAAY,SAASmB,GACjBC,KAAKC,SAAWF,EAAQG,QACxBF,KAAKG,YAAcJ,EAAQK,WAC3BJ,KAAKK,gBAAkBN,EAAQO,eAE/BN,KAAKO,KAAOtB,IAAO,IAAMe,KAAKH,QAAQ,GACjCG,KAAKO,OAGVP,KAAKQ,QAAUvB,IAAO,IAAMe,KAAKF,oBAAoB,GACrDE,KAAKS,UAAYxB,IAAOe,KAAKO,MAAMG,KAAKC,oBAA6B,GAErE1B,IAAOe,KAAKS,WAAWjB,GAAG,QAASQ,KAAKY,WAAWC,KAAKb,OACxDA,KAAKJ,MAAO,IAGhBgB,WAAY,WACRzB,eAAmBa,KAAKO,MAExB,IAAIO,EAAMd,KAAKC,SAAU,0BAA4BD,KAAKQ,QAAQO,SAElEC,QAAuBF,EAAK,CAAEG,aAAcC,QAGhDC,MAAO,YACe,IAAdnB,KAAKJ,OAILI,KAAKG,cACLhB,eAAmBa,KAAKO,MAExBP,KAAKS,UAAUW,SAEfpB,KAAKK,iBACLL,KAAKqB,sBAIbA,kBAAmB,WACf,IACI,IAAIC,EAAS,GACbA,EAAM,WAAiBC,UAAUC,QACjCF,EAAM,cAAoBC,UAAUE,WACpCH,EAAM,SAAeI,OAAOC,MAC5BL,EAAM,UAAgBI,OAAOE,OAC7BN,EAAM,cAAoBI,OAAOG,WACjC,IAAIC,GAAWC,QAAe,GAAIT,GAE9BR,EAAMd,KAAKC,SAAW,uBAE1Be,QAAuBF,EAAK,CAACgB,SAAUA,IACzC,MAAMrC,Q,2FCmBhB,QA1E0B,CAEtBuC,GAAK,KACLC,KAAO,OACPC,KAAO,OACPC,SAAW,WACXC,QAAU,UACVC,eAAiB,WACjBC,UAAY,yBACZC,mBAAqB,iCACrBC,iBAAmB,mBACnBC,gBAAkB,UAOlBC,eAAiB,SAASC,EAAOC,GAC7BA,EAAS3D,IAAO2D,GAChB,IAAIC,EAAU7C,KAAKqC,eAAiBO,EAAOE,KAAK,MAC5CC,EAAiC,oBAAzB/C,KAAKwC,iBAAyCxC,KAAKgD,YAAchD,KAAKwC,iBAElFQ,qBAA6BL,EAAOC,EAAQC,EAAS7C,KAAKuC,mBAAoBQ,IAGlFE,eAAgB,SAASC,GACrBlD,KAAKgD,YAAcE,GAOvBC,gBAAkB,SAASC,GACvB,QAAIA,GACQnE,IAAOmE,GAAQlE,SAAS,YAYxCmE,OAAS,SAASD,EAAQC,GACtBC,WAAqBF,IAOzBG,QAAU,SAASH,GACfE,YAAsBF,IAQ1BI,eAAiB,SAASJ,EAAQC,GAC3BA,EACCrD,KAAKqD,OAAOD,GAEZpD,KAAKuD,QAAQH,M,iGChEzB,IAXmBK,EAAYC,EACvBC,EAUJC,GAXeH,EAWII,eAXQH,EAWeG,qBAVtCF,EAAU,KACVF,IACIK,aAAWJ,EAAkBD,GAC7BE,EAAUF,EACHK,aAAWJ,EAAkBD,EAAWM,UAAU,EAAG,MAC5DJ,EAAUF,EAAWM,UAAU,EAAG,KAGnCJ,EAAQK,QAAQ,IAAK,MAGhCC,gBAA8B,CAC1BL,OAAQA,EACRM,KAAMC,eACNC,KAAMD,kB,8CCpBV,Y,2JC4BME,GAFOC,aAAa,UAES,kEAE/BC,EAAyB,aAG7BT,WAASS,EAAuBC,UAAW,CACvCC,MAAO,SAAUC,GACb,OAAO1E,MAKX2E,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,OAAU,CAAC5E,KAAMA,KAAK6E,SAAU,MAChC,MAAS,CAAC7E,KAAMA,KAAK6E,SAAU,MAC/B,KAAQ,CAAC7E,KAAMA,KAAK8E,QAAS,MAC7B,SAAY,CAAC9E,KAAMA,KAAK+E,UAAW,MACnC,YAAe,CAAC/E,KAAMA,KAAK+E,UAAW,MACtC,cAAiB,CAAC/E,KAAMA,KAAKgF,eAAgB,MAC7C,QAAW,CAAChF,KAAMA,KAAKiF,WAAY,MACnC,SAAY,CAACjF,KAAMA,KAAKkF,YAAa,MACrC,WAAc,CAAClF,KAAMA,KAAKmF,cAAe,MACzC,KAAQ,CAACnF,KAAMA,KAAKoF,QAAS,MAC7B,MAAS,CAACpF,KAAMA,KAAKqF,SAAU,MAC/B,aAAgB,CAACrF,KAAMA,KAAKsF,gBAAiB,MAC7C,cAAiB,CAACtF,KAAMA,KAAKuF,iBAAkB,MAC/C,GAAM,CAACvF,KAAMA,KAAKwF,MAAO,MACzB,KAAQ,CAACxF,KAAMA,KAAKyF,QAAS,MAC7B,KAAQ,CAACzF,KAAMA,KAAK0F,QAAS,MAC7B,IAAO,CAAC1F,KAAMA,KAAK2F,OAAQ,MAC3B,SAAW,EACX,aAAe,GAEnBC,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,OAQ3C+E,UAAW,SAAUiB,GACjB,IAAIC,EACAC,EAAMC,IAAEH,GACRE,EAAIE,GAAG,IAAMpD,6BACbmD,IAAE9B,GAA4BgC,aAAaH,GAC3CC,IAAE9B,GAA4BiC,YAAYJ,IAE9C,IAI6B,EAJvBK,EAAcL,EAAIxF,KAAJ,WAAaC,kBAAb,SACpB,GAAI4F,EAAYC,OAAS,EACrBP,EAAWM,EAAY,QAEvB,GAAIL,EAAIE,GAAG,aACPH,EAAQ,UAAGC,EAAIxF,KAAK,UAAU,UAAtB,QAA4BsF,OACjC,GAAIE,EAAIE,GAAG,MAAO,OAErBH,EAAQ,UAAGC,EAAIxF,KAAK,OAAO,UAAnB,QAAyBsF,MAC9B,SACHC,EAAQ,UAAGC,EAAIO,QAAQ,MAAM/F,KAAK,OAAO,UAAjC,kBACHwF,EAAIO,QAAQ,MAAM/F,KAAK,UAAU,UAD9B,QACoCsF,EAGpD,OAAOC,GAOXjB,eAAgB,SAAUgB,GACtB,OAAOG,IAAEH,GAASS,QAAX,YAA+B,IAG1CnB,gBAAiB,SAASU,KAG1Bf,WAAY,SAAUe,GAClB,IAEIU,EAFMP,IAAEH,GAEES,QAAQ9F,uBAOtB,OANI+F,EAAIF,OAAO,IACXxG,KAAK2G,eAAeD,EAAI,IAAI,GAE5BpD,SAAmBoD,EAAIhG,KAAKC,oBAA6B,KAGtDqF,GAGXY,mBAAoB,SAAUZ,GAC1B,IAAIU,EAAMP,IAAEH,GACRa,EAAKH,EAAIhG,KAAK,OAEdgG,EAAIxH,SAASyB,kBAA6BkG,EAAG/D,KAAKgE,eAClDD,EAAG/D,KAAKgE,aAAoB,SACvBhE,KAAKgE,aAAoB,SAItCH,eAAgB,SAAUX,EAASe,GAC/B,IAAIL,EAAMP,IAAEH,GACRa,EAAKH,EAAIhG,KAAK,OAElB,GAAIgG,EAAIxH,SAASyB,gBAA0B,CACvCX,KAAK4G,mBAAmBZ,GACxB,IAAMgB,EAAgBhE,kBAA0B0D,EAAIhG,KAAK,YAAY,IAEjEqG,GACAF,EAAG/D,KAAKgE,aAAoB,SAC3BE,GAAiBhE,qBAA6BgD,KAE/CgB,GAAiBhE,qBAA6BgD,GAC9Ca,EAAG/D,KAAKgE,aAAoB,YAKxC5B,YAAa,SAAUc,GACnB,IAAIiB,EAAYd,IAAEH,GAASS,QAAQ9F,uBAKnC,OAJIsG,EAAUT,OAAO,GAEjBlD,QAAkB2D,EAAUvG,KAAKC,oBAA6B,IAE3D,MAMX4E,iBAAkB,SAASS,KAM3Bb,cAAe,SAAUa,GAErB,GAAyB,MAArBA,EAAQkB,SAAkB,CAE1B,IAAIC,EAAQnH,KAAK+E,UAAUiB,GAE3BJ,gBAAmBuB,GAAO,KAIlCtC,SAAU,SAAUmB,GAChB,OAAOhG,KAAKqF,SAASW,IAGzBlB,QAAS,SAAUkB,GAEf,GADeG,IAAEH,GAASS,QAAQ,YACrB3D,KAAK,QAAUnC,YAGxB,OAAOX,KAAKoF,QAAQY,GAFpBhD,gBAORoC,QAAS,SAAUY,GACf,IACMoB,EADYjB,IAAEH,GAASS,QAAQ9F,uBACP8F,QAAQ,MACtC,GAAKW,EAAYhB,GAAZ,WAAmBpD,4BAKpB,OAAOgD,EAJP,IAAMqB,EAAiBD,EAAYX,QAAQ,MAC3Cb,eAAkByB,EAAe3G,KAAK,OAAO,IAC7CV,KAAK2G,eAAeU,EAAe,IAAI,IAM/ChC,SAAU,SAAUW,GAChB,IAAMiB,EAAYd,IAAEH,GAASS,QAAQ9F,uBAC/B2G,EAAeL,EAAUvG,KAAK,oBAAoB6G,QAExD,OAAID,EAAad,OAAO,GACpBxG,KAAK2G,eAAeM,EAAU,IAAI,GAC3BK,EAAa5G,KAAK,OAAO,IAEzBsF,GAIfR,MAAO,SAAUQ,GAKb,IAJA,IAAIE,EAAMC,IAAEH,GAASS,QAAQ9F,uBACzB6G,EAAYtB,EAAIO,QAAQ,MAAM/F,KAAK,QAAQ+G,OAC3CC,EAAQxB,EAAIyB,KAAK,MAEdD,EAAMtB,GAAGzF,wBACZ+G,EAAMA,EAAMC,KAAK,MAOrB,GAJKD,EAAM,KACPA,EAAQF,KAGRE,EAAMlB,OAAO,GAIb,OAAOR,EAHPhG,KAAK2G,eAAeT,EAAI,IAAI,GAC5BN,eAAkB8B,EAAMhH,KAAK,OAAO,KAM5C+E,QAAS,SAAUO,GAKf,IAJA,IAAIE,EAAMC,IAAEH,GAASS,QAAQ9F,uBACzBiH,EAAa1B,EAAIO,QAAQ,MAAM/F,KAAK,QAAQ6G,QAC5CM,EAAQ3B,EAAI4B,KAAK,MAEdD,EAAMzB,GAAGzF,wBACZkH,EAAMA,EAAMC,KAAK,MAOrB,GAJKD,EAAM,KACPA,EAAQD,KAGRC,EAAMrB,OAAO,GAIb,OAAOR,EAHPhG,KAAK2G,eAAeT,EAAI,IAAI,GAC5BN,eAAkBiC,EAAMnH,KAAK,OAAO,KAM5CgF,QAAS,SAAUM,GACf,IAAIE,EAAMC,IAAEH,GAASS,QAAQ9F,uBACzBiH,EAAa1B,EAAIO,QAAQ,MAAM/F,KAAK,QAAQ6G,QAChDvH,KAAK2G,eAAeT,EAAI,IAAI,GAC5BN,eAAkBgC,EAAWlH,KAAK,OAAO,KAG7CiF,OAAQ,SAAUK,GACd,IAAIE,EAAMC,IAAEH,GAASS,QAAQ9F,uBACzB6G,EAAYtB,EAAIO,QAAQ,MAAM/F,KAAK,QAAQ+G,OAC/CzH,KAAK2G,eAAeT,EAAI,IAAI,GAC5BN,eAAkB4B,EAAU9G,KAAK,OAAO,OAMhDyF,WAAS5B,EAAuBC,UAAW,CAGvCqB,QAAS,aAaTC,aAAc,KAGlB,YAAmBvB,G,uGCxSbwD,EAASzD,aAAa,UAEtB0D,EAAwB,aAG9B/I,WAAc+I,EAAsBxD,UAAW,CAG3CG,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,SAAY,CAAC5E,KAAMA,KAAK+E,UAAW,OAEvCa,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,KAAK4E,WAKhDG,UAAW,SAAUiB,GACjB,IAAKhD,gBAED,OADA+E,EAAOE,MAAM,oFACNjC,EAGX,IAGIkC,EAHEC,EAAcnF,gBACpBA,cAAqB,GAGrB,IAAMkD,EAAMjH,IAAO+G,GAQnB,OAPIE,EAAIyB,OAAOvB,GAAG,IAAMpD,2BACpBkF,EAAwBtC,4BAA+BuC,GAChDjC,EAAI4B,OAAO1B,GAAG,IAAMpD,6BAC3BkF,EAAwBtC,gCAAmCuC,IAIxDD,KAMfjJ,WAAc+I,EAAsBxD,UAAW,CAG3CqB,QAAS,WASTC,aAAc,KAGlB,QAD+B,IAAIkC,G,uGC/D/BD,E,SAASzD,WAAa,UAItB8D,EAAU,EACVC,EAA0B,WAC1BD,IACApI,KAAKsI,OAASF,GAMlBjC,WAASkC,EAAwB7D,UAAW,CACxCC,MAAO,SAAUC,GAEb,OADAqD,EAAOQ,MAAM,gCAAkC7D,EAAW,OACnD1E,MAIX2E,SAAU,WAON3E,KAAK4E,SAAW,CACZ,SAAY,CACR5E,KACAA,KAAKwI,UACL,MAEJ,YAAe,CACXxI,KACAA,KAAKyI,aACL,MAEJ,MAAS,KACT,KAAQ,KACR,IAAO,KACP,MAAS,CACLzI,KACAA,KAAK6E,SACL,MAEJ,OAAU,CACN7E,KACAA,KAAK6E,SACL,MAEJ,SAAY,CACR7E,KACAA,KAAK+E,UACL,MAEJ,cAAiB,CACb/E,KACAA,KAAKgF,eACL,MAEJ,KAAQ,KACR,SAAW,EACX,aAAe,EACf,KAAQ,KACR,SAAY,KACZ,OAAU,KACV,MAAS,KACT,aAAgB,CACZY,IACAA,sBACA,CACI,SAAY,EACZ,cAAiB,KACjB,YAAc,IAGtB,cAAiB,CACbA,IACAA,uBACA,CAAE,YAAc,IAEpB,GAAM,MAEVA,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAI7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,KAAK4E,WAOhD4D,UAAW,SAAUE,GAGjB,OAAO,MASXD,aAAc,SAAUC,GAGpB,OAAO,MAEX7D,SAAU,SAAUmB,GAChB,IAAIE,EAAMC,IAAEH,GACZ,GAAIE,EAAIE,GAAG,gBAMP2B,EAAOE,MAAM,sFACT/B,EAAIxF,KAAK,kBAAoB,GAC7BqH,EAAOE,MAAM,0EAEd,CAKH,IAAIU,EAASzC,EAAIxF,KAAK,YAClBkI,EAAe1C,EAAIhH,SAAS,wBAE5ByJ,EAAOnC,OAAS,GAEhBqC,0BAAsCF,EAAO,IAG9CC,GACCC,0BAAsC3C,EAAI,IAIlD,OAAOF,GAKXjB,UAAW,SAAUiB,GACjB,SAAS8C,EAAQJ,GACb,MAA2B,QAAvBvC,IAAEuC,GAAI5F,KAAK,QACJ4F,EAGJ1C,EAAQ+C,cAAc,gBAAkB/C,EAAQ+C,cAAc,gBAAkB/C,EAG3F,IAAIgD,EAAU7C,IAAEH,GAASS,QAAQ,gBAAmBzG,KAAK6F,QAAU,MACnE,GAAImD,EAAQxC,OAAS,EAEjB,OADAuB,EAAOkB,KAAK,6CACLH,EAAQ9C,GAEnB,IAAIkD,EAAUC,6BAAqCH,EAAQ,IAC3D,GAAIpD,oBAAuBsD,GAEvB,OADAnB,EAAOkB,KAAK,4CACLH,EAAQ9C,GAEnB,GAA6B,aAA1BG,IAAEH,GAASlD,KAAK,QAAqB,CACpC,GAAGqD,IAAEH,GAAStF,KAAK,aAAa8F,OAC5B,OAAOL,IAAEH,GAAStF,KAAK,yBAE3B,IAAI0I,EAAcN,EAAQ9C,GAE1B,OADAG,IAAEiD,GAAaC,SAAS,YACjBD,EAEX,OAAOF,EAAQI,oBAGnBC,aAAc,SAAUvD,GACpB,OAAO,MAKXhB,eAAgB,SAAUgB,GACtB,IACIwD,EAAerD,IAAEH,GAASS,QAAQ,SAOtC,OANI+C,EAAahD,OAAS,EACNgD,EAAa,GAGb,MASxBlE,gBAAiB,SAAUU,GACvB,IAAIC,EAEAwD,EAAStD,IAAEH,GAAS0D,SAAS,kBACjC,GAAID,EAAOjD,OAAS,EAChBiD,EAAOE,YAAY,cAEnB1D,EAAWwD,EAAO,OACf,CAEH,IAAIG,EAAQzD,IAAEH,GAAS0D,SAAS,6BAE5BzD,EADA2D,EAAMpD,OAAS,EACJoD,EAAM,GAIN5D,EAGnB,OAAOC,GAIXV,iBAAkB,SAAUS,OAMhCG,WAASkC,EAAwB7D,UAAW,CAGxCqB,QAAS,cAQTC,aAAc,KAGlB,QADiC,IAAIuC,G,kHCxNjCN,EAASzD,aAAa,UAItB8D,EAAU,EAGdzH,qBAAgC,mBAChCA,wBAAmC,sBACnCA,iBAA4B,qBAE5BA,oBAA+B,8CAC/BA,yBAAoC,iDAIpC,IAAIkJ,EAAoB,WACpBzB,IACApI,KAAKsI,OAASF,GAOlBjC,WAAS0D,EAAkBrF,UAAW,CAClCC,MAAO,SAAUC,GAEb,OADAqD,EAAOQ,MAAM,0BAA4B7D,EAAW,OAC7C1E,MAKX2E,SAAU,WAON3E,KAAK4E,SAAW,CACZ,SAAY,CAAC5E,KAAMA,KAAKwI,UAAW,MACnC,YAAe,CAACxI,KAAMA,KAAKyI,aAAc,MACzC,KAAQ,CAACzI,KAAMA,KAAKyF,QAAS,MAC7B,MAAS,CAACzF,KAAMA,KAAK6E,SAAU,MAC/B,KAAQ,CAAC7E,KAAMA,KAAK8E,QAAS,MAC7B,SAAW,EACX,aAAe,EACf,cAAiB,CAACc,IAAQA,uBAA2B,MACrD,aAAgB,CAACA,IAAQA,sBAA0B,CAC/C,SAAY,EACZ,cAAiB,SACjB,YAAc,KAGtBA,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,KAAK4E,WAQhD4D,UAAW,SAAUE,GAEjB,OAAO,MAUXD,aAAc,SAAUC,GAEpB,OAAO,MAOXjD,QAAS,SAASO,GACd,IAAIE,EAAMC,IAAEH,GAeZ,OAdGE,EAAIE,GAAG,qBACNpG,KAAK8J,OAAS9D,EACdE,EAAIO,QAAQ,MAAM4C,SAAS,YAC3BR,0BAAsC1C,IAAE,4BAA4B,IACpEA,IAAExF,0BAAmC4G,QAAQ7G,KAAK,KAAK2I,SAAS,QAChErD,EAAUG,IAAExF,0BAAmC4G,QAAQ,IACjDrB,EAAIE,GAAG,yBACbpG,KAAK8J,OAAS9D,EACdE,EAAIO,QAAQ,MAAM4C,SAAS,YAC3BR,0BAAsC1C,IAAE,yBAAyB,IACjEA,IAAExF,0BAAmC4G,QAAQ7G,KAAK,KAAK2I,SAAS,QAChErD,EAAUG,IAAExF,0BAAmC4G,QAAQ,IAGpDvB,GAGXlB,QAAS,SAASkB,GACd,IAAIE,EAAMC,IAAEH,GAUZ,OARGE,EAAIE,GAAGzF,sBACNqF,EAAUG,IAAE,2BAA2B,GAChCD,EAAIE,GAAGzF,yBACdqF,EAAUG,IAAE,6BAA6B,GAClCD,EAAIE,GAAGzF,oBACdqF,EAAUG,IAAE,6BAA6B,IAGtCH,GAGXnB,SAAU,SAASmB,GACf,IAAIE,EAAMC,IAAEH,GAUZ,OARGE,EAAIE,GAAGzF,sBACNqF,EAAUG,IAAE,2BAA2B,GAChCD,EAAIE,GAAGzF,yBACdqF,EAAUG,IAAE,6BAA6B,GAClCD,EAAIE,GAAGzF,oBACdqF,EAAUG,IAAE,6BAA6B,IAGtCH,KAMfG,WAAS0D,EAAkBrF,UAAW,CAGlCqB,QAAS,QASTC,aAAc,CAAC,OAAQ,QAAS,WAAY,SAAU,SAAU,cAGpE,QAD2B,IAAI+D,G,iLC7KzBE,GAFOzF,aAAa,UAEU,4BAE9B0F,EAAY7D,IAAE,IAAMxF,wBACpBsJ,EAAY9D,IAAE,IAAMxF,kCACpBuJ,EAAe/D,IAAE,IAAMxF,qCAEzBwJ,EAAuB,WACvBnK,KAAKoK,oBAAsB,CACvBC,MAAO,KAIfvG,WAASqG,EAAqB3F,UAAW,CACrCC,MAAO,SAAUC,GACb,OAAO1E,MAKX2E,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,OAAU,CAAC5E,KAAMA,KAAKsK,UAAW,MACjC,MAAS,CAACtK,KAAMA,KAAK6E,SAAU,MAC/B,KAAQ,CAAC7E,KAAMA,KAAK8E,QAAS,MAC7B,SAAY,CAAC9E,KAAMA,KAAK+E,UAAW,MACnC,YAAe,CAAC/E,KAAMA,KAAK+E,UAAW,MACtC,YAAe,CAAC/E,KAAMA,KAAKyI,aAAc,MACzC,QAAW,CAACzI,KAAMA,KAAKiF,WAAY,MACnC,SAAY,CAACjF,KAAMA,KAAKkF,YAAa,MACrC,MAAS,CAAClF,KAAMA,KAAKuK,SAAU,MAC/B,WAAc,CAACvK,KAAMA,KAAKmF,cAAe,MACzC,YAAe,CAACnF,KAAMA,KAAKwK,eAAgB,MAC3C,KAAQ,CAACxK,KAAMA,KAAKoF,QAAS,MAC7B,MAAS,CAACpF,KAAMA,KAAKqF,SAAU,MAC/B,GAAM,CAACrF,KAAMA,KAAKwF,MAAO,MACzB,KAAQ,CAACxF,KAAMA,KAAKyF,QAAS,MAC7B,KAAQ,CAACzF,KAAMA,KAAK0F,QAAS,MAC7B,IAAO,CAAC1F,KAAMA,KAAK2F,OAAQ,MAC3B,SAAW,EACX,aAAe,GAEnBC,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,OAK3C+E,UAAW,SAAUiB,GACjB,OAAOA,GAGXyC,aAAc,WACVzI,KAAKyK,6BAA6BT,EAAUtJ,KAAKC,iCAGrD+J,kCAAmC,SAAUC,EAAG5D,GAAoB,IAAd6D,EAAc,wDAC1DC,EAAsB1E,IAAEwE,GAC9B,GAAIE,EAAoB/H,KAAKgE,cAAqB,CAC9C,IAAMgE,EAAOD,EAAoB/H,KAAK,QACtC8H,GAAQC,EAAoB/H,KAAK,OAAQ,QACzC+H,EACK/H,KAAKgE,aAAoBC,EAAO,OAAS,SAC9C6D,GAAQC,EAAoB/H,KAAK,OAAQgI,KAIjDL,6BAA8B,SAAUzE,GACXG,IAAEH,GACVtF,KAAK,OACjBoC,KAAKgE,aAAoB,SACzBhE,KAAKgE,aAAoB,QACzBhE,KAAKgE,aAAoB9D,2BACzBF,KAAKgE,SAAgB9D,4BAG9B+H,cAAe,SAAU/E,GACrBhG,KAAK0K,kCAAkCvE,IAAEH,GAAStF,KAAK,QAAQ,GAE/DsC,gBAGJgI,aAAc,SAAUhF,GACpB,IAAM6E,EAAsB1E,IAAEH,GACxBiF,EAAmBJ,EAAoBpE,QAAQ9F,+BACrD,GAAIsK,EAAiBzE,OAAO,EAAG,CAC3B,IAAMK,EAAKoE,EAAiBvK,KAAK,KAC3BwK,EAAuBlB,EAAUtJ,KAAV,UAAkBC,8BAAlB,gBAAgEmG,aAAhE,WACzBoE,EAAqB1E,SAAWK,EAAGT,GAAG8E,IACtClL,KAAK0K,kCAAkCQ,GAAsB,GAAO,GAGxElL,KAAK0K,kCAAkC7D,GAAI,GAC3CsE,sBAAoC,KAAMF,EAAiB,GAAIA,EAAiBG,OAAOC,aAEvFrL,KAAK+K,cAAcF,EAAoB,KAI/CS,uBAAwB,WACpB,IAAMC,EAAuBvB,EAAUlH,KAAKiH,GAC5C,OAAQ5D,IAAE,IAAD,OAAKoF,KAGlBtG,WAAY,SAAUe,GAClB,IAAME,EAAMC,IAAEH,GACVwF,EAAuBtF,EAAIpD,KAAKiH,GAOpC,OANKyB,IACDA,EAAuBtF,EAAIxF,KAAK,MAAM6G,QAAQzE,KAAK,MACnDoD,EAAIpD,KAAKiH,EAA6ByB,IAGdxL,KAAKsL,yBACN,IAG/BpG,YAAa,SAAUc,GAInB,OAHA1C,QAAkB6C,IAAEH,GAAStF,KAAKC,oBAA6B,IAC/DX,KAAK+K,cAAc/E,GAEZ,MAGXuE,SAAU,SAAUvE,GAChB,IAAMyF,EAAWtF,IAAEH,GAASS,QAAQ,MAChCgF,EAASjF,OAAS,GAClBZ,gBAAmB6F,IAM3BtG,cAAe,SAAUa,GAAS,MACxBE,EAAMC,IAAEH,GAASS,QAAQ,MACzBiF,EAAS,UAAGxF,EAAIxF,KAAK,KAAKoC,KAAK,aAAtB,QAA+BoD,EAAIpD,KAAK,MACvDkH,EAAUlH,KAAKgE,qBAA4B4E,GAC3CpI,SAAmB4C,EAAIxF,KAAKC,oBAA6B,IAErDuF,EAAIO,QAAQ,IAAM9F,wBAAiC6F,SACnDwD,EAAUlH,KAAKiH,EAA6B7D,EAAIpD,KAAK,OACrD9C,KAAKgL,aAAa9E,KAI1BsE,eAAgB,SAAUxE,GACtB1C,QAAkB6C,IAAEH,GAAStF,KAAKC,oBAA6B,KAGnE2J,UAAW,SAAUtE,GACjBhG,KAAK6E,SAASmB,IAGlBnB,SAAU,SAAUmB,GACXhD,qBACDhD,KAAKgL,aAAahF,IAGlBG,IAAEH,GAASI,GAAX,WAAkBzF,uBAAlB,SAA8DwF,IAAEH,GAASI,GAAG6D,IAAc9D,IAAEH,GAASI,GAAG8D,GAGxGrB,0BAAsC7C,GAFtChG,KAAKyF,QAAQO,IAMrBlB,QAAS,SAAUkB,GACf,IAAM2F,EAAsB3L,KAAKsL,yBACjC1F,gBAAmB+F,EAAoB,IACvC3L,KAAK+K,cAAcY,IAIvBvG,QAAS,SAAUY,GACf,IAEI0B,EAFwB1H,KAAKsL,yBAED3D,OACX,IAAjBD,EAAMlB,SACNkB,EAAQsC,EAAUtJ,KAAK,MAAM+G,QAGjC7B,gBAAmB8B,EAAM,KAG7BrC,SAAU,SAAUW,GAChB,IAEI6B,EAFwB7H,KAAKsL,yBAEDxD,OACX,IAAjBD,EAAMrB,SACNqB,EAAQmC,EAAUtJ,KAAK,MAAM6G,SAGjC3B,gBAAmBiC,EAAM,KAG7B+D,yBAA0B,SAAUC,GAChC,IAAIC,EAAa3F,IAAExF,uBACfsG,EAAY4E,EAAqB1F,IAAE,IAAD,OAAK0F,IAAsBpF,QAAQ,MAAQ,KAC7EmB,EAAakE,EAAWvE,QACxBM,EAAQgE,EAAqB5E,EAAUa,KAAKnH,uBAAkCiH,EAUlF,IARKC,EAAM,KACPA,EAAQD,GAOLC,EAAMzB,GAAGzF,wBACZkH,EAAMA,EAAMC,KAAKnH,uBAGrB,OAAOkH,GAGXkE,6BAA8B,SAAUF,GACpC,IAAIC,EAAa3F,IAAExF,uBACfsG,EAAY4E,EAAqB1F,IAAE,IAAD,OAAK0F,IAAsBpF,QAAQ,MAAQ,KAC7Ee,EAAYsE,EAAWrE,OACvBuE,EAAYH,EAAqB5E,EAAUU,KAAKhH,uBAAkC6G,EAUtF,IARKwE,EAAU,KACXA,EAAYxE,GAOTwE,EAAU5F,GAAGzF,wBAChBqL,EAAYA,EAAUrE,KAAKhH,uBAG/B,OAAOqL,GAGXxG,MAAO,SAAUQ,GAKb,GAJKhD,qBACDhD,KAAKgL,aAAahF,GAGlBhD,oBAA6B,CAC7B,IAAM6I,EAAqB7B,EAAUlH,KAAKgE,sBACpCY,EAAQ1H,KAAK+L,6BAA6BF,GAEhDjG,gBAAmB8B,EAAM,MAIjCjC,QAAS,SAAUO,GAKf,GAJKhD,qBACDhD,KAAKgL,aAAahF,GAGlBhD,oBAA6B,CAC7B,IAAMiJ,EAAmBjC,EAAUlH,KAAKgE,sBAClCe,EAAQ7H,KAAK4L,yBAAyBK,GAE5CrG,gBAAmBiC,EAAM,MAIjCnC,QAAS,SAAUM,GACf,IAAMuB,EAAQpB,IAAEH,GAASS,QAAQ,MAAM/F,KAAK,MAAM6G,QAAQ,GAC1D3B,gBAAmB2B,IAGvB5B,OAAQ,SAAUK,GACd,IAAMyB,EAAOtB,IAAEH,GAASS,QAAQ,MAAM/F,KAAK,MAAM+G,OAAO,GACxD7B,gBAAmB6B,MAM3BtB,WAASgE,EAAqB3F,UAAW,CAGrCqB,QAAS,WAaTC,aAAc,KAGlB,YAAmBqE,G,2JC9Rf/B,EAAU,EAGdzH,yBAAoC,eACpCA,8BAAyC,kBAEzCA,sBAAiC,2BACjCA,yBAAoC,8BACpCA,0BAAqC,wBACrCA,wBAAmC,qBACnCA,kBAA6B,gBAE7BA,qBAAgC,mBAChCA,wBAAmC,sBAEnCA,mBAA8B,iBAC9BA,oBAA+B,8CAC/BA,yBAAoC,iDAGpC,IAAIuL,EAAsB,WACtB9D,IACApI,KAAKsI,OAASF,GAGlBtE,WAASoI,EAAoB1H,UAAW,CACpCC,MAAO,SAAUC,GACb,OAAO1E,MAKX2E,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,SAAY,CAAC5E,KAAMA,KAAKwI,UAAW,MACnC,YAAe,CAACxI,KAAMA,KAAKyI,aAAc,MACzC,KAAQ,CAACzI,KAAMA,KAAKyF,QAAS,MAC7B,MAAS,CAACzF,KAAMA,KAAKmM,kBAAmB,MACxC,KAAQ,CAACnM,KAAMA,KAAK8E,QAAS,MAC7B,SAAY,CAAC9E,KAAMA,KAAK+E,UAAW,MACnC,YAAe,CAAC/E,KAAMA,KAAK+E,UAAW,MACtC,cAAiB,CAAC/E,KAAMA,KAAKgF,eAAgB,MAC7C,QAAW,CAAChF,KAAMA,KAAKiF,WAAY,MACnC,SAAY,CAACjF,KAAMA,KAAKkF,YAAa,MACrC,KAAQ,CAAClF,KAAMA,KAAKoF,QAAS,MAC7B,MAAS,CAACpF,KAAMA,KAAKqF,SAAU,MAC/B,WAAc,CAACrF,KAAMA,KAAKmF,cAAe,MACzC,aAAgB,CAACnF,KAAMA,KAAKsF,gBAAiB,MAC7C,cAAiB,CAACtF,KAAMA,KAAKuF,iBAAkB,MAC/C,GAAM,CAACvF,KAAMA,KAAKwF,MAAO,MACzB,SAAW,GAEfI,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,OAQ3CwI,UAAW,SAAUE,GACjB1I,KAAKyI,aAAaC,IAUtBD,aAAc,SAAUC,GACpB,IAAI0D,EAASjG,IAAEuC,GAAIhI,KAAK,MAAM2L,IAAI,YAUlC,OATAlG,IAAEuC,GAAI5F,KAAK,OAAQ,eACnBqD,SAAOiG,GAAQ,SAAUE,EAAKC,GAC1B,IAAIC,EAAQrG,IAAEoG,GACdC,EAAM1J,KAAK,OAAQ,UACnB,IAAI2J,EAAaD,EAAM9L,KAAK,iBACvB8L,EAAM1J,KAAK,eAAiB2J,EAAWjG,QACxCgG,EAAM1J,KAAK,aAAc2J,EAAW3J,KAAK,kBAG1C,MAQXiC,UAAW,SAAUiB,GACjB,IAAIC,EACAC,EAAMC,IAAEH,GACZ,GAAIE,EAAIE,GAAG,aAAc,CAcrB,IAAIwD,EAAQ1D,EAAIxF,KAAK,YAEjBuF,EADA2D,EAAMpD,OAAS,IAGfoD,EAAQ1D,EAAIxF,KAAK,MAAM2L,IAAI,aACjB7F,OAAS,EAHRoD,EAAM,GAQF5D,OAGhB,GAAIE,EAAIE,GAAG,UAEdH,EAAWD,MACR,CAEH,IAAI0G,EAAMxG,EAAIO,QAAQ,MAClBiG,EAAIlG,OAAS,IAGTP,GAFmC,IAAnCE,IAAEuG,EAAI,IAAIC,KAAK,gBAEJzG,EAAIO,QAAQ,SAEZiG,EAAI,IAe3B,OATIvG,IAAEF,GAAUG,GAAG,cAAgBD,IAAEF,GAAUvF,KAAK,mBAAmB0F,GAAG,gBACtEH,EAAWL,6BAAgCK,IAI3CA,EAAS,KAAOC,EAAI,KACpBD,EAAW,MAGRA,GAOXjB,eAAgB,SAAUgB,GACtB,IACI4G,EAAQzG,IAAEH,GAASS,QAAQ,MAO/B,OANImG,EAAMpG,OAAS,EACCoG,EAAM,GAGN,MAOxBtH,gBAAiB,SAASU,GACtB,IAAI6G,EAAQ1G,IAAEH,GACV8G,EAAc3G,IAAEnG,KAAK8J,QAAQrD,QAAQ9F,0BACrCoM,EAAeF,EAAMpG,QAAQ,SAASD,QAAUqG,EAkBpD,OAhBIE,GAAiBD,EAAYhK,KAAK,aAAa,IAC/C9C,KAAKgN,gBAAkBF,EAAYhK,KAAK,YAEpC9C,KAAKgN,iBAAiB,GACtBD,EAAajK,KAAK,wBAAyB9C,KAAKgN,iBAChDD,EAAarM,KAAK,YAAYoC,KAAK,WAAY9C,KAAKgN,mBAEpDH,EAAM/J,KAAK,wBAAyB,QACpCiK,EAAarM,KAAK,YAAYoC,KAAK,YAAa,IAIpDiK,EAAajK,KAAK,WAAY,MAC9BgK,EAAYhK,KAAK,WAAY,OAG1BkD,GAGXb,cAAe,SAASa,GACpB,IAAIiH,EAAM9G,IAAEH,GAASS,QAAQ9F,0BAE1BsM,EAAInK,KAAK,0BAA0B,EAClCqD,IAAEH,GAASlD,KAAK,WAAYmK,EAAInK,KAAK,0BAC9BmK,EAAInK,KAAK,aAAa,IAC7BqD,IAAEH,GAASlD,KAAK,WAAYmK,EAAInK,KAAK,aACrCmK,EAAInK,KAAK,wBAAyBmK,EAAInK,KAAK,eAInDmC,WAAY,SAAUe,GAClB,IAAIiB,EACAiG,EAEAC,EAAYhH,IAAEH,GAiClB,OAhCImH,EAAU3G,OAAO,KACjBS,EAAYkG,EAAU1G,QAAQ9F,gCAChB6F,OAAO,GAEjBlD,SAAmB2D,EAAUvG,KAAK,WAAW,KAE7CwM,EAAWjG,EAAUvG,KAAK,YAEb8F,OAAO,IAAMlD,eAAyB4J,EAASrK,SAGxDsI,mBAAiC,KAAM+B,EAAS,KAIhDlK,eACAmD,IAAExF,qBAA8ByM,WAGpCnG,EAAYkG,EAAU/G,GAAG,YAAa+G,EAAYA,EAAU1G,QAAQ,UACtDD,OAAO,GAEjBlD,SAAmB2D,EAAUvG,KAAK,KAAK,KAIxCyM,EAAU/G,GAAGzF,wBAAmCwM,EAAU/G,GAAGzF,2BACzDwM,EAAU/G,GAAGzF,6BAChBwM,EAAU9C,UAIfrE,GAGXd,YAAa,SAAUc,GACnB,IAAIiB,EAAYd,IAAEH,GAASS,QAAQ9F,+BAoBnC,OAlBIsG,EAAUT,OAAO,EAIbxG,KAAKqN,kBAAoBrH,IACzB1C,QAAkB2D,EAAUvG,KAAKC,oBAA6B,IAC9DsG,EAAUqG,WAAW,cAIzBrG,EAAYd,IAAEH,GAASS,QAAQ9F,wBACjB6F,OAAO,IAEjBlD,QAAkB2D,EAAUvG,KAAKC,oBAA6B,IAC9DsG,EAAUqG,WAAW,aAItB,MAGX/H,iBAAkB,SAASS,GACvB,IAAIuH,EAAWpH,IAAExF,oBAEjB,GAAI4M,EAAS/G,OAAO,EAEhB,OAAOR,EAMX,GADaG,IAAEqH,SAASC,eACXhH,QAAQ,aAAaD,OAAO,EAAE,CACvC,IAAI2G,EAAYI,EAAS7M,KAAK,IAAMC,mBAEhCwM,EAAU3G,OAAO,GACjBlD,QAAkB6J,EAAU,IAGhCnK,eACAmD,IAAExF,qBAA8ByM,OAGtBjH,IAAEnG,KAAK8J,QAAQrD,QAAQ9F,0BAE7BmC,KAAK,WAAY9C,KAAKgN,iBAE1BhN,KAAK8J,OAAS,KACd9J,KAAKqN,gBAAkB,KACvBlH,IAAE,aAAawD,YAAY,cAQnCvE,QAAS,SAAUY,GACf,IAAIiB,EAAYd,IAAEH,GAASS,QAAQ9F,+BAC/B+G,EAAMvB,IAAEH,KAERiB,EAAUT,QAAUL,IAAEH,GAASS,QAAQ,SAASD,SAChDS,EAAYd,IAAEnG,KAAK0N,eAAe1H,KAGlCiB,EAAUT,OAAO,IACFS,EAAU0G,QAAQhN,+BACxBiN,MAAK,SAAStB,EAAKuB,GACxB,IAAIhB,EAAQ1G,IAAE0H,GACd,IAAIhB,EAAM3N,SAAS,YAAuD,IAAzC2N,EAAMnM,KAAK,mBAAmB8F,QAAuD,IAAvCqG,EAAMnM,KAAK,iBAAiB8F,OAEvG,OADAkB,EAAQmF,GACD,KAKnB,OAAOnF,EAAM,IAGjBrC,SAAU,SAAUW,GAChB,IAAIiB,EAAYd,IAAEH,GAASS,QAAQ9F,+BAC/BkH,EAAM1B,IAAEH,KAERiB,EAAUT,QAAUL,IAAEH,GAASS,QAAQ,SAASD,SAChDS,EAAYd,IAAEnG,KAAK0N,eAAe1H,KAGlCiB,EAAUT,OAAO,IACFS,EAAU6G,QAAQnN,+BACxBiN,MAAK,SAAStB,EAAKuB,GACxB,IAAIhB,EAAQ1G,IAAE0H,GACd,IAAIhB,EAAM3N,SAAS,YAAuD,IAAzC2N,EAAMnM,KAAK,mBAAmB8F,QAAuD,IAAvCqG,EAAMnM,KAAK,iBAAiB8F,OAEvG,OADAqB,EAAQgF,GACD,KAKnB,OAAOhF,EAAM,IAGjBrC,MAAO,SAAUQ,GACb,IAAI0B,EAAQvB,IAAEH,GAYd,OAVGG,IAAEH,GAASS,QAAQ,SAASD,SACxBkB,EAAMC,OAAOnB,QACZkB,EAAMhH,KAAK,KAAKiJ,YAAYhJ,oBAC5B+G,EAAQA,EAAMC,OAAOzI,SAAS,aAAewI,EAAMC,OAAOA,OAASD,EAAMC,QACnEjH,KAAK,KAAK2I,SAAS1I,oBAEzB+G,EAAMlB,OAAS,GAInBkB,EAAMlB,OAAO,EACNkB,EAAM,GAEN1H,KAAK0N,eAAe1H,IAInCP,QAAS,SAAUO,GACf,IAAI+H,EACAC,EACAnG,EAAQ1B,IAAEH,GACViI,EAASpG,EAAMnH,KAAK,SASxB,GANIuN,EAAO7H,GAAGzF,sBACVqN,EAAU7H,IAAExF,uBACLsN,EAAO7H,GAAGzF,2BACjBqN,EAAU7H,IAAExF,4BAGbqN,GAAWA,EAAQxH,OAKlB,OAJAxG,KAAKkO,eAAelI,GAEpB6C,0BAAsCmF,EAAQ,IAC9C7H,IAAExF,0BAAmC4G,QAAQ7G,KAAK,KAAK2I,SAAS1I,mBACxDwF,IAAExF,0BAAmC4G,QAAQ,GAGzD,GAAGM,EAAMiC,SAAS1D,GAAG,gBAAgB,CAEjC,GAA+F,IAA3FyB,EAAMnH,KAAKC,wBAAmC,IAAMA,mBAA4B6F,OAChF,OAAOR,EAEXG,IAAE,IAAIxF,aAAsBgJ,YAAY,UACxCoE,EAAQ5H,IAAE,IAAIxF,YAAuB,YAErCoN,EAAQlG,EAAMpB,QAAQ,MAAM4F,IAAI,cAgBpC,OAbGlG,IAAEH,GAASS,QAAQ,SAASD,OACxBqB,EAAMC,OAAOtB,SACZqB,EAAMnH,KAAK,KAAKiJ,YAAYhJ,oBAC5BkH,EAAQA,EAAMC,OAAO5I,SAAS,aAAe2I,EAAMC,OAAOA,OAASD,EAAMC,QACnEpH,KAAK,KAAK2I,SAAS1I,oBAEvBwF,IAAEH,GAASS,QAAQ,cAAcD,SACvCqB,EAAQkG,EAAMrN,KAAK,MAAM6G,QAEzBvH,KAAKkO,eAAelI,IAIjB6B,EAAM,IAGjB/C,QAAS,SAASkB,GAQd,OALIA,EAFMG,IAAEH,GACLtF,KAAK,KAAK8F,OAAO,EACVxG,KAAK0N,eAAe1H,GAEpBG,IAAE,IAAIxF,0BAAmC,IAM3DwL,kBAAmB,SAAUnG,GAEzB,IAAImI,EACAjI,EAAMC,IAAEH,GA4BZ,OA1BGE,EAAIhH,SAAS,gBACZc,KAAKkO,eAAelI,IACpBA,EAAUE,EAAIxF,KAAK,SAAS,KAIxByF,IAAEH,GAASoI,UAIhBlI,EAAIxF,KAAK,KAAK8F,OAAO,EACpB2H,EAAajI,EAAIxF,KAAK,KAAK,GACS,IAA7BwF,EAAIxF,KAAK,SAAS8F,SACzB2H,EAAajI,EAAIxF,KAAK,WAAW,IAIlCyN,GAA+E,IAAjEhI,IAAEnG,KAAK8J,QAAQpJ,KAAKC,yBAAkC6F,QACR,IAA3DL,IAAEnG,KAAK8J,QAAQpJ,KAAKC,mBAA4B6F,QAChDqC,0BAAsCsF,GAGvChI,IAAEH,GAAStF,KAAK,KAAK8F,OAAO,IAC3BR,EAAUhG,KAAK0N,eAAe1H,IAG3BA,GAGXkI,eAAgB,SAASlI,GACrBhG,KAAK8J,OAAS9D,EACdG,IAAEH,GAASqD,SAAS,YACpBrJ,KAAKqN,gBAAkBrH,GAG3B0H,eAAgB,SAAU1H,GAOtB,OANAA,EAAUhG,KAAK8J,UAEX9D,EAAUG,IAAE,aAAa,IAG7BA,IAAEH,GAAS2D,YAAY,YAChB3D,KAIfG,WAAS+F,EAAoB1H,UAAW,CAGpCqB,QAAS,UAQTC,aAAc,KAGlB,YAAmBoG,G,2HCtff9D,EAAU,EACdzH,yBAAoC,2BACpCA,oBAA+B,QAE/B,IAAI0N,EAAwB,WACxBjG,IACApI,KAAKsI,OAASF,GAGlBtE,WAASuK,EAAsB7J,UAAW,CACtCC,MAAO,WACH,OAAOzE,MAIX2E,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,SAAY,CAAC5E,KAAMA,KAAKwI,UAAW,MACnC,YAAe,CAACxI,KAAMA,KAAKyI,aAAc,MACzC,SAAY,CAACzI,KAAMA,KAAK+E,UAAW,MACnC,YAAe,CAAC/E,KAAMA,KAAK+E,UAAW,MACtC,cAAiB,CAAC/E,KAAMA,KAAKgF,eAAgB,MAC7C,cAAiB,CAAChF,KAAMA,KAAKuF,iBAAkB,MAC/C,WAAc,CAACvF,KAAMA,KAAKmF,cAAe,MACzC,YAAe,CAACnF,KAAMA,KAAKwK,eAAgB,MAC3C,KAAQ,CAACxK,KAAMA,KAAKoF,QAAS,MAC7B,GAAM,CAACpF,KAAMA,KAAKwF,MAAO,MACzB,KAAQ,CAACxF,KAAMA,KAAKyF,QAAS,MAC7B,MAAS,CAACzF,KAAMA,KAAKqF,SAAU,MAC/B,MAAS,CAACrF,KAAMA,KAAK6E,SAAU,MAC/B,OAAU,CAAC7E,KAAMA,KAAK6E,SAAU,MAChC,KAAQ,CAAC7E,KAAMA,KAAK0F,QAAS,MAC7B,IAAO,CAAC1F,KAAMA,KAAK2F,OAAQ,MAC3B,MAAS,CAAC3F,KAAMA,KAAKuK,SAAU,MAC/B,SAAW,EACX,aAAe,GAEnB3E,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,OAM3CwI,UAAW,SAAUE,GACjB1I,KAAKyI,aAAaC,IAItBD,aAAc,SAAUC,GACpBvC,IAAEuC,GAAI5F,KAAK,OAAQ,WACnB,IAAMwL,EAAYnI,IAAEuC,GAAIhI,KAAK,WAY7B,OAXAyF,SAAOmI,GAAW,SAAUhC,EAAKC,GAC7B,IAAMC,EAAQrG,IAAEoG,GAChBC,EAAM1J,KAAK,eAAgB,SAE3B0J,EAAM1J,KAAK,aAAc,QAEzB,IAAMyL,EAASpI,IAAEqG,GAAO9L,KAAK,kBAC7ByF,SAAOoI,GAAQ,SAAUjC,EAAKkC,GAC1BrI,IAAEqI,GAAQ1L,KAAK,cAAe,cAG/B,MAIXiC,UAAW,SAAUiB,GACjB,IAAIC,EAqC4E,EApC1EC,EAAMC,IAAEH,GACd,GAAIE,EAAIE,GAAGzF,0BAAoC,CAC3C,IAAIiJ,EAAQ1D,EAAIxF,KAAKC,qBAA8B0L,IAAI,YACvD,GAAIzC,EAAMpD,OAAS,EAEf,IADAoD,EAAQA,EAAMlJ,KAAK,WAAW2L,IAAI,cACxB7F,OAAS,EACfP,EAAW2D,EAAM,OACd,CAEH,IAAI6E,EAAwBtI,IAAE,eAAe,GACzCD,EAAI4B,OAAQ,KAAO2G,GACnBxI,EAAWL,gCAAmCI,KAC/BC,IAAaE,IAAE,gBAAgB,KAC1CF,EAAWL,gCAAmCK,IAGlDA,EAAWL,4BAA+BI,SAInD,GAAIE,EAAIE,GAAGzF,qBACdsF,EAAYC,EAAIxF,KAAK,WAAY,OAC9B,CAEH,IAAMgM,EAAMxG,EAAIO,QAAQ9F,qBACpB+L,EAAIlG,OAAS,IAGTP,GAFmC,IAAnCE,IAAEuG,EAAI,IAAIC,KAAK,gBAEJzG,EAAIO,QAAQ9F,0BAEZ+L,EAAIhM,KAAK,aAM5ByF,IAAEF,GAAUG,GAAG,cAAgBD,IAAEF,GAAUvF,KAAK,WAAW0F,GAAG,gBAI9DH,EAAQ,UAHaE,IAAEF,GAAUQ,QAAQ9F,qBAA8BmN,UAAUY,QAAO,SAAUC,EAAO3I,GACrG,OAAOG,IAAEH,GAAStF,KAAK,WAAW0F,GAAG,eAEjB,UAAhB,QAAsBH,GAQlC,OAJIA,GAAaA,EAAS,KAAOC,EAAI,KACjCD,EAAW,MAGRA,GAIXjB,eAAgB,SAAUgB,GACtB,IACM4G,EAAQzG,IAAEH,GAASS,QAAQ9F,0BAOjC,OANIiM,EAAMpG,OAAS,EACCoG,EAAM,GAGN,MAKxBrH,iBAAkB,SAASS,GACNG,IAAEH,GAASS,QAAQ9F,0BAAmCD,KAAKC,qBAA8B0L,IAAI,YACrGuB,MAAK,SAAStB,EAAKuB,GACxB1H,IAAE0H,GAAMnN,KAAK,WAAWiJ,YAAYhJ,mBAA4BmC,KAAK,eAAgB,aAI7FqC,cAAe,SAASa,GACpB,IAAM6G,EAAQ1G,IAAEH,GAASI,GAAG,WAAaD,IAAEH,GAAWG,IAAEH,GAAStF,KAAK,WACtE4C,SAAmBuJ,EAAM,KAG7BrC,eAAgB,SAASxE,GACrB,IAAM6G,EAAQ1G,IAAEH,GAASI,GAAG,WAAaD,IAAEH,GAAWG,IAAEH,GAAStF,KAAK,WACtE4C,QAAkBuJ,EAAM,KAI5BzH,QAAS,SAAUY,GAAQ,MACjBiB,EAAYd,IAAEH,GAASI,GAAGzF,qBAAgCwF,IAAEH,GAAWG,IAAEH,GAASS,QAAQ9F,qBAC5F+G,EAAQ,KAERT,EAAUT,OAAO,IACAS,EAAU0G,QAAQhN,qBAA8B0L,IAAI,YAC5DuB,MAAK,SAAStB,EAAKuB,GACxB,IAAMhB,EAAQ1G,IAAE0H,GACH,OAAVnG,GAA6D,IAA1CmF,EAAMnM,KAAK,oBAAoB8F,QAAwD,IAAxCqG,EAAMnM,KAAK,kBAAkB8F,SAC9FkB,EAAQmF,EAAMnM,KAAK,eAKd,OAAVgH,GACkBT,EAAU6G,QAAQnN,qBAA8B0L,IAAI,YAC5DuB,MAAK,SAAStB,EAAKuB,GACxB,IAAMhB,EAAQ1G,IAAE0H,GAC6B,IAA1ChB,EAAMnM,KAAK,oBAAoB8F,QAAwD,IAAxCqG,EAAMnM,KAAK,kBAAkB8F,SAC3EkB,EAAQmF,EAAMnM,KAAK,gBAMnC,OADAgH,EAAK,UAAGA,SAAH,QAAY1B,GAIrBX,SAAU,SAAUW,GAAS,MACnBiB,EAAYd,IAAEH,GAASI,GAAGzF,qBAAgCwF,IAAEH,GAAWG,IAAEH,GAASS,QAAQ9F,qBAC5FkH,EAAQ,KAERZ,EAAUT,OAAO,IACAS,EAAU6G,QAAQnN,qBAA8B0L,IAAI,YAC5DuB,MAAK,SAAStB,EAAKuB,GACxB,IAAMhB,EAAQ1G,IAAE0H,GACH,OAAVhG,GAA4D,IAA1CgF,EAAMnM,KAAK,oBAAoB8F,QAAwD,IAAxCqG,EAAMnM,KAAK,kBAAkB8F,SAC7FqB,EAAQgF,EAAMnM,KAAK,eAId,OAAVmH,GACkBZ,EAAU0G,QAAQhN,qBAA8B0L,IAAI,YAC5DuB,MAAK,SAAStB,EAAKuB,GACxB,IAAMhB,EAAQ1G,IAAE0H,GAC6B,IAA1ChB,EAAMnM,KAAK,oBAAoB8F,QAAwD,IAAxCqG,EAAMnM,KAAK,kBAAkB8F,SAC3EqB,EAAQgF,EAAMnM,KAAK,gBAMnC,OADAmH,EAAK,UAAGA,SAAH,QAAY7B,GAIrBR,MAAO,SAAUQ,GAEb,OAAOA,GAGXP,QAAS,SAAUO,GAEf,OAAOA,GAGXnB,SAAU,SAAUmB,GAChB,IAAMiB,EAAYd,IAAEH,GAASI,GAAGzF,qBAAgCwF,IAAEH,GAAWG,IAAEH,GAASS,QAAQ9F,qBAChG,GAAGsG,EAAUT,OAAO,IACIS,EAAU2H,SAASjO,qBAA8B0L,IAAI,YAC7DuB,MAAK,SAAStB,EAAKuB,GAC3B1H,IAAE0H,GAAMnN,KAAK,WAAWiJ,YAAYhJ,mBAA4BmC,KAAK,eAAgB,YAEtFmE,EAAUvG,KAAK,WAAW8F,OAAQ,GAAmD,IAA9CS,EAAUvG,KAAK,oBAAoB8F,QAA4D,IAA5CS,EAAUvG,KAAK,kBAAkB8F,QAAa,CACvI,IAAIqI,EAAO5H,EAAUvG,KAAK,WAC1BmO,EAAK/L,KAAK,eAAgB,QAC1BQ,SAAmBuL,EAAK,IACxB1I,IAAE0I,EAAK,IAAIC,QAAQ,aAK/BpJ,QAAS,SAAUM,GAAS,MACpB+I,EAAW,KASf,OARkB5I,IAAEH,GAASI,GAAGzF,qBAAgCwF,IAAEH,GAAWG,IAAEH,GAASS,QAAQ9F,sBACrEgN,QAAQhN,qBAA8B0L,IAAI,YAC5DuB,MAAK,SAAStB,EAAKuB,GACxB,IAAMhB,EAAQ1G,IAAE0H,GAC6B,IAA1ChB,EAAMnM,KAAK,oBAAoB8F,QAAwD,IAAxCqG,EAAMnM,KAAK,kBAAkB8F,SAC3EuI,EAAWlC,EAAMnM,KAAK,eAG9B,UAAOqO,SAAP,QAAmB/I,GAGvBL,OAAQ,SAAUK,GAAS,MACnBgJ,EAAU,KASd,OARkB7I,IAAEH,GAASI,GAAGzF,qBAAgCwF,IAAEH,GAAWG,IAAEH,GAASS,QAAQ9F,sBACrEmN,QAAQnN,qBAA8B0L,IAAI,YAC5DuB,MAAK,SAAStB,EAAKuB,GACxB,IAAMhB,EAAQ1G,IAAE0H,GAC6B,IAA1ChB,EAAMnM,KAAK,oBAAoB8F,QAAwD,IAAxCqG,EAAMnM,KAAK,kBAAkB8F,SAC3EwI,EAAUnC,EAAMnM,KAAK,eAG7B,UAAOsO,SAAP,QAAkBhJ,GAGtBuE,SAAU,SAAUvE,GACIG,IAAEH,GAASS,QAAQ9F,qBAA8BiO,SAASjO,qBAA8B0L,IAAI,YACpGuB,MAAK,SAAStB,EAAKuB,GAC3B1H,IAAE0H,GAAMnN,KAAK,WAAWoC,KAAK,eAAgB,YAEjD,IAAM+L,EAAO1I,IAAEH,GAASI,GAAG,WAAaD,IAAEH,GAAWG,IAAEH,GAASS,QAAQ,WACrEoI,EAAKrI,OAAO,GACXqI,EAAK/L,KAAK,eAAgB,WAKtCqD,WAASkI,EAAsB7J,UAAW,CAGtCqB,QAAS,YAQTC,aAAc,KAGlB,YAAmBuI,G,gHCrSfjG,EAAU,EACdzH,yBAAoC,yBACpCA,oBAA+B,eAE/B,IAAIsO,EAAgB,WAChB7G,IACApI,KAAKsI,OAASF,GAGlBtE,WAASmL,EAAczK,UAAW,CAC9BC,MAAO,WACH,OAAOzE,MAIX2E,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,SAAY,CAAC5E,KAAMA,KAAKwI,UAAW,MACnC,YAAe,CAACxI,KAAMA,KAAKyI,aAAc,MACzC,SAAY,CAACzI,KAAMA,KAAK+E,UAAW,MACnC,YAAe,CAAC/E,KAAMA,KAAK+E,UAAW,MACtC,cAAiB,CAAC/E,KAAMA,KAAKgF,eAAgB,MAC7C,KAAQ,CAAChF,KAAMA,KAAKoF,QAAS,MAC7B,MAAS,CAACpF,KAAMA,KAAKqF,SAAU,MAC/B,GAAM,CAACrF,KAAMA,KAAKwF,MAAO,MACzB,KAAQ,CAACxF,KAAMA,KAAKyF,QAAS,MAC7B,MAAS,CAACzF,KAAMA,KAAKuK,SAAU,MAC/B,SAAW,EACX,aAAe,GAEnB3E,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,OAM3CwI,UAAW,SAAUE,GACjB1I,KAAKyI,aAAaC,IAItBD,aAAc,SAAUC,GACpBvC,IAAEuC,GAAI5F,KAAK,OAAQ,WACnB,IAAMoM,EAAY/I,IAAEuC,GAAIhI,KAAKC,qBAA8B0L,IAAI,cAe/D,OAdAlG,SAAO+I,GAAW,SAAU5C,EAAKC,GAC7B,IAAMC,EAAQrG,IAAEoG,GACbpG,IAAEoG,GAAMrN,SAAS,YAChBsN,EAAM1J,KAAK,gBAAiB,QAE5B0J,EAAM1J,KAAK,gBAAiB,SAEhC0J,EAAM1J,KAAK,OAAQ,OAEnB,IAAMyL,EAASpI,IAAEqG,GAAO9L,KAAK,kBAC7ByF,SAAOoI,GAAQ,SAAUjC,EAAKkC,GAC1BrI,IAAEqI,GAAQ1L,KAAK,cAAe,cAG/B,MAIXiC,UAAW,SAAUiB,GACjB,IAAIC,EA2B6E,EA1B3EC,EAAMC,IAAEH,GACd,GAAIE,EAAIE,GAAGzF,0BAAoC,CAC3C,IAAIiJ,EAAQ1D,EAAIxF,KAAKC,qBAA8B0L,IAAI,UAGnDpG,EAFA2D,EAAMpD,OAAS,EAEHoD,EAAM8E,QAAO,SAACC,EAAOpC,GAAR,OAAepG,IAAEoG,GAAMrN,SAAS,eAAc,GAG5D0G,4BAA+BI,QAE3C,GAAIE,EAAIE,GAAGzF,qBACdsF,EAAWD,MACR,CAEH,IAAM0G,EAAMxG,EAAIO,QAAQ9F,qBACpB+L,EAAIlG,OAAS,IAGTP,GAFmC,IAAnCE,IAAEuG,EAAI,IAAIC,KAAK,gBAEJzG,EAAIO,QAAQ9F,0BAEZ+L,EAAI,KAMvBvG,IAAEF,GAAUG,GAAG,eAAiBD,IAAEF,GAAUvF,KAAK,WAAW0F,GAAG,gBAE/DH,EAAQ,UADcE,IAAEF,GAAUQ,QAAQ9F,0BAAmCD,KAAKC,qBAA8B0L,IAAI,cAC3F,UAAjB,QAAuBpG,GAQnC,OAJIA,GAAaA,EAAS,KAAOC,EAAI,KACjCD,EAAW,MAGRA,GAIXjB,eAAgB,SAAUgB,GACtB,IACM4G,EAAQzG,IAAEH,GAASS,QAAQ9F,0BAOjC,OANIiM,EAAMpG,OAAS,EACCoG,EAAM,GAGN,MAMxBxH,QAAS,SAAUY,GACf,IAAMiB,EAAYd,IAAEH,GAASI,GAAGzF,qBAAgCwF,IAAEH,GAAWG,IAAEH,GAASS,QAAQ9F,qBAC5F+G,EAAQ,KAERT,EAAUT,OAAO,IACjBS,EAAUnE,KAAK,gBAAiB,SAAS6G,YAAY,YACpC1C,EAAU0G,QAAQhN,qBAA8B0L,IAAI,UAC5DuB,MAAK,SAAStB,EAAKuB,GACxB,IAAMhB,EAAQ1G,IAAE0H,GACH,OAAVnG,GAAoBmF,EAAMzG,GAAG,eAA4D,IAA1CyG,EAAMnM,KAAK,oBAAoB8F,SAC7EkB,EAAQmF,OAMpB,OAFAnF,EAAQA,EAAQA,EAAM,GAAK1B,EAC3BG,IAAEuB,GAAO5E,KAAK,gBAAiB,QAAQuG,SAAS,YACzC3B,GAGXrC,SAAU,SAAUW,GAChB,IAAMiB,EAAYd,IAAEH,GAASI,GAAGzF,qBAAgCwF,IAAEH,GAAWG,IAAEH,GAASS,QAAQ9F,qBAC5FkH,EAAQ,KAERZ,EAAUT,OAAO,IACjBS,EAAUnE,KAAK,gBAAiB,SAAS6G,YAAY,YACpC1C,EAAU6G,QAAQnN,qBAA8B0L,IAAI,UAC5DuB,MAAK,SAAStB,EAAKuB,GACxB,IAAMhB,EAAQ1G,IAAE0H,GACH,OAAVhG,GAAoBgF,EAAMzG,GAAG,eAA4D,IAA1CyG,EAAMnM,KAAK,oBAAoB8F,SAC7EqB,EAAQgF,OAMpB,OAFAhF,EAAQA,EAAQA,EAAM,GAAK7B,EAC3BG,IAAE0B,GAAO/E,KAAK,gBAAiB,QAAQuG,SAAS,YACzCxB,GAGXrC,MAAO,SAAUQ,GACb,OAAOA,GAGXP,QAAS,SAAUO,GACf,OAAOA,GAGXuE,SAAU,SAAUvE,GAChB,IAAMmJ,EAAWhJ,IAAEH,GAASI,GAAGzF,qBAAgCwF,IAAEH,GAAWG,IAAEH,GAASS,QAAQ9F,qBAC3EwO,EAASP,SAASjO,qBAA8B0L,IAAI,UAC5DuB,MAAK,SAAStB,EAAKuB,GAC3B1H,IAAE0H,GAAM/K,KAAK,gBAAiB,YAErBqM,EAAS9C,IAAI,cAClB7F,OAAO,GACX2I,EAASrM,KAAK,gBAAiB,WAK3CqD,WAAS8I,EAAczK,UAAW,CAG9BqB,QAAS,UAQTC,aAAc,KAGlB,YAAmBmJ,G,qDC1NfG,G,SAAgB,MAIhBC,EAAaD,MADEjJ,0BAAwB,MAG3CA,0BAA0BkJ,EAE1BlJ,0BAAwB,KAAMkJ,GAE9BlJ,mCAMAA,8BAJiBmJ,8GAMjB,IAAIC,EAAkBpJ,wBAEtBA,wBAAwB,WACpB,IAAIqJ,EAASD,EAAgBE,MAAMtJ,eAAcuJ,WAKjD,OAHAF,EAAOG,MAAMhG,YAAYyF,GACzBI,EAAOG,MAAMtG,SAAS+F,GAEfI,GAGX,IAAII,EAAoBzJ,0BAExBA,0BAA0B,SAAS0J,GAC/BD,EAAkBE,KAAK9P,KAAM6P,GAC7B7P,KAAK+P,YAAYF,I,6BC/BjBN,EAAkBpJ,wBAEtBA,wBAAwB,SAAS8H,EAAQ+B,GAChCA,EAAKC,oBACND,EAAKC,kBAAoB,SAASC,EAAMC,EAAOC,EAAYC,GACvDD,EAAWE,YAAcF,EAAWG,aACpCH,EAAWI,aAAeJ,EAAWK,cACrCL,EAAWM,WAAaN,EAAWO,YAEnCN,EAAWO,gBAAgBR,KAInC,IAAIS,EAAWtB,EAAgBO,KAAK3J,eAAc8H,EAAQ+B,GAEtDc,EAAuBD,EAASE,cAQpC,OANAF,EAASE,cAAgB,WAGrB,OAFA/Q,KAAKgR,SAAS,GAAGC,kBAAoB,KAE9BH,EAAqBrB,MAAMzP,KAAM0P,YAGrCmB,I,sGCLPzI,EAAU,EAEVL,EAASzD,aAAa,UAItB4M,EAAqB,WACrB9I,IACApI,KAAKsI,OAASF,GAOlBjC,WAAS+K,EAAmB1M,UAAW,CACnCC,MAAO,SAAUC,GAEb,OADAqD,EAAOQ,MAAM,2BAA6B7D,EAAW,OAC9C1E,MAKX2E,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,SAAY,CAAC5E,KAAMA,KAAKwI,UAAW,MACnC,YAAe,CAACxI,KAAMA,KAAKyI,aAAc,MACzC,KAAQ,CAACzI,KAAMA,KAAKmR,YAAa,MACjC,MAAS,CAACnR,KAAMA,KAAKmM,kBAAmB,MACxC,OAAU,CAACnM,KAAMA,KAAKsK,UAAW,MACjC,SAAW,EACX,aAAe,EACf,KAAQ,CAACtK,KAAMA,KAAKmR,YAAa,MACjC,MAAS,CAACnR,KAAMA,KAAKoR,eAAgB,MACrC,GAAM,CAACpR,KAAMA,KAAKoR,eAAgB,OAEtCxL,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB,SAAU5F,KAAK4E,WAQ5C4D,UAAW,SAAUE,GAQjB,OAAO,MAUXD,aAAc,SAAUC,GAQpB,OAAO,MAKXa,aAAc,SAAUvD,GACpB,IAAIqL,EACAnL,EAAMC,IAAEH,GAEZ,GAAIE,EAAIE,GAAG,KACPiL,EAAcnL,OAGd,QAAoBoL,KADpBD,EAAclL,IAAEH,GAASS,QAAQ,MAG7B,OAQR,OAFA4K,EAAY3Q,KAAK,eAAeiJ,YAAY,eAC5C0H,EAAY3H,WAAWhJ,KAAK,aAAaiJ,YAAY,aAC9C0H,GAKXpM,WAAY,SAAUe,GAClB,IAAIqL,EAEA5H,EAAStD,IAAEH,GAAS0D,SAAS,eACjC,GAAID,EAAOjD,OAAS,EAChBiD,EAAOE,YAAY,cAEnB0H,EAAcrR,KAAKuJ,aAAaE,EAAO,QACpC,CAEH,IAAIG,EAAQzD,IAAEH,GAAS0D,SAAS,6BAE5B2H,EADAzH,EAAMpD,OAAS,EACDxG,KAAKuJ,aAAaK,EAAM,IAIxB5D,EAGtB,OAAOqL,GAGXF,YAAa,SAASnL,GAClB,IAAI0B,EAAMvB,IAAEH,GAAS2B,KAAK,KAC1B,OAAID,EAAMlB,OAAO,EACNR,EAEJ0B,EAAM,IAGjB0J,eAAgB,SAASpL,GACrB,IAAI6B,EAAM1B,IAAEH,GAAS8B,KAAK,KAC1B,OAAID,EAAMrB,OAAO,EACNR,EAEJ6B,EAAM,IAKjB1C,cAAe,SAAUa,GACrB,GAAmC,KAA/BG,IAAEH,GAAS2G,KAAK,YAAoB,CAEpC,IAAIxF,EAAQnH,KAAKuJ,aAAavD,GAE9BJ,gBAAmBuB,GAAO,KAYlCgF,kBAAmB,SAAUnG,GAOzB,OALUG,IAAEH,GACJI,GAAG,MAEPyC,0BAAsC7C,GAEnCA,GAIXsE,UAAW,SAAUtE,GAEjB,IAAIE,EAAMC,IAAEH,GACZ,OAAIE,EAAIE,GAAG,MAA6B,WAArBF,EAAIpD,KAAK,QACjB9C,KAAKmM,kBAAkBnG,GAG3BA,KAMfG,WAAS+K,EAAmB1M,UAAW,CAGnCqB,QAAS,SASTC,aAAc,CAAC,OAGnB,QAD4B,IAAIoL,G,uGC1M5B9I,EAAU,EAEVL,EAASzD,aAAa,UAItBiN,EAAqB,WACrBnJ,IACApI,KAAKsI,OAASF,GAOlBjC,WAASoL,EAAmB/M,UAAW,CACnCC,MAAO,SAAUC,GAEb,OADAqD,EAAOQ,MAAM,2BAA6B7D,EAAW,OAC9C1E,MAKX2E,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,MAAS,CAAC5E,KAAMA,KAAKmM,kBAAmB,MACxC,QAAW,CAACnM,KAAMA,KAAKmM,kBAAmB,MAC1C,OAAU,CAACnM,KAAMA,KAAKmM,kBAAmB,MACzC,SAAW,EACX,aAAe,GAEnBvG,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB,SAAU5F,KAAK4E,WAK5C2E,aAAc,SAAUvD,GACpB,IAAIqL,EACAnL,EAAMC,IAAEH,GAEZ,GAAIE,EAAIE,GAAG,0BACPiL,EAAcnL,OAGd,QAAoBoL,KADpBD,EAAclL,IAAEH,GAASS,QAAQ,2BAG7B,OAQR,OAFA4K,EAAY3Q,KAAK,eAAeiJ,YAAY,eAC5C0H,EAAY3H,WAAWhJ,KAAK,aAAaiJ,YAAY,aAC9C0H,GAKXpM,WAAY,SAAUe,GAClB,IAAIqL,EAEA5H,EAAStD,IAAEH,GAAS0D,SAAS,eACjC,GAAID,EAAOjD,OAAS,EAChBiD,EAAOE,YAAY,cAEnB0H,EAAcrR,KAAKuJ,aAAaE,EAAO,QACpC,CAEH,IAAIG,EAAQzD,IAAEH,GAAS0D,SAAS,6BAE5B2H,EADAzH,EAAMpD,OAAS,EACDxG,KAAKuJ,aAAaK,EAAM,IAIxB5D,EAGtB,OAAOqL,GAKXlM,cAAe,SAAUa,GACrB,GAAmC,UAA/BG,IAAEH,GAAS2G,KAAK,YAAyB,CAEzC,IAAIxF,EAAQnH,KAAKuJ,aAAavD,GAE9BJ,gBAAmBuB,GAAO,KAYlCgF,kBAAmB,SAAUnG,GAMzB,OAJUG,IAAEH,GACJI,GAAG,2BACPyC,0BAAsC7C,GAEnCA,KAMfG,WAASoL,EAAmB/M,UAAW,CAGnCqB,QAAS,SASTC,aAAc,CAAC,YAGnB,QAD4B,IAAIyL,G,4FC3J5BC,EAAczJ,aAAgB,oBAI9BK,EAAU,EACVqJ,EAAmB,WACnBrJ,IACApI,KAAKsI,OAASF,GAElBjC,WAASsL,EAAiBjN,UAAW,CACjCC,MAAO,SAAUC,GAEb,OADA8M,EAAYjJ,MAAM,yBAA2B7D,EAAW,OACjD1E,MAEX2E,SAAU,WACN3E,KAAK4E,SAAW,CACZ,QAAW,CACP5E,KACA4F,iBACA,CACI,SAAY,EACZ,cAAiB,aAGzB,SAAY,CACR5F,KACA4F,kBACA,MAEJ,WAAc,CACV5F,KACAA,KAAKmF,cACL,MAEJ,KAAQ,CACJnF,KACAA,KAAKoF,QACL,MAEJ,MAAS,CACLpF,KACAA,KAAKqF,SACL,MAEJ,GAAM,CACFrF,KACAA,KAAKwF,MACL,MAEJ,KAAQ,CACJxF,KACAA,KAAKyF,QACL,MAEJ,QAAW,CACPzF,KACAA,KAAK0R,SACL,MAEJ,SAAW,EACX,aAAe,GAEnB9L,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAE7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,KAAK4E,WAEhD+M,cAAe,SAAUjJ,GACrB,IACIkJ,EADOzL,IAAEuC,GAAIjC,QAAQ,SACR/F,KAAK,aACtB,QAAc4Q,IAAVM,EACA,OAAOzL,IAAEyL,EAAM,KAGvBrI,aAAc,SAAUvD,GACpB,IAAIyD,EACA4H,EACJ,GAAIrL,EAAQ9G,SAAS,QAEjB,IADAuK,EAASzD,EAAQ0D,SAAS,YAAYA,SAAS,0BACpClD,OAAS,EAChB6K,EAAc5H,EAAO,OAClB,CACH,IAAIoI,EAAO7L,EAAQ0D,SAAS,YAC5B,GAAImI,EAAKrL,OAAS,EAAG,CACjB,IAAIsL,EAAQ3L,IAAE0L,EAAK,IAAInI,SAAS,aAE5B2H,EADAS,EAAMtL,OAAS,EACDsL,EAAM,GAEND,EAAK,QAGvBR,EAAcrL,OAGfA,EAAQ9G,SAAS,WAExBmS,GADA5H,EAASzD,EAAQ0D,SAAS,0BACL,GACd1D,EAAQ9G,SAAS,cACxBmS,EAAcrL,GAElB,OAAOqL,GAEXlM,cAAe,SAAUa,GACrB,IAAwC,IAApCG,IAAEH,GAAS9G,SAAS,YAAuB,CAC3C,IAAIiI,EAAQnH,KAAKuJ,aAAapD,IAAEH,IAChCJ,gBAAmBuB,GAAO,KAGlC/B,QAAS,SAAUY,GACf,IAAI+L,EAAO/R,KAAK2R,cAAc3L,GAC1BgM,EAAQ7L,KAAE,GAOd,OANI4L,EAAK7S,SAAS,cACd8S,EAAQD,EAAKpK,KAAK,cAED,IAAjBqK,EAAMxL,QACNZ,gBAAmBoM,IAEhB,GAEX3M,SAAU,SAAUW,GAChB,IAAI+L,EAAO/R,KAAK2R,cAAc3L,GAC1BgM,EAAQ7L,KAAE,GAOd,OANI4L,EAAK7S,SAAS,cACd8S,EAAQD,EAAKjK,KAAK,cAED,IAAjBkK,EAAMxL,QACNZ,gBAAmBoM,IAEhB,GAEXxM,MAAO,SAAUQ,GACb,IACIiM,EADAF,EAAO/R,KAAK2R,cAAc3L,GAE1BkM,EAAS/L,KAAE,GACX6L,EAAQ7L,KAAE,GACd,GAAI4L,EAAK7S,SAAS,cAEK,KADnB+S,EAAMF,EAAKtL,QAAQ,aACXD,SACJ0L,EAASD,EAAItK,KAAK,aAEA,IAAlBuK,EAAO1L,QAAc,CACrB,IAAI2L,EAAOJ,EACPK,GAAO,EACX,GACIA,IACAD,EAAOhM,IAAEgM,EAAKxK,KAAK,aAAa,UAC3BwK,EAAK3L,OAAS,GAEvB,IADAwL,EAAQ7L,IAAE+L,EAAOxR,KAAK,aAAa,IAC5B0R,EAAM,IACTD,EAAOH,EAAMlK,KAAK,cACTtB,OAAS,IACdwL,EAAQ7L,IAAEgM,EAAK,KAEnBC,IAOZ,OAHqB,IAAjBJ,EAAMxL,QACNZ,gBAAmBoM,IAEhB,GAEXvM,QAAS,SAAUO,GACf,IACIiM,EADAF,EAAO/R,KAAK2R,cAAc3L,GAE1BkM,EAAS/L,KAAE,GACX6L,EAAQ7L,KAAE,GACd,GAAI4L,EAAK7S,SAAS,eACd+S,EAAMF,EAAKtL,QAAQ,aACXD,OAAS,IACb0L,EAASD,EAAInK,KAAK,aAElBoK,EAAO1L,OAAS,GAAG,CACnB,IAAI2L,EAAOJ,EACPK,GAAO,EACX,GACIA,IACAD,EAAOhM,IAAEgM,EAAKxK,KAAK,aAAa,UAC3BwK,EAAK3L,OAAS,GAEvB,IADAwL,EAAQ7L,IAAE+L,EAAOxR,KAAK,aAAa,IAC5B0R,EAAM,IACTD,EAAOH,EAAMlK,KAAK,cACTtB,OAAS,IACdwL,EAAQ7L,IAAEgM,EAAK,KAEnBC,IAOZ,OAHqB,IAAjBJ,EAAMxL,QACNZ,gBAAmBoM,IAEhB,KAGf7L,WAASsL,EAAiBjN,UAAW,CACjCqB,QAAS,OACTC,aAAc,KAGlB,QAD0B,IAAI2L,G,4FCvM1BD,EAAczJ,aAAgB,oBAI9BK,EAAU,EACViK,EAAmB,WACnBjK,IACApI,KAAKsI,OAASF,GAElBjC,WAASkM,EAAiB7N,UAAW,CACjCC,MAAO,SAAUC,GAEb,OADA8M,EAAYjJ,MAAM,yBAA2B7D,EAAW,OACjD1E,MAEX2E,SAAU,WACN3E,KAAK4E,SAAW,CACZ,SAAY,CACR5E,KACAA,KAAKwI,UACL,MAEJ,YAAe,CACXxI,KACAA,KAAKyI,aACL,MAEJ,MAAS,CACLzI,KACAA,KAAKuK,SACL,MAEJ,KAAQ,CACJvK,KACAA,KAAKyF,QACL,MAEJ,SAAY,CACRzF,KACAA,KAAK+E,UACL,MAEJ,cAAiB,CACb/E,KACAA,KAAKgF,eACL,MAEJ,SAAW,EACX,aAAe,EACf,KAAQ,CACJhF,KACAA,KAAKoF,QACL,MAEJ,MAAS,CACLpF,KACAA,KAAKqF,SACL,MAEJ,GAAM,CACFrF,KACAA,KAAKwF,MACL,MAEJ,aAAgB,CACZI,IACAA,sBACA,CACI,SAAY,EACZ,cAAiB,KACjB,YAAc,IAGtB,cAAiB,CACbA,IACAA,uBACA,CAAE,YAAc,KAGxBA,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAE7DC,WAAY,WACRH,sBAAyB,OAAQ5F,KAAK4E,WAE1C4D,UAAW,SAAUE,GACjB1I,KAAKyI,aAAaC,IAEtBD,aAAc,SAAUC,GACpB,IACI0D,EADQjG,IAAEuC,GACKgB,SAAS,MAU5B,OATAvD,SAAOiG,GAAQ,SAAUuC,EAAOpC,GAC5B,IAAIC,EAAQrG,IAAEoG,QACoB,IAAvBC,EAAM1J,KAAK,UACD0J,EAAM9L,KAAK,KACb8F,OAAS,GACpBgG,EAAM1J,KAAK,OAAQ,YAIxB,MAEXiC,UAAW,SAAUiB,GACjB,IAAIyD,EACAxD,EACAC,EAAMC,IAAEH,GACZ,GAAIE,EAAIE,GAAG,aAAeF,EAAIwD,SAAS,eAAelD,OAClD,OAAOR,EAEX,GAAIE,EAAIE,GAAG,SAEP,IADAqD,EAASvD,EAAIwD,SAAS,mBACXlD,OAAS,EAChBP,EAAWwD,EAAO,OACf,CACH,IAAIG,EAAQ1D,EAAIwD,SAAS,MAErBzD,EADA2D,EAAMpD,OAAS,EACJoD,EAAM,GAEN5D,OAGhB,GAAIE,EAAIE,GAAG,MACdH,EAAWD,MACR,CACH,IAAI0G,EAAMxG,EAAIO,QAAQ,MAGdR,EAFJyG,EAAIlG,OAAS,GAC0B,IAAnCL,IAAEuG,EAAI,IAAIC,KAAK,gBACJzG,EAAIO,QAAQ,SAEZiG,EAAI,GAGRxG,EAAIO,QAAQ,SAG/B,OAAOR,GAEXsD,aAAc,SAAUvD,GACpB,OAAO,MAEXhB,eAAgB,SAAUgB,GACtB,IACIwD,EAAerD,IAAEH,GAASS,QAAQ,SAMtC,OALI+C,EAAahD,OAAS,EACNgD,EAAa,GAEb,MAOxBe,SAAU,SAAUvE,GAChB,IAAIE,EAAMC,IAAEH,GACZ,GAAyB,OAArBA,EAAQkB,UAA0C,SAArBhB,EAAIpD,KAAK,QAAoB,CAC1D,IAAIwP,EAAYpM,EAAIxF,KAAK,KAAK,QACL,IAAd4R,GACP1M,cAAiB,QAAS0M,GAGlC,OAAOtM,GAEXV,gBAAiB,SAAUU,GACvB,IAAIC,EACAwD,EAAStD,IAAEH,GAAS0D,SAAS,kBACjC,GAAID,EAAOjD,OAAS,EAChBiD,EAAOE,YAAY,cACnB1D,EAAWwD,EAAO,OACf,CACH,IAAIG,EAAQzD,IAAEH,GAAS0D,SAAS,6BAE5BzD,EADA2D,EAAMpD,OAAS,EACJoD,EAAM,GAEN5D,EAGnB,OAAOC,GAEXV,iBAAkB,SAAUS,KAE5BZ,QAAS,SAAUY,GACf,IAAIC,EAAWD,EACXuM,EAAQpM,IAAEH,GAASS,QAAQ,SAC/B,GAAI8L,EAAMrT,SAAS,cAAe,CAC9B,IAAIsT,EAAYrM,IAAEH,GAAS2B,KAAK,MAChC,GAAyB,IAArB6K,EAAUhM,OACV,GAAqC,SAAjC+L,EAAMzP,KAAK,kBAA8B,CACzC,IAAIsJ,EAASmG,EAAM7I,SAAS,MACxB0C,EAAO5F,OAAS,IAChBP,EAAWmG,EAAOA,EAAO5F,OAAS,SAGtCP,EAAWsM,EAAM7R,KAAK,MAAM+G,OAAO,QAGvCxB,EAAWuM,EAAU,GAG7B,OAAOvM,GAEXZ,SAAU,SAAUW,GAChB,IAAIC,EAAWD,EACXuM,EAAQpM,IAAEH,GAASS,QAAQ,SAC/B,GAAI8L,EAAMrT,SAAS,cAAe,CAC9B,IAAIsT,EAAYrM,IAAEH,GAAS8B,KAAK,MAChC,GAAyB,IAArB0K,EAAUhM,OACV,GAAqC,SAAjC+L,EAAMzP,KAAK,kBAA8B,CACzC,IAAIsJ,EAASmG,EAAM7I,SAAS,MACxB0C,EAAO5F,OAAS,IAChBP,EAAWmG,EAAO,SAGtBnG,EAAWsM,EAAM7R,KAAK,MAAM6G,QAAQ,QAGxCtB,EAAWuM,EAAU,GAG7B,OAAOvM,GAEXT,MAAO,SAAUQ,GACb,IAAIC,EAAWD,EACXuM,EAAQpM,IAAEH,GAASS,QAAQ,SAC/B,IAAK8L,EAAMrT,SAAS,cAAe,CAC/B,IAAIsT,EAAYrM,IAAEH,GAAS2B,KAAK,MAChC,GAAyB,IAArB6K,EAAUhM,QACV,GAAoC,QAAhC+L,EAAMzP,KAAK,kBAA6B,CACxC,IAAIsJ,EAASmG,EAAM7I,SAAS,MACxB0C,EAAO5F,OAAS,IAChBP,EAAWmG,EAAOA,EAAO5F,OAAS,UAI1CP,EAAWuM,EAAU,GAG7B,OAAOvM,GAEXR,QAAS,SAAUO,GACf,IAAIC,EAAWD,EACXuM,EAAQpM,IAAEH,GAASS,QAAQ,SAC/B,IAAK8L,EAAMrT,SAAS,cAAe,CAC/B,IAAIsT,EAAYrM,IAAEH,GAAS8B,KAAK,MAChC,GAAyB,IAArB0K,EAAUhM,QACV,GAAoC,QAAhC+L,EAAMzP,KAAK,kBAA6B,CACxC,IAAIsJ,EAASmG,EAAM7I,SAAS,MACxB0C,EAAO5F,OAAS,IAChBP,EAAWmG,EAAO,UAI1BnG,EAAWuM,EAAU,GAG7B,OAAOvM,KAGfE,WAASkM,EAAiB7N,UAAW,CACjCqB,QAAS,OACTC,aAAc,CACV,KACA,QAIR,QAD0B,IAAIuM,G,uGCtQxBtK,EAASzD,aAAa,UAEtB0D,EAAwB,aAG9B/I,WAAc+I,EAAsBxD,UAAW,CAG3CG,SAAU,WAIN3E,KAAK4E,SAAW,CACZ,SAAY,CAAC5E,KAAMA,KAAK+E,UAAW,OAEvCa,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAK7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,KAAK4E,WAKhDG,UAAW,SAAUiB,GACjB,IAOIkC,EAPEhC,EAAMjH,IAAO+G,GACbyM,EAAyB7M,qBAAwBM,EAAIpD,KAAK4P,MAChE,OAAKD,GAMDvM,EAAIyB,OAAOvB,GAAGqM,GACdvK,EAAwBtC,6BAAgC6M,GACjDvM,EAAI4B,OAAO1B,GAAGqM,KACrBvK,EAAwBtC,4BAA+B6M,IAGtDvK,IACDH,EAAOE,MAAM,uDACNjC,KAbP+B,EAAOE,MAAM,6DACNjC,MAqBnB/G,WAAc+I,EAAsBxD,UAAW,CAG3CqB,QAAS,YASTC,aAAc,KAGlB,QAD+B,IAAIkC,G,2ECnE/BwJ,EAAczJ,aAAgB,qBAI9BK,EAAU,EACVuK,EAAoB,WACpBvK,IACApI,KAAKsI,OAASF,GAElBjC,WAASwM,EAAkBnO,UAAW,CAClCC,MAAO,SAAUC,GAEb,OADA8M,EAAYjJ,MAAM,0BAA4B7D,EAAW,OAClD1E,MAEX2E,SAAU,WACN3E,KAAK4E,SAAW,CACZ,SAAY,CACR5E,KACAA,KAAKwI,UACL,MAEJ,YAAe,CACXxI,KACAA,KAAKyI,aACL,MAEJ,KAAQ,CACJzI,KACAA,KAAKyF,QACL,MAEJ,SAAY,CACRzF,KACAA,KAAK+E,UACL,MAEJ,cAAiB,CACb/E,KACAA,KAAKgF,eACL,MAEJ,SAAW,EACX,aAAe,EACf,KAAQ,CACJhF,KACAA,KAAKoF,QACL,MAEJ,UAAa,CACTQ,IACAA,oBAEJ,MAAS,CACL5F,KACAA,KAAKqF,SACL,MAEJ,GAAM,CACFrF,KACAA,KAAKwF,MACL,MAEJ,aAAgB,CACZI,IACAA,sBACA,CACI,SAAY,EACZ,cAAiB,KACjB,YAAc,IAGtB,cAAiB,CACbA,IACAA,uBACA,CAAE,YAAc,KAGxBA,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAE7DC,WAAY,WACRH,sBAAyB5F,KAAK6F,QAAS7F,KAAK4E,WAEhD4D,UAAW,SAAUE,GACjB1I,KAAKyI,aAAaC,IAEtBD,aAAc,SAAUC,GACpB,IAAIkK,EAASzM,IAAEuC,GACfkK,EAAO9P,KAAK,OAAQ,eACpB,IAAI+P,EAAQD,EAAO9P,KAAK,cACpBgQ,EAAaF,EAAO9P,KAAK,mBACzBsJ,EAASwG,EAAOlS,KAAK,SACrBkF,oBAAuBiN,IAAUjN,oBAAuBkN,KACzC1G,EAAO1L,KAAK,KACd8F,SAAW4F,EAAO5F,OAC3BoM,EAAO9P,KAAK,aAAc,YAAcsJ,EAAO5F,OAAS,WAExDoM,EAAO9P,KAAK,aAAc,YAAcsJ,EAAO5F,OAAS,YAiBhE,OAdAL,SAAOiG,GAAQ,SAAUuC,EAAOpC,GAC5B,IAAIC,EAAQrG,IAAEoG,GAEd,GADiBC,EAAM9L,KAAK,KACb8F,OAAS,EAAG,CACvBgG,EAAM1J,KAAK,OAAQ,QACnB,IAAIiQ,EAAYvG,EAAM1J,KAAK,cACvBkQ,EAAiBxG,EAAM1J,KAAK,mBAChC,GAAI8C,oBAAuBmN,IAAcnN,oBAAuBoN,GAE5DD,EADevG,EAAMpB,OAErBoB,EAAM1J,KAAK,aAAciQ,OAI9B,MAEXpB,cAAe,SAAUjJ,GACrB,IACIkJ,EADQzL,IAAEuC,GAAIjC,QAAQ,SACR/F,KAAK,aACvB,QAAc4Q,IAAVM,EACA,OAAOzL,IAAEyL,EAAM,KAGvBqB,oBAAqB,SAAUjN,GAC3B,IACIkN,EADAC,EAAchN,IAAEH,GAASS,QAAQ,qBAErC,QAAoB6K,IAAhB6B,EAAJ,CAGA,OAAQA,EAAYxG,KAAK,aACzB,IAAK,QACDuG,EAAcC,EAAYrJ,SAASJ,SAAS,SAC5C,MACJ,IAAK,QACDwJ,EAAcC,EAAYrJ,SAASJ,SAAS,SAMhD,YAAoB4H,IAAhB4B,GAA6BA,EAAY1M,OAAS,EAC3C0M,EAAY,QADvB,IAKJE,gBAAiB,SAAUpN,GACvB,IACIqN,EADAF,EAAchN,IAAEH,GAASS,QAAQ,qBAErC,QAAoB6K,IAAhB6B,EAAJ,CAGA,OAAQA,EAAYxG,KAAK,aACzB,IAAK,QACD0G,EAAcF,EAAYrJ,SAASJ,SAAS,SAC5C,MACJ,IAAK,QACD2J,EAAcF,EAAYrJ,SAASJ,SAAS,SAMhD,YAAoB4H,IAAhB+B,GAA6BA,EAAY7M,OAAS,EAC3C6M,EAAY,QADvB,IAKJrO,eAAgB,SAAUgB,GACtB,IACIsN,EAAgBnN,IAAEH,GAASS,QAAQ,SAMvC,OALI6M,EAAc9M,OAAS,EACP8M,EAAc,GAEd,MAIxBvO,UAAW,SAAUiB,GACjB,IAAIC,EACJ,OAAQE,IAAEH,GAAS2G,KAAK,aACxB,IAAK,KACL,IAAK,KACD1G,EAAWD,EACX,MACJ,IAAK,UAEgBsL,KADjBrL,EAAWL,sBAAyBI,EAAS,oBAAqB,KAAM,UAGnDsL,KADjBrL,EAAWL,sBAAyBI,EAAS,QAAS,KAAM,UAGvCsL,KADjBrL,EAAWE,IAAEH,GAAS2B,KAAK,SAEvB1B,EAAWjG,KAAK+E,UAAUoB,IAAEH,GAAS8D,WAIjD,MACJ,IAAK,QACL,IAAK,QACL,IAAK,QAED,QAAiBwH,KADjBrL,EAAWL,sBAAyBI,EAAS,oBAAqB,KAAM,UAGnDsL,KADjBrL,EAAWL,sBAAyBI,EAAS,QAAS,KAAM,IAChC,CACxB,IAAIqN,EAAcrT,KAAKoT,gBAAgBpN,GAEnCC,OADgBqL,IAAhB+B,EACWrT,KAAK+E,UAAUoB,IAAEH,GAASS,QAAQ,UAElCzG,KAAK+E,UAAUsO,GAItC,MACJ,IAAK,WACL,IAAK,MAGL,IAAK,UACDpN,EAAWjG,KAAK+E,UAAUoB,IAAEH,GAASS,QAAQ,UAC7C,MACJ,IAAK,aAEgB6K,KADjBrL,EAAWL,sBAAyBI,EAAS,oBAAqB,KAAM,UAGnDsL,KADjBrL,EAAWL,sBAAyBI,EAAS,QAAS,KAAM,MAExDC,EAAWD,GAGnB,MACJ,QACIC,EAAWjG,KAAK+E,UAAUoB,IAAEH,GAASS,QAAQ,gBAEjD,OAAOR,GAEXd,cAAe,SAAUa,GACrB,IAAIuN,EAAgBvN,GACQ,IAAxBG,IAAEH,GAASI,GAAG,QACdmN,EAAgBvT,KAAKuJ,aAAapD,IAAEH,IACpCJ,gBAAmB2N,GAAe,IAEtCpN,SAAOnG,KAAM4F,oBAAwB2N,IAEzCnO,QAAS,SAAUY,GACf,IAAI+L,EAAO/R,KAAK2R,cAAc3L,GAC1BgM,EAAQ7L,KAAE,GAId,OAHI4L,EAAK3L,GAAG,QACR4L,EAAQD,EAAKpK,KAAK,OAED,IAAjBqK,EAAMxL,OACCwL,EAEJhM,GAEXX,SAAU,SAAUW,GAChB,IAAI+L,EAAO/R,KAAK2R,cAAc3L,GAC1BgM,EAAQ7L,KAAE,GAId,OAHI4L,EAAK3L,GAAG,QACR4L,EAAQD,EAAKjK,KAAK,OAED,IAAjBkK,EAAMxL,OACCwL,EAEJhM,GAEXR,MAAO,SAAUQ,GACb,IACIiM,EADAF,EAAO/R,KAAK2R,cAAc3L,GAE1BkM,EAAS/L,KAAE,GACX6L,EAAQ7L,KAAE,GACd,GAAI4L,EAAK3L,GAAG,QAEW,KADnB6L,EAAMF,EAAKtL,QAAQ,OACXD,SACJ0L,EAASD,EAAItK,KAAK,OAED,GAAjBuK,EAAO1L,QAAa,CACpB,IAAI2L,EAAOJ,EACPK,GAAO,EACX,GACIA,IACAD,EAAOhM,IAAEgM,EAAKxK,KAAK,MAAM,UACpBwK,EAAK3L,OAAS,GAEvB,IADAwL,EAAQ7L,IAAE+L,EAAOxR,KAAK,MAAM,IACrB0R,EAAM,IACTD,EAAOH,EAAMlK,KAAK,OACTtB,OAAS,IACdwL,EAAQ7L,IAAEgM,EAAK,KAEnBC,IAIZ,OAAqB,IAAjBJ,EAAMxL,OACCwL,EAEJhM,GAEXP,QAAS,SAAUO,GACf,IACIiM,EADAF,EAAO/R,KAAK2R,cAAc3L,GAE1BkM,EAAS/L,KAAE,GACX6L,EAAQ7L,KAAE,GACd,GAAI4L,EAAK3L,GAAG,SACR6L,EAAMF,EAAKtL,QAAQ,OACXD,OAAS,IACb0L,EAASD,EAAInK,KAAK,OAElBoK,EAAO1L,OAAS,GAAG,CACnB,IAAI2L,EAAOJ,EACPK,GAAO,EACX,GACIA,IACAD,EAAOhM,IAAEgM,EAAKxK,KAAK,MAAM,UACpBwK,EAAK3L,OAAS,GAEvB,IADAwL,EAAQ7L,IAAE+L,EAAOxR,KAAK,MAAM,IACrB0R,EAAM,IACTD,EAAOH,EAAMlK,KAAK,OACTtB,OAAS,IACdwL,EAAQ7L,IAAEgM,EAAK,KAEnBC,IAIZ,OAAqB,IAAjBJ,EAAMxL,OACCwL,EAEJhM,KAGfG,WAASwM,EAAkBnO,UAAW,CAClCqB,QAAS,QACTC,aAAc,CAAC,WAEQ,IAAI6M,G,4FC1U3BnB,EAAczJ,aAAgB,4BAG9BK,EAAU,EAEVoL,EAA2B,WAC3BpL,IACApI,KAAKsI,OAASF,GAGlBjC,WAASqN,EAAyBhP,UAAW,CACzCC,MAAO,SAAeC,GAElB,OADA8M,EAAYjJ,MAAM,iCAAmC7D,EAAW,OACzD1E,MAEX2E,SAAU,WACN3E,KAAK4E,SAAW,CACZ,SAAY,CAAC5E,KAAMA,KAAKwI,UAAW,MACnC,YAAe,CAACxI,KAAMA,KAAKyI,aAAc,MACzC,MAAS,CAACzI,KAAMA,KAAKqF,SAAU,MAC/B,KAAQ,CAACrF,KAAMA,KAAKoF,QAAS,MAC7B,GAAM,CAACpF,KAAMA,KAAKwF,MAAO,MACzB,KAAQ,CAACxF,KAAMA,KAAKyF,QAAS,MAC7B,KAAQ,CAACzF,KAAMA,KAAK0F,QAAS,MAC7B,IAAO,CAAC1F,KAAMA,KAAK2F,OAAQ,MAC3B,OAAU,CAAC3F,KAAMA,KAAKyT,iBAAkB,MACxC,MAAS,CAACzT,KAAMA,KAAKyT,iBAAkB,MACvC,KAAQ,CAACzT,KAAMA,KAAK8E,QAAS,MAC7B,SAAY,CAAC9E,KAAMA,KAAK+E,UAAW,MACnC,cAAiB,CAAC/E,KAAMA,KAAKgF,eAAgB,MAC7C,MAAS,CAAChF,KAAMA,KAAKuK,SAAU,MAC/B,SAAW,EACX,aAAe,GAEnB3E,oBAAuB5F,KAAK6F,QAAS7F,KAAK4E,SAAU5E,KAAK8F,eAE7DC,WAAY,WACRH,sBAAyB,QAAS5F,KAAK4E,WAE3C4D,UAAW,SAAmBE,GAC1B1I,KAAKyI,aAAaC,IAEtBD,aAAc,WACV,OAAO,MAEX1D,UAAW,SAAmBiB,GAC1B,IAAIE,EAAMC,IAAEH,GAMZ,OAJIE,EAAIE,GAAG,QACPJ,EAAUE,EAAIxF,KAAK,MAAMgT,GAAG,GAAG,IAG5B1N,GAEXhB,eAAgB,SAAwBgB,GACpC,IACIwD,EAAerD,IAAEH,GAAS2N,QAAQ,MAAMlM,OAO5C,OALI+B,EAAahD,OAAS,EACNgD,EAAa,GAEb,MAIxBe,SAAU,SAAkBvE,GACxB,IAAME,EAAMC,IAAEH,GACR4N,EAAkB1N,EAAIO,QAAQ,UAAUD,OAAS,EACjDqN,EAAoC,OAAzB3N,EAAIyG,KAAK,aAA6C,YAArBzG,EAAIpD,KAAK,QACb,OAAzBoD,EAAIyG,KAAK,aAA6C,aAArBzG,EAAIpD,KAAK,QAG3D8C,eAAkBM,GACT0N,GAAmBC,GAC5BjO,eAAkBM,EAAIyN,QAAQ,MAAMlM,SAG5CqM,2BAA4B,SAAoC9N,EAAS+N,EAAcC,GACnF,IAAMC,EAAe9N,IAAEH,GAASS,QAAQ,aAExC,MAAsC,OAAlCwN,EAAatH,KAAK,YACXoH,IACkC,WAAlCE,EAAatH,KAAK,YAClBqH,IAEJ,MAEX5O,QAAS,SAAiBY,GACtB,IAAqBkO,EAAaC,EAC5BC,EAAoBjO,IAAEH,GAASS,QAAQ,MAAM/F,KAAK,kBAExD,OAAI0T,EAAkB7M,QAAQrI,SAAS,YAC5BkV,EAAkB3M,QAG7ByM,EADkB/N,IAAE,aAAawI,MAAMxI,IAAE,oBACT,EAChCgO,EAAoBhO,IAAE,aAAauN,GAAGQ,GAC/BA,GAAe,GAAKC,EAAkB,KAEjD9O,SAAU,SAAkBW,GAiBxB,OAAOhG,KAAK8T,2BAA2B9N,GAhBlB,WAEjB,OAD0BG,IAAEH,GAASS,QAAQ,MAAM/F,KAAK,kBAC/B6G,WAEN,WACnB,IAAqB2M,EAAaC,EAC5BC,EAAoBjO,IAAEH,GAASS,QAAQ,MAAM/F,KAAK,kBAExD,OAAI0T,EAAkB3M,OAAOvI,SAAS,YAC3BkV,EAAkB7M,SAG7B2M,EADkB/N,IAAE,aAAawI,MAAMxI,IAAE,oBACT,GAChCgO,EAAoBhO,IAAE,aAAauN,GAAGQ,IACb1N,QAAU2N,EAAkB,QAI7D3O,MAAO,SAAeQ,GAqBlB,OAAOhG,KAAK8T,2BAA2B9N,GApBlB,WACjB,IAAMqO,EAAYlO,IAAEH,GAASS,QAAQ,MAC/B6N,EAASD,EAAUvK,SAASJ,SAAS,MACrC6K,EAAeF,EAAU1M,OAE/B,OAAI2M,EAAO9N,QAAU,EACV,KAEJ+N,EAAa/N,OAAS+N,EAAeD,EAAO7M,UAEhC,WACnB,IAAM+M,EAAkBrO,IAAEH,GAASS,QAAQ,MAAMqD,SAC3C2K,EAAeD,EAAgB1K,SAASJ,SAAS,MACjD6K,EAAeC,EAAgB7M,OAErC,OAAI8M,EAAajO,QAAU,EAChB,KAEJ+N,EAAa/N,OAAS+N,EAAeE,EAAahN,WAIjEhC,QAAS,SAAiBO,GAqBtB,OAAOhG,KAAK8T,2BAA2B9N,GApBlB,WACjB,IAAMqO,EAAYlO,IAAEH,GAASS,QAAQ,MAC/B6N,EAASD,EAAUvK,SAASJ,SAAS,MACrCgL,EAAWL,EAAUvM,OAE3B,OAAIwM,EAAO9N,QAAU,EACV,KAEJkO,EAASlO,OAASkO,EAAWJ,EAAO/M,WAExB,WACnB,IAAMiN,EAAkBrO,IAAEH,GAASS,QAAQ,MAAMqD,SAC3C2K,EAAeD,EAAgB1K,SAASJ,SAAS,MACjDgL,EAAWF,EAAgB1M,OAEjC,OAAI2M,EAAajO,QAAU,EAChB,KAEJkO,EAASlO,OAASkO,EAAWD,EAAalN,YAIzD7B,QAAS,SAAiBM,GAStB,OAAOhG,KAAK8T,2BAA2B9N,GARlB,WAEjB,OADeG,IAAEH,GAASS,QAAQ,MAAMqD,SAASJ,SAAS,MAC5CnC,WAEK,WAEnB,OAD0BpB,IAAEH,GAASS,QAAQ,MAAM/F,KAAK,kBAC/B6G,YAIjC5B,OAAQ,SAAgBK,GASpB,OAAOhG,KAAK8T,2BAA2B9N,GARlB,WAEjB,OADeG,IAAEH,GAASS,QAAQ,MAAMqD,SAASJ,SAAS,MAC5CjC,UAEK,WAEnB,OAD0BtB,IAAEH,GAASS,QAAQ,MAAM/F,KAAK,kBAC/B+G,WAIjCgM,iBAAkB,SAA0BzN,GACxC,IAAME,EAAMC,IAAEH,GACd,MAA6B,OAAzBE,EAAIyG,KAAK,aAA6C,aAArBzG,EAAIpD,KAAK,QACnCoD,EAAIxF,KAAK,kBAAkB6G,QAE/B,MAEXzC,QAAS,SAAiBkB,GACtB,IAAME,EAAMC,IAAEH,GACd,MAA6B,WAAzBE,EAAIyG,KAAK,YACFzG,EAAIO,QAAQ,MAAMqD,SAEtB,QAGf3D,WAASqN,EAAyBhP,UAAW,CACzCqB,QAAS,eACTC,aAAc,CAAC,KAAM,YAIzB,QAD+B,IAAI0N,G,4BCxO5B,IAAK1M,E,0BAAAA,K,yCAAAA,E,qBAAAA,E,iCAAAA,E,iBAAAA,E,uBAAAA,E,yBAAAA,E,+BAAAA,E,yBAAAA,E,6BAAAA,E,yBAAAA,E,qBAAAA,E,uBAAAA,E,yBAAAA,E,qBAAAA,E,uBAAAA,E,mBAAAA,E,6BAAAA,E,mBAAAA,E,iBAAAA,E,2BAAAA,E,uCAAAA,E,+BAAAA,E,iBAAAA,E,yBAAAA,E,uBAAAA,E,yBAAAA,E,yBAAAA,E,yBAAAA,E,yBAAAA,E,uBAAAA,E,iBAAAA,E,yBAAAA,E,yBAAAA,E,yBAAAA,E,4BAAAA,M,uFCuBZ,SACI6N,kBAAmB,CACfC,SAAS,EACTC,YAAY,EACZC,KAAMtH,SAASuH,YACfC,OAAQ,EACRC,QAAS,EACTC,QAAS,EACTC,QAAS,EACTC,QAAS,EACTC,SAAS,EACTC,QAAQ,EACRC,UAAU,EACVC,SAAS,EACTpS,OAAQ,EACRqS,cAAe,KACfC,WAAY,MAEhBC,mBAAoB,SAAUC,EAAWC,EAAQ9V,GAC7C,IAAkC+V,EAA9BC,EAAKC,WAET,GADAH,EAASA,IAAWE,EAAKvI,SAASyI,gBAAkBC,QAChD1I,SAAS2I,YAAa,CACtB,IAAInG,EACJ,OAAQ4F,GACR,IAAK,QACL,IAAK,cACL,IAAK,YACL,IAAK,YACL,IAAK,WACL,IAAK,YACL,IAAK,WACD5F,EAAO7J,WAAS,GAAInG,KAAK2U,kBAAmB5U,IACvC2V,WAAaG,EACQ,mBAAfO,WACPN,EAAK,IAAIM,WAAWR,EAAW5F,IAE/B8F,EAAKtI,SAAS2I,YAAY,gBACvBE,eAAeT,EAAW5F,EAAK4E,QAAS5E,EAAK6E,WAAY7E,EAAK8E,KAAM9E,EAAKgF,OAAQhF,EAAKiF,QAASjF,EAAKkF,QAASlF,EAAKmF,QAASnF,EAAKoF,QAASpF,EAAKqF,QAASrF,EAAKsF,OAAQtF,EAAKuF,SAAUvF,EAAKwF,QAASxF,EAAK5M,OAAQ4M,EAAKyF,eAE1N,MACJ,SACIzF,EAAO7J,WAAS,GAAInG,KAAKsW,aAAcvW,IAClC2V,WAAaG,GAClBC,EAAKtI,SAAS2I,YAAY,eACvBI,UAAUX,EAAW5F,EAAKwG,OAAQxG,EAAK6E,YAE9CgB,EAAOY,cAAcX,QAErBA,EAAKtI,SAASkJ,qBACXhB,WAAaG,EACC,SAAbD,QAAgD,IAAjBC,EAAOxL,MACtCwL,EAAOxL,QAEPwL,EAAOc,UAAU,KAAOf,EAAWE,IAI/Cc,sBAAuB,SAAU5Q,GAC7BhG,KAAK2V,mBAAmB,YAAa3P,GACrChG,KAAK2V,mBAAmB,UAAW3P,GACnChG,KAAK2V,mBAAmB,QAAS3P,IAErC6Q,4BAA6B,SAAU7Q,GACnChG,KAAK2V,mBAAmB,YAAa3P,GACrChG,KAAK2V,mBAAmB,UAAW3P,GACnChG,KAAK2V,mBAAmB,QAAS3P,GACjChG,KAAK2V,mBAAmB,YAAa3P,GACrChG,KAAK2V,mBAAmB,UAAW3P,GACnChG,KAAK2V,mBAAmB,QAAS3P,GACjChG,KAAK2V,mBAAmB,WAAY3P,M,6HCxDxC8Q,G,SAAqB,CACjBC,SAAU,EACVC,WAAY,EACZC,WAAY,EACZC,YAAY,EACZC,aAAa,EACbC,YAAY,EACZC,iBAAiB,EACjBpH,kBAAmB,KACnBqH,gBAAgB,IAEpBC,EAAgB,CACZL,YAAW,EACXI,gBAAe,GAGnBhT,EAAMyD,aAAgB,qBAE1B5B,mBAAmB,SAAUqR,GAEzBlT,EAAI2E,KAAKuO,IAGb,QAAeC,gBAAqB,CAehCC,YAAa,SAAU3X,GACnBC,KAAK2X,cAAgB7T,UAAQ/D,GAEzBC,KAAK2X,cAAcC,eAAe,gBAAkB9T,aAAW9D,KAAK2X,cAAcE,oBAC3E7X,KAAK2X,cAAcE,WAE1B7X,KAAK2X,cAAcC,eAAe,gBAAkB9T,aAAW9D,KAAK2X,cAAcG,oBAC3E9X,KAAK2X,cAAcG,WAG9B9X,KAAK+X,SAAW/X,KAAK2X,cAAcjP,KAAM,EACzC1I,KAAKgY,WAAahY,KAAK2X,cAAcK,aAAc,SAE5ChY,KAAK2X,cAAcjP,UACnB1I,KAAK2X,cAAcK,WAE1BhY,KAAKiY,WAAaC,EAAmBlY,KAAK2X,eAE1C3X,KAAK2X,cAAgBQ,EAA4BnY,KAAK2X,cAAe3X,KAAKiY,YAE1EjY,KAAK2X,cAAgBS,EAA2BpY,KAAK2X,cAAe3X,KAAKgY,YAEzEhY,KAAKsE,IAAMvE,EAAQuE,IAAMvE,EAAQuE,IAAMA,EAEvCmT,eAAoBzX,KAAM0P,YAG9B9Q,WAAY,WACR,IAAIyZ,EAAOrY,KAGXA,KAAKkG,IAAIlG,KAAKiY,YAAYjY,KAAK2X,eAE/B3X,KAAKsY,kBAAoB,SAAUvY,GAC/BsY,EAAKnS,IAAImS,EAAKJ,YAAYlY,KASlCwY,QAAS,WAQL,MALwB,eAApBvY,KAAKiY,WACEjY,KAAKkG,IAAIlG,KAAKiY,YAAYM,UAE1BvY,KAAKkG,IAAIlG,KAAKiY,YAAYO,WAUzCC,QAAS,SAASvU,GAEd,IAAKA,EAAM,OAAOlE,KAElB,IAGQ8D,aAAWI,KACa,mBAApBlE,KAAKiY,WACL/T,EAAOiC,6BAA2BnG,KAAK2X,cAAcE,WAAY7X,KAAK2X,cAAcG,WAAa5T,GACtE,eAApBlE,KAAKiY,aACZ/T,EAAOiC,yBAAuBnG,KAAK2X,cAAcE,WAAY3T,KAI7C,eAApBlE,KAAKiY,WACLjY,KAAKkG,IAAIlG,KAAKiY,YAAY,UAAW/T,GACX,eAApBlE,KAAKiY,WACXjY,KAAKkG,IAAIlG,KAAKiY,YAAY,UAAW/T,GACX,mBAApBlE,KAAKiY,aACXjY,KAAKkG,IAAIlG,KAAKiY,YAAY,UAAW/T,GACrClE,KAAKkG,IAAIlG,KAAKiY,YAAY,UAAW/T,IAG5C,MAAMsT,GACHxX,KAAKsE,IAAIiE,MAAMiP,GAEnB,OAAOxX,MAOXjB,KAAM,WAEF,OADAiB,KAAKsY,kBAAkB,QAChBtY,MAOXoN,KAAM,WAEF,OADApN,KAAKsY,kBAAkB,QAChBtY,MAGX0Y,OAAQ,WACJ1Y,KAAKsY,kBAAkB,WACnBtY,KAAK+X,QACL/X,KAAKkG,IAAIyS,QAAQC,MACjB5Y,KAAK6Y,iBAELpB,gCAAqCzX,KAAM0P,aAKpD,CAOCoJ,YAAc,SAASC,GACnB5S,wBAAsB4S,EAAQnV,QAAUmV,EAAQ7U,KAChDiC,2BAAyB4S,EAAQ7U,MACjCiC,2BAAyB4S,EAAQ3U,OAGrC4U,QAAU,CAENZ,2BAA4BA,EAE5Ba,kCAAmCA,EAEnCC,oBAAqBA,EAErBhB,mBAAoBA,EAEpBC,4BAA6BA,KAIrC,SAASD,EAAmBnY,GACxB,IAAIyP,EAAS,iBACb,OAAIzP,EAAQ8X,YAAc9X,EAAQ+X,aAEvB/X,EAAQ8X,WACfrI,EAAS,aACFzP,EAAQ+X,aACftI,EAAS,eAJFA,EASf,SAAS2I,EAA4BpY,EAASoZ,GAE1C,IAAI3J,EAASzP,EAQb,MANI,kBAAoBoZ,GAAQ,cAAgBA,EAC5C3J,EAAS1L,aAAW/D,EAAS+W,GACxB,cAAgBqC,IACrB3J,EAAS1L,aAAW/D,EAASwX,IAG1B/H,EAGX,SAAS4I,EAA2BrY,EAASiY,GAEzC,IAAIoB,EAAuBrZ,EAAQsZ,WAYnC,OAVAtZ,EAAQsZ,WAAa,WACjBH,EAAoBzJ,MAAMzP,KAAM0P,WAChCsI,GAAciB,EAAkCxJ,MAAMzP,KAAM0P,WAC5D0J,GAAwBA,EAAqB3J,MAAMzP,KAAM0P,YAG7D3P,EAAQuZ,YAAc,WAClBJ,EAAoBzJ,MAAMzP,KAAM,CAACA,KAAKiO,OAAO,GAAIjO,KAAKuZ,QAGnDxZ,EAGX,SAASkZ,EAAkCO,EAAOD,GAC9C,IAAIE,EAAStT,IAAEqT,GAAOC,SAASC,KAC3B/X,EAAQgY,WAAWJ,EAAK5J,MAAMiK,IAAI,SAAS5V,QAAQ,KAAM,KACzD6V,EAAOJ,EAASD,EAAMM,YAAcnY,EAAQwE,IAAE+P,QAAQvU,QAC1D4X,EAAK5J,MAAMiK,IAAI,CACXG,WAAYF,EAAOL,EAAMM,YAAc,KAAO,IAItD,SAASZ,EAAoBM,EAAOD,GAChC,IAEIS,EAFAC,EAAkBV,EAAK5J,MACvBuK,EAAUD,EAAgBnQ,SAG1BoQ,GAAWA,EAAQ9T,GAAG,UACtB4T,EAASC,EAAgBE,UACzBF,EAAkB9T,ICrR1B,yGDsRwBiU,OAAOJ,GACvB7T,IAAE,QAAQiU,OAAOH,M,6DErRjB,qBAAoC,sBAAqC,GACzE,QAAe,IAAiC","file":"_chunks/chunk.4268.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @author: Yuriy Plakosh\n * @version: $Id$\n */\nimport jQuery from 'jquery';\nimport dialogs from './components.dialogs';\n\nvar about = {\n    /**\n     * Initialize about module.\n     */\n    initialize: function () {\n        about.aboutBox.registerListeners();\n    }\n};\n///////////////////////////\n// About box component\n///////////////////////////\nabout.aboutBox = {\n    /**\n     * Shows about box.\n     */\n    show: function () {\n        var dom = jQuery('#aboutBox');\n        if (dom.hasClass('hidden')) {\n            dialogs.popup.show(dom[0], true, {closable: true});\n        }\n    },\n    _hide: function () {\n        var dom = jQuery('#aboutBox');\n        if (!dom.hasClass('hidden')) {\n            dialogs.popup.hide(dom[0]);\n        }\n    },\n\n    registerListeners : function() {\n        var $about = jQuery(\"#about\"),\n            $aboutBoxCloseButton = jQuery(\"#aboutBox button\");\n\n        $about.on('click', function(e) {\n            e.preventDefault();\n            about.aboutBox.show();\n        });\n\n        $aboutBoxCloseButton.on('click', function(e) {\n            about.aboutBox._hide();\n            e.stopPropagation();\n        });\n\n    }\n};\n\nexport default about;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\n\nimport layoutModule from '../core/core.layout';\nimport {ajaxNonReturningUpdate, appendPostData} from \"../core/core.ajax\";\nimport {baseErrorHandler} from \"../core/core.ajax.utils\";\nimport dialogs from './components.dialogs';\nimport jQuery from 'jquery';\n\nvar heartbeat = {\n    init: false,\n    DOM_ID: \"heartbeatOptin\",\n    PERMIT_CHECKBOX_ID: \"heartbeatCheck\",\n\n    initialize: function(options) {\n        this._baseUrl = options.baseUrl;\n        this._showDialog = options.showDialog;\n        this._sendClientInfo = options.sendClientInfo;\n\n        this._dom = jQuery('#' + this.DOM_ID)[0];\n        if (!this._dom) {\n            return;\n        }\n        this._permit = jQuery('#' + this.PERMIT_CHECKBOX_ID)[0];\n        this._okButton = jQuery(this._dom).find(layoutModule.BUTTON_PATTERN)[0];\n\n        jQuery(this._okButton).on(\"click\", this._okHandler.bind(this));\n        this.init = true;\n    },\n\n    _okHandler: function() {\n        dialogs.popup.hide(this._dom);\n\n        var url = this._baseUrl +\"/heartbeat.html?permit=\" + this._permit.checked;\n\n        ajaxNonReturningUpdate(url, { errorHandler: baseErrorHandler });\n    },\n\n    start: function() {\n        if (this.init === false) {\n            return;\n        }\n\n        if (this._showDialog) {\n            dialogs.popup.show(this._dom);\n\n            this._okButton.focus();\n        }\n        if (this._sendClientInfo) {\n            this._doSendClientInfo();\n        }\n    },\n\n    _doSendClientInfo: function() {\n        try {\n            var params = {};\n            params[\"navAppName\"] = navigator.appName;\n            params[\"navAppVersion\"] = navigator.appVersion;\n            params[\"scrWidth\"] = screen.width;\n            params[\"scrHeight\"] = screen.height;\n            params[\"scrColorDepth\"] = screen.colorDepth;\n            var postData = appendPostData(\"\", params);\n\n            var url = this._baseUrl + \"/heartbeatInfo.html\";\n\n            ajaxNonReturningUpdate(url, {postData: postData});\n        } catch(e) {\n            // Ignore.\n        }\n    }\n};\n\nexport default heartbeat;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\n\nimport jQuery from 'jquery';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport buttonManager from '../core/core.events.bis';\n\n////////////////////////////////////////////////\n// Generic toolbar button utils\n////////////////////////////////////////////////\n\nvar toolbarButtonModule = {\n\n    UP : \"up\",\n    DOWN : \"down\",\n    OVER : \"over\",\n    DISABLED : \"disabled\",\n    PRESSED : \"pressed\",\n    CONTENT_PREFIX : \"toolbar_\", //action model\n    MenuClass : \"menu vertical dropDown\",\n    TOOLBAR_MENU_CLASS : \"menu vertical dropDown fitable\",\n    ACTION_MODEL_TAG : \"adhocActionModel\",\n    CAPSULE_PATTERN : \"capsule\",\n\n    /**\n     * Used by all toolbar components to show menu\n     * @param event\n     * @param object object we want the menu for\n     */\n    showButtonMenu : function(event, object){\n        object = jQuery(object);\n        var context = this.CONTENT_PREFIX + object.attr(\"id\"),\n            model = this.ACTION_MODEL_TAG == 'adhocActionModel' ? this.actionModel : this.ACTION_MODEL_TAG;\n\n        actionModel.showDropDownMenu(event, object, context, this.TOOLBAR_MENU_CLASS, model);\n    },\n\n    setActionModel: function(newActionModel){\n        this.actionModel = newActionModel;\n    },\n\n    /**\n     * Test to see if the button clicked is a toolbar type\n     * @param button\n     */\n    isToolBarButton : function(button){\n        if (button){\n            return (jQuery(button).hasClass(\"capsule\"));\n        } else{\n            return false;\n        }\n\n    },\n\n    /**\n     * Used to enable toolbar button\n     * @param button\n     * @param enable\n     */\n    enable : function(button, enable){\n        buttonManager.enable(button);\n    },\n\n    /**\n     * Used to disable toolbar button\n     * @param button\n     */\n    disable : function(button){\n        buttonManager.disable(button);\n    },\n\n    /**\n     * Used to enable or disable button based on adhoc state variables\n     * @param button\n     * @param enable\n     */\n    setButtonState : function(button, enable){\n        if(enable){\n            this.enable(button);\n        }else{\n            this.disable(button);\n        }\n    }\n};\n\nexport default toolbarButtonModule;\n\n\n\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport $ from 'jquery';\nimport _ from 'underscore';\n\nimport dateTimeSettings from '../settings/dateTimeSettings.settings';\nimport DateAndTimePicker from 'js-sdk/src/components/dateAndTime/DateAndTimePicker';\n\nfunction getLocale(userLocale, availableLocales) {\n    var postfix = 'en';\n    if (userLocale) {\n        if (_.contains(availableLocales, userLocale)) {\n            postfix = userLocale;\n        } else if (_.contains(availableLocales, userLocale.substring(0, 2))) {\n            postfix = userLocale.substring(0, 2);\n        }\n    }\n    return postfix.replace('_', '-');\n}\nvar locale = getLocale(jrsConfigs.userLocale, jrsConfigs.availableLocales);\nDateAndTimePicker.setDefaults({\n    locale: locale,\n    date: dateTimeSettings.datepicker,\n    time: dateTimeSettings.timepicker\n});\nexport default $;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n// This settings store will be filled with the actual settings loaded from the server\n\nexport default {};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @author: ${username}\n * @version: $Id$\n */\n\n/* Standard Navigation library (stdnav) plugin\n * Elements: LI, OL, UL\n * Navtype:  actionmenu\n *\n * Plugin for \"actionModel\"-based menus, such as the JRS main menu, which\n * handle mouse and touch events, but offer no keyboard support.  (Note\n * that \"actionModel\" itself is not used in a Backbone context yet, in\n * case its name suggests that to you; it's a coincidence.)\n *\n * This module supports enhancements intended to improve compliance with\n * section 508 of the Rehabilitation Act of 1973, 29 USC 798, as amended\n * 1998.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport stdnav from 'js-sdk/src/common/stdnav/stdnav';\nimport actionModel from '../../actionModel/actionModel.modelGenerator';\nimport buttonManager from '../../core/core.events.bis';\nimport layoutModule from '../../core/core.layout';\nimport log from 'js-sdk/src/common/logging/logger';\nimport {AriaProps} from \"js-sdk/src/common/util/accessibility/waiAriaConstants\";\n\nvar logger = log.register(\"stdnav\");\n\nconst MENU_TRAP_ELEMENT_TEMPLATE = '<div js-navtype=\"menuTrap\" class=\"offLeft\" tabindex=\"0\"></div>';\n\nvar stdnavPluginActionMenu = function () {\n};\n\n_.extend(stdnavPluginActionMenu.prototype, {\n    zinit: function (selector) {\n        return this;\n    },\n\n    // Registers the 'actionMenu' navtype with stdnav.  Both stdnav and ActionMenu\n    // must be loaded and activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'toggle': [this, this._onEnter, null],\n            'enter': [this, this._onEnter, null],\n            'exit': [this, this._onExit, null],\n            'fixfocus': [this, this._fixFocus, null],\n            'fixsubfocus': [this, this._fixFocus, null],\n            'fixsuperfocus': [this, this._fixSuperfocus, null],\n            'focusin': [this, this._onFocusIn, null],\n            'focusout': [this, this._onFocusOut, null],\n            'subfocusin': [this, this._onSubfocusIn, null],\n            'left': [this, this._onLeft, null],\n            'right': [this, this._onRight, null],\n            'superfocusin': [this, this._onSuperfocusIn, null],\n            'superfocusout': [this, this._onSuperfocusOut, null],\n            'up': [this, this._onUp, null],\n            'down': [this, this._onDown, null],\n            'home': [this, this._onHome, null],\n            'end': [this, this._onEnd, null],\n            'inherit': false,\n            'inheritable': true\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters the 'actionMenu' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this);\n    },\n\n    /* ====== Focus Management ====== */\n\n\n    // Focus adjustment callback.  Ensures that if the DIV or UL elements\n    // themselves are given focus, that it is promoted to the first LI.\n    _fixFocus: function (element) {\n        var newFocus;\n        var $el = $(element);\n        if ($el.is('#' + actionModel.PARENT_MENU_CONTAINER)) {\n            $(MENU_TRAP_ELEMENT_TEMPLATE).insertBefore($el);\n            $(MENU_TRAP_ELEMENT_TEMPLATE).insertAfter($el);\n        }\n        const pressedItem = $el.find(`.${layoutModule.PRESSED_CLASS} > p`);\n        if (pressedItem.length > 0) {\n            newFocus = pressedItem[0];\n        }else {\n            if ($el.is('div,ul,ol')) {\n                newFocus = $el.find('li > p')[0] ?? element;\n            } else if ($el.is('li')) {\n                // Focus is already appropriate.\n                newFocus = $el.find('> p')[0] ?? element;\n            } else {\n                newFocus = $el.closest('li').find('> p')[0] ??\n                    ($el.closest('ul').find('li > p')[0] ?? element);\n            }\n        }\n        return newFocus;\n    },\n\n    // Superfocus adjustment callback.  Because of the way actionModel\n    // works, the menu is expected to be rooted in an enclosing DIV that\n    // contains the list, so use the DIV for the superfocus region.\n    // However, context menus are _not_\n    _fixSuperfocus: function (element) {\n        return $(element).closest(`.context`)[0];\n    },\n\n    _onSuperfocusIn: function(element){\n    },\n\n    _onFocusIn: function (element) {\n        var $el = $(element);\n\n        var $li = $el.closest(layoutModule.MENU_LIST_PATTERN);\n        if ($li.length>0) {\n            this._openChildMenu($li[0], true);\n            //this._setAriaAttributes($li[0]);\n            buttonManager.over($li.find(layoutModule.BUTTON_PATTERN)[0]);\n        }\n\n        return element;\n    },\n\n    _setAriaAttributes: function (element) {\n        var $li = $(element);\n        var $p = $li.find('> p');\n\n        if ($li.hasClass(layoutModule.NODE_CLASS) && !$p.attr(AriaProps.HasPopup)) {\n            $p.attr(AriaProps.Expanded, 'false')\n                .attr(AriaProps.HasPopup, 'true')\n        }\n    },\n\n    _openChildMenu: function (element, open) {\n        var $li = $(element);\n        var $p = $li.find('> p');\n\n        if ($li.hasClass(layoutModule.NODE_CLASS)) {\n            this._setAriaAttributes(element);\n            const isMenuShowing = actionModel.isMenuShowing($li.find('.context')[0]);\n\n            if (open) {\n                $p.attr(AriaProps.Expanded, 'true')\n                !isMenuShowing && actionModel.showChildSubmenu(element);\n            } else {\n                isMenuShowing && actionModel.hideChildSubmenu(element);\n                $p.attr(AriaProps.Expanded, 'false');\n            }\n        }\n    },\n\n    _onFocusOut: function (element) {\n        var $thisItem = $(element).closest(layoutModule.MENU_LIST_PATTERN);\n        if ($thisItem.length>0) {\n            // An item in a drop-down or context menu has lost focus.\n            buttonManager.out($thisItem.find(layoutModule.BUTTON_PATTERN)[0]);\n        }\n        return null;\n    },\n\n    // When the entire menu loses superfocus, ensure that any remaining\n    // hover events and classes for actionMenu fire as expected, and that\n    // the context menu is hidden.\n    _onSuperfocusOut: function(element){\n\n    },\n\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n\n    _onSubfocusIn: function (element) {\n        // Handle menus hosted in non-focusable elements (such as a cell in a grid).\n        if (element.nodeName !== 'P') {\n            // Find a usable child element.\n            var subel = this._fixFocus(element);\n            // Adjust subfocus without firing callbacks.\n            stdnav.setSubfocus(subel, false);\n        }\n    },\n\n    _onEnter: function (element) {\n        return this._onRight(element);\n    },\n\n    _onExit: function (element) {\n        var $context = $(element).closest('.context');\n        if ($context.attr('id') === layoutModule.MENU_ID) {\n            actionModel.hideMenu();\n        } else {\n            return this._onLeft(element);\n        }\n    },\n\n    /* ========== KEYBOARD BEHAVIOR =========== */\n    _onLeft: function (element){\n        const $thisItem = $(element).closest(layoutModule.MENU_LIST_PATTERN);\n        const $parentMenu = $thisItem.closest('ul');\n        if (!$parentMenu.is(`#${actionModel.PARENT_MENU_CONTAINER}`)) {\n            const parentMenuItem = $parentMenu.closest('li');\n            stdnav.forceFocus(parentMenuItem.find('> p')[0]);\n            this._openChildMenu(parentMenuItem[0], false);\n        } else {\n            return element\n        }\n    },\n\n    _onRight: function (element) {\n        const $thisItem = $(element).closest(layoutModule.MENU_LIST_PATTERN);\n        const $subMenuItem = $thisItem.find('ul[role=menu] li').first();\n\n        if ($subMenuItem.length>0) {\n            this._openChildMenu($thisItem[0], true);\n            return $subMenuItem.find('> p')[0];\n        } else {\n            return element;\n        }\n    },\n\n    _onUp: function (element) {\n        var $el = $(element).closest(layoutModule.MENU_LIST_PATTERN);\n        var $lastItem = $el.closest('ul').find('> li').last();\n        var $prev = $el.prev('li');\n\n        while ($prev.is(layoutModule.SEPARATOR_PATTERN)){\n            $prev=$prev.prev('li');\n        }\n\n        if (!$prev[0]) {\n            $prev = $lastItem;\n        }\n\n        if ($prev.length>0){\n            this._openChildMenu($el[0], false);\n            stdnav.forceFocus($prev.find('> p')[0]);\n        } else {\n            return element;\n        }\n    },\n\n    _onDown: function (element) {\n        var $el = $(element).closest(layoutModule.MENU_LIST_PATTERN);\n        var $firstItem = $el.closest('ul').find('> li').first();\n        var $next = $el.next('li');\n\n        while ($next.is(layoutModule.SEPARATOR_PATTERN)){\n            $next=$next.next('li');\n        }\n\n        if (!$next[0]) {\n            $next = $firstItem;\n        }\n\n        if ($next.length>0){\n            this._openChildMenu($el[0], false);\n            stdnav.forceFocus($next.find('> p')[0]);\n        } else {\n            return element;\n        }\n    },\n\n    _onHome: function (element) {\n        var $el = $(element).closest(layoutModule.MENU_LIST_PATTERN);\n        var $firstItem = $el.closest('ul').find('> li').first();\n        this._openChildMenu($el[0], false);\n        stdnav.forceFocus($firstItem.find('> p')[0]);\n    },\n\n    _onEnd: function (element) {\n        var $el = $(element).closest(layoutModule.MENU_LIST_PATTERN);\n        var $lastItem = $el.closest('ul').find('> li').last();\n        this._openChildMenu($el[0], false);\n        stdnav.forceFocus($lastItem.find('> p')[0]);\n    }\n});\n\n// SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\n$.extend(stdnavPluginActionMenu.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'actionmenu',\n\n    // This arrray extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    //\n    // NOTE: The HTML5 \"menu\" element is still very broken.  In practice\n    // our menus are built with list items and use \"js-navtype\" overrides to\n    // this type.\n    //\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: []\n});\n\nexport default new stdnavPluginActionMenu();\n","/*\n * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport jQuery from 'jquery';\nimport log from \"js-sdk/src/common/logging/logger\";\nimport stdnav from 'js-sdk/src/common/stdnav/stdnav';\nimport actionModel from \"../../actionModel/actionModel.modelGenerator\";\n\nconst logger = log.register(\"stdnav\");\n\nconst stdnavPluginModalTrap = function () {\n};\n\njQuery.extend(stdnavPluginModalTrap.prototype, {\n    // Registers the 'button' navtype with stdnav.  stdnav must be loaded and\n    // activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with jQuery.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'fixfocus': [this, this._fixFocus, null]\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this.behavior);\n    },\n\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n\n    _fixFocus: function (element) {\n        if (!actionModel.lastFocused) {\n            logger.error('Menu Trap element exists while there is no parent focusable element for the menu');\n            return element;\n        }\n\n        const lastFocused = actionModel.lastFocused;\n        actionModel.hideMenu(false);\n\n        let modalFocusableElement;\n        const $el = jQuery(element);\n        if ($el.prev().is('#' + actionModel.PARENT_MENU_CONTAINER)) {\n            modalFocusableElement = stdnav.getNextFocusableElement(lastFocused)\n        } else if ($el.next().is('#' + actionModel.PARENT_MENU_CONTAINER)) {\n            modalFocusableElement = stdnav.getPreviousFocusableElement(lastFocused)\n        }\n\n        //$el.parent().find('[js-navtype=menuTrap]').remove();\n        return modalFocusableElement;\n    }\n});\n\n// SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\njQuery.extend(stdnavPluginModalTrap.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'menuTrap',\n\n    // This arrary extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    //\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: []\n});\nvar newStdnavPluginModalTrap = new stdnavPluginModalTrap();\nexport default newStdnavPluginModalTrap;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport eventAutomation from 'js-sdk/src/common/util/eventAutomation';\nimport stdnav from 'js-sdk/src/common/stdnav/stdnav';\nimport {dynamicList} from '../../components/list.base';\nimport log from 'js-sdk/src/common/logging/logger';\n\nvar logger = log.register(\"stdnav\");\n\nvar version = '0.0.1';\nvar singleton = null;\nvar gserial = 0;\nvar stdnavPluginDynamicList = function () {\n    gserial++;\n    this.serial = gserial;\n};\n// FIRST EXTENSION PASS - FUNCTIONS\n// Provides forward-references for hashes in the second pass, so that\n// references in that second pass to functions declared here resolve\n// (since the entire pass is applied at once, they cannot be combined).\n$.extend(stdnavPluginDynamicList.prototype, {\n    zinit: function (selector) {\n        logger.debug('stdnavPluginDynamicList.init(' + selector + ')\\n');\n        return this;\n    },\n    // Registers the 'dynamiclist' navtype with stdnav.  stdnav must be loaded and\n    // activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        //\n        // For dynamic lists, pass arrow keys through to the existing keyboard\n        // behavior.\n        this.behavior = {\n            'ariaprep': [\n                this,\n                this._ariaPrep,\n                null\n            ],\n            'ariarefresh': [\n                this,\n                this._ariaRefresh,\n                null\n            ],\n            'click': null,\n            'down': null,\n            'end': null,\n            'enter': [\n                this,\n                this._onEnter,\n                null\n            ],\n            'toggle': [\n                this,\n                this._onEnter,\n                null\n            ],\n            'fixfocus': [\n                this,\n                this._fixFocus,\n                null\n            ],\n            'fixsuperfocus': [\n                this,\n                this._fixSuperfocus,\n                null\n            ],\n            'home': null,\n            'inherit': true,\n            'inheritable': true,\n            'left': null,\n            'pagedown': null,\n            'pageup': null,\n            'right': null,\n            'superfocusin': [\n                stdnav,\n                stdnav.basicSuperfocusIn,\n                {\n                    'maxdepth': 1,\n                    'focusSelector': 'li',\n                    'ghostfocus': false\n                }\n            ],\n            'superfocusout': [\n                stdnav,\n                stdnav.basicSuperfocusOut,\n                { 'ghostfocus': false }\n            ],\n            'up': null\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n    // Unregisters the 'dynamiclist' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this.behavior);\n    },\n    // This callback is run when the page is initially rendered.  Add the\n    // appropriate ARIA tags for the handled construt, if they do not already\n    // exist.  The element passed will be the superfocus for the construct\n    // being instrumented, but this construct may not actually have focus at\n    // the time this function is called.\n    _ariaPrep: function (el) {\n        //$(el).attr('role', 'application');\n        // $(el).attr('aria-label', 'Dynamic List');\n        return null;\n    },\n    // This callback is run when the superfocus changes to the construct.\n    // Its two purposes are to update existing constructs, and to handle\n    // dynamically-created content whose creation was not detected during\n    // initial page construction (possibly because no part of the construct\n    // existed yet).  The element passed will be the superfocus for the\n    // construct, but this construct may not actually have focus at the time\n    // this function is called.\n    _ariaRefresh: function (el) {\n        //$(el).attr('role', 'application');\n        //$(el).attr('aria-label', 'Dynamic List');\n        return null;\n    },\n    _onEnter: function (element) {\n        let $el = $(element);\n        if ($el.is('.supercursor')) {\n            // If a sublist is expanded, and a subitem has an active cursor,\n            // then the parent item gets the \"supercursor\" class instead,\n            // and should NEVER get keyboard focus at the same time (or the\n            // cursor would have been removed from the sublist and this item\n            // would have \"cursor\" instead of \"supercursor\" class).\n            logger.error('dynamicList item has supercursor class-- should not have focus while this is true.');\n            if ($el.find('ul > li.cursor') < 0) {\n                logger.error('...additionally, no sublist item appears to have the cursor class.');\n            }\n        } else {\n            // Using \"stdnav.getClosestNavigableDescendant\" here would just\n            // give us the sublist, if any, if that appears in the markup\n            // prior to the actual link on this item.  Therefore, explicitly\n            // look for buttons, links, and form fields only.\n            let $links = $el.find('a,:input');\n            let isButtonLink = $el.hasClass('button focus-visible')\n\n            if ($links.length > 0) {\n                // Fire the click handler\n                eventAutomation.simulateClickSequence($links[0]);\n            }\n\n            if(isButtonLink) {\n                eventAutomation.simulateClickSequence($el[0]);\n            }\n\n        }// DO NOT move focus.\n        return element;\n    },\n    // Focus adjustment callback.  Given an element somewhere within a\n    // dynamicList, including the list itself, return the element which should\n    // have get focused.  This is done by obtaining the cursor for the list.\n    _fixFocus: function (element) {\n        function findRow(el){\n            if ($(el).attr('role') === 'row'){\n                return el;\n            }\n\n            return element.querySelector('[role=\"row\"]') ? element.querySelector('[role=\"row\"]') : element;\n        }\n\n        var $listEl = $(element).closest('[js-navtype=\\'' + this.navtype + '\\']');\n        if ($listEl.length < 1) {\n            logger.warn('Can\\'t find a dynamic list to fix focus to');\n            return findRow(element);\n        }\n        var listObj = dynamicList.getDynamicListForElement($listEl[0]);\n        if (stdnav.nullOrUndefined(listObj)) {\n            logger.warn('Can\\'t map a dynamic list to fix focus to');\n            return findRow(element);\n        }\n        if($(element).attr('role')==='treegrid'){\n            if($(element).find('.selected').length){\n                return $(element).find('.selected[role=\"row\"]');\n            }\n            let focusableEl = findRow(element);\n            $(focusableEl).addClass('selected');\n            return focusableEl;\n        }\n        return listObj.getCursorElement();\n    },\n    // Subfocus adjustment callback.  Use the same element that has focus.\n    _fixSubfocus: function (element) {\n        return null;\n    },\n    // Superfocus adjustment callback.  Given an element somewhere within a\n    // sub-DOM within a list, ensures that the list itself (OL,UL) is given\n    // superfocus.\n    _fixSuperfocus: function (element) {\n        var newSuperfocus;\n        var $closestList = $(element).closest('ol,ul');\n        if ($closestList.length > 0) {\n            newSuperfocus = $closestList[0];\n        } else {\n            // FAULT, let StdNav fall back to BODY\n            newSuperfocus = null;\n        }\n        return newSuperfocus;\n    },\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n    // The list has been entered from another control, and superfocus has been\n    // set appropriately.  Browser focus may be temporarily on the control's\n    // container.  Return the element which should receive browser focus for\n    // accessibility purposes.\n    _onSuperfocusIn: function (element) {\n        var newFocus;    // This should fire on the list itself, not the item.\n        // This should fire on the list itself, not the item.\n        var ghosts = $(element).children('li .ghostfocus');\n        if (ghosts.length > 0) {\n            ghosts.removeClass('ghostfocus');    // Promote ghost.\n            // Promote ghost.\n            newFocus = ghosts[0];\n        } else {\n            // No ghosts.  Set focus to first item.\n            var items = $(element).children('li[js-navigable!=\"false\"]');\n            if (items.length > 0) {\n                newFocus = items[0];\n            } else {\n                // For visual reasons, in the case of an empty list, we give up and\n                // set subfocus to the list itself.\n                newFocus = element;\n            }\n        }\n        return newFocus;\n    },\n    // The list is being exited for another control, and superfocus has been\n    // lost.\n    _onSuperfocusOut: function (element) {\n    }    // FIXME: ghostfocus\n});    // SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\n// SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\n$.extend(stdnavPluginDynamicList.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'dynamiclist',\n    // This arrary extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    //\n    // The normal List plugin should handle UL and OL tags by default.\n    navtype_tags: []\n});\nvar newStdnavPluginDynamicList = new stdnavPluginDynamicList();\nexport default newStdnavPluginDynamicList;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n* @author: ${username}\n* @version: $Id$\n*/\n\n/* Standard Navigation library (stdnav) plugin\n* Elements: FORM, INPUT, OPTION, OPTGROUP, SELECT, TEXTAREA\n* Navtype:  forms (element default)\n*\n* Plugin for the \"forms\" navtype.  This is the default-- AND STRONGLY\n* RECOMMENDED-- behavior for forms and inputs.  Primarily needed to ensure\n* that input controls inside of lists and grids can properly obtain focus,\n* and also so they don't get inappropriate navigation effects intended for\n* their parents.  Be aware that \"button\" has its own plugin.\n*\n* Note that screen readers take classic, standard web forms more seriously\n* than practically anything else.  They implement them well, and in general\n* you will want to stay out of their way.  Avoid unexpected focus changes\n* when dealing with forms.\n*\n* This module supports enhancements intended to improve compliance with\n* section 508 of the Rehabilitation Act of 1973, 29 USC 798, as amended\n* 1998.\n*/\nimport $ from 'jquery';\nimport log from \"js-sdk/src/common/logging/logger\";\nimport stdnav from 'js-sdk/src/common/stdnav/stdnav';\n\nimport eventAutomation from \"js-sdk/src/common/util/eventAutomation\";\n\nimport layoutModule from \"../../core/core.layout\";\n\nlet logger = log.register('stdnav');\n\nvar version = \"0.0.1\",\n    singleton = null,\n    gserial = 0;\n\n// TODO: get rid of dependency on JRS mark-up\nlayoutModule.INPUT_ZOOM_VALUE = 'input#zoom_value';\nlayoutModule.INPUT_SEARCH_REPORT = 'input#search_report';\nlayoutModule.PAGE_CURRENT = 'input#page_current';\n\nlayoutModule.MENU_VWROPTIONS = '#vwroptions .menu.vertical.dropDown.fitable';\nlayoutModule.MENU_VWROPTIONS_LIST = '#vwroptions .menu.vertical.dropDown.fitable li';\n\n// Local object definition.\n\nvar stdnavPluginForms = function () {\n    gserial++;\n    this.serial = gserial;\n};\n\n// FIRST EXTENSION PASS - FUNCTIONS\n// Provides forward-references for hashes in the second pass, so that\n// references in that second pass to functions declared here resolve\n// (since the entire pass is applied at once, they cannot be combined).\n$.extend(stdnavPluginForms.prototype, {\n    zinit: function (selector) {\n        logger.debug('stdnavPluginForms.init(' + selector + \")\\n\");\n        return this;\n    },\n\n    // Registers the 'forms' navtype with stdnav.  stdnav must be loaded and\n    // activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        //\n        // For dynamic lists, pass arrow keys through to the existing keyboard\n        // behavior.\n        this.behavior = {\n            'ariaprep': [this, this._ariaPrep, null],\n            'ariarefresh': [this, this._ariaRefresh, null],\n            'down': [this, this._onDown, null],\n            'enter': [this, this._onEnter, null],\n            'exit': [this, this._onExit, null],\n            'inherit': false,\n            'inheritable': true,\n            'fixsuperfocus': [stdnav, stdnav.basicFixSuperfocus, null],\n            'superfocusin': [stdnav, stdnav.basicSuperfocusIn, {\n                'maxdepth': 1,\n                'focusSelector': ':input',\n                'ghostfocus': false\n            }]\n        }\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters the 'forms' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this.behavior);\n    },\n\n    // This callback is run when the page is initially rendered.  Add the\n    // appropriate ARIA tags for the handled construct, if they do not already\n    // exist.  The element passed will be the superfocus for the construct\n    // being instrumented, but this construct may not actually have focus at\n    // the time this function is called.\n    _ariaPrep: function (el) {\n        //$(el).attr('role', 'form');\n        return null;\n    },\n\n    // This callback is run when the superfocus changes to the construct.\n    // Its two purposes are to update existing constructs, and to handle\n    // dynamically-created content whose creation was not detected during\n    // initial page construction (possibly because no part of the construct\n    // existed yet).  The element passed will be the superfocus for the\n    // construct, but this construct may not actually have focus at the time\n    // this function is called.\n    _ariaRefresh: function (el) {\n        //$(el).attr('role', 'form');\n        return null;\n    },\n\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n\n    /* ========== KEYBOARD BEHAVIOR =========== */\n    //ToDo need refactor!!!\n    _onDown: function(element){\n        var $el = $(element);\n        if($el.is(\"input#zoom_value\")){\n            this.parent = element;\n            $el.closest(\"li\").addClass(\"isParent\");\n            eventAutomation.simulateClickSequence($('button#zoom_value_button')[0]);\n            $(layoutModule.MENU_VWROPTIONS_LIST).first().find(\"p\").addClass(\"over\");\n            element = $(layoutModule.MENU_VWROPTIONS_LIST).first()[0];\n        } else if($el.is(\"input#search_report\")){\n            this.parent = element;\n            $el.closest(\"li\").addClass(\"isParent\");\n            eventAutomation.simulateClickSequence($('button#search_options')[0]);\n            $(layoutModule.MENU_VWROPTIONS_LIST).first().find(\"p\").addClass(\"over\");\n            element = $(layoutModule.MENU_VWROPTIONS_LIST).first()[0]\n        }\n\n        return element;\n    },\n\n    _onExit: function(element){\n        var $el = $(element);\n\n        if($el.is(layoutModule.INPUT_ZOOM_VALUE)){\n            element = $(\"li.zoom.leaf.j-dropdown\")[0];\n        } else if ($el.is(layoutModule.INPUT_SEARCH_REPORT)){\n            element = $(\"li.search.leaf.j-dropdown\")[0];\n        } else if ($el.is(layoutModule.PAGE_CURRENT)){\n            element = $(\"li.paging.leaf.j-dropdown\")[0];\n        }\n\n        return element;\n    },\n\n    _onEnter: function(element){\n        var $el = $(element);\n\n        if($el.is(layoutModule.INPUT_ZOOM_VALUE)){\n            element = $(\"li.zoom.leaf.j-dropdown\")[0];\n        } else if ($el.is(layoutModule.INPUT_SEARCH_REPORT)){\n            element = $(\"li.search.leaf.j-dropdown\")[0];\n        } else if ($el.is(layoutModule.PAGE_CURRENT)){\n            element = $(\"li.paging.leaf.j-dropdown\")[0];\n        }\n\n        return element;\n    }\n});\n\n// SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\n$.extend(stdnavPluginForms.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'forms',\n\n    // This arrary extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    // Note that 'button' has its own plugin.\n    // USE UPPER-CASE!\n    navtype_tags: ['FORM', 'INPUT', 'OPTGROUP', 'OPTION', 'SELECT', 'TEXTAREA']\n});\nvar newStdnavPluginForms = new stdnavPluginForms();\nexport default newStdnavPluginForms;","/*\n * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport stdnav from 'js-sdk/src/common/stdnav/stdnav';\nimport actionModel from '../../actionModel/actionModel.modelGenerator';\nimport buttonManager from '../../core/core.events.bis';\nimport layoutModule from '../../core/core.layout';\nimport primaryNavigation from '../../actionModel/actionModel.primaryNavigation';\nimport log from 'js-sdk/src/common/logging/logger';\nimport eventAutomation from \"js-sdk/src/common/util/eventAutomation\";\nimport {AriaProps} from \"js-sdk/src/common/util/accessibility/waiAriaConstants\";\n\nvar logger = log.register(\"stdnav\");\n\nconst ActiveTopLevelMenuAttribute = 'data-toplevel-descendant';\n\nconst $mainMenu = $('#' + layoutModule.MAIN_NAVIGATION_ID);\nconst $homeMenu = $('#' + layoutModule.MAIN_NAVIGATION_HOME_ITEM_ID);\nconst $libraryMenu = $('#' + layoutModule.MAIN_NAVIGATION_LIBRARY_ITEM_ID);\n\nvar stdnavPluginMainMenu = function () {\n    this.menu_item_callbacks = {\n        click: {}\n    };\n};\n\n_.extend(stdnavPluginMainMenu.prototype, {\n    zinit: function (selector) {\n        return this;\n    },\n\n    // Registers the 'actionMenu' navtype with stdnav.  Both stdnav and ActionMenu\n    // must be loaded and activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'toggle': [this, this._onToggle, null],\n            'enter': [this, this._onEnter, null],\n            'exit': [this, this._onExit, null],\n            'fixfocus': [this, this._fixFocus, null],\n            'fixsubfocus': [this, this._fixFocus, null],\n            'ariarefresh': [this, this._ariaRefresh, null],\n            'focusin': [this, this._onFocusIn, null],\n            'focusout': [this, this._onFocusOut, null],\n            'click': [this, this._onClick, null],\n            'subfocusin': [this, this._onSubfocusIn, null],\n            'subfocusout': [this, this._onSubfocusOut, null],\n            'left': [this, this._onLeft, null],\n            'right': [this, this._onRight, null],\n            'up': [this, this._onUp, null],\n            'down': [this, this._onDown, null],\n            'home': [this, this._onHome, null],\n            'end': [this, this._onEnd, null],\n            'inherit': false,\n            'inheritable': true\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters the 'actionMenu' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this);\n    },\n\n    /* ====== Focus Management ====== */\n\n    _fixFocus: function (element) {\n        return element;\n    },\n\n    _ariaRefresh: function () {\n        this._setHasSubMenuAriaAttributes($mainMenu.find(layoutModule.NAVIGATION_MUTTON_PATTERN));\n    },\n\n    _setOpenSubMenuAriaAttributeState: function (p, open, mute = false) {\n        const $activeToplevelMenu = $(p);\n        if ($activeToplevelMenu.attr(AriaProps.HasPopup)) {\n            const role = $activeToplevelMenu.attr('role');\n            mute && $activeToplevelMenu.attr('role', 'none')\n            $activeToplevelMenu\n                .attr(AriaProps.Expanded, open ? 'true' : 'false')\n            mute && $activeToplevelMenu.attr('role', role)\n        }\n    },\n\n    _setHasSubMenuAriaAttributes: function (element) {\n        const $menuWithSubmenu = $(element);\n        $menuWithSubmenu.find('> p')\n            .attr(AriaProps.Expanded, 'false')\n            .attr(AriaProps.HasPopup, 'true')\n            .attr(AriaProps.Controls, actionModel.PARENT_MENU_CONTAINER)\n            .attr(AriaProps.Owns, actionModel.PARENT_MENU_CONTAINER)\n    },\n\n    _closeSubMenu: function (element) {\n        this._setOpenSubMenuAriaAttributeState($(element).find('> p'), false);\n\n        actionModel.hideMenu();\n    },\n\n    _showSubMenu: function (element) {\n        const $activeToplevelMenu = $(element);\n        const $menuWithSubmenu = $activeToplevelMenu.closest(layoutModule.NAVIGATION_MUTTON_PATTERN);\n        if ($menuWithSubmenu.length>0) {\n            const $p = $menuWithSubmenu.find('p');\n            const allExpandedMenuItems = $mainMenu.find(`${layoutModule.NAVIGATION_MUTTON_PATTERN} > p[${AriaProps.Expanded}=true]`);\n            if (allExpandedMenuItems.length && !$p.is(allExpandedMenuItems)) {\n                this._setOpenSubMenuAriaAttributeState(allExpandedMenuItems, false, true);\n            }\n\n            this._setOpenSubMenuAriaAttributeState($p, true)\n            primaryNavigation.showNavButtonMenu(null, $menuWithSubmenu[0], $menuWithSubmenu.text().trim());\n        } else {\n            this._closeSubMenu($activeToplevelMenu[0]);\n        }\n    },\n\n    _getActiveTopLevelMenu: function () {\n        const activeToplevelMenuId = $mainMenu.attr(ActiveTopLevelMenuAttribute);\n        return  $(`#${activeToplevelMenuId}`);\n    },\n\n    _onFocusIn: function (element) {\n        const $el = $(element);\n        let activeTopLevelMenuId = $el.attr(ActiveTopLevelMenuAttribute);\n        if (!activeTopLevelMenuId) {\n            activeTopLevelMenuId = $el.find('li').first().attr('id');\n            $el.attr(ActiveTopLevelMenuAttribute, activeTopLevelMenuId);\n        }\n\n        const $activeToplevelMenu = this._getActiveTopLevelMenu();\n        return $activeToplevelMenu[0];\n    },\n\n    _onFocusOut: function (element) {\n        buttonManager.out($(element).find(layoutModule.BUTTON_PATTERN)[0]);\n        this._closeSubMenu(element);\n\n        return null;\n    },\n\n    _onClick: function (element) {\n        const menuItem = $(element).closest('li');\n        if (menuItem.length > 0) {\n            stdnav.setSubfocus(menuItem);\n        }\n    },\n\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n\n    _onSubfocusIn: function (element) {\n        const $el = $(element).closest('li');\n        const elementId = $el.find('p').attr('id') ?? $el.attr('id');\n        $mainMenu.attr(AriaProps.ActiveDescendant, elementId);\n        buttonManager.over($el.find(layoutModule.BUTTON_PATTERN)[0]);\n\n        if ($el.closest('#' + layoutModule.MAIN_NAVIGATION_ID).length) {\n            $mainMenu.attr(ActiveTopLevelMenuAttribute, $el.attr('id'));\n            this._showSubMenu($el);\n        }\n    },\n\n    _onSubfocusOut: function (element) {\n        buttonManager.out($(element).find(layoutModule.BUTTON_PATTERN)[0]);\n    },\n\n    _onToggle: function (element) {\n        this._onEnter(element);\n    },\n\n    _onEnter: function (element) {\n        if (!actionModel.isMenuShowing()) {\n            this._showSubMenu(element);\n        }\n\n        if ($(element).is(`#${layoutModule.MAIN_NAVIGATION_ID} li`) && (!($(element).is($homeMenu) || $(element).is($libraryMenu)))) {\n            this._onDown(element);\n        } else {\n            eventAutomation.simulateClickSequence(element);\n        }\n    },\n\n    _onExit: function (element) {\n        const $activeTopLevelMenu = this._getActiveTopLevelMenu()\n        stdnav.setSubfocus($activeTopLevelMenu[0]);\n        this._closeSubMenu($activeTopLevelMenu)\n    },\n\n    /* ========== KEYBOARD BEHAVIOR =========== */\n    _onLeft: function (element){\n        const $activeTopLevelMenu = this._getActiveTopLevelMenu()\n\n        let $prev = $activeTopLevelMenu.prev();\n        if ($prev.length === 0) {\n            $prev = $mainMenu.find('li').last();\n        }\n\n        stdnav.setSubfocus($prev[0]);\n    },\n\n    _onRight: function (element) {\n        const $activeTopLevelMenu = this._getActiveTopLevelMenu()\n\n        let $next = $activeTopLevelMenu.next();\n        if ($next.length === 0) {\n            $next = $mainMenu.find('li').first();\n        }\n\n        stdnav.setSubfocus($next[0]);\n    },\n\n    _getNextActiveDescendant: function (activeDescendantId) {\n        var $menuItems = $(layoutModule.MENU_LIST_PATTERN);\n        var $thisItem = activeDescendantId ? $(`#${activeDescendantId}`).closest('li') : null;\n        var $firstItem = $menuItems.first();\n        var $next = activeDescendantId ? $thisItem.next(layoutModule.MENU_LIST_PATTERN) : $firstItem;\n\n        if (!$next[0]) {\n            $next = $firstItem;\n        }\n\n        // Oddly, trying to add \":not(.separator)\" to the pattern\n        // above did not work; the separator was indeed skipped, but\n        // the menu item after it was not returned.  This code skips\n        // over any number of adjacent separators.\n        while ($next.is(layoutModule.SEPARATOR_PATTERN)){\n            $next=$next.next(layoutModule.MENU_LIST_PATTERN);\n        }\n\n        return $next;\n    },\n\n    _getPreviousActiveDescendant: function (activeDescendantId) {\n        var $menuItems = $(layoutModule.MENU_LIST_PATTERN);\n        var $thisItem = activeDescendantId ? $(`#${activeDescendantId}`).closest('li') : null;\n        var $lastItem = $menuItems.last();\n        var $previous = activeDescendantId ? $thisItem.prev(layoutModule.MENU_LIST_PATTERN) : $lastItem;\n\n        if (!$previous[0]) {\n            $previous = $lastItem;\n        }\n\n        // Oddly, trying to add \":not(.separator)\" to the pattern\n        // above did not work; the separator was indeed skipped, but\n        // the menu item after it was not returned.  This code skips\n        // over any number of adjacent separators.\n        while ($previous.is(layoutModule.SEPARATOR_PATTERN)){\n            $previous = $previous.prev(layoutModule.MENU_LIST_PATTERN);\n        }\n\n        return $previous;\n    },\n\n    _onUp: function (element) {\n        if (!actionModel.isMenuShowing()) {\n            this._showSubMenu(element);\n        }\n\n        if (actionModel.isMenuShowing()) {\n            const activeDescendantId = $mainMenu.attr(AriaProps.ActiveDescendant);\n            const $prev = this._getPreviousActiveDescendant(activeDescendantId);\n\n            stdnav.setSubfocus($prev[0]);\n        }\n    },\n\n    _onDown: function (element) {\n        if (!actionModel.isMenuShowing()) {\n            this._showSubMenu(element);\n        }\n\n        if (actionModel.isMenuShowing()) {\n            const activeDescendant = $mainMenu.attr(AriaProps.ActiveDescendant);\n            const $next = this._getNextActiveDescendant(activeDescendant);\n\n            stdnav.setSubfocus($next[0]);\n        }\n    },\n\n    _onHome: function (element) {\n        const first = $(element).closest('ul').find('li').first()[0];\n        stdnav.setSubfocus(first);\n    },\n\n    _onEnd: function (element) {\n        const last = $(element).closest('ul').find('li').last()[0];\n        stdnav.setSubfocus(last);\n    }\n});\n\n// SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\n$.extend(stdnavPluginMainMenu.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'mainmenu',\n\n    // This arrray extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    //\n    // NOTE: The HTML5 \"menu\" element is still very broken.  In practice\n    // our menus are built with list items and use \"js-navtype\" overrides to\n    // this type.\n    //\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: []\n});\n\nexport default new stdnavPluginMainMenu();\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id: $\n */\n\n/* Standard Navigation library (stdnav) plugin\n * Elements: LI, OL, UL\n * Navtype:  toolbar\n *\n * Plugin for toolbar menus, which may consist of simple buttons, text inputs,\n * buttons with drop-down options, tabs, etc. It handles the basic keyboard\n * navigation: moving left/right, opening the drop-downs, firing the actions.\n *\n * This module supports enhancements intended to improve compliance with\n * section 508 of the Rehabilitation Act of 1973, 29 USC 798, as amended\n * 1998.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport stdnav from 'js-sdk/src/common/stdnav/stdnav';\nimport buttonManager from '../../core/core.events.bis';\nimport layoutModule from '../../core/core.layout';\nimport primaryNavigation from '../../components/components.toolbarButtons';\nimport eventAutomation from 'js-sdk/src/common/util/eventAutomation';\nimport actionModel from '../../actionModel/actionModel.modelGenerator';\n\nvar gserial = 0;\n\n// TODO: get rid of dependency on JRS mark-up\nlayoutModule.TOOLBAR_MENU_PATTERN = 'ul.j-toolbar';\nlayoutModule.TOOLBAR_MENU_ITEM_PATTERN = 'ul.j-toolbar li';\n\nlayoutModule.BUTTON_ZOOM_VALUE = 'button#zoom_value_button';\nlayoutModule.BUTTON_SEARCH_REPORT = 'button#search_report_button';\nlayoutModule.BUTTON_SEARCH_OPTIONS = 'button#search_options';\nlayoutModule.BUTTON_FILE_OPTIONS = 'button#fileOptions';\nlayoutModule.BUTTON_EXPORT = 'button#export';\n\nlayoutModule.INPUT_ZOOM_VALUE = 'input#zoom_value';\nlayoutModule.INPUT_SEARCH_REPORT = 'input#search_report';\n\nlayoutModule.VIEWER_TOOLBAR = '#viewerToolbar';\nlayoutModule.MENU_VWROPTIONS = '#vwroptions .menu.vertical.dropDown.fitable';\nlayoutModule.MENU_VWROPTIONS_LIST = '#vwroptions .menu.vertical.dropDown.fitable li';\n\n\nvar StdnavPluginToolbar = function () {\n    gserial++;\n    this.serial = gserial;\n};\n\n_.extend(StdnavPluginToolbar.prototype, {\n    zinit: function (selector) {\n        return this;\n    },\n\n    // Registers the 'toolbar' navtype with stdnav.  Both stdnav and toolbar\n    // must be loaded and activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'ariaprep': [this, this._ariaPrep, null],\n            'ariarefresh': [this, this._ariaRefresh, null],\n            'down': [this, this._onDown, null],\n            'enter': [this, this._onEnterOrEntered, null],\n            'exit': [this, this._onExit, null],\n            'fixfocus': [this, this._fixFocus, null],\n            'fixsubfocus': [this, this._fixFocus, null],\n            'fixsuperfocus': [this, this._fixSuperfocus, null],\n            'focusin': [this, this._onFocusIn, null],\n            'focusout': [this, this._onFocusOut, null],\n            'left': [this, this._onLeft, null],\n            'right': [this, this._onRight, null],\n            'subfocusin': [this, this._onSubfocusIn, null],\n            'superfocusin': [this, this._onSuperfocusIn, null],\n            'superfocusout': [this, this._onSuperfocusOut, null],\n            'up': [this, this._onUp, null],\n            'inherit': false\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters the 'toolbar' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this);\n    },\n\n    // This callback is run when the page is initially rendered.  Add the\n    // appropriate ARIA tags for the handled construt, if they do not already\n    // exist.  The element passed will be the superfocus for the construct\n    // being instrumented, but this construct may not actually have focus at\n    // the time this function is called.\n    _ariaPrep: function (el) {\n        this._ariaRefresh(el);\n    },\n\n    // This callback is run when the superfocus changes to the construct.\n    // Its two purposes are to update existing constructs, and to handle\n    // dynamically-created content whose creation was not detected during\n    // initial page construction (possibly because no part of the construct\n    // existed yet).  The element passed will be the superfocus for the\n    // construct, but this construct may not actually have focus at the time\n    // this function is called.\n    _ariaRefresh: function (el) {\n        var $items = $(el).find('li').not(\".divider\");\n        $(el).attr('role', 'application');\n        $.each($items, function (key, item) {\n            var $item = $(item);\n            $item.attr('role', 'option');\n            var $labeledEl = $item.find(\"[aria-label]\");\n            if (!$item.attr('aria-label') && $labeledEl.length) {\n                $item.attr('aria-label', $labeledEl.attr('aria-label'));\n            }\n        });\n        return null;\n    },\n\n    /* ====== Focus Management ====== */\n\n\n    // Focus adjustment callback.  Ensures that if the DIV or UL elements\n    // themselves are given focus, that it is promoted to the first LI.\n    _fixFocus: function (element) {\n        var newFocus;\n        var $el = $(element);\n        if ($el.is('div,ul,ol')) {\n            // The usual case: the entire menu is gaining focus.  One of\n            // the reasons this can happen, of course, is in response to a\n            // mouse click, not a TAB press-- as a result, check to see if\n            // any of the menu options has the \"pressed\" CSS class, and\n            // focus that, if it does.  However, ignore the \"over\" class,\n            // as the mouse pointer can wind up anywhere for a blind user\n            // by total coincidence, so it must be ignored when setting\n            // focus in response to TAB.\n            //\n            // If nothing seems to be in use yet, select the first list\n            // item-- if there ARE any.\n            //\n            // Failing even that, select the list itself.\n            var items = $el.find('.pressed');\n            if (items.length > 0) {\n                newFocus = items[0];\n            } else {\n                items = $el.find('li').not(\".divider\");\n                if (items.length > 0) {\n                    newFocus = items[0];\n                } else {\n                    // The entire list is empty-- set focus to the root list element\n                    // after all.\n                    newFocus = element;\n                }\n            }\n        } else if ($el.is('button')) {\n            // Focus is already appropriate.\n            newFocus = element;\n        } else {\n            // Assume we're in a span or something within a list item.\n            var lis = $el.closest('li');\n            if (lis.length > 0) {\n                if ($(lis[0]).prop['js-navigable'] === false) {\n                    // Clicked on a header or something; focus the list instead.\n                    newFocus = $el.closest('ul,ol');\n                } else {\n                    newFocus = lis[0];\n                }\n            }\n        }\n\n        // Avoid focusing disabled button\n        if ($(newFocus).is(\":disabled\") || $(newFocus).find(\".button,.mutton\").is(\":disabled\")) {\n            newFocus = stdnav.closestNavigableAncestor(newFocus);\n        }\n\n        // this code is necessary to fix JS-63350\n        if (newFocus[0] === $el[0]) {\n            newFocus = null;\n        }\n\n        return newFocus;\n    },\n\n    // Superfocus adjustment callback.  Because of the way actionModel\n    // works, the menu is expected to be rooted in an enclosing DIV that\n    // contains the list, so use the DIV for the superfocus region.\n    // However, context menus are _not_\n    _fixSuperfocus: function (element) {\n        var newSuperfocus;\n        var $root = $(element).closest('ul');\n        if ($root.length > 0) {\n            newSuperfocus = $root[0];\n        } else {\n            // FAULT, let StdNav fall back to BODY\n            newSuperfocus = null;\n        }\n        return newSuperfocus;\n    },\n\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n\n    _onSuperfocusIn: function(element){\n        var $elem = $(element),\n            $parentList = $(this.parent).closest(layoutModule.TOOLBAR_MENU_PATTERN),\n            $currentList = $elem.closest(\".menu\").length && $elem;\n\n        if( $currentList && ($parentList.attr(\"tabindex\")>-1)){\n            this._parentTabindex = $parentList.attr(\"tabindex\");\n\n            if (this._parentTabindex>-1) {\n                $currentList.attr('js-suspended-tabindex', this._parentTabindex);\n                $currentList.find(\"li:first\").attr('tabindex', this._parentTabindex);\n            } else {\n                $elem.attr('js-suspended-tabindex', 'none');\n                $currentList.find(\"li:first\").attr('tabindex', -1);\n            }\n\n            // Explicitly make the element unfocusable-- temporarily.\n            $currentList.attr('tabindex', '-1');\n            $parentList.attr(\"tabindex\", \"-1\");\n        }\n\n        return element;\n    },\n\n    _onSubfocusIn: function(element){\n        var $ul = $(element).closest(layoutModule.TOOLBAR_MENU_PATTERN);\n\n        if($ul.attr('js-suspended-tabindex')>-1){\n            $(element).attr(\"tabindex\", $ul.attr('js-suspended-tabindex'));\n        } else if ($ul.attr('tabindex')>-1){\n            $(element).attr(\"tabindex\", $ul.attr('tabindex'));\n            $ul.attr('js-suspended-tabindex', $ul.attr('tabindex'));\n        }\n    },\n\n    _onFocusIn: function (element) {\n        var $thisItem,\n            $matched;\n\n        var $selected = $(element);\n        if ($selected.length>0) {\n            $thisItem = $selected.closest(layoutModule.TOOLBAR_MENU_ITEM_PATTERN);\n            if ($thisItem.length>0) {\n                // An item in the main menu bar has been focused.\n                buttonManager.over($thisItem.find(\".button\")[0]);\n                //buttonManager.over($thisItem.find(layoutModule.MENU_LIST_PATTERN)[0]); //ToDo\n                $matched = $thisItem.find(\".mutton\");\n\n                if ($matched.length>0 && !buttonManager.isDisabled($matched.context)) {\n                    // The item has a submenu-- show it.\n                    //actionModel.hideMenu();\n                    primaryNavigation.showButtonMenu(null, $matched[0]);\n                } else {\n                    // An item with no drop-down menu has been focused;\n                    // ensure any drop-down menus for other items are closed.\n                    actionModel.hideMenu();\n                    $(layoutModule.MENU_VWROPTIONS).hide();\n                }\n            } else {\n                $thisItem = $selected.is(\".menu li\")? $selected : $selected.closest(\".menu\");\n                if ($thisItem.length>0) {\n                    // An item in a drop-down or context menu has been focused.\n                    buttonManager.over($thisItem.find(\"p\")[0]);\n                }\n\n                // TODO: get rid of dependency on JRS mark-up\n                if($selected.is(layoutModule.BUTTON_ZOOM_VALUE) || $selected.is(layoutModule.BUTTON_SEARCH_REPORT)\n                    || $selected.is(layoutModule.BUTTON_SEARCH_OPTIONS)){\n                    $selected.click();\n                }\n            }\n        }\n        return element;\n    },\n\n    _onFocusOut: function (element) {\n        var $thisItem = $(element).closest(layoutModule.TOOLBAR_MENU_ITEM_PATTERN);\n\n        if ($thisItem.length>0) {\n            // A top-level item in the main menu bar has lost focus.\n            //actionModel.hideMenu();\n            // Don't remove the style if we've moved into a drop-down menu.\n            if (this.lastMenuBarItem !== element){\n                buttonManager.out($thisItem.find(layoutModule.BUTTON_PATTERN)[0]);\n                $thisItem.removeAttr(\"tabindex\");\n            }\n            //buttonManager.out($thisItem.find(layoutModule.MENU_LIST_PATTERN)[0]);\n        } else {\n            $thisItem = $(element).closest(layoutModule.MENU_LIST_PATTERN);\n            if ($thisItem.length>0) {\n                // An item in a drop-down or context menu has lost focus.\n                buttonManager.out($thisItem.find(layoutModule.BUTTON_PATTERN)[0]);\n                $thisItem.removeAttr(\"tabindex\");\n            }\n        }\n\n        return null;\n    },\n\n    _onSuperfocusOut: function(element){\n        var $toolbar = $(layoutModule.VIEWER_TOOLBAR);\n\n        if ($toolbar.length<1){\n            // There is no main navigation in embedded mode.\n            return element;\n        }\n        // Hide the dropdown menu unless the new focus is _in_ the\n        // dropdown menu.  Because of the way actionModel works, the\n        // dropdown menu is NOT a DOM descendant of the toolbar.\n        var newFocus=$(document.activeElement);\n        if (newFocus.closest('.dropDown').length<1){\n            var $selected = $toolbar.find(\".\" + layoutModule.HOVERED_CLASS);\n\n            if ($selected.length>0) {\n                buttonManager.out($selected[0]);\n            }\n\n            actionModel.hideMenu();\n            $(layoutModule.MENU_VWROPTIONS).hide();\n\n            // Explicitly make the element unfocusable-- temporarily.\n            var $ul = $(this.parent).closest(layoutModule.TOOLBAR_MENU_PATTERN);\n\n            $ul.attr(\"tabindex\", this._parentTabindex);\n\n            this.parent = null;\n            this.lastMenuBarItem = null;\n            $(\".isParent\").removeClass(\"isParent\");\n        }\n    },\n\n    /* ========== KEYBOARD BEHAVIOR =========== */\n\n\n    /* ========== KEYBOARD BEHAVIOR =========== */\n    _onLeft: function (element){\n        var $thisItem = $(element).closest(layoutModule.TOOLBAR_MENU_ITEM_PATTERN);\n        var $prev=$(element);\n\n        if(!$thisItem.length && $(element).closest(\".menu\").length){\n            $thisItem = $(this._onExitHandler(element));\n        }\n\n        if ($thisItem.length>0){\n            var $prevAll = $thisItem.prevAll(layoutModule.TOOLBAR_MENU_ITEM_PATTERN);\n            $prevAll.each(function(key, elem){\n                var $elem = $(elem);\n                if(!$elem.hasClass(\"divider\") && $elem.find(\"button:disabled\").length === 0 && $elem.find(\"button:hidden\").length === 0){\n                    $prev = $elem;\n                    return false;\n                }\n            });\n        }\n\n        return $prev[0];\n    },\n\n    _onRight: function (element) {\n        var $thisItem = $(element).closest(layoutModule.TOOLBAR_MENU_ITEM_PATTERN);\n        var $next=$(element);\n\n        if(!$thisItem.length && $(element).closest(\".menu\").length){\n            $thisItem = $(this._onExitHandler(element));\n        }\n\n        if ($thisItem.length>0){\n            var $nextAll = $thisItem.nextAll(layoutModule.TOOLBAR_MENU_ITEM_PATTERN);\n            $nextAll.each(function(key, elem){\n                var $elem = $(elem);\n                if(!$elem.hasClass(\"divider\") && $elem.find(\"button:disabled\").length === 0 && $elem.find(\"button:hidden\").length === 0){\n                    $next = $elem;\n                    return false;\n                }\n            });\n        }\n\n        return $next[0];\n    },\n\n    _onUp: function (element) {\n        var $prev = $(element);\n\n        if($(element).closest(\".menu\").length){\n            if($prev.prev().length){\n                $prev.find(\"p\").removeClass(layoutModule.HOVERED_CLASS);\n                $prev = $prev.prev().hasClass(\"separator\") ? $prev.prev().prev() : $prev.prev();\n                $prev.find(\"p\").addClass(layoutModule.HOVERED_CLASS);\n            } else {\n                $prev.length = 0;\n            }\n        }\n\n        if ($prev.length>0){\n            return $prev[0];\n        } else {\n            return this._onExitHandler(element);\n        }\n    },\n\n    _onDown: function (element) {\n        var $menu,\n            $button,\n            $next = $(element),\n            $input = $next.find(\"input\");\n\n        // TODO: get rid of dependency on JRS mark-up\n        if ($input.is(layoutModule.INPUT_ZOOM_VALUE) ){\n            $button = $(layoutModule.BUTTON_ZOOM_VALUE);\n        } else if ($input.is(layoutModule.INPUT_SEARCH_REPORT) ){\n            $button = $(layoutModule.BUTTON_SEARCH_OPTIONS);\n        }\n\n        if($button && $button.length){\n            this._setParentElem(element);\n\n            eventAutomation.simulateClickSequence($button[0]);\n            $(layoutModule.MENU_VWROPTIONS_LIST).first().find(\"p\").addClass(layoutModule.HOVERED_CLASS);\n            return  $(layoutModule.MENU_VWROPTIONS_LIST).first()[0];\n        }\n\n        if($next.parent().is(\"ul.buttonSet\")){\n            // TODO: get rid of dependency on JRS mark-up\n            if ($next.find(layoutModule.BUTTON_FILE_OPTIONS + \",\" + layoutModule.BUTTON_EXPORT).length === 0)  {\n                return element;\n            }\n            $(\"#\"+layoutModule.MENU_ID).removeClass(\"hidden\");\n            $menu = $(\"#\"+layoutModule.MENU_ID + \" ul\");\n        } else {\n            $menu = $next.closest(\"ul\").not(\".j-toolbar\");\n        }\n\n        if($(element).closest(\".menu\").length){\n            if($next.next().length){\n                $next.find(\"p\").removeClass(layoutModule.HOVERED_CLASS);\n                $next = $next.next().hasClass(\"separator\") ? $next.next().next() : $next.next();\n                $next.find(\"p\").addClass(layoutModule.HOVERED_CLASS);\n            }\n        } else if($(element).closest(\".buttonSet\").length) {\n            $next = $menu.find(\"li\").first();\n\n            this._setParentElem(element);\n            // this.lastMenuBarItem = element;\n        }\n\n        return $next[0];\n    },\n\n    _onExit: function(element){\n        var $el = $(element);\n        if($el.find(\"p\").length>0){\n            element = this._onExitHandler(element);\n        } else {\n            element = $(\"#\"+layoutModule.MAIN_SEARCH_INPUT_ID)[0];\n        }\n\n        return element;\n    },\n\n    _onEnterOrEntered: function (element) {\n        // Activate the link.\n        var simulateEl;\n        var $el = $(element);\n\n        if($el.hasClass(\"j-dropdown\")){\n            this._setParentElem(element);\n            element = $el.find(\"input\")[0];\n\n            // select the existing text value\n            if (element) {\n                $(element).select();\n            }\n        }\n\n        if($el.find(\"p\").length>0){\n            simulateEl = $el.find(\"p\")[0];\n        } else if ($el.find(\"input\").length === 0) {\n            simulateEl = $el.find(\".button\")[0];\n        }\n\n        // TODO: get rid of dependency on JRS mark-up\n        if(simulateEl && $(this.parent).find(layoutModule.BUTTON_FILE_OPTIONS).length === 0 &&\n            $(this.parent).find(layoutModule.BUTTON_EXPORT).length === 0){\n            eventAutomation.simulateClickSequence(simulateEl);\n        }\n\n        if($(element).find(\"p\").length>0){\n            element = this._onExitHandler(element);\n        }\n\n        return element;\n    },\n\n    _setParentElem: function(element){\n        this.parent = element;\n        $(element).addClass(\"isParent\");\n        this.lastMenuBarItem = element;\n    },\n\n    _onExitHandler: function (element) {\n        element = this.parent;\n        if(!element){\n            element = $(\".isParent\")[0];\n        }\n\n        $(element).removeClass(\"isParent\");\n        return element;\n    }\n});\n\n$.extend(StdnavPluginToolbar.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'toolbar',\n\n    // This arrray extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: []\n});\n\nexport default new StdnavPluginToolbar();\n","/*\n * Copyright (C) 2005 - 2021 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id: $\n */\n\n/* Standard Navigation library (stdnav) plugin\n * Elements: LI, OL, UL\n * Navtype:  toolbarV2\n *\n * Plugin for toolbar menus, which may consist of simple buttons, text inputs,\n * buttons with drop-down options, tabs, etc. It handles the basic keyboard\n * navigation: moving left/right, opening the drop-downs, firing the actions.\n *\n * This module supports enhancements intended to improve compliance with\n * section 508 of the Rehabilitation Act of 1973, 29 USC 798, as amended\n * 1998.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport stdnav from 'js-sdk/src/common/stdnav/stdnav';\nimport buttonManager from '../../core/core.events.bis';\nimport layoutModule from \"../../core/core.layout\";\n\nlet gserial = 0;\nlayoutModule.TOOLBAR_CONTAINER_EL = '[js-navtype=\"toolbarV2\"]';\nlayoutModule.TOOLBAR_LEAF_EL = '.leaf';\n\nvar StdnavPluginToolbarV2 = function () {\n    gserial++;\n    this.serial = gserial;\n};\n\n_.extend(StdnavPluginToolbarV2.prototype, {\n    zinit: function () {\n        return this;\n    },\n\n    // Registers the 'toolbarV2' navtype with stdnav.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'ariaprep': [this, this._ariaPrep, null],\n            'ariarefresh': [this, this._ariaRefresh, null],\n            'fixfocus': [this, this._fixFocus, null],\n            'fixsubfocus': [this, this._fixFocus, null],\n            'fixsuperfocus': [this, this._fixSuperfocus, null],\n            'superfocusout': [this, this._onSuperfocusOut, null],\n            'subfocusin': [this, this._onSubfocusIn, null],\n            'subfocusout': [this, this._onSubfocusOut, null],\n            'left': [this, this._onLeft, null],\n            'up': [this, this._onUp, null],\n            'down': [this, this._onDown, null],\n            'right': [this, this._onRight, null],\n            'enter': [this, this._onEnter, null],\n            'toggle': [this, this._onEnter, null],\n            'home': [this, this._onHome, null],\n            'end': [this, this._onEnd, null],\n            'click': [this, this._onClick, null],\n            'inherit': false,\n            'inheritable': true\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters the 'toolbarV2' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this);\n    },\n\n    // This callback is run when the page is initially rendered.  Add the\n    // appropriate ARIA tags for the handled construct, if they do not already\n    // exist.\n    _ariaPrep: function (el) {\n        this._ariaRefresh(el);\n    },\n\n    // This callback is run when the superfocus changes to the construct.\n    _ariaRefresh: function (el) {\n        $(el).attr('role', 'toolbar');\n        const $btnItems = $(el).find('.button');\n        $.each($btnItems, function (key, item) {\n            const $item = $(item);\n            $item.attr('aria-pressed', 'false');\n            //set navtype to button to avoid running default 'button' navtype for button\n            $item.attr('js-navtype', 'none');\n\n            const $icons = $($item).find('[class=\"icon\"]');\n            $.each($icons, function (key, iconEl) {\n                $(iconEl).attr('aria-hidden', 'true');\n            });\n        });\n        return null;\n    },\n\n    /* ====== Focus Management ====== */\n    _fixFocus: function (element) {\n        let newFocus;\n        const $el = $(element);\n        if ($el.is(layoutModule.TOOLBAR_CONTAINER_EL)) {\n            var items = $el.find(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n            if (items.length > 0) {\n                items = items.find('.button').not(':disabled');\n                if (items.length > 0) {\n                    newFocus = items[0];\n                } else {\n                    // The entire list is empty-- set focus to the next/previous focusable element depending on where is superfocus\n                    let elementWithSuperfocus = $('.superfocus')[0];\n                    if(($el.next())[0] === elementWithSuperfocus){\n                        newFocus = stdnav.getPreviousFocusableElement(element);\n                        if(newFocus && newFocus === $('#maincontent')[0]){\n                            newFocus = stdnav.getPreviousFocusableElement(newFocus);\n                        }\n                    }else{\n                        newFocus = stdnav.getNextFocusableElement(element);\n                    }\n                }\n            }\n        } else if ($el.is(layoutModule.TOOLBAR_LEAF_EL)) {\n            newFocus = ($el.find('.button'))[0];\n        } else {\n            // Assume we're in a span or something within a leaf.\n            const lis = $el.closest(layoutModule.TOOLBAR_LEAF_EL);\n            if (lis.length > 0) {\n                if ($(lis[0]).prop['js-navigable'] === false) {\n                    // Clicked on a header or something; focus the list instead.\n                    newFocus = $el.closest(layoutModule.TOOLBAR_CONTAINER_EL);\n                } else {\n                    newFocus = lis.find('.button');\n                }\n            }\n        }\n\n        // Avoid focusing disabled button\n        if ($(newFocus).is(\":disabled\") || $(newFocus).find(\".button\").is(\":disabled\")) {\n            const nextElements = $(newFocus).closest(layoutModule.TOOLBAR_LEAF_EL).nextAll().filter(function (index, element) {\n                return $(element).find(\".button\").is(\":enabled\");\n            });\n            newFocus = nextElements[0] ?? newFocus;\n        }\n\n        // this code is necessary to avoid issues like JS-63350\n        if (newFocus && (newFocus[0] === $el[0])) {\n            newFocus = null;\n        }\n\n        return newFocus;\n    },\n\n    // Superfocus adjustment callback.\n    _fixSuperfocus: function (element) {\n        let newSuperfocus;\n        const $root = $(element).closest(layoutModule.TOOLBAR_CONTAINER_EL);\n        if ($root.length > 0) {\n            newSuperfocus = $root[0];\n        } else {\n            // let StdNav fall back to BODY\n            newSuperfocus = null;\n        }\n        return newSuperfocus;\n    },\n\n    _onSuperfocusOut: function(element) {\n        const $leafAll = $(element).closest(layoutModule.TOOLBAR_CONTAINER_EL).find(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n        $leafAll.each(function(key, elem){\n            $(elem).find(\".button\").removeClass(layoutModule.PRESSED_CLASS).attr('aria-pressed', 'false');\n        });\n    },\n\n    _onSubfocusIn: function(element){\n        const $elem = $(element).is('.button') ? $(element) : $(element).find('.button');\n        buttonManager.over($elem[0]);\n    },\n\n    _onSubfocusOut: function(element){\n        const $elem = $(element).is('.button') ? $(element) : $(element).find('.button');\n        buttonManager.out($elem[0]);\n    },\n\n    /* ========== KEYBOARD BEHAVIOR =========== */\n    _onLeft: function (element){\n        const $thisItem = $(element).is(layoutModule.TOOLBAR_LEAF_EL) ? $(element) : $(element).closest(layoutModule.TOOLBAR_LEAF_EL);\n        let $prev = null;\n\n        if ($thisItem.length>0){\n            const $prevAll = $thisItem.prevAll(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n            $prevAll.each(function(key, elem){\n                const $elem = $(elem);\n                if($prev === null &&  $elem.find(\".button:disabled\").length === 0 && $elem.find(\".button:hidden\").length === 0){\n                    $prev = $elem.find('.button');\n                }\n            });\n\n            //If we are on first Item of toolbar Item, pressing left arrow key should take us to last toolbar enabled item.\n            if($prev === null){\n                const $nextAll = $thisItem.nextAll(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n                $nextAll.each(function(key, elem){\n                    const $elem = $(elem);\n                    if($elem.find(\".button:disabled\").length === 0 && $elem.find(\".button:hidden\").length === 0){\n                        $prev = $elem.find('.button');\n                    }\n                });\n            }\n        }\n        $prev = $prev ?? element;\n        return $prev;\n    },\n\n    _onRight: function (element) {\n        const $thisItem = $(element).is(layoutModule.TOOLBAR_LEAF_EL) ? $(element) : $(element).closest(layoutModule.TOOLBAR_LEAF_EL);\n        let $next = null;\n\n        if ($thisItem.length>0){\n            const $nextAll = $thisItem.nextAll(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n            $nextAll.each(function(key, elem){\n                const $elem = $(elem);\n                if($next === null && $elem.find(\".button:disabled\").length === 0 && $elem.find(\".button:hidden\").length === 0){\n                    $next = $elem.find('.button');\n                }\n            });\n            //If we are on last Item of toolbar Item, pressing right should take us to first enabled item.\n            if($next === null){\n                const $prevAll = $thisItem.prevAll(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n                $prevAll.each(function(key, elem){\n                    const $elem = $(elem);\n                    if($elem.find(\".button:disabled\").length === 0 && $elem.find(\".button:hidden\").length === 0){\n                        $next = $elem.find('.button');\n                    }\n                });\n            }\n        }\n        $next = $next ?? element;\n        return $next;\n    },\n\n    _onUp: function (element) {\n        //toolbar with buttons only not need any behaviour, if needed change this with checks\n        return element;\n    },\n\n    _onDown: function (element) {\n        //toolbar with buttons only not need any behaviour, if needed change this with checks\n        return element;\n    },\n\n    _onEnter: function (element) {\n        const $thisItem = $(element).is(layoutModule.TOOLBAR_LEAF_EL) ? $(element) : $(element).closest(layoutModule.TOOLBAR_LEAF_EL);\n        if($thisItem.length>0){\n            const $siblingAll = $thisItem.siblings(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n            $siblingAll.each(function(key, elem){\n                $(elem).find(\".button\").removeClass(layoutModule.PRESSED_CLASS).attr('aria-pressed', 'false');\n            });\n            if($thisItem.find(\".button\").length >0 && $thisItem.find(\".button:disabled\").length === 0 && $thisItem.find(\".button:hidden\").length === 0){\n                let $btn = $thisItem.find(\".button\");\n                $btn.attr('aria-pressed', 'true');\n                buttonManager.down($btn[0]);\n                $($btn[0]).trigger('mouseup');\n            }\n        }\n    },\n\n    _onHome: function (element) {\n        let $firstEl = null;\n        const $thisItem = $(element).is(layoutModule.TOOLBAR_LEAF_EL) ? $(element) : $(element).closest(layoutModule.TOOLBAR_LEAF_EL);\n        const $prevAll = $thisItem.prevAll(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n        $prevAll.each(function(key, elem){\n            const $elem = $(elem);\n            if($elem.find(\".button:disabled\").length === 0 && $elem.find(\".button:hidden\").length === 0){\n                $firstEl = $elem.find('.button');\n            }\n        });\n        return $firstEl ?? element;\n    },\n\n    _onEnd: function (element) {\n        let $lastEl = null;\n        const $thisItem = $(element).is(layoutModule.TOOLBAR_LEAF_EL) ? $(element) : $(element).closest(layoutModule.TOOLBAR_LEAF_EL);\n        const $nextAll = $thisItem.nextAll(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n        $nextAll.each(function(key, elem){\n            const $elem = $(elem);\n            if($elem.find(\".button:disabled\").length === 0 && $elem.find(\".button:hidden\").length === 0){\n                $lastEl = $elem.find('.button');\n            }\n        });\n        return $lastEl ?? element;\n    },\n\n    _onClick: function (element) {\n        const $siblingAll = $(element).closest(layoutModule.TOOLBAR_LEAF_EL).siblings(layoutModule.TOOLBAR_LEAF_EL).not(\".divider\");\n        $siblingAll.each(function(key, elem){\n            $(elem).find(\".button\").attr('aria-pressed', 'false');\n        });\n        const $btn = $(element).is('.button') ? $(element) : $(element).closest('.button');\n        if($btn.length>0) {\n            $btn.attr('aria-pressed', 'true');\n        }\n    }\n});\n\n$.extend(StdnavPluginToolbarV2.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'toolbarV2',\n\n    // This array extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: []\n});\n\nexport default new StdnavPluginToolbarV2();","/*\n * Copyright (C) 2005 - 2021 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id: $\n */\n\n/* Standard Navigation library (stdnav) plugin\n * Elements: LI, OL, UL, div\n * Navtype:  tablist\n *\n * Plugin for toolbar menus, which may consist of simple buttons, text inputs,\n * buttons with drop-down options, tabs, etc. It handles the basic keyboard\n * navigation: moving left/right, opening the drop-downs, firing the actions.\n *\n * This module supports enhancements intended to improve compliance with\n * section 508 of the Rehabilitation Act of 1973, 29 USC 798, as amended\n * 1998.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport stdnav from 'js-sdk/src/common/stdnav/stdnav';\nimport layoutModule from \"../../core/core.layout\";\n\nlet gserial = 0;\nlayoutModule.TABLIST_CONTAINER_EL = '[js-navtype=\"tablist\"]';\nlayoutModule.TABLIST_LEAF_EL = '.tablistleaf';\n\nvar StdnavTabList = function () {\n    gserial++;\n    this.serial = gserial;\n};\n\n_.extend(StdnavTabList.prototype, {\n    zinit: function () {\n        return this;\n    },\n\n    // Registers the 'tablist' navtype with stdnav.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'ariaprep': [this, this._ariaPrep, null],\n            'ariarefresh': [this, this._ariaRefresh, null],\n            'fixfocus': [this, this._fixFocus, null],\n            'fixsubfocus': [this, this._fixFocus, null],\n            'fixsuperfocus': [this, this._fixSuperfocus, null],\n            'left': [this, this._onLeft, null],\n            'right': [this, this._onRight, null],\n            'up': [this, this._onUp, null],\n            'down': [this, this._onDown, null],\n            'click': [this, this._onClick, null],\n            'inherit': false,\n            'inheritable': true\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters the 'tablist' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this);\n    },\n\n    // This callback is run when the page is initially rendered.  Add the\n    // appropriate ARIA tags for the handled construct, if they do not already\n    // exist.\n    _ariaPrep: function (el) {\n        this._ariaRefresh(el);\n    },\n\n    // This callback is run when the superfocus changes to the construct.\n    _ariaRefresh: function (el) {\n        $(el).attr('role', 'tablist');\n        const $tabItems = $(el).find(layoutModule.TABLIST_LEAF_EL).not('[disabled]');\n        $.each($tabItems, function (key, item) {\n            const $item = $(item);\n            if($(item).hasClass('selected')){\n                $item.attr('aria-selected', 'true');\n            }else{\n                $item.attr('aria-selected', 'false');\n            }\n            $item.attr('role', 'tab');\n\n            const $icons = $($item).find('[class=\"icon\"]');\n            $.each($icons, function (key, iconEl) {\n                $(iconEl).attr('aria-hidden', 'true');\n            });\n        });\n        return null;\n    },\n\n    /* ====== Focus Management ====== */\n    _fixFocus: function (element) {\n        let newFocus;\n        const $el = $(element);\n        if ($el.is(layoutModule.TABLIST_CONTAINER_EL)) {\n            var items = $el.find(layoutModule.TABLIST_LEAF_EL).not(\".label\");\n            if (items.length > 0) {\n                //set focus to active/selected Item\n                newFocus = (items.filter((index, item)=>$(item).hasClass(\"selected\")))[0];\n            }else {\n                // The entire list is empty-- set focus to the next focusable element\n                newFocus = stdnav.getNextFocusableElement(element);\n            }\n        } else if ($el.is(layoutModule.TABLIST_LEAF_EL)) {\n            newFocus = element;\n        } else {\n            // Assume we're in a span or something within a leaf.\n            const lis = $el.closest(layoutModule.TABLIST_LEAF_EL);\n            if (lis.length > 0) {\n                if ($(lis[0]).prop['js-navigable'] === false) {\n                    // Clicked on a header or something; focus the list instead.\n                    newFocus = $el.closest(layoutModule.TABLIST_CONTAINER_EL);\n                } else {\n                    newFocus = lis[0];\n                }\n            }\n        }\n\n        // Avoid focusing disabled button\n        if ($(newFocus).is(\"[disabled]\") || $(newFocus).find(\".button\").is(\":disabled\")) {\n            const activeElement = $(newFocus).closest(layoutModule.TABLIST_CONTAINER_EL).find(layoutModule.TABLIST_LEAF_EL).not('[disabled]');\n            newFocus = activeElement[0] ?? newFocus;\n        }\n\n        // this code is necessary to avoid issues like JS-63350\n        if (newFocus && (newFocus[0] === $el[0])) {\n            newFocus = null;\n        }\n\n        return newFocus;\n    },\n\n    // Superfocus adjustment callback.\n    _fixSuperfocus: function (element) {\n        let newSuperfocus;\n        const $root = $(element).closest(layoutModule.TABLIST_CONTAINER_EL);\n        if ($root.length > 0) {\n            newSuperfocus = $root[0];\n        } else {\n            // let StdNav fall back to BODY\n            newSuperfocus = null;\n        }\n        return newSuperfocus;\n    },\n\n    /* ========== KEYBOARD BEHAVIOR =========== */\n    _onLeft: function (element){\n        const $thisItem = $(element).is(layoutModule.TABLIST_LEAF_EL) ? $(element) : $(element).closest(layoutModule.TABLIST_LEAF_EL);\n        let $prev = null;\n\n        if ($thisItem.length>0){\n            $thisItem.attr('aria-selected', 'false').removeClass('selected');;\n            const $prevAll = $thisItem.prevAll(layoutModule.TABLIST_LEAF_EL).not(\".label\");\n            $prevAll.each(function(key, elem){\n                const $elem = $(elem);\n                if($prev === null && !($elem.is(\"[disabled]\")) && $elem.find(\".button:disabled\").length === 0){\n                    $prev = $elem;\n                }\n            });\n        }\n        $prev = $prev ? $prev[0] : element;\n        $($prev).attr('aria-selected', 'true').addClass('selected');;\n        return $prev;\n    },\n\n    _onRight: function (element) {\n        const $thisItem = $(element).is(layoutModule.TABLIST_LEAF_EL) ? $(element) : $(element).closest(layoutModule.TABLIST_LEAF_EL);\n        let $next = null;\n\n        if ($thisItem.length>0){\n            $thisItem.attr('aria-selected', 'false').removeClass('selected');;\n            const $nextAll = $thisItem.nextAll(layoutModule.TABLIST_LEAF_EL).not(\".label\");\n            $nextAll.each(function(key, elem){\n                const $elem = $(elem);\n                if($next === null && !($elem.is(\"[disabled]\")) && $elem.find(\".button:disabled\").length === 0){\n                    $next = $elem;\n                }\n            });\n        }\n        $next = $next ? $next[0] : element;\n        $($next).attr('aria-selected', 'true').addClass('selected');\n        return $next;\n    },\n\n    _onUp: function (element) {\n        return element;\n    },\n\n    _onDown: function (element) {\n        return element;\n    },\n\n    _onClick: function (element) {\n        const $element = $(element).is(layoutModule.TABLIST_LEAF_EL) ? $(element) : $(element).closest(layoutModule.TABLIST_LEAF_EL);\n        const $siblingAll = $element.siblings(layoutModule.TABLIST_LEAF_EL).not(\".label\");\n        $siblingAll.each(function(key, elem){\n            $(elem).attr('aria-selected', 'false');\n        });\n        const item = $element.not('[disabled]');\n        if(item.length>0) {\n            $element.attr('aria-selected', 'true');\n        }\n    }\n});\n\n$.extend(StdnavTabList.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'tablist',\n\n    // This array extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: []\n});\n\nexport default new StdnavTabList();","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\n\nimport 'jquery-ui/ui/widgets/datepicker';\n\nvar _jasperPrefix = \"jr\";\nvar _jasperPopupClass = \"jr-jDatepickerPopupContainer\";\n\nvar datepickerId = $.datepicker.dpDiv.attr(\"id\"),\n    _mainDivId = _jasperPrefix + \"-\" + datepickerId;\n\n$.datepicker._mainDivId = _mainDivId;\n\n$.datepicker.dpDiv.attr(\"id\", _mainDivId);\n\n$.datepicker.dpDiv.removeClass();\n\nvar dpDivClass = _jasperPopupClass\n    + ' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all '\n    + _jasperPrefix;\n\n$.datepicker.dpDiv.addClass(dpDivClass);\n\nvar originalNewInst = $.datepicker._newInst;\n\n$.datepicker._newInst = function() {\n    var result = originalNewInst.apply($.datepicker, arguments);\n\n    result.dpDiv.removeClass(_jasperPrefix);\n    result.dpDiv.addClass(_jasperPrefix);\n\n    return result;\n};\n\nvar originalGoToToday = $.datepicker._gotoToday;\n\n$.datepicker._gotoToday = function(id) {\n    originalGoToToday.call(this, id);\n    this._selectDate(id);\n};\n\nexport default $;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\n\nimport './jQueryDatepickerExtension';\nimport './jQueryUiSliderAccessExtension';\nimport 'jqueryui-timepicker-addon/dist/jquery-ui-timepicker-addon';\n\nvar originalNewInst = $.timepicker._newInst;\n\n$.timepicker._newInst = function($input, opts) {\n    if (!opts.onChangeMonthYear) {\n        opts.onChangeMonthYear = function(year, month, datepicker, timepicker) {\n            datepicker.currentYear = datepicker.selectedYear;\n            datepicker.currentMonth = datepicker.selectedMonth;\n            datepicker.currentDay = datepicker.selectedDay;\n\n            timepicker._updateDateTime(datepicker);\n        };\n    }\n\n    var instance = originalNewInst.call($.timepicker, $input, opts);\n\n    var originalOnTimeChange = instance._onTimeChange;\n\n    instance._onTimeChange = function() {\n        this.$timeObj[0].setSelectionRange = null;\n\n        return originalOnTimeChange.apply(this, arguments);\n    };\n\n    return instance;\n};\n\nexport default $;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n* @author: ${username}\n* @version: $Id$\n*/\n\n/* Standard Navigation library (stdnav) plugin\n* Elements: A\n* Navtype:  anchor (element default)\n*\n* Plugin for the \"anchor\" navtype.  This is the default behavior for \"A\"\n* tags, handling both normal \"HREF\" links and \"#\" internal/Backbone/fake\n* button links.\n*\n* This module supports enhancements intended to improve compliance with\n* section 508 of the Rehabilitation Act of 1973, 29 USC 798, as amended\n* 1998.\n*/\nimport $ from 'jquery';\nimport eventAutomation from '../../util/eventAutomation';\nimport log from \"../../logging/logger\";\nimport stdnav from '../stdnav';\n\nvar version = \"0.0.1\",\n    singleton = null,\n    gserial = 0;\n\nlet logger = log.register('stdnav');\n\n// Local object definition.\n\nvar stdnavPluginAnchor = function () {\n    gserial++;\n    this.serial = gserial;\n};\n\n// FIRST EXTENSION PASS - FUNCTIONS\n// Provides forward-references for hashes in the second pass, so that\n// references in that second pass to functions declared here resolve\n// (since the entire pass is applied at once, they cannot be combined).\n$.extend(stdnavPluginAnchor.prototype, {\n    zinit: function (selector) {\n        logger.debug('stdnavPluginAnchor.init(' + selector + \")\\n\");\n        return this;\n    },\n\n    // Registers the 'anchor' navtype with stdnav.  stdnav must be loaded and\n    // activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'ariaprep': [this, this._ariaPrep, null],\n            'ariarefresh': [this, this._ariaRefresh, null],\n            'down': [this, this._onLeftOrUp, null],\n            'enter': [this, this._onEnterOrEntered, null],\n            'toggle': [this, this._onToggle, null],\n            'inherit': false,\n            'inheritable': true,\n            'left': [this, this._onLeftOrUp, null],\n            'right': [this, this._onRightOrDown, null],\n            'up': [this, this._onRightOrDown, null]\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters the 'anchor' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype('anchor', this.behavior);\n    },\n\n    // This callback is run when the page is initially rendered.  Add the\n    // appropriate ARIA tags for the handled construct, if they do not already\n    // exist.  The element passed will be the superfocus for the construct\n    // being instrumented, but this construct may not actually have focus at\n    // the time this function is called.\n    _ariaPrep: function (el) {\n        //$(el).attr('role', 'link');\n        /*\n        var label = $(el).attr('aria-label');\n        if (stdnav.nullOrUndefined(label)) {\n            $(el).attr('aria-label', $(el).text());\n        }\n        */\n        return null;\n    },\n\n    // This callback is run when the superfocus changes to the construct.\n    // Its two purposes are to update existing constructs, and to handle\n    // dynamically-created content whose creation was not detected during\n    // initial page construction (possibly because no part of the construct\n    // existed yet).  The element passed will be the superfocus for the\n    // construct, but this construct may not actually have focus at the time\n    // this function is called.\n    _ariaRefresh: function (el) {\n        //$(el).attr('role', 'link');\n        /*\n        var label = $(el).attr('aria-label');\n        if (stdnav.nullOrUndefined(label)) {\n            $(el).attr('aria-label', $(el).text());\n        }\n        */\n        return null;\n    },\n\n    // Utility function: given a list, ensure the most appropriate element\n    // available (in this case, the top-level anchor node, only) has focus.\n    _fixSubfocus: function (element) {\n        var newSubfocus;\n        var $el = $(element);\n\n        if ($el.is('A')) {\n            newSubfocus = $el;\n        } else {\n            newSubfocus = $(element).closest('A');\n            if (newSubfocus === undefined) {\n                // Safety\n                return undefined;\n            }\n        }\n\n        // Nothing in or under this node should have ghostfocus; clear anything\n        // that does, and ensure that only the anchor element itself has subfocus.\n        newSubfocus.find('.ghostfocus').removeClass('.ghostfocus');\n        newSubfocus.children().find('.subfocus').removeClass('.subfocus');\n        return newSubfocus;\n    },\n\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n\n    _onFocusIn: function (element) {\n        var newSubfocus;\n        // This should fire on the list itself, not the item.\n        var ghosts = $(element).children('.ghostfocus');\n        if (ghosts.length > 0) {\n            ghosts.removeClass('ghostfocus');\n            // Promote ghost.\n            newSubfocus = this._fixSubfocus(ghosts[0]);\n        } else {\n            // Set subfocus to first item, without firing callbacks.\n            var items = $(element).children('li[js-navigable!=\"false\"]');\n            if (items.length > 0) {\n                newSubfocus = this._fixSubfocus(items[0]);\n            } else {\n                // For visual reasons, in the case of an empty list, we give up and\n                // set subfocus to the list itself.\n                newSubfocus = element;\n            }\n        }\n        return newSubfocus;\n    },\n\n    _onLeftOrUp: function(element) {\n        var $prev=$(element).prev('a');\n        if ($prev.length<1){\n            return element;\n        }\n        return $prev[0];\n    },\n\n    _onRightOrDown: function(element) {\n        var $next=$(element).next('a');\n        if ($next.length<1){\n            return element;\n        }\n        return $next[0];\n    },\n\n    //FIXME: Do not set ghostfocus on focus out\n\n    _onSubfocusIn: function (element) {\n        if ($(element).prop('nodeName') != 'A') {\n            // Find a usable child element.\n            var subel = this._fixSubfocus(element);\n            // Adjust subfocus without firing callbacks.\n            stdnav.setSubfocus(subel, false);\n        }\n    },\n\n    // When activated as a member of a navigable control, such as a list or\n    // table, this is a cascade event from the navigable control's \"enter\"\n    // handler, which will cause our \"enter\" handler to fire.  However, if\n    // the anchor is a simple link, such as an <a> tag embedded in a <p> block,\n    // it will be a simple tabstop, which is therefore focusable.  If such a\n    // link is focused, pressing ENTER will fire our \"enter\" handler.  The same\n    // logic works for both cases, so this callback should be mapped to both\n    // events.\n    _onEnterOrEntered: function (element) {\n        // Activate the link.\n        var $el = $(element);\n        if ($el.is('a')) {\n            // Fire the click handler\n            eventAutomation.simulateClickSequence(element);\n        }\n        return element;\n    },\n\n    // Making links with role='button' react to space bar as normal buttons does\n    _onToggle: function (element) {\n        // Activate the link.\n        var $el = $(element);\n        if ($el.is('a') && $el.attr('role') === 'button') {\n            return this._onEnterOrEntered(element);\n        }\n\n        return element;\n    }\n});\n\n// SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\n$.extend(stdnavPluginAnchor.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'anchor',\n\n    // This arrary extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    //\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: ['A']\n});\nvar newStdnavPluginAnchor = new stdnavPluginAnchor();\nexport default newStdnavPluginAnchor;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n* @author: ${username}\n* @version: $Id$\n*/\n\n/* Standard Navigation library (stdnav) plugin\n* Elements: BUTTON\n* Navtype:  button (element default)\n*\n* Plugin for the \"button\" navtype.  This is the default behavior for \"BUTTON\"\n* elements.\n*\n* This module supports enhancements intended to improve compliance with\n* section 508 of the Rehabilitation Act of 1973, 29 USC 798, as amended\n* 1998.\n*/\n\nimport $ from 'jquery';\nimport eventAutomation from '../../util/eventAutomation';\nimport log from \"../../logging/logger\";\nimport stdnav from '../stdnav';\n\nvar version = \"0.0.1\",\n    singleton = null,\n    gserial = 0;\n\nlet logger = log.register(\"stdnav\");\n\n// Local object definition.\n\nvar stdnavPluginButton = function () {\n    gserial++;\n    this.serial = gserial;\n};\n\n// FIRST EXTENSION PASS - FUNCTIONS\n// Provides forward-references for hashes in the second pass, so that\n// references in that second pass to functions declared here resolve\n// (since the entire pass is applied at once, they cannot be combined).\n$.extend(stdnavPluginButton.prototype, {\n    zinit: function (selector) {\n        logger.debug('stdnavPluginButton.init(' + selector + \")\\n\");\n        return this;\n    },\n\n    // Registers the 'button' navtype with stdnav.  stdnav must be loaded and\n    // activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with $.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'enter': [this, this._onEnterOrEntered, null],\n            'entered': [this, this._onEnterOrEntered, null],\n            'toggle': [this, this._onEnterOrEntered, null],\n            'inherit': false,\n            'inheritable': true\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters the 'button' navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype('button', this.behavior);\n    },\n\n    // Utility function: given a list, ensure the most appropriate element\n    // available (in this case, the top-level link node, only) has focus.\n    _fixSubfocus: function (element) {\n        var newSubfocus;\n        var $el = $(element);\n\n        if ($el.is(\"BUTTON,[role='button']\")) {\n            newSubfocus = $el;\n        } else {\n            newSubfocus = $(element).closest(\"BUTTON,[role='button']\");\n            if (newSubfocus === undefined) {\n                // Safety\n                return undefined;\n            }\n        }\n\n        // Nothing in or under this node should have ghostfocus; clear anything\n        // that does, and ensure that only the link element itself has subfocus.\n        newSubfocus.find('.ghostfocus').removeClass('.ghostfocus');\n        newSubfocus.children().find('.subfocus').removeClass('.subfocus');\n        return newSubfocus;\n    },\n\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n\n    _onFocusIn: function (element) {\n        var newSubfocus;\n        // This should fire on the list itself, not the item.\n        var ghosts = $(element).children('.ghostfocus');\n        if (ghosts.length > 0) {\n            ghosts.removeClass('ghostfocus');\n            // Promote ghost.\n            newSubfocus = this._fixSubfocus(ghosts[0]);\n        } else {\n            // Set subfocus to first item, without firing callbacks.\n            var items = $(element).children('li[js-navigable!=\"false\"]');\n            if (items.length > 0) {\n                newSubfocus = this._fixSubfocus(items[0]);\n            } else {\n                // For visual reasons, in the case of an empty list, we give up and\n                // set subfocus to the list itself.\n                newSubfocus = element;\n            }\n        }\n        return newSubfocus;\n    },\n\n    //FIXME: Do not set ghostfocus on focus out\n\n    _onSubfocusIn: function (element) {\n        if ($(element).prop('nodeName') != 'BUTTON') {\n            // Find a usable child element.\n            var subel = this._fixSubfocus(element);\n            // Adjust subfocus without firing callbacks.\n            stdnav.setSubfocus(subel, false);\n        }\n    },\n\n    // When activated as a member of a navigable control, such as a list or\n    // table, this is a cascade event from the navigable control's \"enter\"\n    // handler, which will cause our \"entered\" handler to fire.  However, if\n    // the anchor is a simple link, such as an <a> tag embedded in a <p> block,\n    // it will be a simple tabstop, which is therefore focusable.  If such a\n    // link is focused, pressing ENTER will fire our \"enter\" handler.  The same\n    // logic works for both cases, so this callback should be mapped to both\n    // events.\n    _onEnterOrEntered: function (element) {\n        // Activate the link.\n        var $el = $(element);\n        if ($el.is(\"BUTTON,[role='button']\")) {\n            eventAutomation.simulateClickSequence(element);\n        }\n        return element;\n    }\n});\n\n// SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\n$.extend(stdnavPluginButton.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'button',\n\n    // This arrary extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    //\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: ['BUTTON']\n});\nvar newStdnavPluginButton = new stdnavPluginButton();\nexport default newStdnavPluginButton;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport logger from \"../../logging/logger\";\nimport stdnav from '../stdnav';\n\nlet localLogger = logger.register(\"stdnavPluginGrid\");\n\nvar version = '0.0.1';\nvar singleton = null;\nvar gserial = 0;\nvar stdnavPluginGrid = function () {\n    gserial++;\n    this.serial = gserial;\n};\n$.extend(stdnavPluginGrid.prototype, {\n    zinit: function (selector) {\n        localLogger.debug('stdnavPluginGrid.init(' + selector + ')\\n');\n        return this;\n    },\n    activate: function () {\n        this.behavior = {\n            'focusin': [\n                this,\n                stdnav.basicFocusIn,\n                {\n                    'maxdepth': 2,\n                    'subfocusclass': 'gridcell'\n                }\n            ],\n            'focusout': [\n                this,\n                stdnav.ghostFocusOut,\n                null\n            ],\n            'subfocusin': [\n                this,\n                this._onSubfocusIn,\n                null\n            ],\n            'left': [\n                this,\n                this._onLeft,\n                null\n            ],\n            'right': [\n                this,\n                this._onRight,\n                null\n            ],\n            'up': [\n                this,\n                this._onUp,\n                null\n            ],\n            'down': [\n                this,\n                this._onDown,\n                null\n            ],\n            'hoverin': [\n                this,\n                this._onHover,\n                null\n            ],\n            'inherit': true,\n            'inheritable': true\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this.behavior);\n    },\n    _findSubfocus: function (el) {\n        var grid = $(el).closest('.grid');\n        var sfels = grid.find('.subfocus');\n        if (sfels !== undefined) {\n            return $(sfels[0]);\n        }\n    },\n    _fixSubfocus: function (element) {\n        var ghosts;\n        var newSubfocus;\n        if (element.hasClass('grid')) {\n            ghosts = element.children('.gridrow').children('.gridcell .ghostfocus');\n            if (ghosts.length > 0) {\n                newSubfocus = ghosts[0];\n            } else {\n                var rows = element.children('.gridrow');\n                if (rows.length > 0) {\n                    var cells = $(rows[0]).children('.gridcell');\n                    if (cells.length > 0) {\n                        newSubfocus = cells[0];\n                    } else {\n                        newSubfocus = rows[0];\n                    }\n                } else {\n                    newSubfocus = element;\n                }\n            }\n        } else if (element.hasClass('gridrow')) {\n            ghosts = element.children('.gridcell .ghostfocus');\n            newSubfocus = ghosts[0];\n        } else if (element.hasClass('gridcell')) {\n            newSubfocus = element;\n        }\n        return newSubfocus;\n    },\n    _onSubfocusIn: function (element) {\n        if ($(element).hasClass('gridcell') === false) {\n            var subel = this._fixSubfocus($(element));\n            stdnav.setSubfocus(subel, false);\n        }\n    },\n    _onLeft: function (element) {\n        var sfel = this._findSubfocus(element);\n        var newsf = $(false);\n        if (sfel.hasClass('gridcell')) {\n            newsf = sfel.prev('.gridcell');\n        }\n        if (newsf.length === 1) {\n            stdnav.setSubfocus(newsf);\n        }\n        return false;\n    },\n    _onRight: function (element) {\n        var sfel = this._findSubfocus(element);\n        var newsf = $(false);\n        if (sfel.hasClass('gridcell')) {\n            newsf = sfel.next('.gridcell');\n        }\n        if (newsf.length === 1) {\n            stdnav.setSubfocus(newsf);\n        }\n        return false;\n    },\n    _onUp: function (element) {\n        var sfel = this._findSubfocus(element);\n        var row;\n        var newrow = $(false);\n        var newsf = $(false);\n        if (sfel.hasClass('gridcell')) {\n            row = sfel.closest('.gridrow');\n            if (row.length === 1) {\n                newrow = row.prev('.gridrow');\n            }\n            if (newrow.length === 1) {\n                var iter = sfel;\n                var col = -1;\n                do {\n                    col++;\n                    iter = $(iter.prev('.gridcell')[0]);\n                } while (iter.length > 0);\n                newsf = $(newrow.find('.gridcell')[0]);\n                while (col > 0) {\n                    iter = newsf.next('.gridcell');\n                    if (iter.length > 0) {\n                        newsf = $(iter[0]);\n                    }\n                    col--;\n                }\n            }\n        }\n        if (newsf.length === 1) {\n            stdnav.setSubfocus(newsf);\n        }\n        return false;\n    },\n    _onDown: function (element) {\n        var sfel = this._findSubfocus(element);\n        var row;\n        var newrow = $(false);\n        var newsf = $(false);\n        if (sfel.hasClass('gridcell')) {\n            row = sfel.closest('.gridrow');\n            if (row.length > 0) {\n                newrow = row.next('.gridrow');\n            }\n            if (newrow.length > 0) {\n                var iter = sfel;\n                var col = -1;\n                do {\n                    col++;\n                    iter = $(iter.prev('.gridcell')[0]);\n                } while (iter.length > 0);\n                newsf = $(newrow.find('.gridcell')[0]);\n                while (col > 0) {\n                    iter = newsf.next('.gridcell');\n                    if (iter.length > 0) {\n                        newsf = $(iter[0]);\n                    }\n                    col--;\n                }\n            }\n        }\n        if (newsf.length === 1) {\n            stdnav.setSubfocus(newsf);\n        }\n        return false;\n    }\n});\n$.extend(stdnavPluginGrid.prototype, {\n    navtype: 'grid',\n    navtype_tags: []\n});\nvar newStdnavPluginGrid = new stdnavPluginGrid();\nexport default newStdnavPluginGrid;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport logger from \"../../logging/logger\";\nimport stdnav from '../stdnav';\n\nlet localLogger = logger.register(\"stdnavPluginList\");\n\nvar version = '0.0.1';\nvar singleton = null;\nvar gserial = 0;\nvar stdnavPluginList = function () {\n    gserial++;\n    this.serial = gserial;\n};\n$.extend(stdnavPluginList.prototype, {\n    zinit: function (selector) {\n        localLogger.debug('stdnavPluginList.init(' + selector + ')\\n');\n        return this;\n    },\n    activate: function () {\n        this.behavior = {\n            'ariaprep': [\n                this,\n                this._ariaPrep,\n                null\n            ],\n            'ariarefresh': [\n                this,\n                this._ariaRefresh,\n                null\n            ],\n            'click': [\n                this,\n                this._onClick,\n                null\n            ],\n            'down': [\n                this,\n                this._onDown,\n                null\n            ],\n            'fixfocus': [\n                this,\n                this._fixFocus,\n                null\n            ],\n            'fixsuperfocus': [\n                this,\n                this._fixSuperfocus,\n                null\n            ],\n            'inherit': true,\n            'inheritable': true,\n            'left': [\n                this,\n                this._onLeft,\n                null\n            ],\n            'right': [\n                this,\n                this._onRight,\n                null\n            ],\n            'up': [\n                this,\n                this._onUp,\n                null\n            ],\n            'superfocusin': [\n                stdnav,\n                stdnav.basicSuperfocusIn,\n                {\n                    'maxdepth': 1,\n                    'focusSelector': 'li',\n                    'ghostfocus': false\n                }\n            ],\n            'superfocusout': [\n                stdnav,\n                stdnav.basicSuperfocusOut,\n                { 'ghostfocus': false }\n            ]\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n    deactivate: function () {\n        stdnav.unregisterNavtype('list', this.behavior);\n    },\n    _ariaPrep: function (el) {\n        this._ariaRefresh(el);\n    },\n    _ariaRefresh: function (el) {\n        var $list = $(el);\n        var $items = $list.children('li');\n        $.each($items, function (index, item) {\n            var $item = $(item);\n            if (typeof $item.attr('role') === \"undefined\") {\n                var $itemLinks = $item.find('a');\n                if ($itemLinks.length > 0) {\n                    $item.attr('role', 'link');\n                }\n            }\n        });\n        return null;\n    },\n    _fixFocus: function (element) {\n        var ghosts;\n        var newFocus;\n        var $el = $(element);\n        if ($el.is('fieldset') && $el.children('ul.inputSet').length) {\n            return element;\n        }\n        if ($el.is('ul,ol')) {\n            ghosts = $el.children('li .ghostfocus');\n            if (ghosts.length > 0) {\n                newFocus = ghosts[0];\n            } else {\n                var items = $el.children('li');\n                if (items.length > 0) {\n                    newFocus = items[0];\n                } else {\n                    newFocus = element;\n                }\n            }\n        } else if ($el.is('li')) {\n            newFocus = element;\n        } else {\n            var lis = $el.closest('li');\n            if (lis.length > 0) {\n                if ($(lis[0]).prop['js-navigable'] === false) {\n                    newFocus = $el.closest('ul,ol');\n                } else {\n                    newFocus = lis[0];\n                }\n            } else {\n                newFocus = $el.closest('ul,ol');\n            }\n        }\n        return newFocus;\n    },\n    _fixSubfocus: function (element) {\n        return null;\n    },\n    _fixSuperfocus: function (element) {\n        var newSuperfocus;\n        var $closestList = $(element).closest('ol,ul');\n        if ($closestList.length > 0) {\n            newSuperfocus = $closestList[0];\n        } else {\n            newSuperfocus = null;\n        }\n        return newSuperfocus;\n    },\n    // Some screen readers have their own shortcuts to activate element.\n    // in case of role=link such activation will trigger 'click' event\n    // on the item, so we have to re-trigger this event on an underlying link\n    _onClick: function (element) {\n        let $el = $(element);\n        if (element.nodeName === 'LI' && $el.attr('role') === 'link') {\n            var firstLink = $el.find('a')[0];\n            if (typeof firstLink !== \"undefined\") {\n                stdnav.runAction('enter', firstLink);\n            }\n        }\n        return element;\n    },\n    _onSuperfocusIn: function (element) {\n        var newFocus;\n        var ghosts = $(element).children('li .ghostfocus');\n        if (ghosts.length > 0) {\n            ghosts.removeClass('ghostfocus');\n            newFocus = ghosts[0];\n        } else {\n            var items = $(element).children('li[js-navigable!=\"false\"]');\n            if (items.length > 0) {\n                newFocus = items[0];\n            } else {\n                newFocus = element;\n            }\n        }\n        return newFocus;\n    },\n    _onSuperfocusOut: function (element) {\n    },\n    _onLeft: function (element) {\n        var newFocus = element;\n        var $list = $(element).closest('ul,ol');\n        if ($list.hasClass('horizontal')) {\n            var $newFocus = $(element).prev('li');\n            if ($newFocus.length === 0) {\n                if ($list.attr('js-stdnav-wrap') === 'wrap') {\n                    var $items = $list.children('li');\n                    if ($items.length > 0) {\n                        newFocus = $items[$items.length - 1];\n                    }\n                } else {\n                    newFocus = $list.find('li').last()[0];\n                }\n            } else {\n                newFocus = $newFocus[0];\n            }\n        }\n        return newFocus;\n    },\n    _onRight: function (element) {\n        var newFocus = element;\n        var $list = $(element).closest('ul,ol');\n        if ($list.hasClass('horizontal')) {\n            var $newFocus = $(element).next('li');\n            if ($newFocus.length === 0) {\n                if ($list.attr('js-stdnav-wrap') === 'wrap') {\n                    var $items = $list.children('li');\n                    if ($items.length > 0) {\n                        newFocus = $items[0];\n                    }\n                } else {\n                    newFocus = $list.find('li').first()[0];\n                }\n            } else {\n                newFocus = $newFocus[0];\n            }\n        }\n        return newFocus;\n    },\n    _onUp: function (element) {\n        var newFocus = element;\n        var $list = $(element).closest('ul,ol');\n        if (!$list.hasClass('horizontal')) {\n            var $newFocus = $(element).prev('li');\n            if ($newFocus.length === 0) {\n                if ($list.attr('js-stdnav-wrap') == 'wrap') {\n                    var $items = $list.children('li');\n                    if ($items.length > 0) {\n                        newFocus = $items[$items.length - 1];\n                    }\n                }\n            } else {\n                newFocus = $newFocus[0];\n            }\n        }\n        return newFocus;\n    },\n    _onDown: function (element) {\n        var newFocus = element;\n        var $list = $(element).closest('ul,ol');\n        if (!$list.hasClass('horizontal')) {\n            var $newFocus = $(element).next('li');\n            if ($newFocus.length === 0) {\n                if ($list.attr('js-stdnav-wrap') == 'wrap') {\n                    var $items = $list.children('li');\n                    if ($items.length > 0) {\n                        newFocus = $items[0];\n                    }\n                }\n            } else {\n                newFocus = $newFocus[0];\n            }\n        }\n        return newFocus;\n    }\n});\n$.extend(stdnavPluginList.prototype, {\n    navtype: 'list',\n    navtype_tags: [\n        'UL',\n        'OL'\n    ]\n});\nvar newStdnavPluginList = new stdnavPluginList();\nexport default newStdnavPluginList;","/*\n * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport jQuery from 'jquery';\nimport log from \"../../logging/logger\";\nimport stdnav from '../stdnav';\nimport {DIALOG_REFERENCE_ATTRIBUTE} from '../stdnavModalFocusing';\n\nconst logger = log.register(\"stdnav\");\n\nconst stdnavPluginModalTrap = function () {\n};\n\njQuery.extend(stdnavPluginModalTrap.prototype, {\n    // Registers the 'button' navtype with stdnav.  stdnav must be loaded and\n    // activated before this can be done.\n    activate: function () {\n        // This is the behaviour hash for the navtype.  These defaults pass\n        // everything through to the browser, and are normally overridden\n        // with jQuery.extend based on specific tagnames and stdnav attributes.\n        this.behavior = {\n            'fixfocus': [this, this._fixFocus, null]\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n\n    // Unregisters navtype from stdnav.  This must be done\n    // before deactivating/unloading stdnav.\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this.behavior);\n    },\n\n    /* ========== NAVTYPE BEHAVIOR CALLBACKS =========== */\n\n    _fixFocus: function (element) {\n        const $el = jQuery(element);\n        const currentModalDialogRoot = stdnav.modalDialogRoots[$el.attr(DIALOG_REFERENCE_ATTRIBUTE)];\n        if (!currentModalDialogRoot) {\n            logger.error('Modal Trap element exists while there is no opened dialog');\n            return element;\n        }\n\n        let modalFocusableElement;\n        if ($el.prev().is(currentModalDialogRoot)) {\n            modalFocusableElement = stdnav.getFirstFocusableElement(currentModalDialogRoot)\n        } else if ($el.next().is(currentModalDialogRoot)) {\n            modalFocusableElement = stdnav.getLastFocusableElement(currentModalDialogRoot)\n        }\n\n        if (!modalFocusableElement) {\n            logger.error('Modal dialog does not contain any focusable element');\n            return element;\n        }\n\n        return modalFocusableElement;\n    }\n});\n\n// SECOND EXTENSION PASS - ATTRIBUTES\n// Hash members in this pass can reference functions from the last pass.\njQuery.extend(stdnavPluginModalTrap.prototype, {\n    // This is the name of the new navtype.  Each stdnav plugin must\n    // define a unique name.\n    navtype: 'modalTrap',\n\n    // This arrary extends the tag-to-navtype map in stdnav.  If your\n    // plugin should apply to all elements of a given type, add those\n    // element tagnames, in lower case, to this array.  It is normally\n    // empty, and the page templates simply set an appropriate\n    // \"data-navtype=\" attribute to get the expected behavior.\n    //\n    // CASE SENSITIVE - USE UPPER-CASE!\n    navtype_tags: []\n});\nvar newStdnavPluginModalTrap = new stdnavPluginModalTrap();\nexport default newStdnavPluginModalTrap;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport logger from \"../../logging/logger\";\nimport stdnav from '../stdnav';\n\nlet localLogger = logger.register(\"stdnavPluginTable\");\n\nvar version = '0.0.1';\nvar singleton = null;\nvar gserial = 0;\nvar stdnavPluginTable = function () {\n    gserial++;\n    this.serial = gserial;\n};\n$.extend(stdnavPluginTable.prototype, {\n    zinit: function (selector) {\n        localLogger.debug('stdnavPluginTable.init(' + selector + ')\\n');\n        return this;\n    },\n    activate: function () {\n        this.behavior = {\n            'ariaprep': [\n                this,\n                this._ariaPrep,\n                null\n            ],\n            'ariarefresh': [\n                this,\n                this._ariaRefresh,\n                null\n            ],\n            'down': [\n                this,\n                this._onDown,\n                null\n            ],\n            'fixfocus': [\n                this,\n                this._fixFocus,\n                null\n            ],\n            'fixsuperfocus': [\n                this,\n                this._fixSuperfocus,\n                null\n            ],\n            'inherit': true,\n            'inheritable': true,\n            'left': [\n                this,\n                this._onLeft,\n                null\n            ],\n            'mousedown': [\n                stdnav,\n                stdnav.basicMouseDown\n            ],\n            'right': [\n                this,\n                this._onRight,\n                null\n            ],\n            'up': [\n                this,\n                this._onUp,\n                null\n            ],\n            'superfocusin': [\n                stdnav,\n                stdnav.basicSuperfocusIn,\n                {\n                    'maxdepth': 4,\n                    'focusSelector': 'td',\n                    'ghostfocus': false\n                }\n            ],\n            'superfocusout': [\n                stdnav,\n                stdnav.basicSuperfocusOut,\n                { 'ghostfocus': false }\n            ]\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n    deactivate: function () {\n        stdnav.unregisterNavtype(this.navtype, this.behavior);\n    },\n    _ariaPrep: function (el) {\n        this._ariaRefresh(el);\n    },\n    _ariaRefresh: function (el) {\n        var $table = $(el);\n        $table.attr('role', 'application');\n        var label = $table.attr('aria-label');\n        var labelledBy = $table.attr('aria-labelledby');\n        var $items = $table.find('td,th');\n        if (stdnav.nullOrUndefined(label) && stdnav.nullOrUndefined(labelledBy)) {\n            var allLinks = $items.find('a');\n            if (allLinks.length === $items.length) {\n                $table.attr('aria-label', 'Table of ' + $items.length + ' links.');\n            } else {\n                $table.attr('aria-label', 'Table of ' + $items.length + ' cells.');\n            }\n        }\n        $.each($items, function (index, item) {\n            var $item = $(item);\n            var $itemLinks = $item.find('a');\n            if ($itemLinks.length > 0) {\n                $item.attr('role', 'link');\n                var itemLabel = $item.attr('aria-label');\n                var itemLabelledBy = $item.attr('aria-labelledby');\n                if (stdnav.nullOrUndefined(itemLabel) && stdnav.nullOrUndefined(itemLabelledBy)) {\n                    var itemText = $item.text();\n                    itemLabel = itemText;\n                    $item.attr('aria-label', itemLabel);\n                }\n            }\n        });\n        return null;\n    },\n    _findSubfocus: function (el) {\n        var table = $(el).closest('table');\n        var sfels = table.find('.subfocus');\n        if (sfels !== undefined) {\n            return $(sfels[0]);\n        }\n    },\n    _getPreviousSection: function (element) {\n        var thisSection = $(element).closest('thead,tbody,tfoot');\n        var prevSection;\n        if (thisSection === undefined) {\n            return undefined;\n        }\n        switch (thisSection.prop('nodeType')) {\n        case 'TFOOT':\n            prevSection = thisSection.parent().children('TBODY');\n            break;\n        case 'TBODY':\n            prevSection = thisSection.parent().children('THEAD');\n            break;\n        case 'THEAD':\n            break;\n        default:\n        }\n        if (prevSection !== undefined && prevSection.length > 0) {\n            return prevSection[0];\n        }\n        return undefined;\n    },\n    _getNextSection: function (element) {\n        var thisSection = $(element).closest('thead,tbody,tfoot');\n        var nextSection;\n        if (thisSection === undefined) {\n            return undefined;\n        }\n        switch (thisSection.prop('nodeType')) {\n        case 'THEAD':\n            nextSection = thisSection.parent().children('TBODY');\n            break;\n        case 'TBODY':\n            nextSection = thisSection.parent().children('TFOOT');\n            break;\n        case 'TFOOT':\n            break;\n        default:\n        }\n        if (nextSection !== undefined && nextSection.length > 0) {\n            return nextSection[0];\n        }\n        return undefined;\n    },\n    _fixSuperfocus: function (element) {\n        var newSuperfocus;\n        var $closestTable = $(element).closest('table');\n        if ($closestTable.length > 0) {\n            newSuperfocus = $closestTable[0];\n        } else {\n            newSuperfocus = null;\n        }\n        return newSuperfocus;\n    },\n    _fixFocus: function (element) {\n        var newFocus;\n        switch ($(element).prop('nodeName')) {\n        case 'TH':\n        case 'TD':\n            newFocus = element;\n            break;\n        case 'TR':\n            newFocus = stdnav.closestDescendant(element, 'td,th .ghostfocus', null, 1);\n            if (newFocus === undefined) {\n                newFocus = stdnav.closestDescendant(element, 'td,th', null, 1);\n                if (newFocus === undefined) {\n                    newFocus = $(element).prev('tr');\n                    if (newFocus === undefined) {\n                        newFocus = this._fixFocus($(element).parent());\n                    }\n                }\n            }\n            break;\n        case 'THEAD':\n        case 'TBODY':\n        case 'TFOOT':\n            newFocus = stdnav.closestDescendant(element, 'td,th .ghostfocus', null, 2);\n            if (newFocus === undefined) {\n                newFocus = stdnav.closestDescendant(element, 'td,th', null, 2);\n                if (newFocus === undefined) {\n                    var nextSection = this._getNextSection(element);\n                    if (nextSection === undefined) {\n                        newFocus = this._fixFocus($(element).closest('table'));\n                    } else {\n                        newFocus = this._fixFocus(nextSection);\n                    }\n                }\n            }\n            break;\n        case 'COLGROUP':\n        case 'COL':\n            newFocus = this._fixFocus($(element).closest('table'));\n            break;\n        case 'CAPTION':\n            newFocus = this._fixFocus($(element).closest('table'));\n            break;\n        case 'TABLE':\n            newFocus = stdnav.closestDescendant(element, 'td,th .ghostfocus', null, 5);\n            if (newFocus === undefined) {\n                newFocus = stdnav.closestDescendant(element, 'td,th', null, 5);\n                if (newFocus === undefined) {\n                    newFocus = element;\n                }\n            }\n            break;\n        default:\n            newFocus = this._fixFocus($(element).closest('td,th,table'));\n        }\n        return newFocus;\n    },\n    _onSubfocusIn: function (element) {\n        var fixedSubfocus = element;\n        if ($(element).is('td') === false) {\n            fixedSubfocus = this._fixSubfocus($(element));\n            stdnav.setSubfocus(fixedSubfocus, false);\n        }\n        $.call(this, stdnav.basicSubfocusIn, fixedSubfocus);\n    },\n    _onLeft: function (element) {\n        var sfel = this._findSubfocus(element);\n        var newsf = $(false);\n        if (sfel.is('td')) {\n            newsf = sfel.prev('td');\n        }\n        if (newsf.length === 1) {\n            return newsf;\n        }\n        return element;\n    },\n    _onRight: function (element) {\n        var sfel = this._findSubfocus(element);\n        var newsf = $(false);\n        if (sfel.is('td')) {\n            newsf = sfel.next('td');\n        }\n        if (newsf.length === 1) {\n            return newsf;\n        }\n        return element;\n    },\n    _onUp: function (element) {\n        var sfel = this._findSubfocus(element);\n        var row;\n        var newrow = $(false);\n        var newsf = $(false);\n        if (sfel.is('td')) {\n            row = sfel.closest('tr');\n            if (row.length === 1) {\n                newrow = row.prev('tr');\n            }\n            if (newrow.length == 1) {\n                var iter = sfel;\n                var col = -1;\n                do {\n                    col++;\n                    iter = $(iter.prev('td')[0]);\n                } while (iter.length > 0);\n                newsf = $(newrow.find('td')[0]);\n                while (col > 0) {\n                    iter = newsf.next('td');\n                    if (iter.length > 0) {\n                        newsf = $(iter[0]);\n                    }\n                    col--;\n                }\n            }\n        }\n        if (newsf.length === 1) {\n            return newsf;\n        }\n        return element;\n    },\n    _onDown: function (element) {\n        var sfel = this._findSubfocus(element);\n        var row;\n        var newrow = $(false);\n        var newsf = $(false);\n        if (sfel.is('td')) {\n            row = sfel.closest('tr');\n            if (row.length > 0) {\n                newrow = row.next('tr');\n            }\n            if (newrow.length > 0) {\n                var iter = sfel;\n                var col = -1;\n                do {\n                    col++;\n                    iter = $(iter.prev('td')[0]);\n                } while (iter.length > 0);\n                newsf = $(newrow.find('td')[0]);\n                while (col > 0) {\n                    iter = newsf.next('td');\n                    if (iter.length > 0) {\n                        newsf = $(iter[0]);\n                    }\n                    col--;\n                }\n            }\n        }\n        if (newsf.length === 1) {\n            return newsf;\n        }\n        return element;\n    }\n});\n$.extend(stdnavPluginTable.prototype, {\n    navtype: 'table',\n    navtype_tags: ['TABLE']\n});\nvar newStdnavPluginTable = new stdnavPluginTable();\nexport default newStdnavPluginTable;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport logger from \"../../logging/logger\";\nimport stdnav from '../stdnav';\n\n\nlet localLogger = logger.register(\"stdnavPluginWorkflowCard\");\nlet version = '0.0.1';\nlet singleton = null;\nlet gserial = 0;\n\nlet StdnavPluginWorkflowCard = function StdnavPluginWorkflowCard() {\n    gserial++;\n    this.serial = gserial;\n};\n\n$.extend(StdnavPluginWorkflowCard.prototype, {\n    zinit: function zinit(selector) {\n        localLogger.debug('stdnavPluginWorkflowCard.init(' + selector + ')\\n');\n        return this;\n    },\n    activate: function activate() {\n        this.behavior = {\n            'ariaprep': [this, this._ariaPrep, null],\n            'ariarefresh': [this, this._ariaRefresh, null],\n            'right': [this, this._onRight, null],\n            'left': [this, this._onLeft, null],\n            'up': [this, this._onUp, null],\n            'down': [this, this._onDown, null],\n            'home': [this, this._onHome, null],\n            'end': [this, this._onEnd, null],\n            'toggle': [this, this._onEnterOrToggle, null],\n            'enter': [this, this._onEnterOrToggle, null],\n            'exit': [this, this._onExit, null],\n            'fixfocus': [this, this._fixFocus, null],\n            'fixsuperfocus': [this, this._fixSuperfocus, null],\n            'click': [this, this._onClick, null],\n            'inherit': true,\n            'inheritable': true\n        };\n        stdnav.registerNavtype(this.navtype, this.behavior, this.navtype_tags);\n    },\n    deactivate: function deactivate() {\n        stdnav.unregisterNavtype('list2', this.behavior);\n    },\n    _ariaPrep: function _ariaPrep(el) {\n        this._ariaRefresh(el);\n    },\n    _ariaRefresh: function _ariaRefresh() {\n        return null;\n    },\n    _fixFocus: function _fixFocus(element) {\n        let $el = $(element);\n\n        if ($el.is(\"ul\")) {\n            element = $el.find(\"li\").eq(0)[0];\n        }\n\n        return element;\n    },\n    _fixSuperfocus: function _fixSuperfocus(element) {\n        let newSuperfocus;\n        let $closestList = $(element).parents('ul').last();\n\n        if ($closestList.length > 0) {\n            newSuperfocus = $closestList[0];\n        } else {\n            newSuperfocus = null;\n        }\n        return newSuperfocus;\n    },\n    _onClick: function _onClick(element) {\n        const $el = $(element);\n        const isButtonOrChild = $el.closest('button').length > 0;\n        const isMainUl = $el.prop('nodeName') === 'UL' && $el.attr('role') === 'menubar';\n        const isLiMenuItem = $el.prop('nodeName') === 'LI' && $el.attr('role') === 'menuitem';\n\n        if (isLiMenuItem) {\n            stdnav.forceFocus($el);\n        } else if (!(isButtonOrChild || isMainUl)) {\n            stdnav.forceFocus($el.parents('li').last());\n        }\n    },\n    _navigationCallbackHandler: function _navigationCallbackHandler(element, listCallback, buttonCallback) {\n        const currentFocus = $(element).closest('li,button');\n\n        if (currentFocus.prop('nodeName') === 'LI') {\n            return listCallback();\n        } else if (currentFocus.prop('nodeName') === 'BUTTON') {\n            return buttonCallback();\n        }\n        return null;\n    },\n    _onLeft: function _onLeft(element) {\n        let currentPosition, newPosition, newSelectedButton;\n        const visibleButtonList = $(element).closest('ul').find('button:visible');\n\n        if (visibleButtonList.first().hasClass('subfocus')) {\n            return visibleButtonList.last();\n        }\n        currentPosition = $('li button').index($('button.subfocus'));\n        newPosition = currentPosition - 1;\n        newSelectedButton = $('li button').eq(newPosition);\n        return newPosition >= 0 && newSelectedButton[0];\n    },\n    _onRight: function _onRight(element) {\n        const listCallback = () => {\n            const visibleButtonList = $(element).closest('li').find('button:visible');\n            return visibleButtonList.first();\n        }\n        const buttonCallback = () => {\n            let currentPosition, newPosition, newSelectedButton;\n            const visibleButtonList = $(element).closest('ul').find('button:visible');\n\n            if (visibleButtonList.last().hasClass('subfocus')) {\n                return visibleButtonList.first();\n            }\n            currentPosition = $('li button').index($('button.subfocus'));\n            newPosition = currentPosition + 1;\n            newSelectedButton = $('li button').eq(newPosition);\n            return newSelectedButton.length && newSelectedButton[0];\n        }\n        return this._navigationCallbackHandler(element, listCallback, buttonCallback);\n    },\n    _onUp: function _onUp(element) {\n        const listCallback = () => {\n            const closestLi = $(element).closest('li');\n            const liList = closestLi.parent().children('li');\n            const previousItem = closestLi.prev();\n\n            if (liList.length <= 1) {\n                return null;\n            }\n            return previousItem.length ? previousItem : liList.last();\n        }\n        const buttonCallback = () => {\n            const closestLiParent = $(element).closest('ul').parent();\n            const liParentList = closestLiParent.parent().children('li');\n            const previousItem = closestLiParent.prev();\n\n            if (liParentList.length <= 1) {\n                return null;\n            }\n            return previousItem.length ? previousItem : liParentList.last();\n        }\n        return this._navigationCallbackHandler(element, listCallback, buttonCallback);\n    },\n    _onDown: function _onDown(element) {\n        const listCallback = () => {\n            const closestLi = $(element).closest('li');\n            const liList = closestLi.parent().children('li');\n            const nextItem = closestLi.next();\n\n            if (liList.length <= 1) {\n                return null;\n            }\n            return nextItem.length ? nextItem : liList.first();\n        }\n        const buttonCallback = () => {\n            const closestLiParent = $(element).closest('ul').parent();\n            const liParentList = closestLiParent.parent().children('li');\n            const nextItem = closestLiParent.next();\n\n            if (liParentList.length <= 1) {\n                return null;\n            }\n            return nextItem.length ? nextItem : liParentList.first();\n        }\n        return this._navigationCallbackHandler(element, listCallback, buttonCallback);\n    },\n    _onHome: function _onHome(element) {\n        const listCallback = () => {\n            const liList = $(element).closest('li').parent().children('li');\n            return liList.first();\n        }\n        const buttonCallback = () => {\n            const visibleButtonList = $(element).closest('ul').find('button:visible');\n            return visibleButtonList.first();\n        }\n        return this._navigationCallbackHandler(element, listCallback, buttonCallback);\n    },\n    _onEnd: function _onEnd(element) {\n        const listCallback = () => {\n            const liList = $(element).closest('li').parent().children('li');\n            return liList.last();\n        }\n        const buttonCallback = () => {\n            const visibleButtonList = $(element).closest('ul').find('button:visible');\n            return visibleButtonList.last();\n        }\n        return this._navigationCallbackHandler(element, listCallback, buttonCallback);\n    },\n    _onEnterOrToggle: function _onEnterOrToggle(element) {\n        const $el = $(element);\n        if ($el.prop('nodeName') === 'LI' && $el.attr('role') === 'menuitem') {\n            return $el.find('button:visible').first();\n        }\n        return null;\n    },\n    _onExit: function _onExit(element) {\n        const $el = $(element);\n        if ($el.prop('nodeName') === 'BUTTON') {\n            return $el.closest('ul').parent();\n        }\n        return null;\n    }\n});\n$.extend(StdnavPluginWorkflowCard.prototype, {\n    navtype: 'workflowCard',\n    navtype_tags: ['li', 'button']\n});\n\nlet stdnavPluginWorkflowCard = new StdnavPluginWorkflowCard();\nexport default stdnavPluginWorkflowCard;\n\n","export enum AriaProps {\n    ActiveDescendant = 'aria-activedescendant',\n    Atomic = 'aria-atomic',\n    AutoComplete = 'aria-autocomplete',\n    Busy = 'aria-busy', //  (state)\n    Checked = 'aria-checked', //  (state)\n    Controls = 'aria-controls',\n    DescribedBy = 'aria-describedby',\n    Disabled = 'aria-disabled', //  (state)\n    DropEffect = 'aria-dropeffect',\n    Expanded = 'aria-expanded', //  (state)\n    FlowTo = 'aria-flowto',\n    Grabbed = 'aria-grabbed', //  (state)\n    HasPopup = 'aria-haspopup',\n    Hidden = 'aria-hidden', //  (state)\n    Invalid = 'aria-invalid', //  (state)\n    Label = 'aria-label',\n    LabelledBy = 'aria-labelledby',\n    Level = 'aria-level',\n    Live = 'aria-live',\n    MultiLine = 'aria-multiline',\n    MultiSelectable = 'aria-multiselectable',\n    Orientation = 'aria-orientation',\n    Owns = 'aria-owns',\n    PosInSet = 'aria-posinset',\n    Pressed = 'aria-pressed', //  (state)\n    ReadOnly = 'aria-readonly',\n    Relevant = 'aria-relevant',\n    Required = 'aria-required',\n    Selected = 'aria-selected', //  (state)\n    SetSize = 'aria-setsize',\n    Sort = 'aria-sort',\n    ValueMax = 'aria-valuemax',\n    ValueMin = 'aria-valuemin',\n    ValueNow = 'aria-valuenow',\n    ValueText = 'aria-valuetext',\n}\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport browserDetection from './browserDetection';\nimport $ from 'jquery';\nexport default {\n    mouseEventOptions: {\n        bubbles: true,\n        cancelable: true,\n        view: document.defaultView,\n        detail: 0,\n        screenX: 0,\n        screenY: 0,\n        clientX: 0,\n        clientY: 0,\n        ctrlKey: false,\n        altKey: false,\n        shiftKey: false,\n        metaKey: false,\n        button: 0,\n        relatedTarget: null,\n        srcElement: null\n    },\n    triggerNativeEvent: function (eventName, target, options) {\n        var ie = browserDetection.isIE(), ev;\n        target = target || (ie ? document.documentElement : window);\n        if (document.createEvent) {\n            var opts;\n            switch (eventName) {\n            case 'click':\n            case 'doubleclick':\n            case 'mousedown':\n            case 'mousemove':\n            case 'mouseout':\n            case 'mouseover':\n            case 'mouseup':\n                opts = $.extend({}, this.mouseEventOptions, options);\n                opts.srcElement = target;\n                if (typeof MouseEvent === 'function') {\n                    ev = new MouseEvent(eventName, opts);\n                } else {\n                    ev = document.createEvent('MouseEvents');\n                    ev.initMouseEvent(eventName, opts.bubbles, opts.cancelable, opts.view, opts.detail, opts.screenX, opts.screenY, opts.clientX, opts.clientY, opts.ctrlKey, opts.altKey, opts.shiftKey, opts.metaKey, opts.button, opts.relatedTarget);\n                }\n                break;\n            default:\n                opts = $.extend({}, this.eventOptions, options);\n                opts.srcElement = target;\n                ev = document.createEvent('HTMLEvents');\n                ev.initEvent(eventName, opts.bubble, opts.cancelable);\n            }\n            target.dispatchEvent(ev);\n        } else {\n            ev = document.createEventObject();\n            ev.srcElement = target;\n            if (eventName == 'click' && typeof target.click !== 'undefined') {\n                target.click();\n            } else {\n                target.fireEvent('on' + eventName, ev);\n            }\n        }\n    },\n    simulateClickSequence: function (element) {\n        this.triggerNativeEvent('mousedown', element);\n        this.triggerNativeEvent('mouseup', element);\n        this.triggerNativeEvent('click', element);\n    },\n    simulateDoubleClickSequence: function (element) {\n        this.triggerNativeEvent('mousedown', element);\n        this.triggerNativeEvent('mouseup', element);\n        this.triggerNativeEvent('click', element);\n        this.triggerNativeEvent('mousedown', element);\n        this.triggerNativeEvent('mouseup', element);\n        this.triggerNativeEvent('click', element);\n        this.triggerNativeEvent('dblclick', element);\n    }\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n* @author: Igor Nesterenko\n* @version: $Id$\n*/\n\nimport Backbone from 'backbone';\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport popupContainerTemplate from './template/dateTimePopupContainer.htm';\n\nimport logger from \"../../common/logging/logger\";\n\nimport \"../../common/extension/jQueryTimepickerExtension\";\n\nvar DATE_TIME_DEFAULTS = {\n        stepHour: 1,\n        stepMinute: 1,\n        stepSecond: 1,\n        showSecond: true,\n        changeMonth: true,\n        changeYear: true,\n        showButtonPanel: true,\n        onChangeMonthYear: null,\n        constrainInput: false\n    },\n    TIME_DEFAULTS = {\n        showSecond:true,\n        constrainInput:false\n    };\n\nlet log = logger.register(\"DateAndTimePicker\");\n\n$.timepicker.log = function (err) {\n    //redirect error messages to our logger\n    log.warn(err);\n};\n\nexport default Backbone.View.extend({\n\n    /**\n     * @constructor DateAndTimePicker\n     * @class DateAndTimePicker\n     * @classdesc DateAndTimePicker decorator over jQuery datetime pickers\n     * @extends Backbone.View\n     * @param {object} options - mixin on Backbone standard properties and jQuery datetime pickers\n     * @description - You have to pass 'el' property to point to element in DOM. We have next behaviour\n     *  - by default it renders with  datetimepicker\n     *  - if only `dateFormat` it renders with datepicker\n     *  - if only `timeFormat` it renders with  timepicker\n     *  - if `dateFormat` and `timeFormat` specified it renders with datetimepicker\n     */\n\n    constructor: function (options) {\n        this.pickerOptions = _.clone(options);\n\n        if (this.pickerOptions.hasOwnProperty(\"dateFormat\") && !_.isString(this.pickerOptions.dateFormat)) {\n            delete this.pickerOptions.dateFormat;\n        }\n        if (this.pickerOptions.hasOwnProperty(\"timeFormat\") && !_.isString(this.pickerOptions.timeFormat)) {\n            delete this.pickerOptions.timeFormat;\n        }\n\n        this.inline = !!this.pickerOptions.el || false;\n        this.skipMoving = this.pickerOptions.skipMoving || false;\n        //clean up from backbone props\n        delete this.pickerOptions.el;\n        delete this.pickerOptions.skipMoving;\n\n        this.pickerType = discoverPickerType(this.pickerOptions);\n\n        this.pickerOptions = provideDefaultPickerOptions(this.pickerOptions, this.pickerType);\n\n        this.pickerOptions = fixPopupPositionAndStyling(this.pickerOptions, this.skipMoving);\n\n        this.log = options.log ? options.log : log;\n\n        Backbone.View.apply(this, arguments);\n    },\n\n    initialize: function () {\n        var self = this;\n\n        //initialize picker\n        this.$el[this.pickerType](this.pickerOptions);\n\n        this._callPickerAction = function (options) {\n            self.$el[self.pickerType](options);\n        }\n    },\n\n    /**\n     * @return {Date} - standart date object\n     * @description Return Date if components has it\n     */\n\n    getDate: function(){\n        var date;\n\n        if (this.pickerType !== \"timepicker\"){\n            date = this.$el[this.pickerType].getDate();\n        }else{\n            date = this.$el[this.pickerType].getTime();\n        }\n        return date;\n    },\n\n    /**\n     * @params {Date|String} date\n     * @return this\n     */\n\n    setDate: function(date){\n\n        if (!date) return this;\n\n        try{\n            //try to convert string to date object\n            // we don't need to convert time because setTime method accepts string time format\n            if (_.isString(date)){\n                if (this.pickerType === \"datetimepicker\") {\n                    date = $.datepicker.parseDateTime(this.pickerOptions.dateFormat, this.pickerOptions.timeFormat,  date);\n                } else if (this.pickerType === \"datepicker\") {\n                    date = $.datepicker.parseDate(this.pickerOptions.dateFormat, date);\n                }\n            }\n\n            if (this.pickerType === \"datepicker\"){\n                this.$el[this.pickerType](\"setDate\", date);\n            }else if (this.pickerType === \"timepicker\") {\n                this.$el[this.pickerType](\"setTime\", date);\n            }else if (this.pickerType === \"datetimepicker\"){\n                this.$el[this.pickerType](\"setTime\", date);\n                this.$el[this.pickerType](\"setDate\", date);\n            }\n\n        }catch(err){\n            this.log.debug(err);\n        }\n        return this;\n    },\n\n    /**\n     * @description Show picker\n     */\n\n    show: function () {\n        this._callPickerAction(\"show\");\n        return this;\n    },\n\n    /**\n     * @description Hide picker\n     */\n\n    hide: function () {\n        this._callPickerAction(\"hide\");\n        return this;\n    },\n\n    remove: function () {\n        this._callPickerAction(\"destroy\");\n        if (this.inline) {\n            this.$el.empty().off();\n            this.stopListening();\n        } else {\n            Backbone.View.prototype.remove.apply(this, arguments);\n        }\n\n    }\n\n}, {\n\n    /**\n     * @param {object} configs - which should contains 'locale', configs for 'date' amd configs for 'time'\n     * @description Provide defaults for locale specific configuration\n     */\n\n    setDefaults : function(configs){\n        $.datepicker.regional[configs.locale] = configs.date;\n        $.datepicker.setDefaults(configs.date);\n        $.timepicker.setDefaults(configs.time);\n    },\n\n    Helpers : {\n\n        fixPopupPositionAndStyling: fixPopupPositionAndStyling,\n\n        movePickerRelativelyToTriggerIcon: movePickerRelativelyToTriggerIcon,\n\n        stylePopupContainer: stylePopupContainer,\n\n        discoverPickerType: discoverPickerType,\n\n        provideDefaultPickerOptions: provideDefaultPickerOptions\n    }\n});\n\nfunction discoverPickerType(options) {\n    var result = \"datetimepicker\";\n    if (options.dateFormat && options.timeFormat) {\n        return result;\n    } else if (options.dateFormat) {\n        result = \"datepicker\"\n    } else if (options.timeFormat) {\n        result = \"timepicker\"\n    }\n    return result;\n}\n\nfunction provideDefaultPickerOptions(options, type){\n\n    var result = options;\n\n    if (\"datetimepicker\" == type || \"datepicker\" == type){\n        result = _.defaults(options, DATE_TIME_DEFAULTS);\n    }else if(\"timepicker\" == type){\n        result = _.defaults(options, TIME_DEFAULTS)\n    }\n\n    return result;\n}\n\nfunction fixPopupPositionAndStyling(options, skipMoving) {\n\n    var originalBeforeShowFn = options.beforeShow;\n\n    options.beforeShow = function () {\n        stylePopupContainer.apply(this, arguments);\n        skipMoving || movePickerRelativelyToTriggerIcon.apply(this, arguments);\n        originalBeforeShowFn && originalBeforeShowFn.apply(this, arguments);\n    };\n\n    options.afterInject = function() {\n        stylePopupContainer.apply(this, [this.$input[0], this.inst]);\n    };\n\n    return options;\n}\n\nfunction movePickerRelativelyToTriggerIcon(input, inst) {\n    var offset = $(input).offset().left;\n    var width = parseFloat(inst.dpDiv.css(\"width\").replace(\"px\", \"\"));\n    var move = offset + input.offsetWidth + width < $(window).width();\n    inst.dpDiv.css({\n        marginLeft: move ? input.offsetWidth + \"px\" : 0\n    });\n}\n\nfunction stylePopupContainer(input, inst) {\n    var $popupContainer = inst.dpDiv,\n        $parent = $popupContainer.parent(),\n        $dpDiv;\n\n    if ($parent && $parent.is('body')) {\n        $dpDiv = $popupContainer.detach();\n        $popupContainer = $(popupContainerTemplate);\n        $popupContainer.append($dpDiv);\n        $('body').append($popupContainer);\n    }\n}\n","export default \"<div class=\\\"jr-jDatepickerPopupContainer jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\\n\";","\n        import settingsStore from 'settingsStore';\n        settingsStore['dateTimeSettings'] = settingsStore['dateTimeSettings'] || {};\n        export default settingsStore['dateTimeSettings'];\n    "],"sourceRoot":""}