(self.webpackChunkjrs_ui=self.webpackChunkjrs_ui||[]).push([[459],{32608:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var r=n(15892),o=n.n(r),i=n(72157),a=n.n(i),s=n(77684),l=n(62287).Z.register("BaseJiveComponentView");const c=o().View.extend({initialize:function(e){this.stateModel=e.stateModel,this.report=e.report,l.debug("Create jive view",this),o().View.prototype.initialize.apply(this,arguments)},getReportId:function(){return this.report&&this.report.id},setDataReportId:function(e,t){e.attr("data-reportId",t)},getReportContainer:function(e){return a()("[data-reportId = '"+e+"']")},scale:function(e){this.model.set("scaleFactor",e)},render:function(e){var t=new(a().Deferred);return t.resolve(),t},detachEvents:function(){},remove:function(){this.detachEvents(),o().View.prototype.remove.apply(this,arguments)},_applyScaleTransform:function(e,t){var n="scale("+t+")",r="0 0",o={"-webkit-transform":n,"-webkit-transform-origin":r,"-moz-transform":n,"-moz-transform-origin":r,"-ms-transform":n,"-ms-transform-origin":r,"-o-transform":n,"-o-transform-origin":r,transform:n,"transform-origin":r};s.Z.isIE8()&&(o.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+t+", M12=0, M21=0, M22="+t+", SizingMethod='auto expand')"),e.css(o)}})},50459:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(32608),o=n(75964),i=0,a=function(){return"__async_req_".concat(i+=1,"__")};function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=n(62287).Z.register("GooglemapComponentView"),u=null,d=null,g=null;const f=r.Z.extend({render:function(e){this.$reportEl=e,this.infowindow=null,this._init()},_init:function(){var e=this,t=this.model.get("instanceData"),n=t.useMarkerClustering,r=t.useMarkerSpidering,o=t.requestParams||"";"&"===o[0]&&(o=o.substring(1));var i=this._getGoogleMapsLoadedPromise(o),a=this._getMarkerClustererLoadedPromise(n),s=this._getMarkerSpideringLoadedPromise(r);Promise.all([i,a,s]).then((function(){e._showMap(e.model.get("id"),t.latitude,t.longitude,t.zoom,t.mapType,t.markerList,t.pathsList,n,r,t.defaultMarkerIcon,t.legendProperties,t.resetMapProperties)})).catch((function(e){c.error(e)}))},_getGoogleMapsLoadedPromise:function(e){return new Promise((function(t,n){"undefined"==typeof google||void 0===google.maps?(u||(u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"callback";return new Promise((function(n,r){var i=a();window[i]=n;var s=new URL(e,window.location.href);s.searchParams.append(t,i),(0,o.v)(s.href,{scriptProps:{async:!0}}).catch(r)}))}("//maps.google.com/maps/api/js?".concat(e),"callback")),u.then(t).catch(n)):t()}))},_getMarkerClustererLoadedPromise:function(e){return new Promise((function(t,n){e&&"undefined"==typeof markerClusterer?(d||(d=(0,o.v)("https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js",{scriptProps:{async:!0}})),d.then(t).catch(n)):t()}))},_getMarkerSpideringLoadedPromise:function(e){return new Promise((function(t,n){e&&"undefined"==typeof OverlappingMarkerSpiderfier?(g||(g=(0,o.v)("https://cdnjs.cloudflare.com/ajax/libs/OverlappingMarkerSpiderfier/1.0.3/oms.min.js",{scriptProps:{async:!0}})),g.then(t).catch(n)):t()}))},_configureImage:function(e,t,n){var r,o,i,a,s,l,c=t,u=e;r=c[u+".width"]?parseInt(c[u+".width"]):null,o=c[u+".height"]?parseInt(c[u+".height"]):null,i=c[u+".origin.x"]?parseInt(c[u+".origin.x"]):0,a=c[u+".origin.y"]?parseInt(c[u+".origin.y"]):0,s=c[u+".anchor.x"]?parseInt(c[u+".anchor.x"]):0,l=c[u+".anchor.y"]?parseInt(c[u+".anchor.y"]):0,n[u]={url:c[u+".url"],size:r&&o?new google.maps.Size(r,o):null,origin:new google.maps.Point(i,a),anchor:new google.maps.Point(s,l)}},_createInfo:function(e){var t=e;if(t["infowindow.content"]&&t["infowindow.content"].length>0){var n=google.maps,r={content:t["infowindow.content"]};return t["infowindow.pixelOffset"]&&(r.pixelOffset=t["infowindow.pixelOffset"]),t["infowindow.latitude"]&&t["infowindow.longitude"]&&(r.position=new n.LatLng(t["infowindow.latitude"],t["infowindow.longitude"])),t["infowindow.maxWidth"]&&(r.maxWidth=t["infowindow.maxWidth"]),new n.InfoWindow(r)}return null},_placeMarkers:function(e,t,n,r){var o=[];if(e)for(var i,a=this,s=0;s<e.length;s++){var l=e[s],c={position:new google.maps.LatLng(l.latitude,l.longitude)};for(i in r||(c.map=t),l["icon.url"]&&l["icon.url"].length>0?this._configureImage("icon",l,c):l.icon&&l.icon.length>0?c.icon=l.icon:l.color&&l.color.length>0&&(c.icon="https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%7C"+l.color),l["shadow.url"]&&l["shadow.url"].length>0?this._configureImage("shadow",l,c):l.shadow&&l.shadow.length>0&&(c.shadow=l.shadow),l)i.indexOf(".")<0&&l.hasOwnProperty(i)&&!c.hasOwnProperty(i)&&(c[i]=l[i]);var u=new google.maps.Marker(c);if(!n){u.info=this._createInfo(l);var d=r?"spider_click":"click";google.maps.event.addListener(u,d,(function(){t.autocloseinfo&&a.infowindow&&a.infowindow.close(),this.info?(a.infowindow=this.info,this.info.open(t,this)):this.url&&this.url.length>0&&window.open(this.url,this.target)}))}o.push(u)}return o},_drawPaths:function(e,t,n){if(e)for(var r=0;r<e.length;r++){var o,i,a=e[r],s={},l=[],c=!1;for(i in a)if("locations"===i&&a[i])for(var u=a[i],d=0;d<u.length;d++){var g=u[d];l.push(new google.maps.LatLng(g.latitude,g.longitude))}else"isPolygon"===i?c=this._getBooleanValue(a[i]):s[i]="visible"===i||"editable"===i||"clickable"===i||"draggable"===i||"geodesic"===i?this._getBooleanValue(a[i]):a[i];s.map=t,c?(s.paths=l,o=new google.maps.Polygon(s)):(s.path=l,o=new google.maps.Polyline(s)),n||s["path.hyperlink"]&&google.maps.event.addListener(o,"click",(function(){window.open(this["path.hyperlink"],this["path.hyperlink.target"])}))}},_placeSeriesMarkers:function(e,t,n,r){var o,i,a,s=this._getObjectKeys(t),l={};for(o=0,i=s.length;o<i;o++){var c=t[a=s[o]],u=null!=c.markerSpidering?c.markerSpidering:r,d=null;null!=c.markerClustering&&(!0!==c.markerClustering&&"true"!==c.markerClustering||(d=!0),!1!==c.markerClustering&&"false"!==c.markerClustering||(d=!1)),l[a]={useMarkerSpidering:u,useMarkerClustering:d,legendIcon:c.legendIcon,googleMarkers:this._placeMarkers(c.markers,e,n,u)}}return l},_enableSpidering:function(e,t){var n,r,o,i=this._getObjectKeys(t),a=null;for(n=0;n<i.length;n++)if((o=t[i[n]]).useMarkerSpidering)for(null===a&&(a=new OverlappingMarkerSpiderfier(e,{markersWontMove:!0,markersWontHide:!0,basicFormatEvents:!0,keepSpiderfied:!0})),r=0;r<o.googleMarkers.length;r++)a.addMarker(o.googleMarkers[r]);return a},_enableClustering:function(e,t,n){var r,o,i,a,s=this._getObjectKeys(t),l={},c=[],u=[];for(r=0,o=s.length;r<o;r++)null===(a=t[i=s[r]]).useMarkerClustering&&n?(this._extendArray(c,a.googleMarkers),u.push(i)):a.useMarkerClustering&&(l[i]=new markerClusterer.MarkerClusterer({map:e,markers:a.googleMarkers}));if(c.length){var d=new markerClusterer.MarkerClusterer({map:e,markers:c});for(r=0,o=u.length;r<o;r++)l[i=u[r]]=d}return l},_drawLegend:function(e,t,n,r,o,i,a,s){var l,c,u,d,g,f,p,h,m,w,y,v,k,M,b,x,_,I,C,P,E=this;this._getBooleanValue(e.enabled)&&function(){var S=function(e,n){for(var r="show"===n?t:null,o=0;o<e.length;o++)e[o].setMap(r)};for(l=e.label||"Legend",c=e.position||"RIGHT_CENTER",u=e.orientation||"vertical",d=e.legendMaxWidth||"100px",g=e["legendMaxWidth.fullscreen"]||"150px",f=e.legendMaxHeight||"150px",p=e["legendMaxHeight.fullscreen"]||"300px",h=null==e.useMarkerIcons||E._getBooleanValue(e.useMarkerIcons),m=document.getElementById(n+"_legend"),(w=document.createElement("div")).style.display="flex",w.style.alignItems="center",(y=document.createElement("h3")).insertAdjacentText("beforeend",l),w.insertAdjacentElement("beforeend",y),m.insertAdjacentElement("beforeend",w),x=E._getObjectKeys(r),(_=document.createElement("div")).style.display="flex",k=0,M=x.length;k<M;k++)b=x[k],(v=document.createElement("button")).textContent=b,v.type="button",v.style.backgroundColor="#fff",v.style.border="2px solid #fff",v.style.fontFamily="Roboto,Arial,sans-serif",v.style.fontSize="12px",v.style.verticalAlign="top",v.style.cursor="pointer",function(e){v.addEventListener("click",(function(t){var n,a=r[e];if(null==a.action||"show"===a.action?a.action="hide":a.action="show",S(a.googleMarkers,a.action),o[e]&&("hide"===a.action?o[e].removeMarkers(a.googleMarkers,!1):o[e].addMarkers(a.googleMarkers,!1)),null!=i&&a.useMarkerSpidering)if("hide"===a.action)for(n=0;n<a.googleMarkers.length;n++)i.forgetMarker(a.googleMarkers[n]);else for(n=0;n<a.googleMarkers.length;n++)i.trackMarker(a.googleMarkers[n]);"hide"===a.action?t.currentTarget.style.color="#d8d8d8":t.currentTarget.style.color="#000"}))}(b),(I=document.createElement("div")).style.display="flex",I.style.alignItems="flex-start",h&&((C=r[b].legendIcon)||(C=r[b].googleMarkers[0].getIcon()),C||(C=a),C&&((P=document.createElement("img")).src=C,P.style.width="16px",P.style.marginBottom="5px",I.insertAdjacentElement("beforeend",P))),I.insertAdjacentElement("beforeend",v),_.insertAdjacentElement("beforeend",I);"horizontal"===u?(w.style.marginRight="20px",m.style.flexDirection="row",_.style.flexDirection="row",_.style.alignItems="center"):(w.style.marginRight="0",m.style.flexDirection="column",_.style.flexDirection="column",_.style.alignItems="flex-start"),-1!==c.indexOf("BOTTOM")?m.style.marginBottom="24px":m.style.marginBottom="10px",_.style.overflow="auto",m.insertAdjacentElement("beforeend",_),m.style.maxWidth=d,m.style.maxHeight=f,!s&&google.maps.event.addListener(t,"bounds_changed",(function(){t.getDiv().firstChild.clientHeight===window.innerHeight?(m.style.maxWidth=g,m.style.maxHeight=p):(m.style.maxWidth=d,m.style.maxHeight=f)})),t.controls[google.maps.ControlPosition[c]].push(m)}()},_drawResetMap:function(e,t,n,r,o){if(this._getBooleanValue(e.enabled)){var i=document.createElement("button");i.textContent=e.label||"Reset map",i.type="button",i.style.backgroundColor="#fff",i.style.border="2px solid #fff",i.style.fontFamily="Roboto,Arial,sans-serif",i.style.fontSize="12px",i.style.margin="10px",i.style.borderRadius="2px",i.style.cursor="pointer",i.addEventListener("click",(function(){t.setCenter({lat:n,lng:r}),t.setZoom(o)}));var a=e.position||"RIGHT_TOP";t.controls[google.maps.ControlPosition[a]].push(i)}},_showMap:function(e,t,n,r,o,i,a,s,l,c,u,d){var g={zoom:r,center:new google.maps.LatLng(t,n),mapTypeId:google.maps.MapTypeId[o],autocloseinfo:!0},f=this.$reportEl.find("#"+e),p=new google.maps.Map(f[0],g);f.attr("js-stdnav","false");var h=this._placeSeriesMarkers(p,i,!1,l),m=this._enableSpidering(p,h),w=this._enableClustering(p,h,s);this._drawLegend(u,p,e,h,w,m,c,!1),this._drawResetMap(d,p,t,n,r),this._drawPaths(a,p,!1)},_getBooleanValue:function(e){return!0===e||"true"===e},_extendArray:function(e,t){var n,r=s(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;e.push(o)}}catch(e){r.e(e)}finally{r.f()}},_getObjectKeys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}})},75964:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var r=1e3*Number("60"),o={},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.cache,i=void 0===n||n,a=t.prefix,s=void 0===a?"":a,l=t.scriptProps,c=void 0===l?{}:l,u=s+e;if(i&&o[u])return o[u];var d=new Promise((function(t,n){var o=document.createElement("script"),i=Object.assign({charset:"utf-8",timeout:r},c);Object.keys(i).forEach((function(e){return o[e]=i[e]})),o.src=e;var a=function(){o.onerror=null,o.onload=null,clearTimeout(s),n.apply(void 0,arguments)},s=setTimeout((function(){a(new Error("Load timeout for the script ".concat(e)))}),i.timeout);o.onerror=a,o.onload=function(){o.onerror=null,o.onload=null,clearTimeout(s),t()},document.head.appendChild(o)}));return o[u]=d,d}}}]);
//# sourceMappingURL=chunk.459.js.map