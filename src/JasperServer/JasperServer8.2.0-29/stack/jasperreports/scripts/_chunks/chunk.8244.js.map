{"version":3,"sources":["webpack://jrs-ui/./src/components/components.searchBox.js","webpack://jrs-ui/./src/components/components.toolbarButtons.events.js","webpack://jrs-ui/./src/components/components.toolbarButtons.js","webpack://jrs-ui/./src/manage/mng.common.actions.js","webpack://jrs-ui/./src/manage/mng.common.js","webpack://jrs-ui/./src/manage/mng.org.module.js","webpack://jrs-ui/./src/manage/mng.main.js","webpack://jrs-ui/./src/manage/mng.root.js","webpack://jrs-ui/./src/tenantImportExport/utils/RegExpRepresenter.js","webpack://jrs-ui/./src/tenantImportExport/export/view/ExportDialogView.js","webpack://jrs-ui/./src/tenantImportExport/import/view/ImportDialogView.js","webpack://jrs-ui/../js-sdk/src/common/component/tree/plugin/ContextMenuTreePlugin.js","webpack://jrs-ui/./src/tenantImportExport/utils/tenantTreeDataUriTemplateUtil.js","webpack://jrs-ui/./src/tenantImportExport/view/tenantTree.js","webpack://jrs-ui/../js-sdk/src/common/component/menu/template/menuOptionTemplate.htm","webpack://jrs-ui/../js-sdk/src/common/component/menu/Menu.js","webpack://jrs-ui/../js-sdk/src/common/component/menu/template/menuContainerTemplate.htm","webpack://jrs-ui/../js-sdk/src/common/component/menu/ContextMenu.js","webpack://jrs-ui/./src/tenantImportExport/view/TenantsTreeView.js","webpack://jrs-ui/./src/tenantImportExport/templates/tooltipTemplate.htm","webpack://jrs-ui/./src/util/tools.infiniteScroll.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/ConfirmationDialog.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/template/confirmDialogTemplate.htm"],"names":["SearchBox","options","this","_id","id","_dom","jQuery","_enabled","_process","_assignHandlers","addMethod","_input","find","_clearButton","_searchButton","on","e","Event","stop","_keyPressHandler","bindAsEventListener","_clearHandler","_searchHandler","KEY_RETURN","keyCode","_doSearch","getText","blank","removeClass","layoutModule","addClass","setText","getValue","text","setValue","_updateClearButtonVisibility","buttonManager","attr","onSearch","toolbarButtonModule","actionMap","evt","prop","type","substring","toUpperCase","isFirefox","each","index","li","css","el","execFunction","className","indexOf","getAsFunction","executableFunction","stopPropagation","originalEvent","UP","DOWN","OVER","DISABLED","PRESSED","CONTENT_PREFIX","MenuClass","TOOLBAR_MENU_CLASS","ACTION_MODEL_TAG","CAPSULE_PATTERN","showButtonMenu","event","object","context","model","actionModel","setActionModel","newActionModel","isToolBarButton","button","hasClass","enable","disable","setButtonState","orgModule","createAction","entity","data","Object","toJSON","entityName","assigned","unassigned","unencryptedEntity","entities","collect","getNameWithTenant","entityEvent","action","onSuccess","successData","exist","onExist","uniqueId","onNotExist","onError","errorData","inputData","responseData","actionName","Error","org","count","length","dialog","ConfirmationDialog","open","getDisplayName","showConfirm","properties","locked","isChanged","confirm","lock","isEditMode","cancel","done","newEntity","getDetailsLoadedEntity","showProperties","fullName","unlock","entityId","cancelIfEdit","hide","RegExpRepresenter","expression","charMap","expressionTokens","__parse","assign","TREE_ID","COOKIE_NAME","messages","ActionMap","SEARCH","BROWSE","NEXT","SELECT_AND_GET_DETAILS","SEARCH_AVAILABLE","SEARCH_ASSIGNED","NEXT_AVAILABLE","NEXT_ASSIGNED","CREATE","UPDATE","DELETE","DELETE_ALL","EXIST","ORG_BROWSE","ENTITY_SEARCH","ENTITY_NEXT","ENTITY_SELECT_AND_GET_DETAILS","RESULT_CHANGED","RESULT_NEXT","ENTITY_DETAILS_LOADED","SEARCH_AVAILABLE_LOADED","SEARCH_ASSIGNED_LOADED","NEXT_AVAILABLE_LOADED","NEXT_ASSIGNED_LOADED","SERVER_ERROR","SERVER_UNAVAILABLE","ENTITY_CREATED","ENTITY_UPDATED","ENTITY_DELETED","ENTITIES_DELETED","observe","eventName","handler","_getContainer","stopObserving","fire","memo","getMessage","messageId","message","Template","evaluate","_comparator","l1","l2","_container","document","body","Configuration","nameSeparator","userDefaultRole","userNameNotSupportedSymbols","roleNameNotSupportedSymbols","emailRegExpPattern","superuserRole","adminRole","anonymousRole","jsonOrNode","param","name","uri","treeNode","tenantId","tenantName","alias","tenantAlias","desc","tenantDesc","tenantUri","parentId","subTenantCount","level","primaryNavModule","deepClone","toQueryString","isInherited","permission","inheritedPermission","isDisabled","newPermission","userName","password","confirmPassword","email","enabled","external","roles","role","push","bind","permissionToDisplay","_flowId","FLOW_ID","encodeURIComponent","user","toData","roleName","selectedItem","selectedTenant","window","localStorage","setItem","JSON","stringify","organization","changeDisable","_EDIT_BUTTON_ID","force","refreshAttributes","ID_PATTERN","_listId","_containerId","_searchBoxId","initialize","list","dynamicList","listTemplateDomId","listTemplateId","itemTemplateDomId","itemTemplateId","multiSelect","selectionDefaultsToCursor","comparator","item1","item2","getLabel","_initEvents","_infiniteScroll","InfiniteScroll","contentId","_searchBox","onLoad","toolbarModel","toolbar","show","item","lastSelectedName","tenantsTree","getTenant","isCtrlHeld","refresh","stopSelectOrUnselect","_createEntityItem","value","label","entityList","processTemplate","element","select","update","xssUtil","getSearchText","setSearchText","getSelectedEntities","getSelectedItems","setEntities","items","reset","setItems","findEntity","getItems","_","addEntities","addItems","selectEntity","matched","detect","isSelected","deselect","restoreSelectedEntity","deselectAll","resetSelected","findAll","remove","entityNameOrNameSet","all","isArray","include","removeItems","_EDIT_MODE_CLASS","_moveButtonsId","_value","_NOTHING_TO_DISPLAY_ID","_ASSIGNED_VIEW_ID","_ASSIGNED_VIEW_LIST_ID","_ASSIGNED_ID","_AVAILABLE_ID","_ASSIGNED_LIST_ID","_AVAILABLE_LIST_ID","_ATTRIBUTES_LIST_ID","_SAVE_BUTTON_ID","_CANCEL_BUTTON_ID","_DELETE_BUTTON_ID","_REMOVE_FROM_ASSIGNED_BUTTON_ID","_ADD_TO_ASSIGNED_BUTTON_ID","_BUTTONS_CONTAINER_ID","_MOVE_BUTTONS_CONTAINER_ID","_DND_CLASS","_DROP_CLASS","buttonsFunctions","attributesTypesEnum","_toggleButton","attributes","attributesType","TENANT","USER","optionsFactory","attributesViewOptionsFactory","scrollEventTrait","AttributesViewFacade","extend","attributesFacade","container","showAssigned","initDnD","initEvents","initButtonsFunctions","_initConfirmationDialog","self","i18n","confirmationDialog","title","cancelOnEdit","propertiesIsChanged","containsUnsavedItems","saveButton","removeAttribute","removeClassName","setAttribute","isRoot","getCurrentView","setContext","render","$","addClassName","changeMode","nothingToDisplay","centerElement","horz","vert","setDetailsLoadedEntity","detailsLoadedEntity","editButton","cancelButton","deleteButton","removeFromAssigned","addToAssigned","assignedViewList","viewAssignedListTemplateDomId","viewAssignedItemTemplateDomId","assignedComparator","allowSelections","commonOptions","dragPattern","selectOnMousedown","setCursorOnMouseDown","assignedList","availableList","searchAssigned","assignedViewSearchBox","identify","availableSearchBox","assignedSearchBox","assignedViewInfiniteScroll","parentNode","availableInfiniteScroll","assignedInfiniteScroll","Droppables","up","accept","hoverclass","onDrop","dragged","dropped","_addToAssigned","_removeFromAssigned","assignedSelectionHandler","availableSelectionHandler","matchAny","call","preventDefault","extObj","dfd","asyncValidate","saveChildren","resolve","fail","reject","trigger","save","validate","_deleteEntity","_addFromAssigned","edit","tabs","attributeTab","propertiesTab","$anchor","hideFilters","detachScrollEvent","$container","parent","toggleMode","initScrollEvent","$$","down","_assigned","_unassigned","style","zIndex","_editEntity","canEdit","canDelete","_showEntity","orgProperties","currentUser","setValuesProperty","setProperties","_moveEntities","bToAssigned","from","to","fromList","toList","concat","available","compact","fromItem","equals","_entitiesToItems","isAvailable","tooltipText","template","undefined","JSTooltip","templateId","nameAnchor","insert","writeAttribute","getManagerURL","getAssignedEntities","getUnassignedEntities","setAssignedEntities","filteredEntities","_filterEntities","addAssignedEntities","setAvailableEntities","addAvailableEntities","removeSet","addSet","allEntities","removeEntity","toLowerCase","changeReadonly","elementsPatterns","elementPattern","resetValidation","panel","ValidationModule","invokeFn","beforeInvoke","isFunction","invokeAction","apply","arguments","doNothing","eventId","actionURL","localContext","flowExecutionKey","ajaxTargettedUpdate","postData","callback","response","error","errorHandler","ajaxAgent","getResponseHeader","baseErrorHandler","mode","AjaxRequester","_actionModel","_toActionMap","buttonId","testFn","toFunction","test","bulkActionModel","bulkAction","actionArgs","myAction","args","belongsToLocalContext","input","validator","isValid","regExp","errorMessage","symbols","unsupportedSymbols","messageKey","onValid","onInvalid","replaceKey","max","hasAttribute","readAttribute","maxlength","parseInt","replace","asElement","matches","exec","truncate","result","$A","i","ch","charAt","token","startsWith","eval","chars","getCharacters","len","state","isProVersion","TenantsTreeView","removeContextMenuTreePlugin","t1","t2","lastSelectedOrg","selectTenant","lastSearchText","Boolean","firstEntity","entityJsonToObject","defaultEntity","relatedEntityJsonToObject","alert","description","entityJson","evalJSON","saveDfD","designer","updateEntityList","entityNameSet","json","reloadEntities","isUserSuperuser","currentUserRoles","r","actionBuilder","mngCommonActions","mngCommon","mngMain","prototype","getRepresentedString","hasReports","resourceType","Dialog","constructor","resizable","modal","content","buttons","primary","_onExportButtonClick","_closeExportDialog","exportView","ExportView","listenTo","openRepoDialog","repoData","eventTarget","target","ancestors","filter","hasClassName","uris","URIString","organizationsFolderUri","jrsConfigs","orgTemplateFolderUri","subOrgRegExp","RegExp","rootOrgTemplateRegExp","isSubOrgLevel","renderOptions","exportTypesEnum","subtitle","i18n2","addCssClasses","_openExportDialog","set","openTenantDialog","tenant","fieldIsValid","fieldIsInvalid","doExport","$el","width","close","html","focusElement","setContent","setTitle","setReturnFocus","applyEpoxyBindings","delegateEvents","minHeight","outerHeight","outerWidth","additionalCssClasses","_onImportButtonClick","_closeImportDialog","importView","ImportView","openDialog","importExportTypesEnum","doImport","returnContextMenuOptions","contextMenu","option","get","cid","TreePlugin","contextMenus","defaultSelectedItems","showContextMenuCondition","itemAction","optionModel","treeItem","itemsRendered","currentContextMenu","lastContextMenu","resetSelection","left","pageX","top","pageY","collection","optionView","stopListening","contextPath","processors","processItem","_node","addToSelection","TreeWithPlugins","Tree","TooltipTreePlugin","contentTemplate","tooltipContentTemplate","use","ContextMenuTreePlugin","create","instance","selection","allowed","right","multiple","rootless","collapsed","lazyLoad","bufferSize","allowMouseDownEventPropagation","dataUriTemplate","tenantTreeDataUriTemplateUtil","levelDataId","getDataArray","status","xhr","orgs","sort","customDataLayers","TreeDataLayer","parse","_links","dataType","OptionContainer","additionalSettings","mainTemplate","menuContainerTemplate","optionTemplate","menuOptionTemplate","toggle","toggleClass","maxSize","_onConstructor","append","_onInitialize","res","applyMaxSize","height","Menu","topPadding","leftPadding","extraOffset","hideOnMouseLeave","_tryHide","_signOffTryHide","off","_checkBounds","position","menuElHeight","_calculateMenuHeightOnShow","menuElWidth","containerHeight","containerWidth","containerOffset","offset","fitByHeight","fitByWidth","elementRect","offsetTop","bottom","offsetHeight","offsetLeft","offsetWidth","_isPointerOutOfBounds","clientX","clientY","opacity","ROOT_TENANT_ID","Backbone","getItem","root","split","splittedUri","splice","unshift","treeInitOptions","ContextMenu","_onExport","_onImport","exportDialog","ExportDialogView","importDialog","ImportDialogView","tree","tenantTree","refreshTenant","treeLevel","getLevel","getDataLayer","predefinedData","setTenant","addTenant","parentTenantId","parentLevel","listenToOnce","addItem","_processItem","updateTenant","updatedTenant","updateItem","removeTenant","tenantIds","isNew","tenantFolderUri","expandedLevels","_recursivelyOpenLevels","rootLevel","expand","newlevel","_contentId","_scroll","scroll","_loadFactor","loadFactor","_lastContentHeight","_loading","control","_control","_content","childElements","_eventType","isSupportsTouch","_onScrollHandler","_handler","controlScrollTop","y","scrollTop","contentHeight","getHeight","controlHeight","allowLoad","isBottom","isIPad","wait","_waitIndicator","Element","dimensions","getDimensions","offsets","positionedOffset","setStyle","after","confirmDialogTemplate","yesLabel","noLabel"],"mappings":"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","file":"_chunks/chunk.8244.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: Yuriy Plakosh\n * @version: $Id$\n */\n\n/*\n * Search box class.\n *\n * @param options {JSON Object} - Set of options for search box:\n * <ul>\n *      <li>id - the identifier of search box form element in the DOM</li>\n * </ul>\n */\n\nimport layoutModule from '../core/core.layout';\nimport buttonManager from '../core/core.events.bis';\nimport jQuery from 'jquery';\n\nvar SearchBox = function(options) {\n    this._id = options.id;\n    this._dom = jQuery('#' + this._id)[0];\n    this._enabled = true;\n\n    this._process();\n    this._assignHandlers();\n};\n\n/**\n * Processes DOM.\n */\nSearchBox.addMethod('_process', function() {\n    this._input = jQuery(this._dom).find('input')[0];\n    this._clearButton = jQuery(this._dom).find('.button.searchClear')[0];\n    this._searchButton = jQuery(this._dom).find('.button.search')[0];\n});\n\n/**\n * Assigns handlers.\n */\nSearchBox.addMethod('_assignHandlers', function() {\n    jQuery(this._dom).on('submit', function(e) {\n        Event.stop(e);\n    });\n\n    jQuery(this._input).on(\"keypress\", this._keyPressHandler.bindAsEventListener(this));\n\n    jQuery(this._clearButton).on('click', this._clearHandler.bindAsEventListener(this));\n    jQuery(this._searchButton).on('click', this._searchHandler.bindAsEventListener(this));\n});\n\n/**\n * Key pressed handler for input field.\n */\nSearchBox.addMethod('_keyPressHandler', function(e) {\n    if (this._enabled && Event.KEY_RETURN == e.keyCode) {\n        this._doSearch();\n\n        // Fix to prevent click event handling on clear button when enter key is pressed in the input field.\n        Event.stop(e);\n    }\n});\n\n/**\n * Updates visibility of clear button.\n */\nSearchBox.addMethod('_updateClearButtonVisibility', function() {\n    if (!this.getText().blank()) {\n        jQuery(this._clearButton).addClass(layoutModule.UP_CLASS);\n    } else {\n        jQuery(this._clearButton).removeClass(layoutModule.UP_CLASS);\n    }\n});\n\n/**\n * Click handler for clear button.\n */\nSearchBox.addMethod('_clearHandler', function() {\n    if (this._enabled) {\n        this.setText(\"\");\n        this._doSearch();\n    }\n});\n\n/**\n * Click handler for search button.\n */\nSearchBox.addMethod('_searchHandler', function() {\n    if (this._enabled) {\n        this._doSearch();\n    }\n});\n\n/**\n * Gets search box text.\n */\nSearchBox.addMethod('getText', function() {\n    return this._input.getValue();\n});\n\n/**\n * Sets search box text.\n */\nSearchBox.addMethod('setText', function(text) {\n    this._input.setValue(text);\n    this._updateClearButtonVisibility();\n});\n\n/**\n * Enables search box.\n */\nSearchBox.addMethod('enable', function() {\n    buttonManager.enable(this._clearButton);\n    buttonManager.enable(this._searchButton);\n    jQuery(this._input).attr(layoutModule.READONLY_ATTR_NAME, null);\n    jQuery(this._dom).attr(layoutModule.DISABLED_ATTR_NAME, null);\n\n    this._enabled = true;\n});\n\n/**\n * Disables search box.\n */\nSearchBox.addMethod('disable', function() {\n    buttonManager.disable(this._clearButton);\n    buttonManager.disable(this._searchButton);\n    jQuery(this._input).attr(layoutModule.READONLY_ATTR_NAME, layoutModule.READONLY_ATTR_NAME);\n    jQuery(this._dom).attr(layoutModule.DISABLED_ATTR_NAME, layoutModule.DISABLED_ATTR_NAME);\n\n    this._enabled = false;\n});\n\n/**\n * Does search action.\n */\nSearchBox.addMethod('_doSearch', function(text) {\n    this._updateClearButtonVisibility();\n    this.onSearch(this.getText());\n});\n\n/**\n * Is invoked when search action was performed (search button pressed, clear button pressed, enter key pressed in the\n * text input field). This method should be replaced in the instance of SearchBox class to handle search action.\n *\n * @param text the text in the search box.\n */\nSearchBox.addMethod('onSearch', function(text) {\n    // No-op.\n});\n\nexport default SearchBox;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\nimport jQuery from 'jquery';\nimport {isFirefox, getAsFunction} from \"../util/utils.common\";\nimport buttonManager from '../core/core.events.bis';\nimport toolbarButtonModule from './components.toolbarButtons';\n\ntoolbarButtonModule.initialize = function(actionMap){\n    toolbarButtonModule.actionMap = actionMap;\n    jQuery('.toolbar').on('mouseup mouseover mouseout','button',function(evt){\n        if(!jQuery(this).prop('disabled'))toolbarButtonModule['mouse' + evt.type.substring(5,6).toUpperCase() + evt.type.substring(6) + 'Handler'](evt,this);\n    });\n\n    if (isFirefox()) { // workaround for Bug 26223\n        jQuery(\".toolbar li\").each(function(index,li){\n            jQuery(li).css(\"padding\", \"0 2px\");\n        });\n    }\n};\n\ntoolbarButtonModule.mouseUpHandler = function(evt,el){\n    /*\n    if (element.hasClass(toolbarButtonModule.CAPSULE_PATTERN)) {\n        var elementId = element.attr(\"id\");\n        var execFunction = toolbarButtonModule.actionMap[elementId];\n        if (execFunction) {\n            var executableFunction = getAsFunction(execFunction);\n            executableFunction(evt);\n            evt.stopPropagation();\n        }\n    }\n    */\n    var execFunction = el.className.indexOf('capsule') >= 0 ? toolbarButtonModule.actionMap[el.id] : null;\n    if (execFunction) {\n        var executableFunction = getAsFunction(execFunction);\n        executableFunction(evt);\n        evt.stopPropagation();\n    }\n};\n\ntoolbarButtonModule.mouseOverHandler = function(evt,el){\n    /*\n    if (element.hasClass(toolbarButtonModule.CAPSULE_PATTERN)) {\n        if (element.hasClass(\"mutton\") && !buttonManager.isDisabled(element)) {\n            toolbarButtonModule.showButtonMenu(evt, element);\n        }\n    }\n    */\n    if(el.className.indexOf('capsule') >= 0 && el.className.indexOf('mutton') >= 0 && !buttonManager.isDisabled(el)){\n        toolbarButtonModule.showButtonMenu(evt.originalEvent,el);\n    }\n};\n\ntoolbarButtonModule.mouseOutHandler = function(evt,el){};\n\nexport default toolbarButtonModule;\n\n\n\n\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\n\nimport jQuery from 'jquery';\nimport actionModel from '../actionModel/actionModel.modelGenerator';\nimport buttonManager from '../core/core.events.bis';\n\n////////////////////////////////////////////////\n// Generic toolbar button utils\n////////////////////////////////////////////////\n\nvar toolbarButtonModule = {\n\n    UP : \"up\",\n    DOWN : \"down\",\n    OVER : \"over\",\n    DISABLED : \"disabled\",\n    PRESSED : \"pressed\",\n    CONTENT_PREFIX : \"toolbar_\", //action model\n    MenuClass : \"menu vertical dropDown\",\n    TOOLBAR_MENU_CLASS : \"menu vertical dropDown fitable\",\n    ACTION_MODEL_TAG : \"adhocActionModel\",\n    CAPSULE_PATTERN : \"capsule\",\n\n    /**\n     * Used by all toolbar components to show menu\n     * @param event\n     * @param object object we want the menu for\n     */\n    showButtonMenu : function(event, object){\n        object = jQuery(object);\n        var context = this.CONTENT_PREFIX + object.attr(\"id\"),\n            model = this.ACTION_MODEL_TAG == 'adhocActionModel' ? this.actionModel : this.ACTION_MODEL_TAG;\n\n        actionModel.showDropDownMenu(event, object, context, this.TOOLBAR_MENU_CLASS, model);\n    },\n\n    setActionModel: function(newActionModel){\n        this.actionModel = newActionModel;\n    },\n\n    /**\n     * Test to see if the button clicked is a toolbar type\n     * @param button\n     */\n    isToolBarButton : function(button){\n        if (button){\n            return (jQuery(button).hasClass(\"capsule\"));\n        } else{\n            return false;\n        }\n\n    },\n\n    /**\n     * Used to enable toolbar button\n     * @param button\n     * @param enable\n     */\n    enable : function(button, enable){\n        buttonManager.enable(button);\n    },\n\n    /**\n     * Used to disable toolbar button\n     * @param button\n     */\n    disable : function(button){\n        buttonManager.disable(button);\n    },\n\n    /**\n     * Used to enable or disable button based on adhoc state variables\n     * @param button\n     * @param enable\n     */\n    setButtonState : function(button, enable){\n        if(enable){\n            this.enable(button);\n        }else{\n            this.disable(button);\n        }\n    }\n};\n\nexport default toolbarButtonModule;\n\n\n\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n/* global confirm */\nimport ConfirmationDialog from 'js-sdk/src/common/component/dialog/ConfirmationDialog';\nimport orgModule from './mng.org.module';\n\norgModule.serverActionFactory = {\n    'browse': function (options) {\n        return this.createAction(orgModule.ActionMap.BROWSE, options);\n    },\n    'search': function (options) {\n        return this.createAction(orgModule.ActionMap.SEARCH, options);\n    },\n    'next': function (options) {\n        return this.createAction(orgModule.ActionMap.NEXT, options);\n    },\n    'selectAndGetDetails': function (options) {\n        return this.createAction(orgModule.ActionMap.SELECT_AND_GET_DETAILS, options);\n    },\n    'searchAvailable': function (options) {\n        return this.createAction(orgModule.ActionMap.SEARCH_AVAILABLE, options);\n    },\n    'searchAssigned': function (options) {\n        return this.createAction(orgModule.ActionMap.SEARCH_ASSIGNED, options);\n    },\n    'nextAvailable': function (options) {\n        return this.createAction(orgModule.ActionMap.NEXT_AVAILABLE, options);\n    },\n    'nextAssigned': function (options) {\n        return this.createAction(orgModule.ActionMap.NEXT_ASSIGNED, options);\n    },\n    'create': function (options) {\n        var entity = options.entity;\n        var data = { 'entity': Object.toJSON(entity) };\n        return this.createAction(orgModule.ActionMap.CREATE, data);\n    },\n    'update': function (options) {\n        var entityName = options.entityName;\n        var data = {\n            'entityName': entityName,\n            'entity': Object.toJSON(options.entity),\n            'assignedEntities': Object.toJSON(options.assigned),\n            'unassignedEntities': Object.toJSON(options.unassigned)\n        };\n        return this.createAction(orgModule.ActionMap.UPDATE, data, options.unencryptedEntity);\n    },\n    'deleteAll': function (options) {\n        var entities = options.entities;\n        var data = {\n            'entities': Object.toJSON(entities.collect(function (entity) {\n                return entity.getNameWithTenant();\n            }))\n        };\n        return this.createAction(orgModule.ActionMap.DELETE_ALL, data);\n    },\n    'delete': function (options) {\n        var entity = options.entity, entityEvent = options.entityEvent;\n        var data = {\n            'entity': entity.getNameWithTenant(),\n            'entityEvent': entityEvent\n        };\n        return this.createAction(orgModule.ActionMap.DELETE, data);\n    },\n    'exist': function (options) {\n        // TODO: refactor to use createAction method.\n        var entity = options.entity;\n        var data = { entityName: entity.getNameWithTenant() };\n        var action = new orgModule.ServerAction(orgModule.ActionMap.EXIST, data);\n        action.onSuccess = function (successData) {\n            successData.exist ? options.onExist && options.onExist(successData.uniqueId) : options.onNotExist && options.onNotExist();\n        };\n        action.onError = function (errorData) {\n            orgModule.fire(orgModule.Event.SERVER_ERROR, {\n                inputData: options,\n                responseData: errorData\n            });\n        };\n        return action;\n    },\n    createAction: function (actionName, options, unencryptedEntity) {\n        var action = new orgModule.ServerAction(actionName, options);\n        var event;\n        if (actionName == orgModule.ActionMap.BROWSE) {\n            event = orgModule.Event.RESULT_CHANGED;\n        } else if (actionName == orgModule.ActionMap.SEARCH) {\n            event = orgModule.Event.RESULT_CHANGED;\n        } else if (actionName == orgModule.ActionMap.NEXT) {\n            event = orgModule.Event.RESULT_NEXT;\n        } else if (actionName == orgModule.ActionMap.SELECT_AND_GET_DETAILS) {\n            event = orgModule.Event.ENTITY_DETAILS_LOADED;\n        } else if (actionName == orgModule.ActionMap.SEARCH_AVAILABLE) {\n            event = orgModule.Event.SEARCH_AVAILABLE_LOADED;\n        } else if (actionName == orgModule.ActionMap.SEARCH_ASSIGNED) {\n            event = orgModule.Event.SEARCH_ASSIGNED_LOADED;\n        } else if (actionName == orgModule.ActionMap.NEXT_AVAILABLE) {\n            event = orgModule.Event.NEXT_AVAILABLE_LOADED;\n        } else if (actionName == orgModule.ActionMap.NEXT_ASSIGNED) {\n            event = orgModule.Event.NEXT_ASSIGNED_LOADED;\n        } else if (actionName == orgModule.ActionMap.CREATE) {\n            event = orgModule.Event.ENTITY_CREATED;\n        } else if (actionName == orgModule.ActionMap.UPDATE) {\n            event = orgModule.Event.ENTITY_UPDATED;\n        } else if (actionName == orgModule.ActionMap.DELETE_ALL) {\n            event = orgModule.Event.ENTITIES_DELETED;\n        } else if (actionName == orgModule.ActionMap.DELETE) {\n            event = orgModule.Event.ENTITY_DELETED;\n        } else {\n            throw new Error('Unexpected action name \\'' + actionName + '\\'');\n        }\n        action.onSuccess = function (data) {\n            orgModule.fire(event, {\n                inputData: options,\n                unencryptedEntity: unencryptedEntity,\n                responseData: data\n            });\n        };\n        action.onError = function (data) {\n            orgModule.fire(orgModule.Event.SERVER_ERROR, {\n                inputData: options,\n                unencryptedEntity: unencryptedEntity,\n                responseData: data\n            });\n        };\n        return action;\n    }\n};\norgModule.clientActionFactory = {\n    'create': function () {\n        var org;\n        if (orgModule.manager.tenantsTree) {\n            org = orgModule.manager.tenantsTree.getTenant();\n        }\n        var entities = orgModule.entityList.getSelectedEntities();\n        var cancelEditBeforeInvoke = function () {\n            return orgModule.invokeClientAction('cancelIfEdit', { entity: entities[0] });\n        };\n        return new orgModule.Action(function () {\n            orgModule.entityList.deselectAll();\n            orgModule.addDialog.show(org);\n        }, cancelEditBeforeInvoke);\n    },\n    'deleteAll': function () {\n        var entities = orgModule.entityList.getSelectedEntities();\n        var cancelEditBeforeInvoke = function () {\n            return orgModule.invokeClientAction('cancelIfEdit', { entity: entities[0] });\n        };\n        return new orgModule.Action(function () {\n            var text = orgModule.getMessage('deleteAllMessage', { count: entities.length });\n            var dialog = new ConfirmationDialog({ text: text });\n            dialog.on('button:yes', function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.DELETE_ALL, { entities: entities });\n            });\n            dialog.open();\n        }, cancelEditBeforeInvoke);\n    },\n    'delete': function (options) {\n        var entity = options.entity, entityEvent = options.entityEvent;\n        return new orgModule.Action(function () {\n            var text = orgModule.getMessage('deleteMessage', { entity: entity.getDisplayName() });\n\n            var dialog = new ConfirmationDialog({ text: text });\n            dialog.on('button:yes', function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.DELETE, {\n                    entity: entity,\n                    entityEvent: entityEvent\n                });\n            });\n            dialog.open();\n        });\n    },\n    'cancelIfEdit': function (options) {\n        options = options || {};\n        var entity = options.entity || orgModule.manager.tenantsTree && orgModule.manager.tenantsTree.getTenant(), showConfirm = typeof options.showConfirm === 'undefined' ? true : options.showConfirm, entityEvent = typeof options.entityEvent === 'undefined' ? true : options.entityEvent, properties = orgModule.properties;\n        return new orgModule.Action(function () {\n            if ((!properties.locked || !entityEvent) && (!properties.isChanged() || showConfirm && confirm(orgModule.getMessage('cancelEdit', { entity: entity.getDisplayName() })))) {\n                if (properties.isEditMode) {\n                    properties.lock();\n                    properties.cancel().done(function () {\n                        var newEntity = properties.getDetailsLoadedEntity(), showProperties = orgModule.userManager ? orgModule.entityList.findEntity(newEntity.fullName) : true;\n                        properties.unlock();\n                        if (showProperties) {\n                            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                                entityId: newEntity.id,\n                                cancelIfEdit: true,\n                                entityEvent: true\n                            });\n                        } else {\n                            properties.hide();\n                        }\n                    });\n                }\n                return true;\n            } else {\n                !entityEvent && properties.lock();\n                return false;\n            }\n        });\n    }\n};\n\nexport default orgModule;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @version: $Id$\n */\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n// Main module for manege organizations, users and roles\n////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\nimport {Droppables} from 'dragdropextra';\nimport {$, $$, $A, Template} from 'prototype';\nimport SearchBox from '../components/components.searchBox';\nimport toolbarButtonModule from '../components/components.toolbarButtons.events';\nimport {\n    toFunction,\n    getAsFunction,\n    isArray,\n    matchAny,\n    centerElement,\n    ValidationModule,\n    deepClone,\n    doNothing\n} from '../util/utils.common';\nimport layoutModule from '../core/core.layout';\nimport {dynamicList} from '../components/list.base';\nimport InfiniteScroll from '../util/tools.infiniteScroll';\nimport {JSTooltip} from '../components/components.tooltip';\nimport buttonManager from '../core/core.events.bis';\nimport primaryNavModule from '../actionModel/actionModel.primaryNavigation';\nimport {ajaxTargettedUpdate, AjaxRequester} from \"../core/core.ajax\";\nimport {baseErrorHandler} from \"../core/core.ajax.utils\";\nimport orgModule from './mng.org.module';\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport jQuery from 'jquery';\n\nObject.assign(orgModule, {\n    TREE_ID: 'orgTree',\n    COOKIE_NAME: 'selectedTenant',\n    messages: [],\n    ActionMap: {\n        SEARCH: 'search',\n        BROWSE: 'browse',\n        NEXT: 'next',\n        SELECT_AND_GET_DETAILS: 'selectAndGetDetails',\n        SEARCH_AVAILABLE: 'searchAvailable',\n        SEARCH_ASSIGNED: 'searchAssigned',\n        NEXT_AVAILABLE: 'nextAvailable',\n        NEXT_ASSIGNED: 'nextAssigned',\n        CREATE: 'create',\n        UPDATE: 'update',\n        DELETE: 'delete',\n        DELETE_ALL: 'deleteAll',\n        EXIST: 'exist'\n    },\n    Event: {\n        /** Request events. */\n        ORG_BROWSE: 'org:browse',\n        ENTITY_SEARCH: 'entity:search',\n        ENTITY_NEXT: 'entity:next',\n        ENTITY_SELECT_AND_GET_DETAILS: 'entity:selectAndGetDetails',\n        /** Response events. */\n        RESULT_CHANGED: 'result:changed',\n        RESULT_NEXT: 'result:next',\n        ENTITY_DETAILS_LOADED: 'entity:detailsLoaded',\n        SEARCH_AVAILABLE_LOADED: 'searchAvailable:loaded',\n        SEARCH_ASSIGNED_LOADED: 'searchAssigned:loaded',\n        NEXT_AVAILABLE_LOADED: 'nextAvailable:loaded',\n        NEXT_ASSIGNED_LOADED: 'nextAssigned:loaded',\n        SERVER_ERROR: 'server:error',\n        SERVER_UNAVAILABLE: 'server:unavailable',\n        ENTITY_CREATED: 'entity:created',\n        ENTITY_UPDATED: 'entity:updated',\n        ENTITY_DELETED: 'entity:deleted',\n        ENTITIES_DELETED: 'entities:deleted'\n    },\n    observe: function (eventName, handler) {\n        this._getContainer().observe(eventName, handler);\n    },\n    stopObserving: function (eventName, handler) {\n        this._getContainer().stopObserving(eventName, handler);\n    },\n    fire: function (eventName, memo) {\n        this._getContainer().fire(eventName, memo);\n    },\n    getMessage: function (messageId, options) {\n        var message = orgModule.messages[messageId];\n        return message ? new Template(message).evaluate(options ? options : {}) : '';\n    },\n    _comparator: function (l1, l2) {\n        return l1 > l2 ? 1 : l1 < l2 ? -1 : 0;\n    },\n    _getContainer: function () {\n        if (!this._container) {\n            this._container = document.body;\n        }\n        return this._container;\n    },\n    Configuration: {\n        nameSeparator: '|',\n        userDefaultRole: 'ROLE_USER',\n        userNameNotSupportedSymbols: '[|]',\n        roleNameNotSupportedSymbols: '[|]',\n        emailRegExpPattern: '^[\\\\p{L}\\\\p{M}\\\\p{N}._%\\'-\\\\@\\\\,\\\\;\\\\s]+$',\n        superuserRole: 'ROLE_SUPERUSER',\n        adminRole: 'ROLE_ADMINISTRATOR',\n        anonymousRole: 'ROLE_ANONYMOUS'\n    }\n});\n\norgModule.systemRoles = [\n    orgModule.Configuration.userDefaultRole,\n    orgModule.Configuration.superuserRole,\n    orgModule.Configuration.adminRole,\n    orgModule.Configuration.anonymousRole\n];    /**\n * This Class represents tenant in JS\n *\n * @param node {@link dynamicTree.TreeNode}\n */\n/**\n * This Class represents tenant in JS\n *\n * @param node {@link dynamicTree.TreeNode}\n */\norgModule.Organization = function (jsonOrNode) {\n    if (!jsonOrNode) {\n        throw new Error('Can\\'t create Organization from undefined json or node');\n    }\n    if (jsonOrNode.param) {\n        this.id = jsonOrNode.param.id;\n        this.name = jsonOrNode.name;\n        this.uri = jsonOrNode.param.uri;\n        this.treeNode = jsonOrNode;\n    } else {\n        this.id = jsonOrNode.tenantId || jsonOrNode.id;\n        this.name = jsonOrNode.tenantName;\n        this.alias = jsonOrNode.tenantAlias || jsonOrNode.alias || '';\n        this.desc = jsonOrNode.tenantDesc;\n        this.uri = jsonOrNode.tenantUri;\n        this.parentId = jsonOrNode.parentId;\n        this.subTenantCount = jsonOrNode.subTenantCount;\n    }\n};\norgModule.Organization.addMethod('isRoot', function (level) {\n    // TODO: load name of root organization from configuration.\n    return this.id == 'organizations';\n});\norgModule.Organization.addMethod('getNameWithTenant', function () {\n    return this.id;\n});\norgModule.Organization.addMethod('getDisplayName', function () {\n    return this.name;\n});\norgModule.Organization.addMethod('equals', function (org) {\n    return org && this.id == org.id;\n});\norgModule.Organization.addMethod('toJSON', function (org) {\n    return {\n        tenantId: this.id,\n        tenantName: this.name,\n        tenantAlias: this.alias,\n        tenantDesc: this.desc,\n        parentId: this.parentId,\n        tenantUri: this.uri\n    };\n});\norgModule.Organization.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.organization);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({ tenantId: this.id });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.Permission = function (options) {\n    this.isInherited = !!options.isInherited;\n    if (options.permission) {\n        this.permission = options.permission;\n    }\n    if (options.inheritedPermission) {\n        this.inheritedPermission = options.inheritedPermission;\n    }\n    this.isDisabled = !!options.isDisabled;\n};\norgModule.Permission.addMethod('getResolvedPermission', function () {\n    return this.isInherited ? this.inheritedPermission : this.permission;\n});\norgModule.Permission.addMethod('toJSON', function () {\n    return {\n        permission: this.permission,\n        isInherited: this.isInherited,\n        inheritedPermission: this.inheritedPermission,\n        newPermission: this.newPermission\n    };\n});\norgModule.Permission.addMethod('toData', function () {\n    return {\n        permission: this.permission,\n        isInherited: this.isInherited,\n        inheritedPermission: this.inheritedPermission,\n        newPermission: this.newPermission\n    };\n});\norgModule.User = function (options) {\n    if (options) {\n        this.userName = options.userName;\n        this.fullName = options.fullName;\n        this.password = options.password || '';\n        this.confirmPassword = options.confirmPassword || '';\n        this.tenantId = options.tenantId;\n        this.email = options.email;\n        this.enabled = options.enabled;\n        this.external = options.external;\n        this.roles = [];\n        if (options.roles) {\n            options.roles.each(function (role) {\n                this.roles.push(new orgModule.Role(role));\n            }.bind(this));\n        }\n        if (options.permissionToDisplay) {\n            this.permission = new orgModule.Permission(options.permissionToDisplay);\n        }\n    }\n};\norgModule.User.addVar('FLOW_ID', 'userListFlow');\norgModule.User.addMethod('getDisplayName', function () {\n    return this.userName;\n});\norgModule.User.addMethod('getNameWithTenant', function () {\n    if (this.tenantId && !this.tenantId.blank()) {\n        return this.userName + orgModule.Configuration.userNameSeparator + this.tenantId;\n    } else {\n        return this.userName;\n    }\n});\norgModule.User.addMethod('getManagerURL', function () {\n    return 'flow.html?' + Object.toQueryString({\n        _flowId: this.FLOW_ID,\n        text: typeof this.userName !== 'undefined' ? encodeURIComponent(this.userName) : this.userName,\n        tenantId: typeof this.tenantId !== 'undefined' ? encodeURIComponent(this.tenantId) : this.tenantId\n    });\n});\norgModule.User.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.user);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({\n        text: this.userName,\n        tenantId: this.tenantId\n    });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.User.addMethod('equals', function (user) {\n    return user && this.userName == user.userName && this.tenantId == user.tenantId;\n});\norgModule.User.addMethod('toPermissionData', function (user) {\n    return {\n        userName: this.userName,\n        tenantId: this.tenantId,\n        permissionToDisplay: this.permission.toData()\n    };\n});\norgModule.Role = function (options) {\n    if (options) {\n        this.roleName = options.roleName;\n        this.external = options.external;\n        this.tenantId = options.tenantId;\n    }\n    if (options.permissionToDisplay) {\n        this.permission = new orgModule.Permission(options.permissionToDisplay);\n    }\n};\norgModule.Role.addVar('FLOW_ID', 'roleListFlow');\norgModule.Role.addMethod('getDisplayName', function () {\n    return this.roleName;\n});\norgModule.Role.addMethod('getNameWithTenant', function () {\n    if (this.tenantId && !this.tenantId.blank()) {\n        return this.roleName + orgModule.Configuration.userNameSeparator + this.tenantId;\n    } else {\n        return this.roleName;\n    }\n});\norgModule.Role.addMethod('getManagerURL', function () {\n    return 'flow.html?' + Object.toQueryString({\n        _flowId: this.FLOW_ID,\n        // Object.toQueryString already does encodeURIComponent() once, so we have double encoding here\n        text: typeof this.roleName !== 'undefined' ? encodeURIComponent(this.roleName) : this.roleName,\n        tenantId: typeof this.tenantId !== 'undefined' ? encodeURIComponent(this.tenantId) : this.tenantId\n    });\n});\norgModule.Role.addMethod('navigateToManager', function () {\n    primaryNavModule.navigationPaths.tempNavigateToManager = deepClone(primaryNavModule.navigationPaths.role);\n    primaryNavModule.navigationPaths.tempNavigateToManager.params += '&' + Object.toQueryString({\n        text: this.roleName,\n        tenantId: this.tenantId\n    });\n    primaryNavModule.navigationOption('tempNavigateToManager');\n});\norgModule.Role.addMethod('equals', function (role) {\n    return role && this.roleName == role.roleName && this.tenantId == role.tenantId;\n});\norgModule.Role.addMethod('toPermissionData', function (user) {\n    return {\n        roleName: this.roleName,\n        tenantId: this.tenantId,\n        permissionToDisplay: this.permission.toData()\n    };\n});\n\norgModule.initTenantsTreeEvents = function () {\n    orgModule.manager.tenantsTree.on('selection:change', function (selectedItem) {\n        if (!orgModule.manager.lastSelectedOrg || orgModule.manager.lastSelectedOrg.id !== selectedItem.id) {\n            var selectedTenant = new orgModule.Organization(selectedItem), properties = orgModule.properties;\n            orgModule.manager.tenantsTree.setTenant(selectedTenant);\n            window.localStorage && localStorage.setItem(orgModule.COOKIE_NAME, JSON.stringify(selectedItem));\n            orgModule.fire(orgModule.Event.ORG_BROWSE, {\n                organization: selectedTenant,\n                entityEvent: false\n            });\n            if (orgModule.orgManager) {\n                properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n                orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                    entityId: selectedTenant.id,\n                    entityEvent: false\n                });\n            }\n            if (orgModule.userManager || orgModule.roleManager) {\n                properties.hide();\n                properties.unlock();\n            }\n        }\n    });\n    orgModule.manager.tenantsTree.on('import:finished', function (tenantId) {\n        var properties = orgModule.properties;\n        orgModule.fire(orgModule.Event.ORG_BROWSE, {\n            force: true,\n            entityEvent: false\n        });\n        if (orgModule.orgManager) {\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                refreshAttributes: true,\n                entityId: tenantId,\n                entityEvent: false\n            });\n        }\n    });\n};\n\norgModule.entityList = {\n    ID_PATTERN: '.ID > a',\n    _listId: 'entitiesList',\n    _containerId: 'listContainer',\n    _searchBoxId: 'secondarySearchBox',\n    initialize: function (options) {\n        this.list = new dynamicList.List(this._listId, {\n            listTemplateDomId: options.listTemplateId,\n            itemTemplateDomId: options.itemTemplateId,\n            multiSelect: true,\n            selectionDefaultsToCursor: true,\n            comparator: function (item1, item2) {\n                return orgModule._comparator(item1.getLabel(), item2.getLabel());\n            }\n        });\n        this._initEvents();    // Infinite scroll setup.\n        // Infinite scroll setup.\n        this._infiniteScroll = new InfiniteScroll({\n            id: this._containerId,\n            contentId: this._listId\n        });\n        this._searchBox = new SearchBox({ id: this._searchBoxId });\n        if (options.text) {\n            this._searchBox.setText(options.text);\n        }\n        this._infiniteScroll.onLoad = function () {\n            orgModule.fire(orgModule.Event.ENTITY_NEXT, {});\n        };\n        this._searchBox.onSearch = function (text) {\n            orgModule.fire(orgModule.Event.ENTITY_SEARCH, { text: text });\n        };\n        orgModule.toolbar.initialize(options.toolbarModel);\n        this.toolbar = orgModule.toolbar;\n        this.list.show();\n    },\n    _initEvents: function () {\n        this.list.observe('item:selected', function (event) {\n            var item = event.memo.item, properties = orgModule.properties;\n            this.lastSelectedName = item.getValue().getNameWithTenant();\n            orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                entityId: item.getValue().id,\n                entityEvent: true\n            });\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);\n        }.bindAsEventListener(this));\n        this.list.observe('item:unselected', function (event) {\n            var tenantsTree = orgModule.manager.tenantsTree, properties = orgModule.properties;\n            properties.changeDisable(false, ['#' + properties._EDIT_BUTTON_ID]);    // Due to complexity of code in mng.common (event flow) there is need to handle some cases in such inappropriate manner\n            // This need to by refactored once mng.common will be refactored in new AMD way + new tree.\n            // Due to complexity of code in mng.common (event flow) there is need to handle some cases in such inappropriate manner\n            // This need to by refactored once mng.common will be refactored in new AMD way + new tree.\n            if (!properties.locked && tenantsTree) {\n                orgModule.fire(orgModule.Event.ENTITY_SELECT_AND_GET_DETAILS, {\n                    entityId: tenantsTree.getTenant().id,\n                    entityEvent: true,\n                    isCtrlHeld: event.memo.isCtrlHeld\n                });\n            } else {\n                properties.hide();\n                this.toolbar.refresh();\n            }\n        }.bindAsEventListener(this));\n        this.list.observe('item:beforeSelectOrUnselect', function (event) {\n            var item = event.memo.item;\n            event.stopSelectOrUnselect = !orgModule.invokeClientAction('cancelIfEdit', {\n                entity: item.getValue(),\n                showConfirm: event.memo.showConfirm\n            });\n        }.bindAsEventListener(this));\n    },\n    //    _refreshProperties: function() {\n    //        if (this.list.getSelectedItems().length == 1) {\n    //            orgModule.properties.show(this.list.getSelectedItems()[0].getValue());\n    //        } else {\n    //            orgModule.properties.hide();\n    //        }\n    //    },\n    _createEntityItem: function (value) {\n        var item = new dynamicList.ListItem({\n            label: value.getDisplayName(),\n            value: value\n        });\n        var entityList = this;\n        item.processTemplate = function (element) {\n            var id = element.select(entityList.ID_PATTERN)[0];\n            id.update(xssUtil.hardEscape(this.getValue().getDisplayName()));\n            return element;\n        };\n        return item;\n    },\n    getSearchText: function () {\n        return this._searchBox.getText();\n    },\n    setSearchText: function (text) {\n        return this._searchBox.setText(text);\n    },\n    getSelectedEntities: function () {\n        if (this.list) {\n            return this.list.getSelectedItems().collect(function (item) {\n                return item.getValue();\n            });\n        } else {\n            return [];\n        }\n    },\n    setEntities: function (entities) {\n        var items = entities.collect(this._createEntityItem.bind(this));\n        this._infiniteScroll.reset();\n        this.list.setItems(items);\n        this.list.show();\n        this.toolbar.refresh();\n    },\n    findEntity: function (name) {\n        var items = this.list.getItems(), options = orgModule.properties.options || orgModule.userManager.options;\n        return options._.find(items, function (item) {\n            return item.getValue().fullName === name;\n        });\n    },\n    addEntities: function (entities) {\n        var items = entities.collect(this._createEntityItem.bind(this));\n        this.list.addItems(items);\n        this.list.refresh();\n        this.toolbar.refresh();\n    },\n    selectEntity: function (entityName) {\n        var all = this.list.getItems();\n        var matched = all.detect(function (item) {\n            return item.getValue().getNameWithTenant() == entityName;\n        });\n        if (matched) {\n            matched.isSelected() && matched.deselect();\n            matched.select();\n            this.lastSelectedName = matched.getValue().getNameWithTenant();\n        }\n    },\n    restoreSelectedEntity: function (entityName) {\n        this.selectEntity(this.lastSelectedName ? this.lastSelectedName : entityName);\n    },\n    deselectAll: function () {\n        this.list.resetSelected();\n    },\n    update: function (entityName, newEntity) {\n        var all = this.list.getItems();\n        var matched = all.findAll(function (item) {\n            return item.getValue().getNameWithTenant() == entityName;\n        });\n        matched.each(function (item) {\n            item.setValue(newEntity);\n            item.refresh();\n        });\n    },\n    remove: function (entityNameOrNameSet) {\n        var all = this.list.getItems();\n        var matched;\n        if (isArray(entityNameOrNameSet)) {\n            matched = all.findAll(function (item) {\n                return entityNameOrNameSet.include(item.getValue().getNameWithTenant());\n            });\n        } else {\n            matched = all.findAll(function (item) {\n                return item.getValue().getNameWithTenant() == entityNameOrNameSet;\n            });\n        }\n        this.list.resetSelected();\n        this.list.removeItems(matched);\n    }\n};\norgModule.properties = {\n    _EDIT_MODE_CLASS: 'editMode',\n    _moveButtonsId: 'moveButtons',\n    _id: 'properties',\n    _value: null,\n    isEditMode: false,\n    _NOTHING_TO_DISPLAY_ID: 'nothingToDisplay',\n    _ASSIGNED_VIEW_ID: 'assignedView',\n    _ASSIGNED_VIEW_LIST_ID: 'assignedViewList',\n    _ASSIGNED_ID: 'assigned',\n    _AVAILABLE_ID: 'available',\n    _ASSIGNED_LIST_ID: 'assignedList',\n    _AVAILABLE_LIST_ID: 'availableList',\n    _ATTRIBUTES_LIST_ID: 'attributesTab',\n    _EDIT_BUTTON_ID: 'edit',\n    _SAVE_BUTTON_ID: 'save',\n    _CANCEL_BUTTON_ID: 'cancel',\n    _DELETE_BUTTON_ID: 'delete',\n    _REMOVE_FROM_ASSIGNED_BUTTON_ID: 'removeFromAssigned',\n    _ADD_TO_ASSIGNED_BUTTON_ID: 'addToAssigned',\n    _BUTTONS_CONTAINER_ID: 'propertiesButtons',\n    _MOVE_BUTTONS_CONTAINER_ID: 'moveButtons',\n    _DND_CLASS: '.draggable',\n    _DROP_CLASS: 'wrap',\n    buttonsFunctions: {},\n    initialize: function (options) {\n        var attributesTypesEnum = options.attributesTypesEnum;\n        this.options = options;\n        this.locked = false;\n        this.hide();\n        this.processTemplate(options);\n        this._toggleButton();\n        if (options.attributes) {\n            var attributesType = !orgModule.userManager && orgModule.orgManager ? attributesTypesEnum.TENANT : attributesTypesEnum.USER, optionsFactory = options.attributesViewOptionsFactory, scrollEventTrait = options.scrollEventTrait, AttributesViewFacade = options.AttributesViewFacade;\n            this.options._.extend(this, scrollEventTrait);\n            this.attributesFacade = new AttributesViewFacade(optionsFactory({\n                context: options.attributes.context,\n                container: jQuery('#attributesTab'),\n                type: attributesType\n            }));\n        }\n        if (this.options.showAssigned) {\n            this.initDnD();\n        }\n        this.initEvents();\n        this.initButtonsFunctions();\n        this.options.ConfirmationDialog && this._initConfirmationDialog();\n    },\n    _initConfirmationDialog: function () {\n        var self = this, i18n = this.options.i18n;\n        this.confirmationDialog = new this.options.ConfirmationDialog({\n            title: i18n['attributes.confirm.dialog.title'],\n            text: i18n['attributes.confirm.cancel.dialog.text']\n        });\n        this.confirmationDialog.on('button:yes', function () {\n            self.cancelOnEdit();\n        });\n    },\n    _toggleButton: function () {\n        var propertiesIsChanged = this.isChanged(), attributesAndPropertiesChanged = this.attributesFacade && this.attributesFacade.containsUnsavedItems() || propertiesIsChanged;\n        attributesAndPropertiesChanged ? this.saveButton.removeAttribute('disabled') : this.saveButton.removeClassName('over').setAttribute('disabled', 'disabled');\n    },\n    show: function (value, refreshAttributes) {\n        if (!this.locked) {\n            if (this.attributesFacade) {\n                var self = this, isRoot = value && value.isRoot && value.isRoot(), context = !isRoot ? value : this.options._.extend({}, value, { id: null });\n                this.attributesFacade.getCurrentView().setContext(context, refreshAttributes).done(function () {\n                    self.attributesFacade.render(isRoot);\n                });\n            }\n            var nothingToDisplay = $(this._NOTHING_TO_DISPLAY_ID);\n            nothingToDisplay.addClassName(layoutModule.HIDDEN_CLASS);\n            document.body.removeClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS);\n            this._value = value;\n            this.changeMode(false);\n        }\n    },\n    hide: function () {\n        if (!this.locked) {\n            var nothingToDisplay = $(this._NOTHING_TO_DISPLAY_ID);\n            nothingToDisplay.removeClassName(layoutModule.HIDDEN_CLASS);\n            centerElement(nothingToDisplay, {\n                horz: true,\n                vert: true\n            });\n            document.body.addClassName(layoutModule.NOTHING_TO_DISPLAY_CLASS);\n            this._value = null;\n            this.changeMode(false);\n        }\n    },\n    lock: function () {\n        this.locked = true;\n    },\n    unlock: function () {\n        this.locked = false;\n    },\n    setDetailsLoadedEntity: function (entity) {\n        this.detailsLoadedEntity = entity;\n    },\n    getDetailsLoadedEntity: function () {\n        return this.detailsLoadedEntity;\n    },\n    processTemplate: function (options) {\n        this.editButton = $(this._EDIT_BUTTON_ID);\n        this.saveButton = $(this._SAVE_BUTTON_ID);\n        this.cancelButton = $(this._CANCEL_BUTTON_ID);\n        this.deleteButton = $(this._DELETE_BUTTON_ID);\n        if (this.options.showAssigned) {\n            this.removeFromAssigned = $(this._REMOVE_FROM_ASSIGNED_BUTTON_ID);\n            this.addToAssigned = $(this._ADD_TO_ASSIGNED_BUTTON_ID);\n            this.assignedViewList = new dynamicList.List(this._ASSIGNED_VIEW_LIST_ID, {\n                listTemplateDomId: options.viewAssignedListTemplateDomId,\n                itemTemplateDomId: options.viewAssignedItemTemplateDomId,\n                comparator: this.assignedComparator,\n                allowSelections: false,\n                selectionDefaultsToCursor: false\n            });\n            var commonOptions = {\n                listTemplateDomId: 'list_responsive_collapsible_fields',\n                itemTemplateDomId: 'list_responsive_collapsible_fields:fields',\n                comparator: this.assignedComparator,\n                dragPattern: this._DND_CLASS,\n                allowSelections: true,\n                selectionDefaultsToCursor: true,\n                multiSelect: true,\n                selectOnMousedown: true,\n                setCursorOnMouseDown: true\n            };\n            this.assignedList = new dynamicList.List(this._ASSIGNED_LIST_ID, Object.extend({}, commonOptions, {\n                allowSelections: false,\n                selectionDefaultsToCursor: false    //selectOnMouseDown: false,\n                //setCursorOnMouseDown: false\n            }));\n            this.availableList = new dynamicList.List(this._AVAILABLE_LIST_ID, commonOptions);    //            this.assignedList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.assignedList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.availableList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.availableList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.assignedList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.assignedList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            //            this.availableList.DND_WRAPPER_TEMPLATE = \"column_two\";\n            //            this.availableList.DND_ITEM_TEMPLATE = \"column_two:resourceName\";\n            if (options.searchAssigned) {\n                this.assignedViewSearchBox = new SearchBox({ id: $(this._ASSIGNED_VIEW_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n                this.assignedViewSearchBox.onSearch = function (text) {\n                    orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: text });\n                };\n            }\n            this.availableSearchBox = new SearchBox({ id: $(this._AVAILABLE_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n            this.availableSearchBox.onSearch = function (text) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE, { text: text });\n            };\n            this.assignedSearchBox = new SearchBox({ id: $(this._ASSIGNED_ID).select(layoutModule.SEARCH_LOCKUP_PATTERN)[0].identify() });\n            this.assignedSearchBox.onSearch = function (text) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: text });\n            };\n            if (options.searchAssigned) {\n                this.assignedViewInfiniteScroll = new InfiniteScroll({\n                    id: $($(this._ASSIGNED_VIEW_LIST_ID).parentNode).identify(),\n                    contentId: this._ASSIGNED_VIEW_LIST_ID\n                });\n                this.assignedViewInfiniteScroll.onLoad = function () {\n                    orgModule.invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED, {});\n                };\n            }\n            this.availableInfiniteScroll = new InfiniteScroll({\n                id: $($(this._AVAILABLE_LIST_ID).parentNode).identify(),\n                contentId: this._AVAILABLE_LIST_ID\n            });\n            this.availableInfiniteScroll.onLoad = function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.NEXT_AVAILABLE, {});\n            };\n            this.assignedInfiniteScroll = new InfiniteScroll({\n                id: $($(this._ASSIGNED_LIST_ID).parentNode).identify(),\n                contentId: this._ASSIGNED_LIST_ID\n            });\n            this.assignedInfiniteScroll.onLoad = function () {\n                orgModule.invokeServerAction(orgModule.ActionMap.NEXT_ASSIGNED, {});\n            };\n        }\n    },\n    initDnD: function () {\n        Droppables.add($(this._ASSIGNED_LIST_ID).up(), {\n            accept: [this._DROP_CLASS],\n            hoverclass: layoutModule.DROP_TARGET_CLASS,\n            onDrop: function (dragged, dropped, event) {\n                if (dragged.items) {\n                    this._addToAssigned();\n                }\n            }.bind(this)\n        });\n        Droppables.add($(this._AVAILABLE_LIST_ID).up(), {\n            accept: [this._DROP_CLASS],\n            hoverclass: layoutModule.DROP_TARGET_CLASS,\n            onDrop: function (dragged, dropped, event) {\n                if (dragged.items) {\n                    this._removeFromAssigned();\n                }\n            }.bind(this)\n        });\n    },\n    initEvents: function () {\n        function assignedSelectionHandler() {\n            (this.assignedList.getSelectedItems().length > 0 ? buttonManager.enable : buttonManager.disable)(this.removeFromAssigned);\n        }\n        function availableSelectionHandler() {\n            (this.availableList.getSelectedItems().length > 0 ? buttonManager.enable : buttonManager.disable)(this.addToAssigned);\n        }\n        $(this._BUTTONS_CONTAINER_ID).observe('click', function (event) {\n            var element = event.element();\n            var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n            if (button) {\n                if (this.buttonsFunctions[button.identify()]) {\n                    this.buttonsFunctions[button.identify()].call(this);\n                }\n            }\n            event.preventDefault();\n            event.stopPropagation();\n        }.bindAsEventListener(this));\n        if (this.options.showAssigned) {\n            $(this._MOVE_BUTTONS_CONTAINER_ID).observe('click', function (event) {\n                var element = event.element();\n                var button = matchAny(element, [layoutModule.BUTTON_PATTERN], true);\n                if (button) {\n                    if (button == this.removeFromAssigned) {\n                        this._removeFromAssigned();\n                    } else if (button == this.addToAssigned) {\n                        this._addToAssigned();\n                    }\n                }\n                event.preventDefault();\n                event.stopPropagation();\n            }.bindAsEventListener(this));\n            this.assignedList.observe('item:selected', assignedSelectionHandler.bindAsEventListener(this));\n            this.assignedList.observe('item:unselected', assignedSelectionHandler.bindAsEventListener(this));\n            this.assignedList.observe('item:dblclick', function (event) {\n                this._removeFromAssigned();\n            }.bindAsEventListener(this));\n            this.availableList.observe('item:selected', availableSelectionHandler.bindAsEventListener(this));\n            this.availableList.observe('item:unselected', availableSelectionHandler.bindAsEventListener(this));\n            this.availableList.observe('item:dblclick', function (event) {\n                this._addToAssigned();\n            }.bindAsEventListener(this));\n        }\n        this.attributesFacade && this.attributesFacade.on('change', this.options._.bind(this._toggleButton, this));\n    },\n    initButtonsFunctions: function () {\n        this.buttonsFunctions[this._EDIT_BUTTON_ID] = function () {\n            this.changeMode(true);\n        };\n        this.buttonsFunctions[this._SAVE_BUTTON_ID] = function () {\n            var extObj = this;\n            var dfd = new jQuery.Deferred();\n            if(this.asyncValidate) {\n                this.asyncValidate().done(function() {\n                    extObj.attributesFacade ? extObj.attributesFacade.getCurrentView().saveChildren().done(function () {\n                        dfd.resolve();\n                    }).fail(function () {\n                        dfd.reject();\n                        jQuery('.tab[tabid=\\'#attributesTab\\']').trigger('mouseup');\n                    }) : dfd.resolve();\n                    dfd.done(function () {\n                        extObj.save(extObj._value);\n                    });\n                });\n            } else if(this.validate()) {\n                //This part never gets called, we can remove this in future.\n                this.attributesFacade ? this.attributesFacade.getCurrentView().saveChildren().done(function () {\n                    dfd.resolve();\n                }).fail(function () {\n                    dfd.reject();\n                    jQuery('.tab[tabid=\\'#attributesTab\\']').trigger('mouseup');\n                }) : dfd.resolve();\n                dfd.done(function () {\n                    extObj.save(extObj._value);\n                });\n            }\n        };\n        this.buttonsFunctions[this._CANCEL_BUTTON_ID] = function () {\n            if (this.attributesFacade) {\n                this.isChanged() ? this.confirmationDialog.open() : this.cancelOnEdit();\n            } else {\n                orgModule.invokeClientAction('cancelIfEdit', { entity: this.getValue() });\n            }\n        };\n        this.buttonsFunctions[this._DELETE_BUTTON_ID] = function () {\n            this._deleteEntity();\n        };\n        this.buttonsFunctions[this._REMOVE_FROM_ASSIGNED_BUTTON_ID] = function () {\n            this._removeFromAssigned();\n        };\n        this.buttonsFunctions[this._ADD_TO_ASSIGNED_BUTTON_ID] = function () {\n            this._addFromAssigned();\n        };\n    },\n    cancelOnEdit: function () {\n        var self = this;\n        if (this.isEditMode) {\n            this.cancel().done(function () {\n                self.unlock();\n                self.changeMode(false);\n                self._toggleButton();\n            });\n        }\n    },\n    changeMode: function (edit) {\n        this.isEditMode = edit;\n        var tabs, attributeTab, propertiesTab, $anchor;\n        if (this.attributesFacade) {\n            attributeTab = $('attributesTab');\n            var hideFilters = !!this._value && this._value.id === 'organizations';\n            this.detachScrollEvent(this.attributesFacade.getCurrentView().$container.parent());\n            this.attributesFacade.toggleMode(edit, hideFilters);\n            edit && this.initScrollEvent(this.attributesFacade.getCurrentView());\n            tabs = $$('.tertiary')[0];\n            propertiesTab = $('propertiesTab');\n            $anchor = jQuery('.control.tabSet.anchor');\n        }\n        if (edit) {\n            $(this._id).addClassName(this._EDIT_MODE_CLASS);\n            if (tabs) {\n                tabs.down('.selected').removeClassName('selected');\n                tabs.down('li', 0).addClassName('selected');\n                tabs.addClassName('tabbed');\n                attributeTab.addClassName('hidden');\n                propertiesTab.removeClassName('hidden');\n                $anchor.removeClass('attributesAnchor');\n            }\n            this._assigned = [];\n            this._unassigned = [];\n            if (this.options.showAssigned) {\n                centerElement($(this._moveButtonsId), { horz: true });\n                $(this._moveButtonsId).style.zIndex = 1000;    //fix for bug 26831\n                //fix for bug 26831\n                this.assignedList.setItems([]);\n                this.assignedList.show();\n                this.availableList.setItems([]);\n                this.availableList.show();\n                buttonManager.disable(this.removeFromAssigned);\n                buttonManager.disable(this.addToAssigned);\n                this.assignedSearchBox.setText('');\n                this.availableSearchBox.setText('');\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_ASSIGNED, { text: this.assignedSearchBox.getText() });\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH_AVAILABLE, { text: this.availableSearchBox.getText() });\n            }\n            this._editEntity();\n            this._toggleButton();\n        } else {\n            $(this._id).removeClassName(this._EDIT_MODE_CLASS);\n            if (tabs) {\n                attributeTab.removeClassName('hidden');\n                propertiesTab.removeClassName('hidden');\n                tabs.removeClassName('tabbed');\n            }\n            if (this.options.searchAssigned && this.assignedViewSearchBox) {\n                this.assignedViewSearchBox.setText('');\n            }\n            this.changeDisable(this.canEdit(), ['#' + this._EDIT_BUTTON_ID]);\n            this.changeDisable(this.canDelete(), ['#' + this._DELETE_BUTTON_ID]);\n            this._showEntity();\n            this._assigned = [];\n            this._unassigned = [];\n        }\n    },\n    canEdit: function () {\n        return true;\n    },\n    canDelete: function () {\n        let orgProperties = this.getValue();\n        if ( orgProperties && orgProperties.getNameWithTenant() === this.options.currentUser) {\n            return false;\n        }\n        return !!orgProperties && orgProperties.uri !== '/';\n    },\n    setValuesProperty: function (name, value) {\n        this._value[name] = value;\n    },\n    getValue: function () {\n        return this._value;\n    },\n    setProperties: function (properties) {\n    },    // Template method.\n\n    isChanged: function (properties) {\n    },    // Template method.\n\n    save: function (properties) {\n    },    // Template method.\n\n    validate: function () {\n        // Template method.\n        return true;\n    },\n    assignedComparator: function (item1, item2) {\n        var l1 = item1.getLabel();\n        var l2 = item2.getLabel();\n        return l1 > l2 ? 1 : l1 < l2 ? -1 : 0;\n    },\n    _moveEntities: function (bToAssigned) {\n        var from, to, fromList, toList;\n        if (bToAssigned) {\n            from = this._unassigned;\n            fromList = this.availableList;\n            to = this._assigned;\n            toList = this.assignedList;\n        } else {\n            from = this._assigned;\n            fromList = this.assignedList;\n            to = this._unassigned;\n            toList = this.availableList;\n        }\n        var items = fromList.getSelectedItems();\n        var entities = items.collect(function (item) {\n            return item.getValue();\n        });\n        to = to.concat(entities.collect(function (entity) {\n            return entity.available == bToAssigned ? entity : null;\n        })).compact();\n        from = from.reject(function (fromItem) {\n            return entities.detect(function (entity) {\n                return fromItem.equals(entity);\n            });\n        });\n        fromList.removeItems(items);\n        toList.addItems(items, true);\n        toList.refresh();\n        if (bToAssigned) {\n            this._unassigned = from;\n            this._assigned = to;\n        } else {\n            this._assigned = from;\n            this._unassigned = to;\n        }\n    },\n    _addToAssigned: function () {\n        this._moveEntities(true);\n    },\n    _removeFromAssigned: function () {\n        this._moveEntities(false);\n    },\n    _entitiesToItems: function (entities, isAvailable) {\n        entities = entities ? entities : [];\n        return entities.collect(function (entity) {\n            var label = '';\n            var tooltipText = [], template = 'orgTooltip';\n            if (entity instanceof orgModule.User) {\n                label = entity.userName;\n                if (entity.fullName && entity.fullName.length > 0) {\n                    tooltipText = [entity.fullName];\n                }\n                template = entity.tenantId ? 'fullNameAndOrgTooltip' : 'fullNameTooltip';\n            } else if (entity instanceof orgModule.Role) {\n                label = entity.roleName;\n                template = entity.tenantId ? 'orgTooltip' : undefined;\n            }\n            if (entity.tenantId && entity.tenantId.length > 0) {\n                tooltipText.push(entity.tenantId);\n            }\n            entity.available = !!isAvailable;\n            var item = new dynamicList.ListItem({\n                label: label,\n                value: entity\n            });\n            if (this.isEditMode) {\n                item.processTemplate = function (element) {\n                    if (tooltipText.length > 0) {\n                        new JSTooltip(element, {\n                            text: xssUtil.hardEscape(tooltipText),\n                            templateId: template\n                        });\n                    }\n                    return dynamicList.ListItem.prototype.processTemplate.call(this, element);\n                };\n            } else {\n                item.processTemplate = function (element) {\n                    var nameAnchor = element.select('a')[0];\n                    nameAnchor.insert(xssUtil.hardEscape(this.getLabel()));\n                    nameAnchor.writeAttribute('href', this.getValue().getManagerURL());\n                    if (tooltipText.length > 0) {\n                        new JSTooltip(element, {\n                            text: xssUtil.hardEscape(tooltipText),\n                            templateId: template\n                        });\n                    }\n                    return element;\n                };\n            }\n            return item;\n        }.bind(this));\n    },\n    getAssignedEntities: function () {\n        return this._assigned;\n    },\n    getUnassignedEntities: function () {\n        return this._unassigned;\n    },\n    setAssignedEntities: function (entities) {\n        this.assignedViewInfiniteScroll && this.assignedViewInfiniteScroll.reset();\n        this.assignedInfiniteScroll && this.assignedInfiniteScroll.reset();\n        var list = this.isEditMode ? this.assignedList : this.assignedViewList;\n        var filteredEntities = this._filterEntities(entities, this._unassigned, this._assigned, this.assignedSearchBox.getText());\n        list.setItems(this._entitiesToItems(filteredEntities));\n        list.refresh();\n    },\n    addAssignedEntities: function (entities) {\n        var list = this.isEditMode ? this.assignedList : this.assignedViewList;\n        var filteredEntities = this._filterEntities(entities, this._unassigned, this._assigned, this.assignedSearchBox.getText());\n        list.addItems(this._entitiesToItems(filteredEntities));\n        list.refresh();\n    },\n    setAvailableEntities: function (entities) {\n        this.availableInfiniteScroll.reset();\n        var filteredEntities = this._filterEntities(entities, this._assigned, this._unassigned, this.availableSearchBox.getText());\n        this.availableList.setItems(this._entitiesToItems(filteredEntities, true));\n        this.availableList.refresh();\n    },\n    addAvailableEntities: function (entities) {\n        var filteredEntities = this._filterEntities(entities, this._assigned, this._unassigned, this.availableSearchBox.getText());\n        this.availableList.addItems(this._entitiesToItems(filteredEntities, true));\n        this.availableList.refresh();\n    },\n    _filterEntities: function (entities, removeSet, addSet, text) {\n        var allEntities = entities.reject(function (entity) {\n            return removeSet.detect(function (removeEntity) {\n                return removeEntity.equals(entity);\n            });\n        });\n        text = text.toLowerCase();\n        allEntities = allEntities.concat(addSet.findAll(function (entity) {\n            return entity.getDisplayName().toLowerCase().include(text);\n        }));\n        return allEntities;\n    },\n    changeReadonly: function (edit, elementsPatterns) {\n        elementsPatterns.each(function (elementPattern) {\n            $(this._id).select(elementPattern)[0].writeAttribute(layoutModule.READONLY_ATTR_NAME, edit ? null : layoutModule.READONLY_ATTR_NAME);\n        }.bind(this));\n    },\n    resetValidation: function (elementsPatterns) {\n        var panel = $(this._id);\n        elementsPatterns.each(function (elementPattern) {\n            ValidationModule.hideError(panel.select(elementPattern)[0]);\n        }.bind(this));\n    },\n    changeDisable: function (edit, elementsPatterns) {\n        elementsPatterns.each(function (elementPattern) {\n            if (edit) {\n                buttonManager.enable($(this._id).select(elementPattern)[0]);\n            } else {\n                buttonManager.disable($(this._id).select(elementPattern)[0]);\n            }\n        }.bind(this));\n    },\n    _deleteEntity: function () {\n    },    // Template method.\n\n    _editEntity: function () {\n    },    // Template method.\n\n    _showEntity: function () {\n    }    // Template method.\n};\norgModule.addDialog = {\n    show: function (organization) {\n    },    // Template method.\n\n    hide: function (organization) {\n    }    // Template method.\n};\norgModule.Action = function (invokeFn, beforeInvoke) {\n    if (Object.isFunction(invokeFn)) {\n        beforeInvoke = beforeInvoke && Object.isFunction(beforeInvoke) ? beforeInvoke : this.beforeInvoke;\n        this.invokeAction = function () {\n            if (beforeInvoke()) {\n                return invokeFn.apply(this, arguments);\n            }\n        };\n    }\n};    /**\n * Invokes action.\n */\n/**\n * Invokes action.\n */\norgModule.Action.addMethod('invokeAction', doNothing);    /**\n * Invokes function before action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\n/**\n * Invokes function before action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\norgModule.Action.addMethod('beforeInvoke', function () {\n    return true;\n});\norgModule.ServerAction = function (eventId, options) {\n    this.actionURL = 'flow.html?_flowExecutionKey=' + window.localContext.flowExecutionKey + '&_eventId=' + eventId;\n    this.data = Object.toQueryString(options);\n    this.onSuccess = doNothing();\n    this.onError = doNothing();\n};    /**\n * Invokes server action.\n */\n/**\n * Invokes server action.\n */\norgModule.ServerAction.addMethod('invokeAction', function () {\n    if (this.beforeInvoke()) {\n        ajaxTargettedUpdate(this.actionURL, {\n            postData: this.data,\n            callback: function (response) {\n                if (response.error) {\n                    this.onError(response.error);\n                } else {\n                    this.onSuccess(response.data);\n                }\n            }.bind(this),\n            errorHandler: function (ajaxAgent) {\n                if (ajaxAgent.getResponseHeader('LoginRequested')) {\n                    orgModule.fire(orgModule.Event.SERVER_UNAVAILABLE, {});\n                    return true;\n                }\n                return baseErrorHandler(ajaxAgent);\n            },\n            mode: AjaxRequester.prototype.EVAL_JSON\n        });\n    }\n});    /**\n * Invokes function before server action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\n/**\n * Invokes function before server action is invoked..\n *\n * @return {Boolean} if false if true the action will not occur\n */\norgModule.ServerAction.addMethod('beforeInvoke', function () {\n    return true;\n});\norgModule.toolbar = {\n    _actionModel: {},\n    initialize: function (actionModel) {\n        this._actionModel = actionModel;\n        toolbarButtonModule.initialize(this._toActionMap(this._actionModel));\n        this.refresh();\n    },\n    refresh: function () {\n        for (var name in this._actionModel) {\n            var id = this._actionModel[name].buttonId;\n            var testFn = toFunction(this._actionModel[name].test);\n            toolbarButtonModule.setButtonState($(id), testFn());\n        }\n    },\n    _toActionMap: function (bulkActionModel) {\n        var actionMap = {};\n        for (var name in bulkActionModel) {\n            var bulkAction = bulkActionModel[name];\n            var id = bulkAction.buttonId;\n            actionMap[id] = function (action, actionArgs) {\n                return function () {\n                    var myAction = getAsFunction(action);\n                    var args = actionArgs;\n                    var belongsToLocalContext = window.localContext && window.localContext[action];\n                    if (args && isArray(args)) {\n                        myAction.apply(belongsToLocalContext ? window.localContext : null, args);\n                    } else {\n                        myAction.call(belongsToLocalContext ? window.localContext : null, args);\n                    }\n                };\n            }(bulkAction.action, bulkAction.actionArgs);\n        }\n        return actionMap;\n    }\n};    ////////////////////////////////////////////////////////////////////////////////////////\n// Input validator\n////////////////////////////////////////////////////////////////////////////////////////\n/**\n * Parameter should have two properties:\n * <ul>\n * <li>regExp {RegExp} - expression must contains list of unsupported symbols</li>\n * <li>unsupportedSymbols {String} -  list of unsupported symbols which will be displayed in error message</li>\n * </ul>\n * @param input {DOMElement}\n */\n////////////////////////////////////////////////////////////////////////////////////////\n// Input validator\n////////////////////////////////////////////////////////////////////////////////////////\n/**\n * Parameter should have two properties:\n * <ul>\n * <li>regExp {RegExp} - expression must contains list of unsupported symbols</li>\n * <li>unsupportedSymbols {String} -  list of unsupported symbols which will be displayed in error message</li>\n * </ul>\n * @param input {DOMElement}\n */\norgModule.createInputRegExValidator = function (input) {\n    return {\n        validator: function (value) {\n            var matches = input.regExp.test(value);\n            var isValid = !matches;\n            var errorMessage = isValid ? '' : orgModule.getMessage('unsupportedSymbols', { symbols: input.unsupportedSymbols });\n            input.isValid = isValid;\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: input\n    };\n};    /**\n *  Check element value isn't blank\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\n/**\n *  Check element value isn't blank\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\norgModule.createBlankValidator = function (element, messageKey, onValid, onInvalid) {\n    return {\n        validator: function (value) {\n            var isValid = !value.blank();\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element,\n        onValid: onValid,\n        onInvalid: onInvalid\n    };\n};    /**\n *  Check max length of value\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\n/**\n *  Check max length of value\n *\n * @param element {DOMElement}\n * @param messageKey {String}\n */\norgModule.createMaxLengthValidator = function (element, messageKey, replaceKey) {\n    return {\n        validator: function (value) {\n            var max = element.hasAttribute('maxlength') ? element.readAttribute('maxlength') : element.maxlength;\n            var isValid = value.length < parseInt(max);\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            replaceKey && (errorMessage = errorMessage.replace(replaceKey, max));\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};    /**\n *\n *\n * @param element {DOMElement} Validated element\n * @param asElement {DOMElement} Element to compare with\n * @param messageKey {String}\n */\n/**\n *\n *\n * @param element {DOMElement} Validated element\n * @param asElement {DOMElement} Element to compare with\n * @param messageKey {String}\n */\norgModule.createSameValidator = function (element, asElement, messageKey) {\n    return {\n        validator: function (value) {\n            var isValid = value === asElement.getValue();\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};    /**\n *\n *\n * @param element {DOMElement} Validated element\n * @param messageKey {String}\n */\n/**\n *\n *\n * @param element {DOMElement} Validated element\n * @param messageKey {String}\n */\norgModule.createRegExpValidator = function (element, messageKey, regExp) {\n    return {\n        validator: function (value) {\n            var matches = regExp.exec(value);\n            var isValid = !matches && value.length === 0 || matches && value == matches[0];\n            var errorMessage = isValid ? '' : orgModule.getMessage(messageKey);\n            return {\n                isValid: isValid,\n                errorMessage: errorMessage\n            };\n        },\n        element: element\n    };\n};\norgModule.truncateOrgName = function (name) {\n    return name && name.length > 0 ? name.truncate(15) : '';\n};    ////////////////////////////////////////////////////////////////////////////////////////\n// Used to convert regular expression with unsupported symbols into string separated by comas.\n////////////////////////////////////////////////////////////////////////////////////////\n////////////////////////////////////////////////////////////////////////////////////////\n// Used to convert regular expression with unsupported symbols into string separated by comas.\n////////////////////////////////////////////////////////////////////////////////////////\nfunction RegExpRepresenter(expression) {\n    this.charMap = { '\\\\s': ' ' };\n    this.expressionTokens = this.__parse(expression);\n}\nRegExpRepresenter.addMethod('__parse', function (expression) {\n    var result = $A();\n    for (var i = 1; i < expression.length - 1; i++) {\n        var ch = expression.charAt(i);\n        if (ch == '\\\\') {\n            ch += expression.charAt(++i);\n        }\n        if (ch == '\\\\u') {\n            ch += expression.substring(++i, i + 4);\n            i += 3;\n        }\n        result.push(ch);\n    }\n    return result;\n});\nRegExpRepresenter.addMethod('getCharacters', function () {\n    var result = $A();\n    this.expressionTokens.each(function (token) {\n        if (token.startsWith('\\\\u')) {\n            /*eslint-disable-next-line no-eval*/\n            result.push(eval('\"' + token + '\"'));\n        } else if (token.startsWith('\\\\')) {\n            var ch = this.charMap[token];\n            result.push(ch ? ch : token.substring(1, token.length));\n        } else {\n            result.push(token);\n        }\n    }.bind(this));\n    return result;\n});\nRegExpRepresenter.addMethod('getRepresentedString', function () {\n    var result = '';\n    var chars = this.getCharacters();\n    var len = chars.length;\n    for (var i = 0; i < len; i++) {\n        var ch = chars[i];\n        if (ch == ' ' || ch == '.' || ch == ',') {\n            result += '[' + ch + ']';\n        } else {\n            result += ch;\n        }\n        if (i < len - 1) {\n            result += ', ';\n        }\n    }\n    return result;\n});\n\nexport default orgModule;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @version: $Id$\n */\n\n/* global alert */\n\nimport {isProVersion} from \"../namespace/namespace\";\nimport _ from 'underscore';\nimport orgModule from './mng.org.module';\n\nfunction invokeServerAction(actionName, options) {\n    var actionBuilder = orgModule.serverActionFactory[actionName];\n\n    if (actionBuilder) {\n        var action = actionBuilder.call(orgModule.serverActionFactory, options);\n        action.invokeAction();\n    } else {\n        throw new Error(\"No server action found for action name '\" + actionName + \"'\");\n    }\n}\n\nfunction invokeClientAction(actionName, options) {\n    var actionBuilder = orgModule.clientActionFactory[actionName];\n\n    if (actionBuilder) {\n        var action = actionBuilder.call(orgModule.clientActionFactory, options);\n        return action.invokeAction();\n    } else {\n        throw new Error(\"No client action found for action name '\" + actionName + \"'\");\n    }\n}\n\norgModule.confirmAndLeave = function() {\n    var entities = orgModule.entityList.getSelectedEntities();\n\n    if(!orgModule.properties.attributesFacade){\n        return orgModule.invokeClientAction(\"cancelIfEdit\", { entity: entities[0], entityEvent: false});\n    }\n\n    return true;\n};\n\norgModule.manager = {\n    initialize: function(options) {\n        this.options = options;\n        this.state = options.state;\n\n        _.extend(this.state, {id: this.state.tenantId});\n\n        if (isProVersion()) {\n            this.tenantsTree = new options.TenantsTreeView({\n                container: \"#folders .body\",\n                currentUser: options.currentUser,\n                removeContextMenuTreePlugin: options.removeContextMenuTreePlugin,\n                selectedTenant: this.state,\n                comparator: function(t1, t2){\n                    return orgModule._comparator(t1.tenantName, t2.tenantName)\n                }\n            });\n\n            orgModule.initTenantsTreeEvents();\n            this.tenantsTree.render();\n        }\n\n        // Request events listeners.\n        orgModule.observe(\"org:browse\", function(event) {\n            var org;\n\n            this.tenantsTree && (org = this.tenantsTree.getTenant());\n\n            var entityEvent = event.memo.entityEvent,\n                force = event.memo.force;\n\n            if (force || !this.lastSelectedOrg || this.lastSelectedOrg.id !== org?.id) {\n                var entities = orgModule.entityList.getSelectedEntities();\n\n                if(orgModule.invokeClientAction(\"cancelIfEdit\", { entity: entities[0] || org, entityEvent: entityEvent})) {\n                    orgModule.invokeServerAction(orgModule.ActionMap.BROWSE, {\n                        tenantId : (org) ? org.id : null\n                    });\n                    this.lastSelectedOrg = org;\n                } else {\n                    this.lastSelectedOrg && this.tenantsTree.selectTenant(this.lastSelectedOrg.id);\n                }\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:search\", function(event) {\n            var entities = orgModule.entityList.getSelectedEntities(),\n                text = event.memo.text, org;\n\n            if (this.tenantsTree) {\n                org = this.tenantsTree.getTenant();\n            }\n\n            if(orgModule.invokeClientAction(\"cancelIfEdit\", { entity: entities[0] || org })) {\n                orgModule.invokeServerAction(orgModule.ActionMap.SEARCH, {\n                    text: text\n                });\n                this.lastSearchText = text;\n            } else {\n                if (text.length === 0 && this.lastSearchText && this.lastSearchText.length !== 0) {\n                    orgModule.entityList.setSearchText(this.lastSearchText);\n                }\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:next\", function(event) {\n            orgModule.invokeServerAction(orgModule.ActionMap.NEXT, {});\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:selectAndGetDetails\", function(event) {\n            var entityEvent = event.memo.entityEvent,\n                isCtrlHeld = event.memo.isCtrlHeld,\n                cancelIfEdit = event.memo.cancelIfEdit,\n                entities = orgModule.entityList.getSelectedEntities(),\n                refreshAttributes = Boolean(event.memo.refreshAttributes);\n\n            if (entities.length > 1) {\n                orgModule.properties.hide();\n                orgModule.entityList.toolbar.refresh();\n            } else {\n                var firstEntity = entities[0],\n                    entityName;\n\n                if (firstEntity && entityEvent) {\n                    entityName = firstEntity.getNameWithTenant()\n                } else {\n                    entityName = (!entityEvent || isCtrlHeld || cancelIfEdit) && event.memo.entityId;\n                }\n\n                if (!firstEntity && (orgModule.userManager || (!orgModule.userManager && orgModule.roleManager)) && isCtrlHeld) {\n                    orgModule.properties.hide();\n                    return;\n                }\n\n                entityName && orgModule.invokeServerAction(orgModule.ActionMap.SELECT_AND_GET_DETAILS, {\n                    refreshAttributes: refreshAttributes,\n                    entity: entityName\n                });\n            }\n        }.bindAsEventListener(this));\n\n        // Response events listeners.\n        orgModule.observe(\"result:changed\", function(event) {\n            var data = event.memo.responseData;\n            orgModule.entityList.setEntities(data.entities.collect(this.entityJsonToObject));\n            options.defaultEntity && orgModule.entityList.restoreSelectedEntity(options.defaultEntity);\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"result:next\", function(event) {\n            var data = event.memo.responseData;\n            if (data.entities.length > 0) {\n                orgModule.entityList.addEntities(data.entities.collect(this.entityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:detailsLoaded\", function(event) {\n            var entity = this.entityJsonToObject(event.memo.responseData),\n                properties = orgModule.properties,\n                refreshAttributes = event.memo.inputData.refreshAttributes;\n\n            orgModule.entityList.update(entity.getNameWithTenant(), entity);\n\n            properties.setDetailsLoadedEntity(entity);\n            properties.show(entity, refreshAttributes);\n            !properties.locked && properties.setProperties(entity);\n\n            orgModule.entityList.toolbar.refresh();\n\n            properties.unlock();\n\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"searchAvailable:loaded\", function(event) {\n            var data = event.memo.responseData;\n            if (data && data.entities) {\n                orgModule.properties.setAvailableEntities(data.entities.collect(this.relatedEntityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"searchAssigned:loaded\", function(event) {\n            var data = event.memo.responseData;\n\n            if(data && data.entities) {\n                orgModule.properties.setAssignedEntities(data.entities.collect(this.relatedEntityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"nextAvailable:loaded\", function(event) {\n            var data = event.memo.responseData;\n\n            if (data && data.entities && data.entities.length > 0) {\n                orgModule.properties.addAvailableEntities(data.entities.collect(this.relatedEntityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"nextAssigned:loaded\", function(event) {\n            var data = event.memo.responseData;\n\n            if (data && data.entities && data.entities.length > 0) {\n                orgModule.properties.addAssignedEntities(data.entities.collect(this.relatedEntityJsonToObject));\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"server:error\", function(event) {\n            var error = event.memo.responseData;\n            if(error) {\n                alert(error.message + \"\\n\\n\" + (error.description) ? error.description : \"\");\n            }\n        }) ;\n\n        orgModule.observe(\"entity:created\", function(event) {\n            orgModule.addDialog.hide();\n\n            var entityJson = event.memo.inputData.entity;\n            if (entityJson) {\n                var entity = this.entityJsonToObject(entityJson.evalJSON());\n\n                orgModule.entityList.addEntities([entity]);\n                orgModule.entityList.deselectAll();\n                orgModule.entityList.selectEntity(entity.getNameWithTenant());\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:updated\",function(event) {\n            var self = this;\n            var entityName = event.memo.inputData.entityName;\n\n\n            ////////////////////////////////////////////////////\n            //  2012-05-09  thorick chow\n            //              http://bugzilla.jaspersoft.com/show_bug.cgi?id=27717\n            //\n            //              Special case for User Objects\n            //              if\n            //                  the update involves the server\n            //                  sending us back an updated User Object\n            //              then\n            //                 use that as the entity\n            //              else\n            //                 fallback to whatever the pre-existing cases were using\n            //\n\n            //  if the Response *Object* contains 'roles' property\n            //  then we'll assume that that's enough to qualify it as a User Object\n            var entityJson = event.memo.responseData;\n            if (!entityJson.roles) {\n                entityJson = event.memo.unencryptedEntity;\n            }\n            if (!entityJson) {\n                entityJson = event.memo.inputData.entity;\n            }\n\n            var attributesFacade = orgModule.properties.attributesFacade || {};\n            var saveDfD = attributesFacade.designer && attributesFacade.designer.saveDfD;\n\n            if (orgModule.properties.isEditMode) {\n                saveDfD ? saveDfD.done(function(){\n                    orgModule.properties.changeMode(false);\n                }) : orgModule.properties.changeMode(false);\n            }\n\n            if (entityJson) {\n                saveDfD ? saveDfD.done(function(){\n                    self.updateEntityList(entityJson, entityName);\n                }) : this.updateEntityList(entityJson, entityName);\n            }\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entity:deleted\", function(event) {\n            var entityName = event.memo.inputData.entity;\n\n            orgModule.entityList.remove(entityName);\n        }.bindAsEventListener(this));\n\n        orgModule.observe(\"entities:deleted\", function(event) {\n            var entityNameSet = event.memo.inputData.entities;\n\n            if (entityNameSet) {\n                orgModule.entityList.remove(entityNameSet.evalJSON());\n            }\n        }.bindAsEventListener(this));\n    },\n\n    updateEntityList: function(entityJson, entityName){\n        var entity = this.entityJsonToObject(entityJson.evalJSON ? entityJson.evalJSON() : entityJson);\n        orgModule.entityList.update(entityName, entity);\n        orgModule.entityList.selectEntity(entity.getNameWithTenant ? entity.getNameWithTenant() : entityName);\n    },\n\n    entityJsonToObject: function(json) {\n        // Template method.\n    },\n\n    relatedEntityJsonToObject: function(json) {\n        // Template method.\n    },\n\n    reloadEntities: function() {\n        orgModule.fire(orgModule.Event.ORG_BROWSE, {});\n    },\n\n    isUserSuperuser: function () {\n        var superuserRole = (isProVersion())\n            ? orgModule.Configuration.superuserRole\n            : orgModule.Configuration.adminRole;\n\n        var roles = this.options.currentUserRoles;\n\n        return roles.detect(function(r) { return r.roleName == superuserRole && !r.tenantId; }) != null;\n    }\n};\n\norgModule.invokeServerAction = invokeServerAction;\norgModule.invokeClientAction = invokeClientAction;\n\nexport default orgModule;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport mngCommonActions from './mng.common.actions';\nimport mngCommon from './mng.common';\nimport mngMain from './mng.main';\n\nlet orgModule = Object.assign(mngCommonActions, mngCommon, mngMain);\n\n// expose to global scope\nwindow.orgModule = orgModule;\n\nexport default orgModule;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\nimport _ from 'underscore';\nimport {$A} from 'prototype';\n\nfunction RegExpRepresenter(expression) {\n    this.charMap = { '\\\\s': ' ' };\n    this.expressionTokens = this.__parse(expression);\n}\n_.extend(RegExpRepresenter.prototype, {\n    __parse: function (expression) {\n        var result = $A();\n        for (var i = 1; i < expression.length - 1; i++) {\n            var ch = expression.charAt(i);\n            if (ch == '\\\\') {\n                ch += expression.charAt(++i);\n            }\n            if (ch == '\\\\u') {\n                ch += expression.substring(++i, i + 4);\n                i += 3;\n            }\n            result.push(ch);\n        }\n        return result;\n    },\n    getCharacters: function () {\n        var result = $A();\n        this.expressionTokens.each(function (token) {\n            if (token.startsWith('\\\\u')) {\n                /*eslint-disable-next-line no-eval*/\n                result.push(eval('\"' + token + '\"'));\n            } else if (token.startsWith('\\\\')) {\n                var ch = this.charMap[token];\n                result.push(ch ? ch : token.substring(1, token.length));\n            } else {\n                result.push(token);\n            }\n        }.bind(this));\n        return result;\n    },\n    getRepresentedString: function () {\n        var result = '';\n        var chars = this.getCharacters();\n        var len = chars.length;\n        for (var i = 0; i < len; i++) {\n            var ch = chars[i];\n            if (ch == ' ' || ch == '.' || ch == ',') {\n                result += '[' + ch + ']';\n            } else {\n                result += ch;\n            }\n            if (i < len - 1) {\n                result += ', ';\n            }\n        }\n        return result;\n    }\n});\nexport default RegExpRepresenter;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\nimport Dialog from 'js-sdk/src/common/component/dialog/Dialog';\nimport ExportView from './ExportView';\nimport i18n from 'js-sdk/src/i18n/CommonBundle.properties';\nimport i18n2 from '../../../i18n/ImportExportBundle.properties';\nimport exportTypesEnum from '../enum/exportTypesEnum';\n\nfunction parseRepoData(data) {\n    if (_.isArray(data)) {\n        return _.pluck(data, 'URIString');\n    } else {\n        return [data.URIString];\n    }\n}\nfunction hasReports(data) {\n    _.isArray(data) || (data = [data]);\n    return !!_.reduce(data, function (memo, item) {\n        return memo || !item.resourceType || item.resourceType.indexOf('ReportUnit') + 1 || item.resourceType.indexOf('ReportOptions') + 1;\n    }, false);\n}\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.options = options;\n        Dialog.prototype.constructor.call(this, {\n            model: this.model,\n            resizable: true,\n            modal: true,\n            content: '',\n            buttons: [\n                {\n                    label: i18n['button.export'],\n                    action: 'export',\n                    primary: true\n                },\n                {\n                    label: i18n['button.cancel'],\n                    action: 'cancel',\n                    primary: false\n                }\n            ]\n        });\n        this.on('button:export', _.bind(this._onExportButtonClick, this));\n        this.on('button:cancel', _.bind(this._closeExportDialog, this));\n    },\n    initialize: function (options) {\n        this.exportView = new ExportView();\n        this.listenTo(this.exportView.model, 'validated', function (isValid) {\n            isValid ? this.buttons.enable('export') : this.buttons.disable('export');\n        }, this);\n        Dialog.prototype.initialize.apply(this, arguments);\n    },\n    openRepoDialog: function (repoData, event) {\n        let eventTarget = event\n            && ((event.type === 'mouseup' && event.target.ancestors().filter(element => element.hasClassName(\"selected\"))[0])\n                || (event.type === 'dataavailable' && event.target));\n        var uris = parseRepoData(repoData);\n        var organizationsFolderUri = jrsConfigs.organizationsFolderUri || '/organizations';\n        var orgTemplateFolderUri = jrsConfigs.orgTemplateFolderUri || '/org_template';\n        var subOrgRegExp = new RegExp('^(' + organizationsFolderUri + '/([^/]+))+');\n        var rootOrgTemplateRegExp = new RegExp('^' + organizationsFolderUri + orgTemplateFolderUri + '(/.*)?');\n        var isSubOrgLevel = !!subOrgRegExp.exec(uris[0]) && !rootOrgTemplateRegExp.exec(uris[0]);\n        var renderOptions = {\n                type: exportTypesEnum.REPOSITORY,\n                isSubOrgLevel: isSubOrgLevel\n            }, subtitle = ' ' + i18n2['export.dialog.repository.title'];\n        this.addCssClasses('repository-export-dialog');\n        this._openExportDialog(renderOptions, subtitle, eventTarget);\n        this.exportView.model.set({\n            'uris': uris,\n            'includeScheduledReportJobs': hasReports(repoData)\n        });\n    },\n    openTenantDialog: function (tenant) {\n        var tenantName = ' ' + tenant.name, exportType = !tenant.isRoot() ? exportTypesEnum.TENANT : exportTypesEnum.ROOT_TENANT, renderOptions = {\n            type: exportType,\n            tenantId: tenant.id\n        };\n        this.addCssClasses('tenant-export-dialog');\n        this._openExportDialog(renderOptions, tenantName);\n    },\n    // block default validation handlers\n    fieldIsValid: function () {\n    },\n    fieldIsInvalid: function (error) {\n    },\n    _onExportButtonClick: function () {\n        this.exportView.doExport();\n        this._closeExportDialog();\n    },\n    _closeExportDialog: function () {\n        this.$el.css({ width: this.width });\n        this.close();\n        this.$el.find('.export-view').html('');\n    },\n    _openExportDialog: function (renderOptions, subtitle, focusElement) {\n        var title = i18n2['export.dialog.title'] + (subtitle ? subtitle : '');\n        this.setContent(this.exportView.render(renderOptions).$el);\n        this.setTitle(title);\n        this.setReturnFocus(focusElement);\n        //TODO: Find out why applyEpoxyBindings and delegateEvents should be called after new content is set.\n        this.exportView.applyEpoxyBindings();\n        this.exportView.delegateEvents();\n        Dialog.prototype.open.apply(this, arguments);\n        this.$el.css({ minHeight: this.$el.outerHeight() });\n        this.width = this.$el.outerWidth();\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from 'js-sdk/src/common/component/dialog/Dialog';\nimport ImportView from './ImportView';\nimport i18n from 'js-sdk/src/i18n/CommonBundle.properties';\nimport i18n2 from '../../../i18n/ImportExportBundle.properties';\nimport importExportTypesEnum from '../../export/enum/exportTypesEnum';\n\nexport default Dialog.extend({\n\n    constructor: function (options) {\n        options || (options = {});\n        this.options = options;\n        Dialog.prototype.constructor.call(this, {\n            model: this.model,\n            modal: true,\n            resizable: true,\n            additionalCssClasses: 'tenant-import-dialog',\n            content: '',\n            buttons: [\n                {\n                    label: i18n['button.import'],\n                    action: 'import',\n                    primary: true\n                },\n                {\n                    label: i18n['button.cancel'],\n                    action: 'cancel',\n                    primary: false\n                }\n            ]\n        });\n        this.on('button:import', _.bind(this._onImportButtonClick, this));\n        this.on('button:cancel', _.bind(this._closeImportDialog, this));\n    },\n\n    initialize: function (options) {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.importView = new ImportView();\n        this.listenTo(this.importView, 'import:finished', function (tenantId) {\n            this.close();\n            this.trigger('import:finished', tenantId);\n        });\n        this.listenTo(this.importView.model, 'validated', function (isValid) {\n            isValid ? this.buttons.enable('import') : this.buttons.disable('import');\n        }, this);\n    },\n\n    openDialog: function (tenant) {\n        var title = i18n2['tenant.import.dialog.title'] + ' ' + tenant.name;\n        var type = !tenant.isRoot() ? importExportTypesEnum.TENANT : importExportTypesEnum.ROOT_TENANT;\n        tenant.isRoot() && this.addCssClasses('tenant');\n        this.setContent(this.importView.render({\n            type: type,\n            tenantId: tenant.id\n        }).$el);\n\n        this.setTitle(title);\n\n        Dialog.prototype.open.apply(this, arguments);\n\n        this.importView.applyEpoxyBindings();\n        this.importView.delegateEvents();\n    },\n    // block default validation handlers\n    fieldIsValid: function () {},\n    fieldIsInvalid: function (error) {},\n\n    _closeImportDialog: function () {\n        this.close();\n    },\n\n    _onImportButtonClick: function () {\n        var self = this;\n        this.importView.doImport().done(function (response) {\n            self._closeImportDialog();\n        });\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport TreePlugin from './TreePlugin';\nimport _ from 'underscore';\nimport $ from 'jquery';\nvar returnContextMenuOptions = _.memoize(function (contextMenu) {\n    var actions = _.map(contextMenu.options, function (option) {\n        return option.model.get('action');\n    });\n    return actions;\n}, function (contextMenu) {\n    return contextMenu.cid;\n});\nexport default TreePlugin.extend({\n    initialize: function (options) {\n        if (!options) {\n            throw new Error('Initialization error. Options required.');\n        }\n        this.contextMenus = options.contextMenus;\n        this.contextMenu = options.contextMenu;\n        this.defaultSelectedItems = options.defaultSelectedItems || function () {\n        };\n        if (!this.contextMenus && !this.contextMenu) {\n            throw new Error('contextMenu or contextMenus must be specified.');\n        }\n        this.showContextMenuCondition = options.showContextMenuCondition;\n        if (!this.showContextMenuCondition && !this.contextMenu) {\n            throw new Error('contextMenu must be specified for default behaviour');\n        }\n        !this.showContextMenuCondition && (this.showContextMenuCondition = function () {\n            return this.contextMenu;\n        });\n        this.model = options.model;\n        TreePlugin.prototype.initialize.apply(this, arguments);\n    },\n    itemAction: function (optionModel) {\n        var action = optionModel.get('action');\n        this.treeItem.action = action;\n    },\n    itemsRendered: function (model, list) {\n        var self = this;\n        this.listenTo(list, 'list:item:contextmenu', function (item, event) {\n            this.currentContextMenu = self.showContextMenuCondition(item);\n            this.lastContextMenu && this.lastContextMenu.hide();\n            this.lastContextMenu = this.currentContextMenu;\n            if (this.currentContextMenu) {\n                this.currentContextMenu.treeItem = item;\n                var action = this.currentContextMenu.treeItem.action;\n                action || (action = self.defaultSelectedItems.call(this.currentContextMenu, item, returnContextMenuOptions(this.currentContextMenu))) ? this.currentContextMenu.resetSelection([action]) : this.currentContextMenu.resetSelection();\n                this.currentContextMenu.show({\n                    left: event.pageX,\n                    top: event.pageY\n                });\n                this.listenTo(this.currentContextMenu.collection, 'select', function (optionView, optionModel) {\n                    this.itemAction.call(this.currentContextMenu, optionModel);\n                }, this);\n            }\n        }, this);\n    },\n    remove: function () {\n        this.stopListening();\n        this.contextMenu && this.contextMenu.remove();\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default function(options) {\n    return options.contextPath\n        + \"/rest_v2/organizations?{{= id != 'organizations' ? 'rootTenantId=' + encodeURIComponent(id) : ''}}&offset={{= offset }}&limit={{= limit }}&maxDepth=1\";\n}","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Tree from 'js-sdk/src/common/component/tree/Tree';\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport TreeDataLayer from 'js-sdk/src/common/component/tree/TreeDataLayer';\nimport TooltipTreePlugin from 'js-sdk/src/common/component/tree/plugin/TooltipPlugin';\nimport ContextMenuTreePlugin from 'js-sdk/src/common/component/tree/plugin/ContextMenuTreePlugin';\nimport tenantTreeDataUriTemplateUtil from '../utils/tenantTreeDataUriTemplateUtil';\nimport i18n from 'js-sdk/src/i18n/CommonBundle.properties';\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\n\nvar processors = {\n    tenantProcessor: function (tenantId) {\n        return {\n            processItem: function (item) {\n                item._node = true;\n                item.label = item.value.tenantName;\n                item.value.label = item.label;\n                item.value.uri = item.value.tenantUri;\n                item.id === tenantId && (item.addToSelection = true);\n                return item;\n            }\n        };\n    }\n};\nexport default function (options) {\n    var comparator = options.comparator, TreeWithPlugins = Tree.use(TooltipTreePlugin, {\n        i18n: i18n,\n        contentTemplate: options.tooltipContentTemplate\n    });\n    if (options.contextMenu) {\n        TreeWithPlugins = TreeWithPlugins.use(ContextMenuTreePlugin, { contextMenu: options.contextMenu });\n    }\n    return TreeWithPlugins.create().instance(_.extend({}, {\n        selection: {\n            allowed: {\n                left: true,\n                right: true\n            },\n            multiple: false\n        },\n        rootless: true,\n        collapsed: true,\n        lazyLoad: true,\n        bufferSize: 5000,\n        allowMouseDownEventPropagation: true,\n        dataUriTemplate: tenantTreeDataUriTemplateUtil({\n            contextPath: jrsConfigs.contextPath\n        }),\n        levelDataId: 'id',\n        getDataArray: function (data, status, xhr) {\n            var orgs = data ? data['organization'] : [];\n            comparator && orgs.sort(comparator);\n            return orgs;\n        },\n        processors: [processors.tenantProcessor(options.tenantId)],\n        customDataLayers: {\n            //workaround for correct viewing of '/' tenant label\n            '/': _.extend(new TreeDataLayer({\n                dataUriTemplate: jrsConfigs.contextPath + '/flow.html?_flowId=treeFlow&method=getNode&provider=tenantTreeFoldersProvider&uri=/',\n                processors: [processors.tenantProcessor(options.tenantId)],\n                getDataArray: function (data) {\n                    data = JSON.parse($(data).text());\n                    return [{\n                        id: data.id,\n                        tenantName: data.label,\n                        tenantUri: '/',\n                        resourceType: 'folder',\n                        _links: { content: '@fakeContentLink' }\n                    }];\n                }\n            }), {\n                accept: 'text/html',\n                dataType: 'text'\n            })\n        }\n    }));\n}","export default \"<li class=\\\"leaf\\\" {{ if(typeof(groupId)!== \\\"undefined\\\") { }} data-groupId = {{- groupId }} {{ } }} >\\n\\n    <js-templateNonce></js-templateNonce>\\n    <p class=\\\"wrap button\\\"><span class=\\\"icon\\\"></span>{{- label }}</p>\\n</li>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport OptionContainer from '../base/OptionContainer';\nimport menuOptionTemplate from './template/menuOptionTemplate.htm';\nimport menuContainerTemplate from './template/menuContainerTemplate.htm';\n\nexport default OptionContainer.extend({\n    constructor: function (options, additionalSettings) {\n        if (!options || !_.isArray(options) || options.length === 0) {\n            throw new Error('Menu should have options');\n        }\n        additionalSettings || (additionalSettings = {});\n        OptionContainer.call(this, {\n            options: options,\n            collection: additionalSettings.collection,\n            mainTemplate: additionalSettings.menuContainerTemplate || menuContainerTemplate,\n            optionTemplate: additionalSettings.menuOptionTemplate || menuOptionTemplate,\n            toggle: additionalSettings.toggle,\n            toggleClass: additionalSettings.toggleClass\n        });\n        this.maxSize = additionalSettings.maxSize;\n        this._onConstructor && this._onConstructor(options, additionalSettings);\n    },\n    initialize: function () {\n        OptionContainer.prototype.initialize.apply(this, arguments);\n        $('body').append(this.$el);\n        this._onInitialize && this._onInitialize();\n    },\n    show: function () {\n        var res = OptionContainer.prototype.show.apply(this, arguments);\n        this.applyMaxSize();\n        return res;\n    },\n    applyMaxSize: function () {\n        if (this.maxSize && this.options.length > this.maxSize) {\n            this.$el.css({\n                'overflow-y': 'auto',\n                'max-height': this.maxSize * this.options[0].$el.height() + 'px'\n            });\n        }\n    }\n});","export default \"<div class=\\\"menu vertical dropDown fitable\\\" tabindex=\\\"-1\\\" style=\\\"z-index: 99999; display: none;\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <div class=\\\"content\\\">\\n        <ul></ul>\\n    </div>\\n</div>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Menu from './Menu';\nimport $ from 'jquery';\nimport _ from 'underscore';\nvar OPACITY_VALUE_FOR_HEIGHT_CALCULATION = 0;\nvar EXTRA_OFFSET = 10;\nexport default Menu.extend({\n    constructor: function (options, additionalSettings) {\n        Menu.call(this, options, additionalSettings);\n        _.bindAll(this, '_tryHide');\n        this.topPadding = additionalSettings && additionalSettings.topPadding || 5;\n        this.leftPadding = additionalSettings && additionalSettings.leftPadding || 5;\n        this.extraOffset = options.extraOffset || EXTRA_OFFSET;\n        this.hideOnMouseLeave = additionalSettings && additionalSettings.hideOnMouseLeave || false;\n        _.bindAll(this, '_tryHide', '_checkBounds');\n        this.hideOnMouseLeave && this.$el.on('mouseleave', this._tryHide);\n    },\n    _tryHide: function () {\n        this.hide();\n        this._signOffTryHide();\n    },\n    _signOffTryHide: function () {\n        $(document.body).off('click.contextMenu', this._tryHide);\n        $(document.body).off('mousemove', this._checkBounds);\n    },\n    show: function (position, container) {\n        if (!position || !_.isNumber(position.top) || !_.isNumber(position.left)) {\n            throw new Error('Required params (top, left) missing: ' + JSON.stringify(position));\n        }\n        $(document.body).on('click.contextMenu', this._tryHide);\n        this.hideOnMouseLeave && $(document.body).on('mousemove', this._checkBounds);\n        var top = position.top, left = position.left, topPadding = this.topPadding, leftPadding = this.leftPadding, body = $('body'), menuElHeight = this._calculateMenuHeightOnShow(), menuElWidth = this.$el.width(), containerHeight = container ? container.height() : body.height(), containerWidth = container ? container.width() : body.width(), containerOffset = container ? container.offset() : body.offset(), fitByHeight = containerHeight - position.top, fitByWidth = containerWidth - position.left;\n        if (fitByHeight < menuElHeight) {\n            top = position.top - menuElHeight - topPadding;\n            top < containerOffset.top && (top += containerOffset.top - top + topPadding);\n            top = top < 0 ? containerHeight / 2 - menuElHeight / 2 : top;\n        }\n        if (fitByWidth < menuElWidth) {\n            left = position.left - menuElWidth - leftPadding;\n            left < containerOffset.left && (left += containerOffset.left - left + leftPadding);\n            left = left < 0 ? containerWidth / 2 - menuElWidth / 2 : left;\n        }\n        _.extend(this, {\n            top: top,\n            left: left\n        });\n        this.$el.css({\n            top: this.top,\n            left: this.left\n        });\n        return Menu.prototype.show.apply(this, arguments);\n    },\n    _checkBounds: function (event) {\n        var elementRect = {\n            top: this.$el[0].offsetTop - this.extraOffset,\n            bottom: this.$el[0].offsetTop + this.$el[0].offsetHeight + this.extraOffset,\n            left: this.$el[0].offsetLeft - this.extraOffset,\n            right: this.$el[0].offsetLeft + this.$el[0].offsetWidth + this.extraOffset\n        };\n        if (this._isPointerOutOfBounds(elementRect, event)) {\n            this._tryHide();\n        }\n    },\n    _isPointerOutOfBounds: function (elementRect, event) {\n        return event.clientX < elementRect.left || event.clientX > elementRect.right || (event.clientY < elementRect.top || event.clientY > elementRect.bottom);\n    },\n    _calculateMenuHeightOnShow: function () {\n        this.$el.css({ opacity: OPACITY_VALUE_FOR_HEIGHT_CALCULATION });\n        Menu.prototype.show.apply(this, arguments);\n        var height = this.$el.height();\n        this.hide();\n        this.$el.css({ opacity: '' });\n        return height;\n    },\n    remove: function () {\n        this._signOffTryHide();\n        this.hideOnMouseLeave && this.$el.off('mouseleave', this._tryHide);\n        Menu.prototype.remove.apply(this, arguments);\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport Backbone from 'backbone';\nimport i18n from '../../i18n/ImportExportBundle.properties';\nimport ExportDialogView from '../export/view/ExportDialogView';\nimport ImportDialogView from '../import/view/ImportDialogView';\nimport tenantTree from './tenantTree';\nimport ContextMenu from 'js-sdk/src/common/component/menu/ContextMenu';\nimport tooltipTemplate from '../templates/tooltipTemplate.htm';\n\nvar ROOT_TENANT_ID = 'organizations';\nvar TenantsTreeView = Backbone.View.extend({\n    initialize: function (options) {\n        this.$container = $(options.container);\n        var tenant = window.localStorage ? JSON.parse(localStorage.getItem('selectedTenant')) : null, selectedTenant = options.selectedTenant || tenant;\n        var root = options.currentUser ? options.currentUser.split('|')[1] || ROOT_TENANT_ID : selectedTenant?.tenantUri === '/' ? selectedTenant.tenantId || ROOT_TENANT_ID : ROOT_TENANT_ID;\n        this.splittedUri = _.compact(selectedTenant.tenantUri.split('/'));\n        this.splittedUri.splice(this.splittedUri.length - 1, 1);\n        this.splittedUri.unshift(root);\n        var treeInitOptions = {\n            tooltipContentTemplate: tooltipTemplate,\n            tenantId: selectedTenant.id || root,\n            comparator: options.comparator\n        };\n        if (!options.removeContextMenuTreePlugin) {\n            this.contextMenu = new ContextMenu([\n                {\n                    label: i18n['context.menu.option.export'],\n                    action: 'export'\n                },\n                {\n                    label: i18n['context.menu.option.import'],\n                    action: 'import'\n                }\n            ], { hideOnMouseLeave: true });\n            _.extend(treeInitOptions, { contextMenu: this.contextMenu });\n            this.listenTo(this.contextMenu, 'option:export', this._onExport);\n            this.listenTo(this.contextMenu, 'option:import', this._onImport);\n        }\n        this.exportDialog = new ExportDialogView();\n        this.importDialog = new ImportDialogView();\n        this.tree = new tenantTree(treeInitOptions);\n        this._initEvents();\n    },\n    render: function () {\n        this.$container.append(this.tree.render().$el);\n    },\n    refreshTenant: function (tenantId) {\n        var treeLevel = this.tree.getLevel(tenantId);    //TODO: Fix this temporary hack with dublicating items when they're in predefinedData.\n        //TODO: Fix this temporary hack with dublicating items when they're in predefinedData.\n        this.tree.getDataLayer(treeLevel).predefinedData = [];\n        tenantId ? treeLevel.refresh() : this.tree.refresh();\n    },\n    getTenant: function () {\n        return this.selectedTenant;\n    },\n    setTenant: function (tenant, name, value) {\n        !name ? this.selectedTenant = tenant : this.selectedTenant[name] = value;\n    },\n    selectTenant: function (tenantId) {\n        this.tree.select(tenantId);\n    },\n    addTenant: function (parentTenantId, tenant) {\n        var parentLevel = this.tree.getLevel(parentTenantId);\n        this.listenToOnce(parentLevel, 'ready', function () {\n            this.tree.addItem(parentTenantId, this._processItem(tenant, true));\n        });\n        parentLevel.open();\n    },\n    updateTenant: function (parentTenantId, updatedTenant, selectTenant) {\n        this.tree.updateItem(this._processItem(updatedTenant, false, selectTenant), parentTenantId);\n    },\n    removeTenant: function (tenantIds, parentTenantId) {\n        var level, parentLevel = this.tree.getLevel(parentTenantId);\n        tenantIds = !_.isArray(tenantIds) ? [tenantIds] : tenantIds;\n        _.each(tenantIds, function (tenantId) {\n            level = this.tree.getLevel(tenantId);\n            level && level.remove();\n        }, this);\n        parentLevel.refresh();\n        parentLevel.open();\n    },\n    remove: function () {\n        this.tree.remove();\n        this.contextMenu && this.contextMenu.remove();\n    },\n    _processItem: function (item, isNew, select) {\n        var id = item.tenantId || item.id, uri = item.tenantFolderUri || item.tenantUri, label = item.tenantName, value = {\n            id: id,\n            label: label,\n            uri: uri,\n            tenantUri: uri,\n            parentId: item.parentId\n        };\n        return isNew ? {\n            _node: true,\n            id: id,\n            label: label,\n            value: value\n        } : {\n            id: item.tenantId,\n            addToSelection: select,\n            label: label,\n            value: value\n        };\n    },\n    _initEvents: function () {\n        this.expandedLevels = [];\n        this.listenTo(this.tree, 'selection:change', function (selection) {\n            this.trigger('selection:change', _.compact(selection)[0]);\n        });\n        this.listenTo(this.importDialog, 'import:finished', function (tenantId) {\n            this.refreshTenant(tenantId);\n            this.trigger('import:finished', tenantId);\n        });\n        this._recursivelyOpenLevels(this.tree.rootLevel);\n    },\n    _recursivelyOpenLevels: function (level) {\n        this.listenTo(level, 'ready', function () {\n            var treeLevel = this.tree.getLevel(this.splittedUri[0]);\n            this.splittedUri.splice(0, 1);\n            if (treeLevel) {\n                this.expandedLevels.push(treeLevel);\n                this.tree.expand(treeLevel.id);\n                this._recursivelyOpenLevels(treeLevel);\n            } else {\n                _.each(this.expandedLevels, function (newlevel) {\n                    this.stopListening(newlevel, 'ready');\n                }, this);\n            }\n        });\n    },\n    _onExport: function () {\n        this.exportDialog.openTenantDialog(this.selectedTenant);\n    },\n    _onImport: function () {\n        this.importDialog.openDialog(this.selectedTenant);\n    }\n});\nexport default TenantsTreeView;","export default \"{{ if (model.value.tenantDesc) { }}\\n<!--<p class=\\\"message label\\\">{{- i18n['tooltip.description'] }}</p><p class=\\\"message\\\">{{- model.value.tenantDesc }}</p>-->\\n{{ } }}\\n{{ if (model.value.uri) { }}\\n<p class=\\\"message label\\\">{{- i18n['tooltip.path'] }}</p><p class=\\\"message\\\">{{- model.value.uri }}</p>\\n{{ } }}\\n\\n    <js-templateNonce></js-templateNonce>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {doNothing, isSupportsTouch, isIPad} from \"./utils.common\";\nimport jQuery from 'jquery';\n\nvar InfiniteScroll = function (options) {\n    this._id = options.id;\n    this._contentId = options.contentId ? options.contentId : undefined;\n    this._scroll = options.scroll;\n    this._loadFactor = options.loadFactor ? options.loadFactor : 0.95;\n    this._lastContentHeight = 0;\n    this._loading = false;    // getting control from 'id' of jquery object or from DOM element\n    // getting control from 'id' of jquery object or from DOM element\n    if (options.control) {\n        if (options.control.length !== undefined && options.control.length > 1) {\n            this._control = jQuery(options.control[0]);\n        } else {\n            this._control = jQuery(options.control)[0];\n        }\n    } else {\n        this._control = this._scroll ? this._scroll.parent : jQuery('#' + this._id)[0];\n    }\n    if (this._scroll) {\n        this._content = this._scroll.element;\n    } else {\n        // getting content from 'id' of jquery object or from DOM element\n        if (options.content) {\n            if (options.content.length !== undefined && options.content.length > 1) {\n                this._content = jQuery(options.content[0]);\n            } else {\n                this._content = jQuery(options.content)[0];\n            }\n        } else {\n            this._content = this._contentId ? jQuery('#' + this._contentId)[0] : this._control.childElements()[0];\n        }\n    }\n    this._eventType = isSupportsTouch() ? 'touchmove' : 'scroll';\n    this._control.observe(this._eventType, this._onScrollHandler.bind(this));\n};\n/**\n\t * Destroys the infinite scroll.\n\t */\nInfiniteScroll.addMethod('destroy', function () {\n    if (this._control) {\n        this._control.stopObserving(this._eventType, this._handler);\n    }\n});    /**\n\t * Handler for scroll event on the control element.\n\t */\n/**\n\t * Handler for scroll event on the control element.\n\t */\nInfiniteScroll.addMethod('_onScrollHandler', function (e) {\n    var controlScrollTop = this._scroll ? this._scroll.y * -1 : this._control.scrollTop;\n    var contentHeight = this._content.getHeight();\n    var controlHeight = this._control.getHeight();\n    if (contentHeight != this._lastContentHeight) {\n        this._loading = false;\n    }\n    var allowLoad = !this._loading && contentHeight != 0;\n    if (this._scroll) {\n        allowLoad = allowLoad && this._scroll.isBottom();\n    } else {\n        allowLoad = allowLoad && (controlHeight + controlScrollTop) / contentHeight > this._loadFactor;\n    }\n    if (allowLoad) {\n        this._loading = true;\n        this._lastContentHeight = contentHeight;\n        isIPad() && this.wait();\n        this.onLoad();\n    }\n});    /**\n\t * This method is invoked when new data should be loaded. Actually it should load new data. The method should be\n\t * replaced in the instance of InfiniteScroll class. Next invocation of onLoad method will not occur till the content\n\t * element height changed.\n\t */\n/**\n\t * This method is invoked when new data should be loaded. Actually it should load new data. The method should be\n\t * replaced in the instance of InfiniteScroll class. Next invocation of onLoad method will not occur till the content\n\t * element height changed.\n\t */\nInfiniteScroll.addMethod('onLoad', doNothing);    /**\n\t * Resets the infinite scroll for totally new content. This method should be invoked in case the old data is cleaned\n\t * and the new data is set to the content element. Do not invoke this method in case new data is added in onLoad\n\t * method - this case is processed automatically.\n\t *\n\t * The method also moves the slider of the scroll in control element to top position.\n\t */\n/**\n\t * Resets the infinite scroll for totally new content. This method should be invoked in case the old data is cleaned\n\t * and the new data is set to the content element. Do not invoke this method in case new data is added in onLoad\n\t * method - this case is processed automatically.\n\t *\n\t * The method also moves the slider of the scroll in control element to top position.\n\t */\nInfiniteScroll.addMethod('reset', function () {\n    isIPad() ? this._scroll.reset() : this._control.scrollTop = 0;\n    this._loading = false;\n});\nInfiniteScroll.addMethod('wait', function () {\n    if (!this._waitIndicator) {\n        this._waitIndicator = new Element('div', { 'class': 'dimmer resultsOverlay' });\n        var dimensions = this._control.getDimensions();\n        var offsets = this._control.positionedOffset();\n        this._waitIndicator.setStyle({\n            zIndex: '4000',\n            top: offsets.top + 'px',\n            left: offsets.left + 'px',\n            height: dimensions.height + 'px',\n            width: dimensions.width + 'px'\n        });\n        this._control.insert({ after: this._waitIndicator });\n    }\n    this._waitIndicator.show();\n});\nInfiniteScroll.addMethod('stopWaiting', function () {\n    this._waitIndicator && this._waitIndicator.hide();\n});    // TODO: remove it when we move Repository Search into AMD style\n// Make it global due to RepositorySearch modules\n// TODO: remove it when we move Repository Search into AMD style\n// Make it global due to RepositorySearch modules\nwindow.InfiniteScroll = InfiniteScroll;\nexport default InfiniteScroll;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from './Dialog';\nimport confirmDialogTemplate from './template/confirmDialogTemplate.htm';\nimport i18n from '../../../i18n/CommonBundle.properties';\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.confirmDialogTemplate = options.confirmDialogTemplate || _.template(confirmDialogTemplate);\n        Dialog.prototype.constructor.call(this, {\n            modal: true,\n            additionalCssClasses: options.additionalCssClasses || 'confirmationDialog',\n            title: options.title || i18n['dialog.confirm.title'],\n            content: this.confirmDialogTemplate({ text: options.text }),\n            buttons: options.buttons || [\n                {\n                    label: options.yesLabel || i18n['button.yes'],\n                    action: 'yes',\n                    primary: true\n                },\n                {\n                    label: options.noLabel || i18n['button.no'],\n                    action: 'no',\n                    primary: false\n                }\n            ]\n        });\n    },\n    initialize: function () {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.on('button:yes', this.close);\n        this.on('button:no', this.close);\n    },\n    setContent: function (content) {\n        Dialog.prototype.setContent.call(this, this.confirmDialogTemplate({ text: content }));\n    }\n});","export default \"<p class='confirmationText'>\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{ print(_.xssSoftEscape(text)) }}\\n</p>\";"],"sourceRoot":""}