{"version":3,"sources":["webpack://jrs-ui/../js-sdk/src/common/component/tree/dataprovider/DataProviderWithSearchCache.js","webpack://jrs-ui/../js-sdk/src/common/enum/httpStatusCodes.js","webpack://jrs-ui/../js-sdk/src/common/enum/errorCodes.js","webpack://jrs-ui/../js-sdk/src/common/model/BaseModel.js","webpack://jrs-ui/../js-sdk/src/common/util/parse/NumberUtils.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/BaseListWithSelectionModel.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/ListWithSelectionModel.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/ScalableListModel.js"],"names":["MAX_VALUE","DataProvider","options","_","this","dataCache","dataCacheTotal","dataCachePages","pageSize","criteriaKey","searchKey","maxSearchCacheSize","getDataByCriteriaHolder","criteriaValuesCache","controlGetTotal","dataConverter","saveLastCriteria","lastCriteria","serialRequestsDelay","serialRequestsDelayedPromise","request","prototype","getData","_getDataByCriteria","deferred","$","pagesToLoad","_getPagesToLoad","_requestData","_resolveDeferredUsingDataFromCache","promise","clear","limit","length","optionsToQuery","offset","skipGetTotal","clearTimeout","deferredTimeout","setTimeout","_requestDataDeferred","query","done","resolve","fail","reject","_requestDone","data","_putDataToCache","dataToReturn","_getDataFromCache","total","i","firstLast","_convertLimitOffsetToFirstLast","startRange","_findPageIndex","first","endRange","last","indexes","push","index","Math","floor","max","min","slice","result","cachePageStart","cachePageEnd","criteria","firstCacheCriteria","firstCacheIndex","Number","lastCacheIndex","cacheSize","key","hasOwnProperty","cachedCriteriaObj","_createDataProviderForCriteria","self","dataProvider","params","origGetData","optionsCopy","call","100","101","200","201","202","203","204","205","206","300","301","302","303","304","305","307","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","500","501","502","503","504","505","BaseModel","Backbone","initialize","on","unifyServerErrors","serialize","attributes","model","xhr","errorStatus","httpStatusCodes","status","errorObj","createServerError","trigger","error","JSON","parse","responseText","e","message","errorCode","errors","parameters","NumberUtils","separatorSymbolToRegExpPattern","separator","DECIMAL_SEPARATOR","decimalSeparator","GROUPING_SEPARATOR","groupingSeparator","DECIMAL_NUMBER_PATTERN","RegExp","INTEGER_NUMBER_PATTERN","MAX_INT","MAX_SAFE_INTEGER","MIN_INT","MIN_SAFE_INTEGER","number_format","number","decimals","dec_point","thousands_sep","replace","num","absValue","k","n","isFinite","prec","abs","sep","dec","pow","round","toFixed","split","Array","join","isInt","value","isNumberInt","isStringInt","isNaN","POSITIVE_INFINITY","NEGATIVE_INFINITY","test","isInt32","parseNumber","isDecimal","window","console","warn","formatNumber","val","decimalNumStr","toString","decimalPlacesAmount","ex","MaxRange","MinRange","ScalableListModel","select","silent","_addToSelection","_removeFromSelection","_clearSelection","_selectionContains","_getSelection","_triggerSelectionChange","_addRangeToSelection","rangeStart","rangeEnd","start","end","selection","getSelection","_fetchAllDataAndModifySelection","modifySelection","onDone","values","fetchFailed","addValueToSelection","selectionStartIndex","addRangeToSelection","get","that","removeValueFromSelection","toggleSelection","selectionContains","clearSelection","selectAll","firstIteration","invertSelection","BaseListWithSelectionModel","caseSensitiveSelection","undefined","toLowerCase","_isSelectionEmpty","_selectPendingSelection","pendingSelection","_convertInitialArrayToSelection","_calcSelectionStartIndex","parseInt","set","items","bufferSize","loadFactor","_fetchComplete","bufferEndIndex","bufferStartIndex","afterFetchComplete","_isBufferReloadNecessary","topVisibleItem","bottomVisibleItem","topLoadFactor","bottomLoadFactor","responseStatus","fetch","top","bottom","force","bufferCenter","bufferHalf","reset"],"mappings":"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","file":"_chunks/chunk.4327.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n* @author: Sergey Prilukin\n* @version: $Id: ListWithSelection.js 43947 2014-04-02 17:51:07Z sergey.prilukin $\n*/\n\n/*\n* New kind of data provider which supports search,\n* and does caching so no new request call for same limit and offset will be done\n* Also it supports cache for several search terms.\n*\n* It works as a caching proxy.\n* It does requests by pages with 1000 elements by default\n*/\nimport _ from 'underscore';\nimport $ from 'jquery';\n\nvar PAGE_SIZE = 999,\n    SEARCH_CACHE_SIZE = 50,\n    SERIAL_REQUESTS_DELAY = 50, //ms\n    CRITERIA_PARAMETER_NAME = \"criteria\",\n    MAX_VALUE = 2147483647;  //Equivalent to Java's Integer.MAX_VALUE\n\nvar DataProvider = function(options) {\n    _.bindAll(this, \"getData\");\n\n    options = options || {};\n\n    //Holds cached data\n    this.dataCache = [];\n    //holds total data count\n    this.dataCacheTotal = null;\n    //holds information about cached pages in format:\n    //[true, undefined, true]\n    //means that there are two cached pages: 0-999, 2000-2999\n    this.dataCachePages = [];\n    //size of the page\n    this.pageSize = options.pageSize || PAGE_SIZE;\n    //name of the parameter used for searching by criteria\n    this.criteriaKey = options.searchKey || CRITERIA_PARAMETER_NAME;\n\n    //max count of cached searches\n    this.maxSearchCacheSize = options.maxSearchCacheSize || SEARCH_CACHE_SIZE;\n    //holds info about data providers for specific searches\n    this.getDataByCriteriaHolder = {};\n\n    //holds criteria value\n    this.criteriaValuesCache = [];\n\n    //whether to control when we need to get total\n    this.controlGetTotal = typeof options.controlGetTotal !== \"undefined\" ? options.controlGetTotal : false;\n\n    //optional dataconverter for data which cames through request\n    this.dataConverter = options.dataConverter;\n\n    //if true - last criteria will be saved untill it will be changed\n    this.saveLastCriteria = typeof options.saveLastCriteria !== \"undefined\" ? options.saveLastCriteria : false;\n    //saved criteria;\n    this.lastCriteria = null;\n\n    //Quick serial requests with same params will be delayed if > 0\n    this.serialRequestsDelay = typeof options.serialRequestsDelay !== \"undefined\" ? options.serialRequestsDelay : SERIAL_REQUESTS_DELAY;\n\n    //Object where promise for last sent request is stored until request will be done\n    //uset to put all subsequent requests with same params to a queue\n    this.serialRequestsDelayedPromise = null;\n\n    //original data provider. by default it's AJAX request\n    this.request = options.request;\n};\n\n_.extend(DataProvider.prototype, {\n\n\n    /* API */\n\n    getData: function(options) {\n        options = options || {};\n\n        if (options[this.criteriaKey]) {\n            return this._getDataByCriteria(options[this.criteriaKey])(options);\n        } else if (typeof options[this.criteriaKey] === \"undefined\" && this.saveLastCriteria && this.lastCriteria) {\n            return this._getDataByCriteria(this.lastCriteria)(options);\n        }\n\n        //clear last criteria\n        this.lastCriteria = null;\n        //this.criteriaValuesCache = [];\n\n        var deferred = $.Deferred();\n\n        var pagesToLoad = this._getPagesToLoad(options);\n\n        if (!pagesToLoad) {\n            this._resolveDeferredUsingDataFromCache(deferred, options);\n        } else {\n            this._requestData(options, pagesToLoad, deferred);\n        }\n\n        return deferred.promise();\n    },\n\n    /*\n     * Clear all cached data\n     */\n    clear: function() {\n        this.dataCache = [];\n        this.dataCacheTotal = null;\n        this.dataCachePages = [];\n        this.getDataByCriteriaHolder = {};\n        this.criteriaValuesCache = [];\n        this.lastCriteria = null;\n    },\n\n    /* Internal methods */\n    _requestData: function(options, pagesToLoad, deferred) {\n\n        var limit = (pagesToLoad[pagesToLoad.length - 1] - pagesToLoad[0] + 1) * this.pageSize;\n\n        var optionsToQuery = _.extend({}, options, {\n            offset: pagesToLoad[0] * this.pageSize,\n            limit: limit\n        });\n\n        if (this.controlGetTotal) {\n            optionsToQuery.skipGetTotal = true;\n        }\n\n        //Fix limit because server doesn't accept very big value (security?)\n        if (limit >= (MAX_VALUE / this.pageSize) * this.pageSize) {\n            delete optionsToQuery.limit;\n        }\n\n        //a little optimization: do not request total second time\n        if (this.controlGetTotal && typeof this.dataCacheTotal !== \"number\") {\n            delete optionsToQuery.skipGetTotal\n        }\n\n        if (this.serialRequestsDelay > 0) {\n            clearTimeout(this.deferredTimeout);\n\n            this.deferredTimeout =\n                setTimeout(_.bind(this._requestDataDeferred, this, options, optionsToQuery, deferred), this.serialRequestsDelay);\n        } else {\n            this._requestDataDeferred(options, optionsToQuery, deferred);\n        }\n    },\n\n    _requestDataDeferred: function(options, optionsToQuery, deferred) {\n        var pagesToLoad = this._getPagesToLoad(options);\n\n        if (!pagesToLoad) {\n            //Data already in cache\n            //no need to fetch it\n            this._resolveDeferredUsingDataFromCache(deferred, options);\n        } else {\n            if (this.serialRequestsDelayedPromise && _.isEqual(optionsToQuery, this.serialRequestsDelayedPromise.query)) {\n                //if request with same query parameters were already called - do not init other request,\n                //just wait until original request ends\n                this.serialRequestsDelayedPromise.promise\n                    .done(deferred.resolve).fail(deferred.reject);\n            } else {\n                //Does actual request call and save promise and\n                //params for this request\n                this.serialRequestsDelayedPromise = {\n                    promise: deferred.promise(),\n                    query: optionsToQuery\n                };\n\n                this.request(optionsToQuery)\n                    .done(_.bind(this._requestDone, this, options, optionsToQuery, deferred))\n                    .fail(deferred.reject);\n            }\n        }\n    },\n\n    //Called when external request is done\n    _requestDone: function(options, optionsToQuery, deferred, data) {\n        this._putDataToCache(optionsToQuery, data);\n\n        //clear promise holder since request is done\n        this.serialRequestsDelayedPromise = null;\n\n        this._resolveDeferredUsingDataFromCache(deferred, options);\n    },\n\n    _resolveDeferredUsingDataFromCache: function(deferred, options) {\n        var dataToReturn = this._getDataFromCache(options);\n        deferred.resolve({\n            total: this.dataCacheTotal,\n            data: dataToReturn\n        });\n    },\n\n    _getPagesToLoad: function(options) {\n        var firstLast = this._convertLimitOffsetToFirstLast(options);\n\n        var startRange = this._findPageIndex(firstLast.first),\n            endRange = this._findPageIndex(firstLast.last),\n            indexes = [],\n            i;\n\n        //start page to load\n        for (i = startRange; i <= endRange; i++) {\n            if (!this.dataCachePages[i]) {\n                indexes.push(i);\n                break;\n            }\n        }\n\n        //end page to load\n        for (i = endRange; i >= startRange; i--) {\n            if (!this.dataCachePages[i]) {\n                indexes.push(i);\n                break;\n            }\n        }\n\n        return indexes.length > 0 ? indexes : null;\n    },\n\n    _findPageIndex: function(index) {\n        return Math.floor(index / this.pageSize);\n    },\n\n    _convertLimitOffsetToFirstLast: function(options) {\n        var first = options && options.offset ? options.offset : 0,\n            last = options && options.limit\n                ? first + options.limit - 1\n                : (this.dataCacheTotal ? this.dataCacheTotal - 1 : MAX_VALUE);\n\n        if (this.dataCacheTotal && last > this.dataCacheTotal - 1) {\n            last = this.dataCacheTotal - 1;\n        }\n\n        return {\n            first: first,\n            last: last\n        }\n    },\n\n    _getDataFromCache: function(options) {\n        options = _.defaults(options, {\n            offset: 0,\n            limit: MAX_VALUE\n        });\n\n        var first = Math.max(0, options.offset),\n            last = Math.min(first + options.limit, this.dataCacheTotal);\n\n        return this.dataCache.slice(first, last);\n    },\n\n    _putDataToCache: function(options, result) {\n        var i;\n\n        if (typeof result.total !== \"undefined\") {\n            this.dataCacheTotal = result.total;\n        }\n\n        options.limit = options.limit || MAX_VALUE;\n\n        for (i = 0; i < result.data.length; i++) {\n            this.dataCache[i + options.offset] = this.dataConverter\n                ? this.dataConverter(result.data[i])\n                : result.data[i];\n        }\n\n        var cachePageStart = options.offset / this.pageSize,\n            cachePageEnd = Math.floor((Math.min(options.limit, result.data.length) + options.offset - 1) / this.pageSize);\n\n        for (i = cachePageStart; i <= cachePageEnd; i++) {\n            this.dataCachePages[i] = true;\n        }\n    },\n\n    /* Working  with search by criteria */\n\n    /*\n     * We allow to cache maxSearchCacheSize criteria queries\n     * otherwise old ones will be removed from the cache\n     * @param criteria\n     * @returns {*}\n     * @private\n     */\n    _getDataByCriteria: function(criteria) {\n        if (!this.getDataByCriteriaHolder[criteria]) {\n            var firstCacheIndex = Number.MAX_VALUE,\n                lastCacheIndex = 0,\n                firstCacheCriteria,\n                cacheSize = 0;\n\n            for (var key in this.getDataByCriteriaHolder) {\n                if (this.getDataByCriteriaHolder.hasOwnProperty(key)) {\n                    cacheSize += 1;\n                    var cachedCriteriaObj = this.getDataByCriteriaHolder[key];\n                    if (cachedCriteriaObj.index < firstCacheIndex) {\n                        firstCacheIndex = cachedCriteriaObj.index;\n                        firstCacheCriteria = key;\n                    }\n\n                    if (cachedCriteriaObj.index > lastCacheIndex) {\n                        lastCacheIndex = cachedCriteriaObj.index;\n                    }\n                }\n            }\n\n\n            if (cacheSize >= this.maxSearchCacheSize) {\n                delete this.getDataByCriteriaHolder[firstCacheCriteria];\n                this.criteriaValuesCache = [];\n            }\n\n            this.getDataByCriteriaHolder[criteria] = {\n                getData: this._createDataProviderForCriteria(criteria),\n                index: lastCacheIndex + 1\n            };\n            this.criteriaValuesCache.push(criteria);\n        }\n\n        this.lastCriteria = criteria;\n        return this.getDataByCriteriaHolder[criteria].getData;\n    },\n\n    /*\n     * Creates modified DataProvider where criteria will be always hardcoded.\n     * This will alllows us to reuse single caching mechanism\n     * and not duplicate code to query with criteria\n     * @param criteria\n     * @returns {DataProvider}\n     * @private\n     */\n    _createDataProviderForCriteria: function(criteria) {\n        var request = this.request,\n            self = this;\n\n        var dataProvider = new DataProvider({\n            pageSize: this.pageSize,\n            dataConverter: this.dataConverter,\n            serialRequestsDelay: this.serialRequestsDelay,\n            searchKey: this.criteriaKey,\n            controlGetTotal: this.controlGetTotal,\n            request: function(options) {\n                var params = _.extend({}, options);\n\n                params[self.criteriaKey] = criteria;\n                return request(params)\n            }\n        });\n\n        var origGetData = dataProvider.getData;\n        dataProvider.getData = function(options) {\n            var optionsCopy = _.extend({}, options);\n            delete optionsCopy[self.criteriaKey];\n\n            return origGetData.call(dataProvider, optionsCopy);\n        };\n\n        return dataProvider.getData;\n    }\n});\n\nexport default DataProvider;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {\n    100: 'continue',\n    101: 'switchingProtocols',\n    200: 'ok',\n    201: 'created',\n    202: 'accepted',\n    203: 'nonAuthoritativeInformation',\n    204: 'noContent',\n    205: 'resetContent',\n    206: 'partialContent',\n    300: 'multipleChoices',\n    301: 'movedPermanently',\n    302: 'found',\n    303: 'seeOther',\n    304: 'notModified',\n    305: 'useProxy',\n    307: 'temporaryRedirect',\n    400: 'badRequest',\n    401: 'unauthorized',\n    402: 'paymentRequired',\n    403: 'forbidden',\n    404: 'notFound',\n    405: 'methodNotAllowed',\n    406: 'notAcceptable',\n    407: 'proxyAuthenticationRequired',\n    408: 'requestTimeout',\n    409: 'conflict',\n    410: 'gone',\n    411: 'lengthRequired',\n    412: 'preconditionFailed',\n    413: 'requestEntityTooLarge',\n    414: 'requestUriTooLong',\n    415: 'unsupportedMediaType',\n    416: 'requestedRangeNotSatisfiable',\n    417: 'expectationFailed',\n    500: 'internalServerError',\n    501: 'notImplemented',\n    502: 'badGateway',\n    503: 'serviceUnavailable',\n    504: 'gatewayTimeout',\n    505: 'httpVersionNotSupported'\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {\n    UNEXPECTED_ERROR: 'unexpected.error',\n    INVALID_RESOURCE_TYPE: 'invalid.resource.type',\n    ACCESS_DENIED: 'access.denied'\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Backbone from 'backbone';\nimport httpStatusCodes from '../enum/httpStatusCodes';\nimport errors from '../enum/errorCodes';\nvar BaseModel = Backbone.Model.extend({\n    initialize: function () {\n        this.on('error', BaseModel.unifyServerErrors);\n    },\n    serialize: function () {\n        return _.clone(this.attributes);\n    }\n}, {\n    unifyServerErrors: function (model, xhr) {\n        var errorStatus = httpStatusCodes[xhr.status], errorObj = BaseModel.createServerError(xhr);\n        model.trigger('error:' + errorStatus, model, errorObj, xhr);\n        model.trigger('error:all', model, errorObj, xhr);\n    },\n    createServerError: function (xhr) {\n        var error;\n        try {\n            error = JSON.parse(xhr.responseText);\n        } catch (e) {\n            error = {\n                message: 'Can\\'t parse server response',\n                errorCode: errors.UNEXPECTED_ERROR,\n                parameters: []\n            };\n        }\n        return error;\n    }\n});\nexport default BaseModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\n\nconst NumberUtils = function (options) {\n    options = options || {};\n    this.DECIMAL_SEPARATOR = options.decimalSeparator || '.';\n    this.GROUPING_SEPARATOR = options.groupingSeparator || ',';\n    function separatorSymbolToRegExpPattern(separator) {\n        if (separator === '.') {\n            separator = '\\\\.';\n        } else if (separator === ' ') {\n            separator = '\\\\s';\n        }\n        return separator;\n    }\n    this.decimalSeparator = separatorSymbolToRegExpPattern(this.DECIMAL_SEPARATOR);\n    this.groupingSeparator = separatorSymbolToRegExpPattern(this.GROUPING_SEPARATOR);\n\n    // http://regexlib.com/REDetails.aspx?regexp_id=196 with some changes\n    this.DECIMAL_NUMBER_PATTERN = new RegExp('^-?([1-9]{1}[0-9]{0,2}(' + this.groupingSeparator + '[0-9]{3})*(' + this.decimalSeparator + '[0-9]+)?|[1-9]{1}[0-9]{0,}(' + this.decimalSeparator + '[0-9]+)?|0(' + this.decimalSeparator + '[0-9]+)?)$');\n    this.INTEGER_NUMBER_PATTERN = new RegExp('^-?([1-9]{1}[0-9]{0,2}(' + this.groupingSeparator + '[0-9]{3})*|[1-9]{1}[0-9]{0,}|0)$');\n};\nconst MIN_INT32 = -2147483648;\nconst MAX_INT32 = 2147483647;\nconst MAX_INT = Number.MAX_SAFE_INTEGER ? Number.MAX_SAFE_INTEGER+1 : 9007199254740992;\nconst MIN_INT = Number.MIN_SAFE_INTEGER ? Number.MIN_SAFE_INTEGER-1 : -9007199254740992;\n\n/*\n     Copyright (c) 2013 Kevin van Zonneveld (http://kvz.io)\n     and Contributors (http://phpjs.org/authors)\n\n     Permission is hereby granted, free of charge, to any person obtaining a copy of\n     this software and associated documentation files (the \"Software\"), to deal in\n     the Software without restriction, including without limitation the rights to\n     use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies\n     of the Software, and to permit persons to whom the Software is furnished to do\n     so, subject to the following conditions:\n\n     The above copyright notice and this permission notice shall be included in all\n     copies or substantial portions of the Software.\n\n     THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n     IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n     FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n     AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n     LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n     OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n     SOFTWARE.\n     */\n\nNumberUtils.prototype.number_format = function (number, decimals, dec_point, thousands_sep) {\n    //  discuss at: http://phpjs.org/functions/number_format/\n    // original by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)\n    // improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // improved by: davook\n    // improved by: Brett Zamir (http://brett-zamir.me)\n    // improved by: Brett Zamir (http://brett-zamir.me)\n    // improved by: Theriault\n    // improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\n    // bugfixed by: Michael White (http://getsprink.com)\n    // bugfixed by: Benjamin Lupton\n    // bugfixed by: Allan Jensen (http://www.winternet.no)\n    // bugfixed by: Howard Yeend\n    // bugfixed by: Diogo Resende\n    // bugfixed by: Rival\n    // bugfixed by: Brett Zamir (http://brett-zamir.me)\n    //  revised by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)\n    //  revised by: Luke Smith (http://lucassmith.name)\n    //    input by: Kheang Hok Chin (http://www.distantia.ca/)\n    //    input by: Jay Klehr\n    //    input by: Amir Habibi (http://www.residence-mixte.com/)\n    //    input by: Amirouche\n    //   example 1: number_format(1234.56);\n    //   returns 1: '1,235'\n    //   example 2: number_format(1234.56, 2, ',', ' ');\n    //   returns 2: '1 234,56'\n    //   example 3: number_format(1234.5678, 2, '.', '');\n    //   returns 3: '1234.57'\n    //   example 4: number_format(67, 2, ',', '.');\n    //   returns 4: '67,00'\n    //   example 5: number_format(1000);\n    //   returns 5: '1,000'\n    //   example 6: number_format(67.311, 2);\n    //   returns 6: '67.31'\n    //   example 7: number_format(1000.55, 1);\n    //   returns 7: '1,000.6'\n    //   example 8: number_format(67000, 5, ',', '.');\n    //   returns 8: '67.000,00000'\n    //   example 9: number_format(0.9, 0);\n    //   returns 9: '1'\n    //  example 10: number_format('1.20', 2);\n    //  returns 10: '1.20'\n    //  example 11: number_format('1.20', 4);\n    //  returns 11: '1.2000'\n    //  example 12: number_format('1.2000', 3);\n    //  returns 12: '1.200'\n    //  example 13: number_format('1 000,50', 2, '.', ' ');\n    //  returns 13: '100 050.00'\n    //  example 14: number_format(1e-8, 8, '.', '');\n    //  returns 14: '0.00000001'\n\n    number = (number + '').replace(/[^0-9+\\-Ee.]/g, '');\n    const n = !isFinite(+number) ? 0 : +number,\n        prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),\n        sep = typeof thousands_sep === 'undefined' ? ',' : thousands_sep,\n        dec = typeof dec_point === 'undefined' ? '.' : dec_point,\n        toFixedFix = function (num, absValue) {\n            const k = Math.pow(10, absValue);\n            return '' + (Math.round(num * k) / k).toFixed(absValue);\n        };\n\n    let result = (prec ? toFixedFix(n, prec) : '' + Math.round(n)).split('.');\n    if (result[0].length > 3) {\n        result[0] = result[0].replace(/\\B(?=(?:\\d{3})+(?!\\d))/g, sep);\n    }\n    if ((result[1] || '').length < prec) {\n        result[1] = result[1] || '';\n        result[1] += new Array(prec - result[1].length + 1).join('0');\n    }\n    return result.join(dec);\n};\nNumberUtils.prototype.isInt = function (value) {\n    return this.isNumberInt(value) || this.isStringInt(value);\n};\n\n// http://stackoverflow.com/a/3885844\nNumberUtils.prototype.isNumberInt = function (value) {\n    return _.isNumber(value) && !isNaN(value) && value !== Number.POSITIVE_INFINITY && value !== Number.NEGATIVE_INFINITY && (value === +value && value === (value | 0) || value % 1 === 0);\n};\nNumberUtils.prototype.isStringInt = function (value) {\n    return _.isString(value) && this.INTEGER_NUMBER_PATTERN.test(value);\n};\n\n/**\n     * We don't use this validator, since back-end maps Long, bigint fields to Integer filters.\n     * So isInt should be used to validate Long and bigint filters\n     * @param value\n     * @returns {*|boolean}\n     */\n\nNumberUtils.prototype.isInt32 = function (value) {\n    return this.isInt(value) && this.parseNumber(value) >= MIN_INT32 && this.parseNumber(value) <= MAX_INT32;\n};\nNumberUtils.prototype.isDecimal = function (value) {\n    return _.isNumber(value) && !isNaN(value) && value !== Number.POSITIVE_INFINITY && value !== Number.NEGATIVE_INFINITY || _.isString(value) && this.DECIMAL_NUMBER_PATTERN.test(value);\n};\nNumberUtils.prototype.parseNumber = function (value) {\n    if (_.isNumber(value)) {\n        return value;\n    } else if (_.isString(value) && this.DECIMAL_NUMBER_PATTERN.test(value)) {\n        value = value.replace(new RegExp(this.groupingSeparator, 'g'), '').replace(new RegExp(this.decimalSeparator, 'g'), '.');\n        var result = value * 1;\n        if (result >= MAX_INT || result <= MIN_INT) {\n            if (window.console) {\n                window.console.warn(value + ' is out of the [' + (MIN_INT+1)   + ', ' + (MAX_INT-1) + '] bounds. ' + 'Parsing results may be corrupted. Use string representation instead. ' + 'For more details see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number.');\n            }\n            return false;\n        }\n        return result;\n    }\n    return undefined;\n};\nNumberUtils.prototype.formatNumber = function (val, options) {\n    options = options || {};\n    const decimalNumStr = val.toString().split('.')[1];\n\n    let decimalPlacesAmount = decimalNumStr ? decimalNumStr.length : 0;\n    if (!_.isUndefined(options.decimalPlacesAmount)) {\n        decimalPlacesAmount = options.decimalPlacesAmount;\n    }\n\n    try {\n        return this.number_format(\n            val,\n            decimalPlacesAmount,\n            options.decimalSeparator || this.DECIMAL_SEPARATOR,\n            options.groupingSeparator || this.GROUPING_SEPARATOR\n        );\n    } catch (ex) {\n        return val.toString();\n    }\n};\nNumberUtils.prototype.MaxRange = Number.MAX_SAFE_INTEGER ? Number.MAX_SAFE_INTEGER+1 : 9007199254740992;\nNumberUtils.prototype.MinRange = Number.MIN_SAFE_INTEGER ? Number.MIN_SAFE_INTEGER-1 : -9007199254740992;\n\nexport default NumberUtils;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n * @author: Sergey Prilukin\n * @version: $Id$\n */\n\n/**\n * @class BaseListWithSelectionModel\n * @classdesc Model extended from ScalableListModel which allows to work with selection.\n * Base class for other selection implementations\n *\n * Model API (in addition to ScalableListModel API):\n *      addValueToSelection         - adds one value to selection and triggers \"selection:add\" event\n *      addRangeToSelection         - adds range from last adding of single selection to passed\n *                                    index and triggers \"selection:addRange\"\n *      removeValueFromSelection    - removes value from selection and triggers \"selection:remove\"\n *      toggleSelection             - toggles selection and triggers appropriate event\n *      selectionContains           - return true if value is selected and false otherwise\n *      clearSelection              - clear selection and trigger \"selection:clear\" event\n *      getSelection                - returns current selection as sparse array\n *      select                      - select passed values\n *      selectAll                   - select all values\n *      invertSelection             - inverts selection\n *\n * this Model implementation looks for following additional options in hash provided to constructor:\n *      selection       - initial selection\n */\n\nimport _ from 'underscore';\nimport ScalableListModel from './ScalableListModel';\n\nvar BaseListWithSelectionModel = ScalableListModel.extend(\n    /** @lends BaseListWithSelectionModel.prototype */\n    {\n\n        initialize: function(options) {\n            ScalableListModel.prototype.initialize.call(this, options);\n\n            this.select(options.value, {silent: true});\n        },\n\n        /* Methods which supposed to be overridden */\n\n        /**\n         * Adding to selection should be done only through this method.\n         * No direct change of this.selection object is allowed\n         */\n        _addToSelection: function(value, index) {\n            throw \"Not implemented\";\n        },\n\n        /**\n         * Removing from selection should be done only through this method.\n         * No direct change of this.selection object is allowed\n         */\n        _removeFromSelection: function(value, index) {\n            throw \"Not implemented\";\n        },\n\n        /**\n         * Clearing selection should be done only through this method.\n         * No direct change of this.selection object is allowed\n         */\n        _clearSelection: function() {\n            throw \"Not implemented\";\n        },\n\n        /**\n         * Selection contains should be checked only through this method\n         * No direct change of this.selection object is allowed\n         */\n        _selectionContains: function(value, index) {\n            throw \"Not implemented\";\n        },\n\n        /**\n         * Returns current selection\n         * No direct change of this.selection object is allowed\n         */\n        _getSelection: function() {\n            throw \"Not implemented\";\n        },\n\n        /* Internal helper methods */\n\n        _triggerSelectionChange: function(options) {\n            if (!options || !options.silent) {\n                this.trigger(\"change\");\n            }\n\n            this.trigger(\"selection:change\");\n        },\n\n        _addRangeToSelection: function(data, rangeStart, rangeEnd) {\n            for (var i = 0; i < data.length; i++) {\n                this._addToSelection(data[i].value, i + rangeStart);\n            }\n\n            this.trigger(\"selection:addRange\", {start: rangeStart, end: rangeEnd, selection: this.getSelection()});\n        },\n\n        _fetchAllDataAndModifySelection: function(modifySelection, onDone) {\n            this.getData().done(function(values) {\n                for (var i = 0; i < values.data.length; i++) {\n                    modifySelection(values.data[i].value, i);\n                }\n\n                onDone && onDone();\n            }).fail(this.fetchFailed);\n\n            return this;\n        },\n\n        /*-------------------------\n         * API\n         -------------------------*/\n\n        /*\n            Adds value selection and triggers add event\n        */\n        addValueToSelection: function(value, index) {\n            this.selectionStartIndex = index;\n            this._addToSelection(value, index);\n            return this.trigger(\"selection:add\", {value: value, index: index});\n        },\n\n        /*\n            Adds value selection and triggers add event\n        */\n        addRangeToSelection: function(value, index) {\n\n            //No range determined - use single item selection\n            if (typeof this.selectionStartIndex === \"undefined\") {\n                this.addValueToSelection(value, index);\n                return;\n            }\n\n            //Same element selected no need to fire range selection\n            if (this.selectionStartIndex === index) {\n                return;\n            }\n\n            //Calculate range dimensions\n            var rangeStart = Math.min(this.selectionStartIndex, index);\n            var rangeEnd = Math.max(this.selectionStartIndex, index);\n            this.selectionStartIndex = index;\n\n            if (rangeStart >= this.get(\"bufferStartIndex\") && rangeEnd <= this.get(\"bufferEndIndex\")) {\n                //All data from this range already fetched\n                var data = Array.prototype.slice.call(this.get(\"items\"),\n                    rangeStart - this.get(\"bufferStartIndex\"), rangeEnd - this.get(\"bufferStartIndex\") + 1);\n                this._addRangeToSelection(data, rangeStart, rangeEnd);\n            } else {\n                //Need to fetch data\n                var that = this;\n                this.getData({\n                    offset: rangeStart,\n                    limit: rangeEnd - rangeStart + 1}\n                ).done(function(values) {\n                    that._addRangeToSelection(values.data, rangeStart, rangeEnd);\n                }).fail(this.fetchFailed);\n            }\n        },\n\n        /*\n             Removes value from selection and triggers remove event\n         */\n        removeValueFromSelection: function(value, index) {\n            this._removeFromSelection(value, index);\n            this.trigger(\"selection:remove\", {value: value, index: index});\n        },\n\n        /*\n            Does selection toggle for passed value\n         */\n        toggleSelection: function(value, index) {\n            if (this.selectionContains(value, index)) {\n                this.removeValueFromSelection(value, index);\n            } else {\n                this.addValueToSelection(value, index);\n            }\n        },\n\n        /*\n            Returns true if value present in selection\n        */\n        selectionContains: function(value, index) {\n            return this._selectionContains(value, index);\n        },\n\n        /*\n            Removes all items from selection\n         */\n        clearSelection: function() {\n            this._clearSelection();\n            return this.trigger(\"selection:clear\");\n        },\n\n        /*\n            Returns all selected values\n        */\n        getSelection: function() {\n            return this._getSelection();\n        },\n\n        /*\n            Selects passed selection\n         */\n        select: function(selection, options) {\n            throw \"Not implemented\";\n        },\n\n        /*\n            Selects all values\n         */\n        selectAll: function() {\n            var self = this,\n                firstIteration = true;\n\n            this._fetchAllDataAndModifySelection(function(value, index) {\n\n                //this is necessary when getData is slow operation\n                //so model will not be empty too early\n                if (firstIteration) {\n                    self._clearSelection();\n                    firstIteration = false;\n                }\n\n                self._addToSelection(value, index);\n            }, _.bind(this._triggerSelectionChange, this));\n        },\n\n        /*\n            Inverts selection\n         */\n        invertSelection: function() {\n            var self = this;\n\n            this._fetchAllDataAndModifySelection(function(value, index) {\n                if (self._selectionContains(value, index)) {\n                    self._removeFromSelection(value, index);\n                } else {\n                    self._addToSelection(value, index);\n                }\n            }, _.bind(this._triggerSelectionChange, this));\n        }\n    });\n\nexport default BaseListWithSelectionModel;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport BaseListWithSelectionModel from './BaseListWithSelectionModel';\nvar ListWithSelectionModel = BaseListWithSelectionModel.extend({\n    initialize: function(options) {\n        BaseListWithSelectionModel.prototype.initialize.call(this, options);\n\n        this.caseSensitiveSelection = typeof options.caseSensitiveSelection !== 'undefined' ? options.caseSensitiveSelection : true;\n    },\n\n    _addToSelection: function (value, index) {\n        this.selection[index] = value;\n    },\n    _removeFromSelection: function (value, index) {\n        this.selection[index] = undefined;\n    },\n    _clearSelection: function () {\n        this.selection = [];\n    },\n    _selectionContains: function (value, index) {\n        if (this.caseSensitiveSelection) {\n            return this.selection[index] === value;\n        }\n        return this.selection[index].toLowerCase() === value.toLowerCase();\n    },\n    _getSelection: function () {\n        return this.selection;\n    },\n    _isSelectionEmpty: function (selection) {\n        if (!selection) {\n            return true;\n        } else if (_.isArray(selection) && selection.length === 0) {\n            return true;\n        } else if (_.isArray(selection) || typeof selection === 'string') {\n            return false;\n        }\n        for (var index in selection) {\n            if (selection.hasOwnProperty(index) && selection[index] !== undefined) {\n                return false;\n            }\n        }\n        return true;\n    },\n    _selectPendingSelection: function (pendingSelection, options) {\n        if (this.get('bufferStartIndex') === 0 && this.get('bufferEndIndex') == this.get('total') - 1) {\n            this._convertInitialArrayToSelection(this.get('items'), pendingSelection, options);\n        } else {\n            var that = this;\n            this.getData().done(function (values) {\n                that._convertInitialArrayToSelection(values.data, pendingSelection, options);\n            }).fail(this.fetchFailed);\n        }\n    },\n    _convertInitialArrayToSelection: function (data, pendingSelection, options) {\n        for (var i = 0; i < data.length; i++) {\n            if (pendingSelection[data[i].value]) {\n                this._addToSelection(data[i].value, i);\n            }\n        }\n        this._triggerSelectionChange(options);\n    },\n    _triggerSelectionChange: function (options) {\n        this._calcSelectionStartIndex && this._calcSelectionStartIndex();\n        BaseListWithSelectionModel.prototype._triggerSelectionChange.call(this, options);\n    },\n    _calcSelectionStartIndex: function () {\n        if (typeof this.selectionStartIndex !== 'undefined') {\n            return;\n        }\n        for (var index in this.selection) {\n            if (this.selection.hasOwnProperty(index) && this.selection[index] !== undefined) {\n                this.selectionStartIndex = parseInt(index, 10);\n                break;\n            }\n        }\n    },\n    select: function (selection, options) {\n        this._clearSelection();\n        if (this._isSelectionEmpty(selection)) {\n            this._triggerSelectionChange(options);\n            return;\n        }\n        if (_.isArray(selection) || typeof selection === 'string') {\n            var pendingSelection = {};\n            if (typeof selection === 'string') {\n                pendingSelection[selection] = true;\n            } else {\n                for (var i = 0; i < selection.length; i++) {\n                    pendingSelection[selection[i]] = true;\n                }\n            }\n            this._selectPendingSelection(pendingSelection, options);\n        } else {\n            for (var index in selection) {\n                if (selection.hasOwnProperty(index)) {\n                    var value = selection[index];\n                    if (value !== undefined) {\n                        this._addToSelection(value, index);\n                    }\n                }\n            }\n            this._triggerSelectionChange(options);\n        }\n    }\n});\nexport default ListWithSelectionModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nvar DEFAULT_BUFFER_SIZE = 100;\nvar DEFAULT_LOAD_FACTOR = 0.95;\nvar ScalableListModel = Backbone.Model.extend({\n    initialize: function (options) {\n        options = options || {};\n        _.bindAll(this, '_fetchComplete', 'fetchFailed', 'afterFetchComplete', 'fetch');\n        this.set({ items: [] }, { silent: true });\n        this.getData = options.getData;\n        this.bufferSize = options.bufferSize || DEFAULT_BUFFER_SIZE;\n        this.loadFactor = options.loadFactor || DEFAULT_LOAD_FACTOR;\n    },\n    _fetchComplete: function (values) {\n        this.attributes.total = values.total;\n        this.set({ items: values.data }, { silent: true });\n        this.attributes.bufferEndIndex = Math.max(0, Math.min(this.attributes.bufferStartIndex + this.bufferSize - 1, this.attributes.bufferStartIndex + values.data.length - 1));\n        if (this.attributes.bufferEndIndex < this.attributes.bufferStartIndex + this.bufferSize - 1) {\n            this.attributes.total = Math.min(values.total, this.attributes.bufferEndIndex + 1);\n        }\n        this.afterFetchComplete && this.afterFetchComplete(values.data, this.attributes.total);\n        this.trigger('change', this);\n    },\n    _isBufferReloadNecessary: function (topVisibleItem, bottomVisibleItem) {\n        if (typeof this.get('bufferStartIndex') === 'undefined' || typeof this.get('bufferEndIndex') === 'undefined') {\n            return true;\n        }\n        if (topVisibleItem >= 0 && topVisibleItem < this.get('bufferStartIndex') || bottomVisibleItem < this.get('total') && bottomVisibleItem > this.get('bufferEndIndex')) {\n            return true;\n        }\n        if (topVisibleItem === this.get('bufferStartIndex') && bottomVisibleItem === this.get('bufferEndIndex')) {\n            return false;\n        }\n        var topLoadFactor = 1 - (topVisibleItem - this.get('bufferStartIndex')) / this.bufferSize;\n        var bottomLoadFactor = 1 - (this.get('bufferEndIndex') - bottomVisibleItem) / this.bufferSize;\n        return this.get('bufferStartIndex') > 0 && topLoadFactor >= this.loadFactor || this.get('bufferEndIndex') < this.get('total') && bottomLoadFactor >= this.loadFactor;\n    },\n    afterFetchComplete: function (items, total) {\n    },\n    fetchFailed: function (responseStatus, error) {\n        this.trigger('fetchFailed', responseStatus, error);\n    },\n    fetch: function (options) {\n        options = _.extend({\n            top: this.get('bufferStartIndex') || 0,\n            bottom: this.get('bufferEndIndex') || this.bufferSize - 1\n        }, options);\n        if (options.force || this._isBufferReloadNecessary(options.top, options.bottom)) {\n            if (options.top !== this.attributes.bufferStartIndex || options.bottom !== this.attributes.bufferEndIndex || options.force) {\n                var bufferCenter = options.top + Math.floor((options.bottom - options.top) / 2);\n                var bufferHalf = Math.floor(this.bufferSize / 2);\n                this.attributes.bufferStartIndex = Math.max(0, bufferCenter - bufferHalf);\n                if (this.get('total') && !options.force) {\n                    this.attributes.bufferEndIndex = Math.min(this.get('total'), this.attributes.bufferStartIndex + this.bufferSize) - 1;\n                } else {\n                    this.attributes.bufferEndIndex = this.attributes.bufferStartIndex + this.bufferSize - 1;\n                }\n            }\n            this.getData({\n                offset: this.get('bufferStartIndex'),\n                limit: this.get('bufferEndIndex') - this.get('bufferStartIndex') + 1\n            }).done(this._fetchComplete).fail(this.fetchFailed);\n        } else {\n            this.afterFetchComplete && this.afterFetchComplete(this.get('items'), this.get('total'));\n        }\n    },\n    reset: function (options) {\n        this.attributes = {};\n        this.set({ items: [] }, { silent: true });\n        if (!options || !options.silent) {\n            this.trigger('change', this);\n        }\n    }\n});\nexport default ScalableListModel;"],"sourceRoot":""}