(self.webpackChunkjrs_ui=self.webpackChunkjrs_ui||[]).push([[3734,1603,2561,6061,4696,799,3550,620,8612],{44455:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i,o=n(72157),a=n.n(o),s=n(97836),r=n.n(s),l=n(55149),c=n(10388),d=n(76312),p=n(29714),u=(n(68453),{DURATION_PATTERN:"[h]:mm:ss",jQueryUiTimestampToIsoTimestamp:function(e,t){if(e&&t&&t.calendarPatterns){var n=t.calendarPatterns.date,i=t.calendarPatterns.time;try{return l.Z.dateObjectToIso8601Timestamp(a().datepicker.parseDateTime(n,i,e))}catch(t){throw new d.Z(p.Z.INVALID_TIMESTAMP,t,{value:e})}}},jQueryUiTimeToIsoTime:function(e,t){if(e&&t&&t.calendarPatterns){var n=t.calendarPatterns.time;try{var i=a().datepicker.parseTime(n,e);if(i)return c.Z.timeToIso8061Time(i.hour,i.minute,i.second)}catch(t){throw new d.Z(p.Z.INVALID_TIME,t,{value:e})}}},isoTimestampTojQueryUiTimestamp:function(e,t){if(e&&t&&t.calendarPatterns){var n=l.Z.iso8601TimestampToDateObject(e),i=t.calendarPatterns.date,o=t.calendarPatterns.time,s=a().timepicker&&a().timepicker._defaults&&a().timepicker._defaults.separator?a().timepicker._defaults.separator:" ";return a().datepicker.formatDate(i,n)+s+a().datepicker.formatTime(o,{hour:n.getHours(),minute:n.getMinutes(),second:n.getSeconds()})}},isoTimeTojQueryUiTime:function(e,t){if(e&&t&&t.calendarPatterns){var n=c.Z.iso8601TimeToTimeObject(e),i=t.calendarPatterns.time;if(n)return a().datepicker.formatTime(i,{hour:n.hours,minute:n.minutes,second:n.seconds})}},filterStartValue:function(e,t,n,i){var o=null==t&&null==e,a=null!=e&&-1!==e.indexOf("null"),s="boolean"===n,l="datetime"===n,c="time"===n;return o||a?"":r().isArray(t)?l?u.isoTimestampTojQueryUiTimestamp(t[0],i):c?u.isoTimeTojQueryUiTime(t[0],i):t[0]:s?"":l?u.isoTimestampTojQueryUiTimestamp(t,i):c?u.isoTimeTojQueryUiTime(t,i):t},filterEndValue:function(e,t,n,i){var o="datetime"===n,a="time"===n;return null==t&&null==e?"":r().isArray(t)?o?u.isoTimestampTojQueryUiTimestamp(t[1],i):a?u.isoTimeTojQueryUiTime(t[1],i):t[1]:""},dataTypeToSchemaFormat:{Text:"string",Numeric:"numeric",Date:"datetime",Boolean:"boolean",Time:"time"},schemaFormatOperatorToFilterOperatorMap:(i={string:{}},i.string.equal="EQUALS",i.string.not_equal="IS_NOT_EQUAL_TO",i.string.contain="CONTAINS",i.string.not_contain="DOES_NOT_CONTAIN",i.string.start_with="STARTS_WITH",i.string.not_start_with="DOES_NOT_START_WITH",i.string.end_with="ENDS_WITH",i.string.not_end_with="DOES_NOT_END_WITH",i.string.is_null="IS_NULL",i.string.is_not_null="IS_NOT_NULL",i.datetime={},i.datetime.equal="EQUALS",i.datetime.not_equal="IS_NOT_EQUAL_TO",i.datetime.between="IS_BETWEEN",i.datetime.not_between="IS_NOT_BETWEEN",i.datetime.on_or_before="IS_ON_OR_BEFORE",i.datetime.before="IS_BEFORE",i.datetime.on_or_after="IS_ON_OR_AFTER",i.datetime.after="IS_AFTER",i.datetime.is_null="IS_NULL",i.datetime.is_not_null="IS_NOT_NULL",i.time={},i.time.equal="EQUALS",i.time.not_equal="IS_NOT_EQUAL_TO",i.time.between="IS_BETWEEN",i.time.not_between="IS_NOT_BETWEEN",i.time.on_or_before="IS_ON_OR_BEFORE",i.time.before="IS_BEFORE",i.time.on_or_after="IS_ON_OR_AFTER",i.time.after="IS_AFTER",i.time.is_null="IS_NULL",i.time.is_not_null="IS_NOT_NULL",i.numeric={},i.numeric.equal="EQUALS",i.numeric.not_equal="DOES_NOT_EQUAL",i.numeric.greater="GREATER_THAN",i.numeric.greater_or_equal="GREATER_THAN_EQUAL_TO",i.numeric.less="LESS_THAN",i.numeric.less_or_equal="LESS_THAN_EQUAL_TO",i.numeric.between="IS_BETWEEN",i.numeric.not_between="IS_NOT_BETWEEN",i.numeric.is_null="IS_NULL",i.numeric.is_not_null="IS_NOT_NULL",i),filterOperatorToSchemaFormatMap:function(){var e={string:{}};return e.string.EQUALS="equal",e.string.IS_NOT_EQUAL_TO="not_equal",e.string.CONTAINS="contain",e.string.DOES_NOT_CONTAIN="not_contain",e.string.STARTS_WITH="start_with",e.string.DOES_NOT_START_WITH="not_start_with",e.string.ENDS_WITH="end_with",e.string.DOES_NOT_END_WITH="not_end_with",e.string.IS_NULL="is_null",e.string.IS_NOT_NULL="is_not_null",e.datetime={},e.datetime.EQUALS="equal",e.datetime.IS_NOT_EQUAL_TO="not_equal",e.datetime.IS_BETWEEN="between",e.datetime.IS_NOT_BETWEEN="not_between",e.datetime.IS_ON_OR_BEFORE="on_or_before",e.datetime.IS_BEFORE="before",e.datetime.IS_ON_OR_AFTER="on_or_after",e.datetime.IS_AFTER="after",e.datetime.IS_NULL="is_null",e.datetime.IS_NOT_NULL="is_not_null",e.numeric={},e.numeric.EQUALS="equal",e.numeric.DOES_NOT_EQUAL="not_equal",e.numeric.GREATER_THAN="greater",e.numeric.GREATER_THAN_EQUAL_TO="greater_or_equal",e.numeric.LESS_THAN="less",e.numeric.LESS_THAN_EQUAL_TO="less_or_equal",e.numeric.IS_BETWEEN="between",e.numeric.IS_NOT_BETWEEN="not_between",e.numeric.IS_NULL="is_null",e.numeric.IS_NOT_NULL="is_not_null",e.time={},e.time.EQUALS="equal",e.time.IS_NOT_EQUAL_TO="not_equal",e.time.IS_BETWEEN="between",e.time.IS_NOT_BETWEEN="not_between",e.time.IS_ON_OR_BEFORE="on_or_before",e.time.IS_BEFORE="before",e.time.IS_ON_OR_AFTER="on_or_after",e.time.IS_AFTER="after",e.time.IS_NULL="is_null",e.time.IS_NOT_NULL="is_not_null",e}(),schemaFormatOperatorToFilterOperator:function(e,t,n){return"boolean"!==n?u.schemaFormatOperatorToFilterOperatorMap[n][e]:"equal"===e&&!0===t?"IS_TRUE":"equal"===e&&!1===t?"IS_FALSE":"not_equal"===e&&!0===t?"IS_NOT_TRUE":"not_equal"===e&&!1===t?"IS_NOT_FALSE":"is_null"===e?"IS_NULL":"is_not_null"===e?"IS_NOT_NULL":void 0},operatorAndValueToSchemaFormat:function(e,t,n,i,o){var a={};if("boolean"===t)"IS_TRUE"===e?(a.operator="equal",a.value=!0):"IS_FALSE"===e?(a.operator="equal",a.value=!1):"IS_NOT_TRUE"===e?(a.operator="not_equal",a.value=!0):"IS_NOT_FALSE"===e?(a.operator="not_equal",a.value=!1):"IS_NULL"===e?(a.operator="is_null",a.value=""):"IS_NOT_NULL"===e&&(a.operator="is_not_null",a.value="");else{a.operator=u.filterOperatorToSchemaFormatMap[t][e];var s="between"===a.operator||"not_between"===a.operator,r="is_null"===a.operator||"is_not_null"===a.operator;if("string"===t)a.value=null==n?"":n;else if("numeric"===t)a.value=s?[n,i]:n;else{var l=this.parent&&this.parent.config?this.parent.config.genericProperties:void 0;"datetime"===t?a.value=s?[u.jQueryUiTimestampToIsoTimestamp(n,l),u.jQueryUiTimestampToIsoTimestamp(i,l)]:r?n:u.jQueryUiTimestampToIsoTimestamp(n,l):"time"===t&&(a.value=s?[u.jQueryUiTimeToIsoTime(n,l),u.jQueryUiTimeToIsoTime(i,l)]:r?n:u.jQueryUiTimeToIsoTime(n,l))}}return a}});const h=u},29714:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={INVALID_TIMESTAMP:"invalid.timestamp",INVALID_TIME:"invalid.time"}},85112:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Je});var i=n(32608),o=n(97836),a=n.n(o),s=n(40403),r=n(76196),l=n(36562),c=n(72157),d=n.n(c),p=n(15892),u=n.n(p);n(68851);const h=u().View.extend({el:'<div class="jive_marker" style="display: none">\n\n    <js-templateNonce></js-templateNonce>\n    <div class="jive_marker_icon">&nbsp;</div>\n    <div style="position:absolute; top:0; right:6px; bottom:0; left:-6px;"></div>\n</div>\n',constructor:function(e){e=e||{},this.$parentElement=e.parentElement?d()(e.parentElement):d()("body"),u().View.apply(this,arguments)},initialize:function(){var e=this;u().View.prototype.initialize.apply(this,arguments),this.$el.draggable({axis:"x",start:function(t,n){e.trigger("marker:dragStart",t,n)},drag:function(t,n){e.trigger("marker:drag",t,n)},stop:function(t,n){e.trigger("marker:dragStop",t,n)}}),this.render()},render:function(){this.$parentElement.append(this.$el)},css:function(e){return this.$el.css(e),this},setPosition:function(e){return this.$el.position(e),this},show:function(){return this.$el.show(),this.$el.css("position","absolute"),this},hide:function(){return this.$el.hide(),this}});var m=n(89560);var v=n(80451),f=n.n(v);const b=f().Model.extend({defaults:{operator:null,value:""},computeds:{isMultiValueOperator:function(){var e=this.get("operator");return!(!e||-1===e.toLowerCase().indexOf("between"))},isNotNullCheckOperator:function(){var e=this.get("operator");return!!(!e||-1===e.toLowerCase().indexOf("null"))}},initialize:function(){this.on("change:operator",this._onOperatorChange),f().Model.prototype.initialize.apply(this,arguments)},reset:function(){return this.clear({silent:!1}).set(this.defaults),this},_onOperatorChange:function(){var e,t,n=this.get("value"),i=this.get("operator");e=i&&-1!==i.toLowerCase().indexOf("between"),t=i&&-1!==i.toLowerCase().indexOf("null"),!0===e?a().isArray(n)||this.set({value:[n]}):!1===e&&a().isArray(n)&&this.set({value:n[0]}),t&&this.set({value:""})},remove:function(){}});var g=n(12197);function T(e){this.view.pickers.forEach((function(t){t.$el.prop("id")==e&&t.remove()})),this.view.pickers=this.view.pickers.filter((function(t){return e!=t.$el.prop("id")}))}function y(e,t){var n=this.view.viewModel.previous("dataType"),i=this.view.viewModel.get("calendarPatterns");this.view.pickers||(this.view.pickers=[]),n!=t&&("date"!==n&&"time"!==n||T.call(this,e.prop("id")),"date"===t?this.view.pickers.push(new g.Z({el:e[0],dateFormat:i.date,timeFormat:i.time,skipMoving:!0})):"time"===t&&this.view.pickers.push(new g.Z({el:e[0],timeFormat:i.time,skipMoving:!0})))}function _(e,t){return"net.sf.jasperreports.components.sort.FilterType".concat(e,"OperatorsEnum.").concat(t)}function C(e,t){var n;switch(e){case"numeric":n=_("Numeric",t);break;case"date":case"time":n=_("Date",t);break;case"text":n=_("Text",t);break;case"boolean":n=_("Boolean",t);break;default:n=t}return n}var w=f().Model.extend({defaults:{columnLabel:"",clearFilter:"true",filterOptions:[],dataType:"text",emptyFilterOption:"..."},computeds:{isNotClearFilter:function(){return"true"!==this.get("clearFilter")},isNotBooleanType:function(){return"boolean"!==this.get("dataType")},transformedFilterOptions:{deps:["clearFilter","filterOptions","dataType"],get:function(e,t,n){return"true"===e?[]:function(e,t){var n=[];return a().each(t,(function(t){n.push({label:s.Z[C(e,t)],value:t})})),n}(n,t)}}},remove:function(){}});const O=f().View.extend({constructor:function(e){this.i18n=e.i18n,f().View.prototype.constructor.call(this,e)},initialize:function(){this.model=new b,this.viewModel=new w,this.listenTo(this.viewModel,"change:clearFilter",this._onClearFilterChanged),f().View.prototype.initialize.apply(this,arguments)},el:function(){return a().template('<div class="dialogHeader mover">\n\n    <js-templateNonce></js-templateNonce>\n    <h2>\n        <span class="dialogTitle">{{- i18n["net.sf.jasperreports.components.headertoolbar.title.filtercolumn"] }}: </span>\n        <span class="dialogTitle" data-bind="text:columnLabel"></span>\n    </h2>\n</div>\n<div class="dialogBody" style="text-align:left;">\n    <form method="get" class="jive_form" style="width: 700px;">\n        <table width="100%">\n            <tbody>\n            <tr>\n                <td>\n                    <div class="thick wrapper">\n                        <label class="jive_inputLabel">\n                            <input type="radio" name="clearFilter" value="true" data-bind="checked:clearFilter">\n                            {{- i18n["net.sf.jasperreports.components.headertoolbar.label.clearfilter.true"] }}\n                        </label>\n                    </div>\n                </td>\n            </tr>\n            </tbody>\n        </table>\n        <table width="100%">\n            <tbody>\n            <tr>\n                <td colspan="4">\n                    <div class="thick wrapper">\n                        <label class="jive_inputLabel">\n                            <input type="radio" name="clearFilter" value="false" data-bind="checked:clearFilter">\n                            {{- i18n["net.sf.jasperreports.components.headertoolbar.label.clearfilter.false"] }}\n                        </label>\n                    </div>\n                </td>\n            </tr>\n            <tr>\n                <td class="jive_filterTypeOperatorContainer">\n                    <div class="wrapper">\n                        <select name="filterTypeOperator" size="1" data-bind="options:transformedFilterOptions,optionsEmpty:emptyFilterOption,value:operator">\n                        </select>\n                    </div>\n                </td>\n                <td data-bind="toggle:all(isNotBooleanType,isNotNullCheckOperator)">\n                    <div class="wrapper">\n                        <input type="text" name="fieldValueStart" data-bind="value:filterValueStart,enabled:isNotClearFilter,dateTimePicker:dataType">\n                    </div>\n                </td>\n                <td class="jive_textLabel" data-bind="toggle:isMultiValueOperator">\n                    <div>and</div>\n                </td>\n                <td data-bind="toggle:isMultiValueOperator">\n                    <div class="wrapper">\n                        <input type="text" name="fieldValueEnd" data-bind="value:filterValueEnd,enabled:isNotClearFilter,dateTimePicker:dataType">\n                    </div>\n                </td>\n            </tr>\n            </tbody>\n        </table>\n    </form>\n</div>',{i18n:this.i18n})},computeds:{filterValueStart:{deps:["value"],get:function(e){return a().isArray(e)?e[0]:e},set:function(e){var t=this.getBinding("value");a().isArray(t)?t[0]=e:this.setBinding("value",e)}},filterValueEnd:{deps:["value"],get:function(e){if(a().isArray(e))return e[1]},set:function(e){var t=this.getBinding("value");a().isArray(t)&&(t[1]=e)}}},bindingHandlers:{dateTimePicker:y},_onClearFilterChanged:function(){"true"===this.viewModel.get("clearFilter")?this.model.reset():this.model.set("operator",this.viewModel.get("filterOptions")[0])},remove:function(){f().View.prototype.remove.apply(this,arguments),this.model&&this.model.remove(),this.viewModel&&this.viewModel.remove()}});var M=n(44455),j=n(29714);const k={extension:{_adjustPositionWithinViewport:function(e){return{top:e.top+this._getWindowScrollTop(),left:e.left}},_position:function(){var e=m.Z.prototype._position.apply(this,arguments);return this._adjustPositionWithinViewport(e)},_getWindowScrollTop:function(){return d()(window).scrollTop()}}};var N=n(18580);function S(e,t){var n,i,o={};return e.operator&&(o.operator=M.Z.schemaFormatOperatorToFilterOperator(e.operator,e.value,t),n=this.columnComponentModel.parent.config.genericProperties,i=-1!==e.operator.indexOf("null"),"datetime"!==t||i?"time"!==t||i?o.value=e.value:a().isArray(e.value)?(o.value=[],o.value[0]=M.Z.isoTimeTojQueryUiTime(e.value[0],n),o.value[1]=M.Z.isoTimeTojQueryUiTime(e.value[1],n)):o.value=M.Z.isoTimeTojQueryUiTime(e.value,n):a().isArray(e.value)?(o.value=[],o.value[0]=M.Z.isoTimestampTojQueryUiTimestamp(e.value[0],n),o.value[1]=M.Z.isoTimestampTojQueryUiTimestamp(e.value[1],n)):o.value=M.Z.isoTimestampTojQueryUiTimestamp(e.value,n)),o}const x=m.Z.extend({defaultTemplate:'<div class="jive_dialog {{- additionalCssClasses }}">\n\n    <div class="dialogContent"></div>\n    <div class="dialogFooter footer"></div>\n</div>',constructor:function(e){this.tableFilterView=new O({i18n:e.i18n}),this.i18n=e.i18n,m.Z.prototype.constructor.call(this,{buttons:[{label:N.Z["button.cancel"],action:"cancel",primary:!1,float:"right"},{label:N.Z["button.ok"],action:"ok",primary:!0,float:"right"}],traits:[k],additionalCssClasses:"tableFilterDialog",modal:e.modal,resizable:!1,contentContainer:".dialogContent",content:this.tableFilterView}),this.on("button:ok",this._applyFilter),this.on("button:cancel",this.close)},open:function(e){this.columnComponentModel=e;var t=this.columnComponentModel.toReportComponentObject(),n=this.columnComponentModel.get("dataType").toLowerCase();"date"!==n&&"time"!==n||(n="dateTime"),this.tableFilterView.viewModel.set({columnLabel:t.label?t.label:"#"+(this.columnComponentModel.get("columnIndex")+1),clearFilter:null==t.filter.operator?"true":"false",filterOptions:this.columnComponentModel.parent.config.genericProperties.operators[n],dataType:this.columnComponentModel.get("dataType").toLowerCase(),calendarPatterns:this.columnComponentModel.parent.config.genericProperties.calendarPatterns}),this.tableFilterView.model.reset().set(S.call(this,t.filter,t.dataType)),m.Z.prototype.open.apply(this,arguments)},_applyFilter:function(e){var t,n,i=this.tableFilterView.model.toJSON();if(i.operator){var o=this.columnComponentModel.toReportComponentObject(),s=a().isArray(i.value)?i.value[0]:i.value,r=a().isArray(i.value)?i.value[1]:void 0;try{o.filter=M.Z.operatorAndValueToSchemaFormat.call(this.columnComponentModel,i.operator,o.dataType,s,r,o.detailsRowFormat.pattern),this.columnComponentModel.updateFromReportComponentObject(o)}catch(e){t={code:e.errorCode,params:e.parameters,originalException:e}}}else this.columnComponentModel.set({filterValue:null,filterOperator:null},{silent:!0});if(t)t.code?(n=t.code,j.Z.INVALID_TIMESTAMP!==n&&j.Z.INVALID_TIME!==n||(n=(n=this.i18n["net.sf.jasperreports.components.headertoolbar.actions.filter.invalid.date"]).replace("{0}",t.params.value))):n=t.originalException,this.trigger("validationError",n);else{var l=this.columnComponentModel.actions["change:filter"].call(this.columnComponentModel);this.columnComponentModel.filter(l.filterData),this.close()}},remove:function(){m.Z.prototype.remove.call(this),this.tableFilterView&&this.tableFilterView.remove()}});var I=n(70618),E=n(59661);function P(e,t){var n=t.get("action");this._contentRendered[n]||(this._contentRendered[n]=!0,this.tabs[n].render&&this.tabs[n].render()),this.$tabs.hide(),this.$tabs.filter((function(){return d()(this).data("tab")===n})).css("display","block"),this.selectedTab=n,this.trigger("tab:"+n,e,t)}const L=a().extend({},I.Z,{onConstructor:function(e){if(e||(e={}),!e.tabs||!a().isArray(e.tabs)||0===e.tabs.length)throw new Error("Tabbed panel should have at least one tab");this.tabContainerClass=e.tabContainerClass||"tabContainer",this.tabHeaderContainerSelector=e.tabHeaderContainerSelector||"> .header > .tabHeaderContainer",this.tabHeaderContainerClass=e.tabHeaderContainerClass||"tabHeaderContainer",this.tabbedPanelClass=e.tabbedPanelClass||"tabbedPanel",this.tabs={},a().each(e.tabs,a().bind((function(e){this.tabs[e.action]=e.content,delete e.content}),this))},afterSetElement:function(){this.$el.addClass(this.tabbedPanelClass),this.$tabHeaderContainer=this.$(this.tabHeaderContainerSelector),this.$tabHeaderContainer.length||(this.$tabHeaderContainer=d()("<div></div>").addClass(this.tabHeaderContainerClass),this.$("> .header").append(this.$tabHeaderContainer)),this.$contentContainer.empty(),a().each(this.tabs,a().bind((function(e,t){var n=d()("<div></div>").addClass(this.tabContainerClass);n.data("tab",t),n.html(e instanceof u().View?e.$el:e),this.$contentContainer.append(n)}),this));var e=this.tabContainerClass.split(" ");this.$tabs=this.$("."+e[0])},afterInitialize:function(e){this.tabHeaderContainer=new E.Z({options:e.tabs,el:this.$tabHeaderContainer,contextName:"tab",toggleClass:e.toggleClass||"active",toggle:!0,optionTemplate:e.optionTemplate||'<button class="button up">\n\n    <js-templateNonce></js-templateNonce>\n    <span class="wrap">{{- label }}<span class="icon"></span></span>\n</button>\n'}),this._contentRendered={},this.listenTo(this.tabHeaderContainer,a().map(e.tabs,(function(e){return"tab:"+e.action})).join(" "),a().bind(P,this));for(var t=0;t<e.tabs.length;t++)if(e.tabs[t].primary){this.openTab(e.tabs[t].action);break}},onRemove:function(){a().each(this.tabs,(function(e){e.remove&&e.remove()})),this.tabHeaderContainer.remove()},extension:{openTab:function(e){var t=this.tabHeaderContainer.getOptionView(e);t&&t.select()},showTab:function(e){var t=this.tabHeaderContainer.getOptionView(e);t&&t.show()},hideTab:function(e){var t=this.tabHeaderContainer.getOptionView(e);t&&t.hide()}}});var A=n(19377),F=n.n(A),D=n(206),R=n.n(D),U=n(56529);function $(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var V={padding:{top:0,left:0},disableAlpha:!0,showTransparentPreset:!0,color:"",onChangeComplete:function(){},onHide:function(){},ColorPicker:U.Z},Z=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V;$(this,e),this.attachTo=void 0,this.options=void 0,this.color=void 0,this.colorPickerContainerWrapper=void 0,this.onChangeCompleteWrapper=void 0,this.onHideWrapper=void 0,this.ColorPicker=void 0,this.boundOnAttachElementClick=void 0,this.options=i,this.attachTo=t,this.color=this.options.color,this.ColorPicker=this.options.ColorPicker||U.Z,this.colorPickerContainerWrapper=document.createElement("div"),this.colorPickerContainerWrapper.className="jr-jColorPickerWrapper",this.boundOnAttachElementClick=this.onAttachElementClick.bind(this);var o=this.options,a=o.onChangeComplete,s=o.onHide;this.onChangeCompleteWrapper=function(e){n.color=e.hex,a(e)},this.onHideWrapper=function(){var e=n.getColorPickerState(!1);n.renderColorPicker(e),s&&s()};var r=this.getColorPickerState(!1);this.renderColorPicker(r)}var t,n,i;return t=e,(n=[{key:"renderColorPicker",value:function(e){this.remove(),this.attachTo.addEventListener("click",this.boundOnAttachElementClick),document.body.appendChild(this.colorPickerContainerWrapper);var t=this.ColorPicker;R().render(F().createElement(t,e),this.colorPickerContainerWrapper)}},{key:"onAttachElementClick",value:function(){var e=this.getColorPickerState(!0);this.renderColorPicker(e)}},{key:"getColorPickerState",value:function(e){return{padding:this.options.padding,show:e,color:this.color,disableAlpha:this.options.disableAlpha,showTransparentPreset:this.options.showTransparentPreset,onChangeComplete:this.onChangeCompleteWrapper,onHide:this.onHideWrapper,attachTo:this.attachTo}}},{key:"setColor",value:function(e){this.color=e}},{key:"remove",value:function(){this.attachTo.removeEventListener("click",this.boundOnAttachElementClick),R().unmountComponentAtNode(this.colorPickerContainerWrapper),d()(this.colorPickerContainerWrapper).remove()}}])&&H(t.prototype,n),i&&H(t,i),e}(),B=n(38699),W=function(e){return e?e===B.Z.TRANSPARENT?e:"#".concat(e):B.Z.TRANSPARENT};const z=f().View.extend({constructor:function(e){this.i18n=e.i18n,f().View.prototype.constructor.call(this,e)},bindingHandlers:{radioDiv:{init:function(e,t,n,i){var o=e.data("model-attr");this.$el=e;this.callback=a().bind((function(t){n[o](e.data("value"))}),this),this.$el.on("click",this.callback)},set:function(e,t){var n=e.siblings("div[data-bind*='radioDiv']");e.data("value")===t&&(e.addClass("selected"),n.removeClass("selected"))},clean:function(){this.$el.off("click",this.callback)}},checkboxDiv:{init:function(e,t,n,i){var o=e.data("model-attr");this.$el=e,this.isTrippleState=!!this.$el.data("tripplestate");this.callback=a().bind((function(t){n[o](this._get(e))}),this),this.$el.on("click",this.callback)},set:function(e,t){!0===t?e.removeClass("unchanged").addClass("selected"):!1===t?e.removeClass("unchanged").removeClass("selected"):e.removeClass("selected").addClass("unchanged")},_get:function(e){return this.isTrippleState?!!e.is(".unchanged")||!e.is(".selected")&&null:!e.is(".selected")},clean:function(){this.$el.off("click",this.callback)}},resetColor:{el:{},onClick:function(e){},init:function(e,t,n){var i=e.data("model-attr");this.el=e.get(0),e.attr("disabled","disabled"),this.onClick=function(t){t.stopPropagation(),n[i](null),e.attr("disabled","disabled")},this.el.addEventListener("click",this.onClick)},set:function(e,t){t&&(e.removeAttr("disabled"),e.prop("checked",!0))},clean:function(){this.el.removeEventListener("click",this.onClick)}},colorpicker:{attachableColorPickerWrapper:{remove:function(){},setColor:function(e){}},init:function(e,t,n){var i=!!e.data("showTransparentInput"),o=e.data("model-attr");this.attachableColorPickerWrapper=new Z(e[0],{padding:{top:0,left:0},color:W(t),showTransparentPreset:i,onChangeComplete:function(e){n[o](function(e){var t=e.hex;return t===B.Z.TRANSPARENT?B.Z.TRANSPARENT:t.slice(1)}(e))}})},set:function(e,t){var n=W(t);t?e.removeClass("unchanged"):e.addClass("unchanged"),e.find("div.colorpick").css("background-color",n),this.attachableColorPickerWrapper.setColor(n)},clean:function(){this.attachableColorPickerWrapper.remove()}},dateTimePicker:y}});var Q=function(){this.map={},this.keyInfo={}};Q.prototype={get:function(e){return this.map[e]?this.map[e].current:null},set:function(e,t){this.map[e]?this.map[e].current=a().cloneDeep(t):this.map[e]={original:a().cloneDeep(t),current:a().cloneDeep(t)}},createKey:function(e,t,n){var i;return i=n?e+"-column-"+t.get("forColumns").join("_"):e+"-column-"+t.get("columnIndex"),this.keyInfo[i]||(this.keyInfo[i]={applyTo:e,model:t}),i},clear:function(){this.map={},this.keyInfo={}},remove:function(){}};const q=Q,G='<option value="{{- value}}">\n\n    <js-templateNonce></js-templateNonce>\n    {{- text}}</option>',J='{{ if (start) { }} <optgroup label="{{- label }}"> {{ } }}\n\n        <js-templateNonce></js-templateNonce>\n    <option value="{{- value }}">{{- text }}</option>\n{{ if (end) { }} </optgroup> {{ } }}',K=f().Model.extend({defaults:function(){return{columnLabel:void 0,backgroundColor:void 0,align:void 0,pattern:void 0,font:{bold:!1,italic:!1,underline:!1,size:9,name:void 0,color:"000000"}}},computeds:function(){var e={};return a().each(this.defaults().font,(function(t,n){e["font"+n.charAt(0).toUpperCase()+n.substring(1,n.length)]={deps:["font"],get:function(e){return e[n]},set:function(e){var t=a().extend({},this.get("font")),i=e;return"name"!==n||null==i||i.trim().length||(i=null),t[n]=i,{font:t}}}})),e},reset:function(){return this.clear({silent:!0}).set(this.defaults()),this},remove:function(){}});var X=n(72699);const Y=X.Z.extend({constructor:function(e,t){X.Z.call(this,e,t),a().bindAll(this,"_tryHide"),this.topPadding=t&&t.topPadding||5,this.leftPadding=t&&t.leftPadding||5,this.extraOffset=e.extraOffset||10,this.hideOnMouseLeave=t&&t.hideOnMouseLeave||!1,a().bindAll(this,"_tryHide","_checkBounds"),this.hideOnMouseLeave&&this.$el.on("mouseleave",this._tryHide)},_tryHide:function(){this.hide(),this._signOffTryHide()},_signOffTryHide:function(){d()(document.body).off("click.contextMenu",this._tryHide),d()(document.body).off("mousemove",this._checkBounds)},show:function(e,t){if(!e||!a().isNumber(e.top)||!a().isNumber(e.left))throw new Error("Required params (top, left) missing: "+JSON.stringify(e));d()(document.body).on("click.contextMenu",this._tryHide),this.hideOnMouseLeave&&d()(document.body).on("mousemove",this._checkBounds);var n=e.top,i=e.left,o=this.topPadding,s=this.leftPadding,r=d()("body"),l=this._calculateMenuHeightOnShow(),c=this.$el.width(),p=t?t.height():r.height(),u=t?t.width():r.width(),h=t?t.offset():r.offset(),m=p-e.top,v=u-e.left;return m<l&&((n=e.top-l-o)<h.top&&(n+=h.top-n+o),n=n<0?p/2-l/2:n),v<c&&((i=e.left-c-s)<h.left&&(i+=h.left-i+s),i=i<0?u/2-c/2:i),a().extend(this,{top:n,left:i}),this.$el.css({top:this.top,left:this.left}),X.Z.prototype.show.apply(this,arguments)},_checkBounds:function(e){var t={top:this.$el[0].offsetTop-this.extraOffset,bottom:this.$el[0].offsetTop+this.$el[0].offsetHeight+this.extraOffset,left:this.$el[0].offsetLeft-this.extraOffset,right:this.$el[0].offsetLeft+this.$el[0].offsetWidth+this.extraOffset};this._isPointerOutOfBounds(t,e)&&this._tryHide()},_isPointerOutOfBounds:function(e,t){return t.clientX<e.left||t.clientX>e.right||t.clientY<e.top||t.clientY>e.bottom},_calculateMenuHeightOnShow:function(){this.$el.css({opacity:0}),X.Z.prototype.show.apply(this,arguments);var e=this.$el.height();return this.hide(),this.$el.css({opacity:""}),e},remove:function(){this._signOffTryHide(),this.hideOnMouseLeave&&this.$el.off("mouseleave",this._tryHide),X.Z.prototype.remove.apply(this,arguments)}});var ee={numberPart:/([\d|#]+(?!,))/,decimalPart:/(\.[\d|#]+)/,numericChar:/[\d|#]/};function te(e){if(-1!=e.indexOf(".")){var t=ee.decimalPart.exec(e)[1];return e.replace(t,t+"0")}var n=ee.numberPart.exec(e)[1];return e.replace(n,n+".0")}function ne(e){var t=e;if(-1!=t.indexOf(".")){var n=ee.decimalPart.exec(t)[1];t=n.length>2?t.replace(n,n.substring(0,n.length-1)):t.replace(n,"")}return t}function ie(e){var t=e.indexOf(ee.numericChar.exec(e)),n=e.substring(0,t+1);return n+","+e.substring(n.length)}function oe(e){return e.replace(",","")}function ae(e){return e+" %"}function se(e){return e.substring(0,e.length-2)}const re={addRemoveDecimalPlace:function(e,t){var n=e.split(";")[0],i=e.split(";")[1];return t?(e=te(n),i&&(e=e+";"+te(i)),e):(e=ne(n),i&&(e=e+";"+ne(i)),e)},addRemoveThousandsSeparator:function(e,t){var n=e.indexOf(","),i=e.split(";")[0],o=e.split(";")[1];return t?-1==n&&(e=ie(i),o&&(e=e+";"+ie(o))):-1!=n&&(e=oe(i),o&&(e=e+";"+oe(o))),e},addRemovePercentage:function(e,t){var n=e.indexOf("%"),i=e.split(";")[0],o=e.split(";")[1];return t?-1==n&&(e=ae(i),o&&(e=e+";"+ae(o))):-1!=n&&(e=se(i),o&&(e=e+";"+se(o))),e},addRemovePercentageForNumber:function(e,t){var n=ee.numberPart.exec(e)[1];return t?-1==e.indexOf("%")&&-1==n.indexOf("00")&&(e=e.replace(n,n+"00"),e+=" %"):-1!=e.indexOf("%")&&-1!=n.indexOf("00")&&(e=(e=e.replace(n,n.substring(0,n.length-2))).substring(0,e.length-2)),e},addRemoveCurrencySymbol:function(e,t,n){var i=e.indexOf(n),o=e.split(";")[0],a=e.split(";")[1];return t?-1==i&&(e=n+" "+o,a&&(e=e+";"+n+" "+a)):-1!=i&&(e=o.substring(2),a&&(e=e+";"+a.substring(2))),e},jivePatternToSchemaPattern:function(e,t){var n;if("numeric"===t&&"[h]:mm:ss"===e)n=e;else if("numeric"===t){var i=e,o=new RegExp("0\\.(0+)"),a=!1,s=!1,r=0,l="-###0",c=null;i.indexOf(",")>-1&&(a=!0,i=i.replace(/,/g,"")),i.indexOf("%")>-1&&(s=!0,i=i.replace(/%/g,"")),i.indexOf("¤")>-1?(c="LOCALE_SPECIFIC",i=i.replace(/\u00A4/g,"")):i.indexOf("$")>-1?(c="USD",i=i.replace(/\u0024/g,"")):i.indexOf("£")>-1?(c="GBP",i=i.replace(/\u00A3/g,"")):i.indexOf("€")>-1?(c="EUR",i=i.replace(/\u20AC/g,"")):i.indexOf("¥")>-1&&(c="YEN",i=i.replace(/\u00A5/g,"")),i=i.replace(/\s/g,"");var d=o.exec(i);d&&2==d.length&&(r=d[1].length,i=i.replace(new RegExp("\\."+Array(r+1).join("0"),"g"),""));var p=i.split(";");p&&2===p.length&&(l=p[1]),n={negativeFormat:l,currency:c,precision:r,grouping:a,percentage:s}}else n=e;return n}};var le={LOCALE_SPECIFIC:"¤",USD:"$",GBP:"£",EUR:"€",YEN:"¥"};function ce(){var e,t,n,i=this.viewModel,o=this.cache,a=i.get("applyTo"),s=i.previous("applyTo"),r=this.columnComponentModel;null!=a&&(s&&(e="heading"===s||"detailrows"===s?o.createKey(s,r):o.createKey(s,r.parent.columnGroups.findWhere({id:s}),!0),o.set(e,this.model.toJSON())),"heading"===a?(e=o.createKey(a,r),null===o.get(e)&&((n=r.headingFormat.toJSON()).columnLabel=r.get("columnLabel"),o.set(e,n)),this.viewModel.set("dataType","text")):"detailrows"===a?(e=o.createKey(a,r),null===o.get(e)&&((n=r.detailsRowFormat.toJSON()).pattern=r.detailsRowFormat.toJiveFormat(),o.set(e,n)),this.viewModel.set("dataType",r.get("dataType").toLowerCase())):(t=r.parent.columnGroups.findWhere({id:a}),e=o.createKey(a,t,!0),null===o.get(e)&&((n=t.format.toJSON()).pattern=t.format.toJiveFormat(),o.set(e,n)),this.viewModel.set("dataType",t.get("dataType").toLowerCase())),this.model.reset().set(o.get(e)))}function de(){var e=this.columnComponentModel,t=this.viewModel.defaults(),n=this.viewModel.get("dataType");e&&(this.viewModel.set("patterns",e.parent.config.genericProperties.patterns[n]||[]),this.viewModel.set("hasPercentage",t.hasPercentage),this.viewModel.set("hasComma",t.hasComma),this.viewModel.set("currencySymbol",t.currencySymbol))}function pe(){var e=this,t=this.columnComponentModel,n=t.get("columnIndex"),i=t.parent.columnGroups,o=[],s=[],r=[],l=[];t.get("canFormatHeading")&&o.push({value:"heading",label:this.i18n["net.sf.jasperreports.components.headertoolbar.applyto.option.headings"]}),i.each((function(t){-1!=a().indexOf(t.get("forColumns"),n)&&("groupheading"===t.get("groupType")?s.push({value:t.get("id"),label:t.get("groupName")+" "+e.i18n["net.sf.jasperreports.components.headertoolbar.groupheading.prefix"]}):"groupsubtotal"===t.get("groupType")?r.push({value:t.get("id"),label:t.get("groupName")+" "+e.i18n["net.sf.jasperreports.components.headertoolbar.groupsubtotal.prefix"]}):"tabletotal"===t.get("groupType")&&l.push({value:t.get("id"),label:e.i18n["net.sf.jasperreports.components.headertoolbar.applyto.option.tabletotal"]}))})),o.push.apply(o,s),o.push({value:"detailrows",label:this.i18n["net.sf.jasperreports.components.headertoolbar.applyto.option.detailrows"]}),o.push.apply(o,r),o.push.apply(o,l),this.viewModel.set("applyToOptions",o);var c=this.viewModel.previous("applyTo");c?(this.viewModel.set("applyTo",null,{silent:!0}),a().findWhere(o,{value:c})?this.viewModel.set("applyTo",c):this.viewModel.set("applyTo","heading"===o[0].value?"heading":"detailrows")):this.viewModel.set("applyTo","heading"===o[0].value?"heading":"detailrows")}function ue(){var e,t=this.viewModel.get("applyTo");e="heading"===t||"detailrows"===t?this.cache.createKey(t,this.columnComponentModel):this.cache.createKey(t,this.columnComponentModel.parent.columnGroups.findWhere({id:t}),!0),this.cache.set(e,this.model.toJSON())}var he=f().Model.extend({defaults:function(){return{dataType:"text",fontSizes:[],fontNames:[],patterns:[],applyToOptions:[],applyTo:null,hasPercentage:!1,hasComma:!1,currencySymbol:"LOCALE_SPECIFIC"}},computeds:{hasPattern:function(){var e=this.get("dataType");return"numeric"===e||"date"===e||"time"===e},hasHeading:function(){return"heading"===this.get("applyTo")}},reset:function(){return this.clear({silent:!0}).set(this.defaults()),this},remove:function(){}});const me=z.extend({events:{"click .jive_inputbutton[name='increaseDecimalsBtn']":"_addDecimal","click .jive_inputbutton[name='decreaseDecimalsBtn']":"_removeDecimal","click .jive_inputbutton[name='currencyBtn']":"_showCurrencyMenu"},el:function(){return a().template('<div class="applytoWrapper">\n\n    <js-templateNonce></js-templateNonce>\n    <div class="applytoTitle"><span>{{- i18n["net.sf.jasperreports.components.headertoolbar.label.applyto"] }}:</span></div>\n    <div class="applytoSelector">\n        <select data-bind="options:applyToOptions,value:applyTo">\n        </select>\n    </div>\n</div>\n<form class="jive_form_basicFormat jive_form" style="width: 700px; display: block;">\n    <table width="100%" data-bind="toggle:hasHeading">\n        <tbody>\n            <tr>\n                <td colspan="4">\n                    <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.headingtext"] }}:</div>\n                    <div class="wrapper">\n                        <input type="text" data-bind="value:columnLabel">\n                    </div>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    <table width="100%">\n        <tbody>\n        <tr>\n            <td rowspan="2">\n                <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.fontname"] }}:</div>\n                <div class="wrapper">\n                    <input type="text" class="jive_listTextInput" data-bind="value:fontName">\n                    <select class="showList wFreeText" size="6" data-bind="groupedOptions:fontNames,value:fontName">\n                    </select>\n                </div>\n            </td>\n            <td rowspan="2">\n                <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.fontsize"] }}:</div>\n                <div class="wrapper">\n                    <input type="text" class="jive_listTextInput" data-bind="value:customDecimal(fontSize)">\n                    <select class="showList wFreeText" size="6" data-bind="nonGroupedOptions:fontSizes,value:customDecimal(fontSize)">\n                    </select>\n                </div>\n            </td>\n            <td>\n                <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.style"] }}:</div>\n                <div class="wrapper">\n                    <div class="buttonbar">\n                        <div class="jive_inputbutton" data-bind="checkboxDiv:fontBold" data-model-attr="fontBold"><span class="jive_bIcon boldIcon"></span></div>\n                        <div class="jive_inputbutton" data-bind="checkboxDiv:fontItalic" data-model-attr="fontItalic"><span class="jive_bIcon italicIcon"></span></div>\n                        <div class="jive_inputbutton" data-bind="checkboxDiv:fontUnderline" data-model-attr="fontUnderline"><span class="jive_bIcon underlineIcon"></span></div>\n                    </div>\n                </div>\n            </td>\n            <td>\n                <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.color"] }}:</div>\n                <div class="wrapper">\n                    <div class="buttonbar">\n                        <div class="jive_inputbutton  drop" data-bind="colorpicker:backgroundColor" data-model-attr="backgroundColor" data-label="{{- i18n["net.sf.jasperreports.components.headertoolbar.title.fontbackcolor"] }}" data-show-transparent-input="true">\n                            <div class="colorpick wide"></div>\n                            <span class="jive_bIcon backgroundColorIcon"></span>\n                        </div>\n                        <div class="jive_inputbutton  drop" data-bind="colorpicker:fontColor" data-model-attr="fontColor" data-label="{{- i18n["net.sf.jasperreports.components.headertoolbar.title.fontcolor"] }}">\n                            <div class="colorpick normal"></div>\n                            <span class="jive_bIcon fontColorIcon"></span>\n                        </div>\n                    </div>\n                </div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.alignment"] }}:</div>\n                <div class="wrapper">\n                    <div class="buttonbar">\n                        <div class="jive_inputbutton" data-bind="radioDiv:align" data-model-attr="align" data-value="left"><span class="jive_bIcon leftIcon"></span></div>\n                        <div class="jive_inputbutton" data-bind="radioDiv:align" data-model-attr="align" data-value="center"><span class="jive_bIcon centerIcon"></span></div>\n                        <div class="jive_inputbutton" data-bind="radioDiv:align" data-model-attr="align" data-value="right"><span class="jive_bIcon rightIcon"></span></div>\n                    </div>\n                </div>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n    <table width="100%" data-bind="toggle:hasPattern">\n        <tbody>\n        <tr>\n            <td colspan="2" rowspan="2">\n                <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.formatpattern"] }}:</div>\n                <div class="wrapper">\n                    <input type="text" class="jive_listTextInput" data-bind="value:pattern,disabled:isDuration">\n                    <select class="showList wFreeText" size="4" data-bind="transformedPatterns:patterns,value:pattern">\n                    </select>\n                </div>\n            </td>\n            <td data-bind="css:{visibility:getNumericTypeVisibility}">\n                <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.numberformat"] }}:</div>\n                <div class="wrapper">\n                    <div class="buttonbar">\n                        <div class="jive_inputbutton" name="percentageBtn" data-bind="checkboxDiv:hasPercentage" data-model-attr="hasPercentage"><span class="jive_bIcon percentageIcon"></span></div>\n                        <div class="jive_inputbutton" name="commaBtn" data-bind="checkboxDiv:hasComma" data-model-attr="hasComma"><span class="jive_bIcon commaIcon"></span></div>\n                        <div class="jive_inputbutton" name="increaseDecimalsBtn"><span class="jive_bIcon increaseDecimalsIcon"></span></div>\n                        <div class="jive_inputbutton" name="decreaseDecimalsBtn"><span class="jive_bIcon decreaseDecimalsIcon"></span></div>\n                    </div>\n                </div>\n            </td>\n        </tr>\n        <tr data-bind="css:{visibility:getNumericTypeVisibility}">\n            <td>\n                <div class="wrapper label">{{- i18n["net.sf.jasperreports.components.headertoolbar.label.currency"] }}:</div>\n                <div class="wrapper">\n                    <div class="buttonbar">\n                        <div class="jive_inputbutton  drop" name="currencyBtn">\n                            <span class="jive_bIcon currencyIcon"></span>\n                        </div>\n                    </div>\n                </div>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n</form>',{i18n:this.i18n})},initialize:function(){this.model=new K,this.viewModel=new he,this.cache=new q,this.listenTo(this.viewModel,"change:applyTo",a().bind(ce,this)),this.listenTo(this.viewModel,"change:hasPercentage",this._togglePercentageFormat),this.listenTo(this.viewModel,"change:hasComma",this._toggleCommaFormat),this.listenTo(this.viewModel,"change:dataType",a().bind(de,this)),this.on("tabSwitched",(function(){ue.call(this)})),f().View.prototype.initialize.apply(this,arguments),this._initCurrencyContextMenu()},bindingHandlers:a().extend({transformedPatterns:function(e,t){var n="";a().each(t,(function(e){n+=a().template(G,{value:e.key,text:e.val})})),e.html(n)},groupedOptions:function(e,t){var n=this,i="";t.extension&&a().each(t.extension,(function(e,t,o){i+=a().template(J,{start:0===t,end:t==o.length-1,label:n.view.i18n["net.sf.jasperreports.components.headertoolbar.label.extfonts"],value:e,text:e})})),t.system&&a().each(t.system,(function(e,t,o){i+=a().template(J,{start:0===t,end:t==o.length-1,label:n.view.i18n["net.sf.jasperreports.components.headertoolbar.label.sysfonts"],value:e,text:e})})),e.html(i)},nonGroupedOptions:function(e,t){var n="";t&&a().each(t,(function(e,t,i){n+=a().template(G,{value:e,text:e})})),e.html(n)}},z.prototype.bindingHandlers),bindingFilters:{customDecimal:{get:function(e){var t=parseFloat(e);return a().isNaN(t)?null:t},set:function(e){var t=parseFloat(e);return a().isNaN(t)?null:t}}},computeds:{isDuration:function(){return M.Z.DURATION_PATTERN===this.getBinding("pattern")},getNumericTypeVisibility:function(){var e="numeric"===this.getBinding("dataType"),t=M.Z.DURATION_PATTERN===this.getBinding("pattern");return e&&!t?"visible":"hidden"}},setColumnComponentModel:function(e,t){var n=this.viewModel;t?ue.call(this):(this.cache.clear(),n.reset(),n.set("fontSizes",e.parent.config.genericProperties.fontSizes),n.set("fontNames",e.parent.config.genericProperties.fonts)),this.columnComponentModel=e,pe.call(this),this.removeBindings(),this.applyBindings()},getActions:function(){var e,t=this.cache,n=[];return ue.call(this),a().each(t.map,(function(i,o){var a,s=new(u().Model)(i.original);s.set(i.current),s.hasChanged()&&("heading"===(a=t.keyInfo[o]).applyTo?(a.model.updateFromReportComponentObject({label:i.current.columnLabel,headingFormat:i.current}),n.push(a.model.actions["change:headingFormat"].call(a.model))):"detailrows"===a.applyTo?((e=i.current).pattern=re.jivePatternToSchemaPattern(e.pattern,a.model.get("dataType").toLowerCase()),a.model.updateFromReportComponentObject({detailsRowFormat:e}),n.push(a.model.actions["change:detailsRowFormat"].call(a.model))):((e=i.current).pattern=re.jivePatternToSchemaPattern(e.pattern,a.model.get("dataType").toLowerCase()),a.model.updateFromReportComponentObject({format:e}),n.push(a.model.actions["change:format"].call(a.model))))})),n},_initCurrencyContextMenu:function(){var e=this,t=[{label:this.i18n["net.sf.jasperreports.components.headertoolbar.label.currency.none"],action:"none",symbol:null},{label:this.i18n["net.sf.jasperreports.components.headertoolbar.label.localespecific"],action:"localeSpecific",symbol:"LOCALE_SPECIFIC"},{label:le.USD+" - USD",action:"usd",symbol:"USD"},{label:le.EUR+" - EUR",action:"eur",symbol:"EUR"},{label:le.GBP+" - GBP",action:"gbp",symbol:"GBP"},{label:le.YEN+" - YEN",action:"yen",symbol:"YEN"}];this.currencyMenu=new Y(t,{menuContainerTemplate:'<div class="jive_dropdown_menu" style="width: 150px; height: 100px; display: none">\n\n    <js-templateNonce></js-templateNonce>\n    <div class="content">\n        <ul class="pmenu"></ul>\n    </div>\n</div>',menuOptionTemplate:'<li class="pmenuitem">\n\n    <js-templateNonce></js-templateNonce>\n    {{- label }}</li>'}),a().each(t,(function(t){e.listenTo(e.currencyMenu,"option:"+t.action,e._applyCurrencyFormat)}))},_togglePercentageFormat:function(e){var t=this.getBinding("patterns"),n=this.getBinding("hasPercentage"),i=[];t.length&&(a().each(t,(function(e){M.Z.DURATION_PATTERN===e.key?i.push({key:e.key,val:e.val}):i.push({key:re.addRemovePercentage(e.key,n),val:re.addRemovePercentageForNumber(e.val,n)})})),this.setBinding("patterns",i))},_toggleCommaFormat:function(e){var t=this.getBinding("patterns"),n=this.getBinding("hasComma"),i=[];t.length&&(a().each(t,(function(e){M.Z.DURATION_PATTERN===e.key?i.push({key:e.key,val:e.val}):i.push({key:re.addRemoveThousandsSeparator(e.key,n),val:re.addRemoveThousandsSeparator(e.val,n)})})),this.setBinding("patterns",i))},_addDecimal:function(e){var t=this.getBinding("patterns"),n=[];t.length&&(a().each(t,(function(e){M.Z.DURATION_PATTERN===e.key?n.push({key:e.key,val:e.val}):n.push({key:re.addRemoveDecimalPlace(e.key,!0),val:re.addRemoveDecimalPlace(e.val,!0)})})),this.setBinding("patterns",n))},_removeDecimal:function(e){var t=this.getBinding("patterns"),n=[];t.length&&(a().each(t,(function(e){M.Z.DURATION_PATTERN===e.key?n.push({key:e.key,val:e.val}):n.push({key:re.addRemoveDecimalPlace(e.key,!1),val:re.addRemoveDecimalPlace(e.val,!1)})})),this.setBinding("patterns",n))},_applyCurrencyFormat:function(e,t){var n=this.getBinding("currencySymbol"),i=t.get("symbol"),o=this.getBinding("patterns"),s=[];o.length&&(a().each(o,(function(e){M.Z.DURATION_PATTERN===e.key?s.push({key:e.key,val:e.val}):(n&&(e.key=re.addRemoveCurrencySymbol(e.key,!1,le[n]),e.val=re.addRemoveCurrencySymbol(e.val,!1,le[n])),i?s.push({key:re.addRemoveCurrencySymbol(e.key,!0,le[i]),val:re.addRemoveCurrencySymbol(e.val,!0,le[i])}):n&&s.push(e))})),s.length&&(this.setBinding("patterns",[]),this.setBinding("patterns",s))),this.setBinding("currencySymbol",i)},_showCurrencyMenu:function(e){var t=this.$(e.currentTarget),n=t.offset();e.preventDefault(),e.stopPropagation(),this.currencyMenu.show({top:n.top+t.height(),left:n.left})},clear:function(){this.cache.clear()},remove:function(){f().View.prototype.remove.apply(this,arguments),this.model&&this.model.remove(),this.cache&&this.cache.remove(),this.viewModel&&this.viewModel.remove(),this.currencyMenu&&this.currencyMenu.remove()}});var ve=n(84612);const fe=m.Z.extend({contentTemplate:a().template("<p class='alertText'>\n\n    <js-templateNonce></js-templateNonce>\n    {{- message }}\n</p>"),constructor:function(e){e||(e={}),m.Z.prototype.constructor.call(this,{modal:!1!==e.modal,message:e.message,additionalCssClasses:"alertDialog "+(e.additionalCssClasses||""),title:e.title||N.Z["dialog.exception.title"],id:e.id,titleContainerId:e.titleContainerId,bodyContainerId:e.bodyContainerId,buttons:[{label:N.Z["button.close"],action:"close",primary:!0}]},e)},initialize:function(e){m.Z.prototype.initialize.apply(this,arguments),this.on("button:close",this.close),this.setMessage(e.message)},setMessage:function(e){e=ve.Z.softHtmlEscape(e,{whiteList:["br"]}),this.content=this.contentTemplate({message:e});var t=this.renderContent();this.$contentContainer.html(t)}});var be=new(n(92772).Z);function ge(){var e,t,n=this.get("value"),i=this.get("operator");e=i&&-1!=i.toLowerCase().indexOf("between"),t=i&&-1!==i.toLowerCase().indexOf("null"),!0===e?a().isArray(n)||this.set({value:[n]},{silent:!0}):!1===e&&a().isArray(n)&&this.set({value:n[0]},{silent:!0}),t&&this.set({value:""})}function Te(e,t,n,i,o){var s,r,l;if(null==i)s="No value supplied!";else if("datetime"===e)try{void 0===M.Z.jQueryUiTimestampToIsoTimestamp(i,n)&&(s="Unparsable date: "+i+" !")}catch(e){s=e}else if("time"===e)try{void 0===M.Z.jQueryUiTimeToIsoTime(i,n)&&(s="Unparsable time: "+i+" !")}catch(e){s=e}else"numeric"===e&&M.Z.DURATION_PATTERN===t&&((r=a().trim(i)).length>0?((l=r.split(":")).length>3||void 0===be.parseNumber(l[0])||l.length>1&&(void 0===be.parseNumber(l[1])||be.parseNumber(l[1])>59)||l.length>2&&(void 0===be.parseNumber(l[2])||be.parseNumber(l[2])>59))&&(s="Unparsable duration: "+i+" !"):s="Empty value supplied!");return this.trigger("validate:"+o,this,o,s),s}const ye=f().Model.extend({defaults:function(){return{operator:null,value:null,backgroundColor:null,font:{bold:null,italic:null,underline:null,color:null}}},computeds:function(){var e={};return a().each(this.defaults().font,(function(t,n){e["font"+n.charAt(0).toUpperCase()+n.substring(1,n.length)]={deps:["font"],get:function(e){return e[n]},set:function(e){return this.modifyObject("font",n,e),e}}})),e.isMultiValueOperator=function(){var e=this.get("operator");return!(!e||-1==e.toLowerCase().indexOf("between"))},e.isNotNullCheckOperator=function(){var e=this.get("operator");return!!(!e||-1===e.toLowerCase().indexOf("null"))},e},initialize:function(){this.on("change:operator",a().bind(ge,this)),f().Model.prototype.initialize.apply(this,arguments)},reset:function(){return this.set(this.defaults(),{silent:!0}),this},validate:function(e,t){var n,i,o=e.value,s=e.operator,r=M.Z.dataTypeToSchemaFormat[this.collection.dataType],l=this.collection.conditionPattern,c=this.collection.genericProperties;if("IS_NULL"!==s&&"IS_NOT_NULL"!==s)if("IS_TRUE"!==s&&"IS_NOT_FALSE"!==s&&"IS_NOT_TRUE"!==s&&"IS_FALSE"!==s||(o="true/false"),null==o&&this.get("isMultiValueOperator")&&(o=[null,null]),a().isArray(o)){if(n=Te.call(this,r,l,c,o[0],"valueStart"),i=Te.call(this,r,l,c,o[1],"valueEnd"),n||i)return"Invalid value supplied!"}else if(Te.call(this,r,l,c,o,"valueStart"))return"Invalid value supplied!"},remove:function(){}});var _e=f().Model.extend({defaults:{conditionIndex:1,conditionOptions:[],dataType:"text",calendarPatterns:{}},computeds:{isNotBooleanType:function(){return"boolean"!==this.get("dataType")}},remove:function(){}});const Ce=z.extend({events:{"click div.jive_inputbutton[name='conditionRemove']":"_removeCondition","click div.jive_inputbutton[name='conditionMoveUp']":"_moveConditionUp","click div.jive_inputbutton[name='conditionMoveDown']":"_moveConditionDown"},el:function(){return a().template('<tr class="jive_condition">\n\n    <js-templateNonce></js-templateNonce>\n    <td class="jive_textLabel">\n        <span data-bind="text:conditionIndex"></span>\n    </td>\n    <td>\n        <div>\n            <select data-bind="options:convertedOptions,value:operator"></select>\n        </div>\n    </td>\n    <td data-bind="toggle:isNotBooleanType,attr:{colspan:getColspan},classes:{condition_between_start:isMultiValueOperator}">\n        <div class="t_wrap">\n            <input type="text" data-bind="toggle:all(isNotBooleanType,isNotNullCheckOperator),value:conditionValueStart,dateTimePicker:dataType,validationErrorClass:conditionValueStart" data-model-attr="valueStart">\n        </div>\n    </td>\n    <td class="condition_between_start" data-bind="toggle:isMultiValueOperator">\n        <div class="t_wrap"><span>and</span></div>\n    </td>\n    <td class="condition_between_end" data-bind="toggle:isMultiValueOperator">\n        <div class="t_wrap">\n            <input type="text" data-bind="value:conditionValueEnd,dateTimePicker:dataType,validationErrorClass:conditionValueEnd" data-model-attr="valueEnd">\n        </div>\n    </td>\n    <td>\n        <div>\n            <div class="buttonbar">\n                <div class="jive_inputbutton" data-bind="checkboxDiv:fontBold" data-model-attr="fontBold" data-tripplestate="true">\n                    <span class="jive_bIcon boldIcon"></span>\n                </div>\n                <div class="jive_inputbutton" data-bind="checkboxDiv:fontItalic" data-model-attr="fontItalic" data-tripplestate="true">\n                    <span class="jive_bIcon italicIcon"></span>\n                </div>\n                <div class="jive_inputbutton" data-bind="checkboxDiv:fontUnderline" data-model-attr="fontUnderline" data-tripplestate="true">\n                    <span class="jive_bIcon underlineIcon"></span>\n                </div>\n                <div class="jive_inputbutton toggle drop" data-bind="colorpicker:backgroundColor" data-model-attr="backgroundColor" data-label="{{- i18n["net.sf.jasperreports.components.headertoolbar.title.fontbackcolor"] }}" data-show-transparent-input="true" data-show-none-input="true">\n                    <input data-bind="resetColor:backgroundColor" data-model-attr="backgroundColor" type="checkbox">\n                    <div class="colorpick wide"></div>\n                    <span class="jive_bIcon backgroundColorIcon"></span>\n                </div>\n                <div class="jive_inputbutton toggle drop" data-bind="colorpicker:fontColor" data-model-attr="fontColor" data-label="{{- i18n["net.sf.jasperreports.components.headertoolbar.title.fontcolor"] }}" data-show-none-input="true">\n                    <input data-bind="resetColor:fontColor" data-model-attr="fontColor" type="checkbox">\n                    <div class="colorpick normal"></div>\n                    <span class="jive_bIcon fontColorIcon"></span>\n                </div>\n            </div>\n        </div>\n    </td>\n    <td>\n        <div>\n            <div class="buttonbar">\n                <div class="jive_inputbutton  plain" name="conditionMoveUp">\n                    <span class="jive_bIcon moveUpIcon"></span>\n                </div>\n                <div class="jive_inputbutton  plain" name="conditionMoveDown">\n                    <span class="jive_bIcon moveDownIcon"></span>\n                </div>\n            </div>\n        </div>\n    </td>\n    <td class=" last">\n        <div class="jive_inputbutton  plain" name="conditionRemove">\n            <span class="jive_bIcon deleteIcon"></span>\n        </div>\n    </td>\n</tr>',{i18n:this.i18n})},initialize:function(){this.model=new ye,this.viewModel=new _e,f().View.prototype.initialize.apply(this,arguments)},computeds:{convertedOptions:{deps:["conditionOptions","dataType"],get:function(e,t){return function(e,t){var n=[];return a().each(t,(function(t){n.push({label:s.Z[C(e,t)],value:t})})),n}(t,e)}},conditionValueStart:{deps:["value"],get:function(e){return a().isArray(e)?e[0]:e},set:function(e){var t=this.getBinding("value");a().isArray(t)?(t[0]=e,this.model.set({value:t},{validate:!0})):this.model.set({value:e},{validate:!0})}},conditionValueEnd:{deps:["value"],get:function(e){if(a().isArray(e))return e[1]},set:function(e){var t=this.getBinding("value");a().isArray(t)&&(t[1]=e,this.model.set({value:t},{validate:!0}))}},getColspan:function(){return this.getBinding("isMultiValueOperator")?1:3}},_removeCondition:function(e){this.model.trigger("destroy",this.model,this.model.collection)},_moveConditionUp:function(e){var t=this.model.collection,n=t.indexOf(this.model);n>0&&(t.remove(this.model,{silent:!0}),t.add(this.model,{at:n-1},{silent:!0}),this.parent.render())},_moveConditionDown:function(e){var t=this.model.collection,n=t.indexOf(this.model);n<t.length-1&&(t.remove(this.model,{silent:!0}),t.add(this.model,{at:n+1},{silent:!0}),this.parent.render())},remove:function(){f().View.prototype.remove.apply(this,arguments),this.model&&this.model.remove(),this.viewModel&&this.viewModel.remove()}});function we(e,t,n){var i,o,a,s=this.cache,r=t,l=e.previous("applyTo"),c=this.columnComponentModel;null==r||n.isReset||(this.validate()?(l&&(i="detailrows"===l?s.createKey(l,c):s.createKey(l,c.parent.columnGroups.findWhere({id:l}),!0),s.set(i,this.collection.toJSON())),"detailrows"===r?(i=s.createKey(r,c),null===s.get(i)&&s.set(i,je.call(this,c.conditions.toJSON(),c.get("dataType")))):(a=c.parent.columnGroups.findWhere({id:r}),i=s.createKey(r,a,!0),null===s.get(i)&&s.set(i,je.call(this,a.conditions.toJSON(),a.get("dataType")))),o=s.keyInfo[i].model,this.collection.conditionPattern=o.get("conditionalFormattingData").conditionPattern,this.collection.dataType=o.get("dataType"),this.addAll(s.get(i))):e.set({applyTo:l},{isReset:!0}))}function Oe(){var e=this,t=this.columnComponentModel,n=t.get("columnIndex"),i=t.parent.columnGroups,o=[],s=[],r=[],l=[];i.each((function(t){-1!=a().indexOf(t.get("forColumns"),n)&&null!==t.get("conditionalFormattingData")&&("groupheading"===t.get("groupType")?s.push({value:t.get("id"),label:t.get("groupName")+" "+e.i18n["net.sf.jasperreports.components.headertoolbar.groupheading.prefix"]}):"groupsubtotal"===t.get("groupType")?r.push({value:t.get("id"),label:t.get("groupName")+" "+e.i18n["net.sf.jasperreports.components.headertoolbar.groupsubtotal.prefix"]}):"tabletotal"===t.get("groupType")&&l.push({value:t.get("id"),label:e.i18n["net.sf.jasperreports.components.headertoolbar.applyto.option.tabletotal"]}))})),o.push.apply(o,s),t.get("canFormatConditionally")&&o.push({value:"detailrows",label:this.i18n["net.sf.jasperreports.components.headertoolbar.applyto.option.detailrows"]}),o.push.apply(o,r),o.push.apply(o,l),this.viewModel.set("applyToOptions",o);var c=this.viewModel.previous("applyTo");c?(this.viewModel.set("applyTo",null,{silent:!0}),a().findWhere(o,{value:c})?this.viewModel.set("applyTo",c):this.viewModel.set("applyTo","detailrows")):this.viewModel.set("applyTo","detailrows"),o.length?this.viewModel.set("canAddCondition",!0):this.viewModel.set("canAddCondition",!1)}function Me(){var e,t=this.viewModel.get("applyTo");"detailrows"===t?e=this.cache.createKey(t,this.columnComponentModel):t&&(e=this.cache.createKey(t,this.columnComponentModel.parent.columnGroups.findWhere({id:t}),!0)),e&&this.cache.set(e,this.collection.toJSON())}function je(e,t){var n,i=this,o=M.Z.dataTypeToSchemaFormat[t];return a().map(e,(function(e){var t={};return e.operator&&(t.operator=M.Z.schemaFormatOperatorToFilterOperator(e.operator,e.value,o),n=i.columnComponentModel.parent.config.genericProperties,"datetime"===o?a().isArray(e.value)?(t.value=[],t.value[0]=M.Z.isoTimestampTojQueryUiTimestamp(e.value[0],n),t.value[1]=M.Z.isoTimestampTojQueryUiTimestamp(e.value[1],n)):t.value=M.Z.isoTimestampTojQueryUiTimestamp(e.value,n):"time"===o?a().isArray(e.value)?(t.value=[],t.value[0]=M.Z.isoTimeTojQueryUiTime(e.value[0],n),t.value[1]=M.Z.isoTimeTojQueryUiTime(e.value[1],n)):t.value=M.Z.isoTimeTojQueryUiTime(e.value,n):t.value=e.value),a().extend(e,t)}))}function ke(e,t,n){var i,o=this;return e.map((function(e){if(e.operator){var s=a().isArray(e.value)?e.value[0]:e.value,r=a().isArray(e.value)?e.value[1]:void 0;i=M.Z.operatorAndValueToSchemaFormat.call(o.columnComponentModel,e.operator,M.Z.dataTypeToSchemaFormat[t],s,r,n)}return a().extend(e,i)}))}var Ne=u().Collection.extend({model:ye}),Se=f().Model.extend({defaults:function(){return{dataType:"text",applyToOptions:[],applyTo:null,canAddCondition:!0}},computeds:{isNotBooleanType:function(){return"boolean"!==this.get("dataType")}},reset:function(){return this.clear({silent:!0}).set(this.defaults()),this},remove:function(){}});const xe=f().View.extend({events:{"click .jive_inputbutton[name='conditionAdd']":"addNewCondition"},el:function(){return a().template('<div class="applytoWrapper">\n\n    <js-templateNonce></js-templateNonce>\n    <div class="applytoTitle"><span>{{- i18n["net.sf.jasperreports.components.headertoolbar.label.applyto"] }}:</span></div>\n    <div class="applytoSelector">\n        <select data-bind="options:applyToOptions,value:applyTo,enabled:canAddCondition">\n        </select>\n    </div>\n</div>\n<form class="jive_form jive_form_conditionalFormat" style="width: 900px;">\n    <table width="100%">\n        <tbody>\n        <tr>\n            <td class="jive_textLabel">\n                <div class="wrapper label" style="text-align: left;">{{- i18n["net.sf.jasperreports.components.headertoolbar.conditions.list"] }}</div>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n    <table width="100%" class="conditionList">\n        <thead>\n            <tr>\n                <th class="jive_textLabel" style="width: 3%;">\n                    <div style="text-align: center;">#</div>\n                </th>\n                <th class="jive_textLabel" style="width: 26%;">\n                    <div style="text-align: center;">{{- i18n["net.sf.jasperreports.components.headertoolbar.condition.operator"] }}</div>\n                </th>\n                <th class="jive_textLabel" style="width: 30%;" colspan="3" data-bind="toggle:isNotBooleanType">\n                    <div style="text-align: center;">{{- i18n["net.sf.jasperreports.components.headertoolbar.condition.condition"] }}</div>\n                </th>\n                <th class="jive_textLabel" style="width: 26%;">\n                    <div style="text-align: center;">{{- i18n["net.sf.jasperreports.components.headertoolbar.condition.format"] }}</div>\n                </th>\n                <th class="jive_textLabel" style="width: 10%;">\n                    <div style="text-align: center;"></div>\n                </th>\n                <th class="jive_textLabel last" style="width: 5%;">\n                    <div style="text-align: center;"></div>\n                </th>\n            </tr>\n        </thead>\n        <tbody>\n        </tbody>\n        <tfoot>\n            <tr class="add">\n                <td class="jive_textLabel">\n                    <div></div>\n                </td>\n                <td>\n                    <div class="jive_inputbutton plain" name="conditionAdd" data-bind="classes:{disabled:not(canAddCondition)}">{{- i18n["net.sf.jasperreports.components.headertoolbar.condition.add"] }}</div>\n                </td>\n                <td class="jive_textLabel" colspan="3" data-bind="toggle:isNotBooleanType"></td>\n                <td class="jive_textLabel"></td>\n                <td class="jive_textLabel"></td>\n                <td class="jive_textLabel last"></td>\n            </tr>\n        </tfoot>\n    </table>\n</form>',{i18n:s.Z})},constructor:function(e){this.i18n=e.i18n,f().View.apply(this,arguments)},initialize:function(){this.viewModel=new Se,this.collection=new Ne,this.cache=new q,this._subviews=[],this._$subviewsContainer=this.$("table.conditionList > tbody"),this.listenTo(this.viewModel,"change:applyTo",a().bind(we,this)),this.listenTo(this.collection,"remove",this.removeSubview),this.on("tabSwitched",(function(){Me.call(this)})),this.errorDialog=new fe({additionalCssClasses:"jive_dialog"}),f().View.prototype.initialize.apply(this,arguments)},addSubview:function(e){var t=new Ce(a().extend({},{i18n:this.i18n,model:e,genericProperties:this.columnComponentModel.parent.config.genericProperties}));return this._$subviewsContainer.append(t.render().$el),this._subviews.push(t),t},addModel:function(e,t){var n,i,o=new Ce({i18n:this.i18n,genericProperties:this.columnComponentModel.parent.config.genericProperties}),a=this.viewModel.get("applyTo");o.parent=this;var s=n="detailrows"===a?this.columnComponentModel.get("dataType").toLowerCase():this.columnComponentModel.parent.columnGroups.findWhere({id:a}).get("dataType").toLowerCase();return"date"!==s&&"time"!==s||(s="dateTime"),o.viewModel.set({conditionOptions:this.columnComponentModel.parent.config.genericProperties.operators[s],dataType:n,calendarPatterns:this.columnComponentModel.parent.config.genericProperties.calendarPatterns}),o.model.set(e),this._$subviewsContainer.append(o.render().$el),this._subviews.push(o),t||(i=this.collection.add(o.model),o.viewModel.set("conditionIndex",this.collection.indexOf(i)+1)),o.model},addAll:function(e){var t=this;this.collection.set(a().map(e,(function(e,n){var i=t.addModel(e,!0);return t.getSubviewByModel(i).viewModel.set("conditionIndex",n+1),i})))},removeSubview:function(e){var t=this.getSubviewByModel(e);if(t){var n=a().indexOf(this._subviews,t);this._subviews.splice(n,1),t.remove(),this._subviews.length&&a().each(this._subviews,(function(e,t){e.viewModel.set("conditionIndex",t+1)}))}},getSubviewByModel:function(e){return a().find(this._subviews,(function(t){return t.model===e}))},render:function(){a().invoke(this._subviews,"remove"),this._subviews=[],this._$subviewsContainer.empty();var e=this.collection.toJSON();return this.collection.reset(),this.addAll(e),this},addNewCondition:function(e){if(!this.$(e.target).is(".disabled")){var t=new ye,n=this.addModel(t.defaults()),i=this.getSubviewByModel(n);n.set("operator",i.getBinding("convertedOptions")[0].value),t.remove()}},setColumnComponentModel:function(e,t){t?Me.call(this):(this.cache.clear(),this.viewModel.set({applyTo:null},{silent:!0}),this.collection.genericProperties=e.parent.config.genericProperties),this.columnComponentModel=e,this.viewModel.set("dataType",M.Z.dataTypeToSchemaFormat[this.columnComponentModel.get("dataType")]),Oe.call(this)},getActions:function(){var e=this,t=this.cache,n=[];return Me.call(this),a().each(t.map,(function(i,o){var a=t.keyInfo[o];a.model.updateFromReportComponentObject({conditions:ke.call(e,i.current,a.model.get("dataType"),a.model.get("conditionalFormattingData").conditionPattern)}),n.push(a.model.actions["change:conditions"].call(a.model))})),n},isValid:function(){var e=[];return this.collection.reduce((function(e,t){return t.isValid()||e.push(t),e}),e),!e.length},validate:function(){return!!this.isValid()||(this.errorDialog.setMessage(s.Z["net.sf.jasperreports.components.headertoolbar.conditions.invalid"]),this.errorDialog.open(),!1)},clear:function(){a().invoke(this._subviews,"remove"),this._subviews=[],this.collection.reset(),this.cache.clear()},remove:function(){f().View.prototype.remove.apply(this,arguments),this.viewModel&&this.viewModel.remove(),this.collection&&this.collection.remove(),this.cache&&this.cache.remove(),this.errorDialog&&this.errorDialog.remove(),a().invoke(this._subviews,"remove"),this._subviews=[]}});function Ie(e){if(this.conditionFormatView.validate()){var t=[];t.push.apply(t,this.basicFormatView.getActions()),t.push.apply(t,this.conditionFormatView.getActions()),t.length&&this.columnComponentModel.format(t),this.close()}}function Ee(){this.basicFormatView.clear(),this.conditionFormatView.clear(),this.close()}function Pe(){var e=this.columnComponentModel.parent.columns.indexOf(this.columnComponentModel),t=this.columnComponentModel.parent.columns.length;e>0?this.$el.find("button.colprev").prop("disabled",!1):this.$el.find("button.colprev").prop("disabled",!0),e<t-1?this.$el.find("button.colnext").prop("disabled",!1):this.$el.find("button.colnext").prop("disabled",!0)}const Le=m.Z.extend({defaultTemplate:'<div class="jive_dialog {{- additionalCssClasses }}">\n\n    <div class="dialogContent">\n        <div class="dialogHeader mover">\n            <div class="tabContainer"></div>\n            <h2>\n                <span class="dialogTitle">{{- i18n["net.sf.jasperreports.components.headertoolbar.title.formatcolumn"] }}: </span>\n                <span class="dialogTitle columnLabel"></span>\n            </h2>\n        </div>\n        <div class="dialogBody subcontainer" style="text-align: left; overflow-y: hidden;"></div>\n    </div>\n    <div class="dialogFooter footer">\n        <button class="colprev colnav"><span class="wrap">{{- i18n["net.sf.jasperreports.components.headertoolbar.dialog.previous.column"] }}</span></button>\n        <button class="colnext colnav"><span class="wrap">{{- i18n["net.sf.jasperreports.components.headertoolbar.dialog.next.column"] }}</span></button>\n    </div>\n</div>',events:a().extend({"click button.colprev":"_goToPreviousColumn","click button.colnext":"_goToNextColumn"},m.Z.prototype.events),el:function(){return this.template({title:this.title,additionalCssClasses:this.additionalCssClasses,i18n:this.i18n})},constructor:function(e){this.i18n=e.i18n,this.basicFormatView=new me({i18n:this.i18n}),this.conditionFormatView=new xe({i18n:this.i18n}),m.Z.prototype.constructor.call(this,{buttons:[{label:N.Z["button.cancel"],action:"cancel",primary:!1,float:"right"},{label:N.Z["button.ok"],action:"ok",primary:!0,float:"right"}],additionalCssClasses:"tableFormatDialog",modal:e.modal,resizable:!1,traits:[L,k],tabHeaderContainerSelector:".dialogHeader > .tabContainer",tabContainerClass:"jive_form_container",optionTemplate:'<div class="tab dialog">\n\n    <js-templateNonce></js-templateNonce>\n    <span>{{- label }}</span></div>',tabs:[{label:this.i18n["net.sf.jasperreports.components.headertoolbar.title.basicformat"],action:"basicFormatTab",content:this.basicFormatView},{label:this.i18n["net.sf.jasperreports.components.headertoolbar.title.conditions"],action:"conditionalFormatTab",content:this.conditionFormatView}]}),this.on("button:ok",a().bind(Ie,this)),this.on("button:cancel",a().bind(Ee,this)),this.on("tab:basicFormatTab",(function(){if(!this.conditionFormatView.validate())return this.tabHeaderContainer.options[0].removeSelection(),this.$(this.$tabs.get(0)).hide(),this.tabHeaderContainer.options[1].addSelection(),void this.$(this.$tabs.get(1)).show();this.conditionFormatView.trigger("tabSwitched")})),this.on("tab:conditionalFormatTab",(function(){this.basicFormatView.trigger("tabSwitched")}))},open:function(e){var t=e.get("columnLabel")?e.get("columnLabel"):"#"+(e.get("columnIndex")+1);this.columnComponentModel=e,this.$el.find(".dialogTitle.columnLabel").text(t),this.basicFormatView.setColumnComponentModel(this.columnComponentModel),this.conditionFormatView.setColumnComponentModel(this.columnComponentModel),this.openTab("basicFormatTab"),m.Z.prototype.open.apply(this,arguments),Pe.call(this)},_goToPreviousColumn:function(e){if(this.conditionFormatView.validate()){var t=this.columnComponentModel.collection.indexOf(this.columnComponentModel),n=this.columnComponentModel.collection.at(t-1),i=n.get("columnLabel")?n.get("columnLabel"):"#"+(n.get("columnIndex")+1);this.basicFormatView.setColumnComponentModel(n,!0),this.conditionFormatView.setColumnComponentModel(n,!0),this.$el.find(".dialogTitle.columnLabel").text(i),this.columnComponentModel=n,Pe.call(this)}},_goToNextColumn:function(e){if(this.conditionFormatView.validate()){var t=this.columnComponentModel.parent.columns.indexOf(this.columnComponentModel),n=this.columnComponentModel.parent.columns[t+1],i=n.get("columnLabel")?n.get("columnLabel"):"#"+(n.get("columnIndex")+1);this.basicFormatView.setColumnComponentModel(n,!0),this.conditionFormatView.setColumnComponentModel(n,!0),this.$el.find(".dialogTitle.columnLabel").text(i),this.columnComponentModel=n,Pe.call(this)}},remove:function(){m.Z.prototype.remove.call(this),this.basicFormatView&&this.basicFormatView.remove(),this.conditionFormatView&&this.conditionFormatView.remove()}});function Ae(e){return a().some(e,(function(e){return e.interactive&&!e.visible}))}function Fe(e){return a().filter(e,(function(e){return e.interactive&&e.visible})).length>1}var De=n(41155);n(77196);var Re=n(62287).Z.register("TableJiveComponentView");function Ue(){this.overlay&&this.overlay.hide(),this.headerToolbar&&(this.headerToolbar.hide(),this.headerToolbar.cascadingMenus&&this.headerToolbar.cascadingMenus.length&&a().each(this.headerToolbar.cascadingMenus,(function(e){e.hide()}))),this.resizeMarker&&this.resizeMarker.hide(),this.currentColumnData=null}function $e(e,t,n){var i=t.get("message");a().isFunction(this[i])&&this[i](t,e)}function He(e){e.stopPropagation();var t=d()(e.currentTarget),n=this.getColumnData(t);this.currentColumnData=n;var i=this.model.columns,o=n.$header.data("coluuid");i.some((function(e){return e.get("id")===o}))&&this.selectColumn(o,n)}function Ve(e,t){this.resizingColumn=!0}function Ze(e,t){this.overlay.$el.width(t.position.left-this.overlay.$el.position().left)}function Be(e,t){var n=this.model.get("scaleFactor")||1,i=(t.position.left-this.overlay.$el.position().left)/n;this.currentColumn.resize({width:i<8?8:Math.floor(i)}),this.resizingColumn=!1}function We(){var e,t,n,i,o,s,r=[],l=this.model.get("id");this.visibleColumnsMoveData=[],this.reportContainer.find("table.jrPage .jrcolHeader[data-tableuuid='"+l+"']").first().parents("table").each((function(e,t){if(s=d()(t),(r=s.find(".jrcolHeader[data-tableuuid='"+l+"']")).length>0)return!1})),this.$scrollContainer||(this.$scrollContainer=d()(this.stateModel.get("container")));var c=this.$scrollContainer.scrollLeft(),p={};for(t=0;t<r.length;t++){var u,h,m,v,f,b=d()(r.get(t)).data("coluuid");p[b]||(h=(u=s.find(".jrcolHeader[data-coluuid='"+b+"']")).eq(0),m=u.length>0?u.eq(u.length-1):h,v=h.outerWidth(),f=h.position().left,u.each((function(e,t){var n=d()(t);n.position().left<f&&(v+=f-n.position().left,f=n.position().left),n.position().left+n.outerWidth()>f+v&&(v=n.position().left+n.outerWidth()-f)})),p[b]={width:v,height:m.position().top-h.position().top+m.height(),colidx:m.data("colidx"),uuid:h.data("coluuid"),cellid:h.data("cellid"),offsetLeft:h.offset().left+c})}for(o in r=[],p)p.hasOwnProperty(o)&&r.push(p[o]);for(r.sort((function(e,t){return e.colidx-t.colidx})),t=0;t<r.length;t++)n=(e=r[t]).offsetLeft,null!=(i=a().findWhere(this.model.config.allColumnsData,{uuid:e.uuid}))&&(i.visible=!0),this.visibleColumnsMoveData.push({left:n,right:n+e.width,width:e.width,index:null!=i?i.index:null,uuid:e.uuid})}function ze(e,t){this.currentColMoveData=a().findWhere(this.visibleColumnsMoveData,{uuid:this.currentColumn.get("id")}),this.colToMoveToIndex=this.currentColMoveData.index,this.prevPageX=e.pageX+this.$scrollContainer.scrollLeft()}function Qe(e,t){var n,i,o,a,s=this.visibleColumnsMoveData.length,r=this.colToMoveToIndex,l=this.$scrollContainer,c=l.scrollLeft(),d=e.pageX+c;d>this.currentColMoveData.right?o=!0:d<this.currentColMoveData.left&&(o=!1);var p=null;for(n=0;n<s;n++)if(d<=(i=this.visibleColumnsMoveData[n]).right){r=parseInt(i.index),d<=i.left+i.width/2?(this.resizeMarker.$el.offset({left:i.left-c}),!0===o?p=r>0?r-1:0:!1===o&&(p=r)):(this.resizeMarker.$el.offset({left:i.right-c}),!0===o?p=r:!1===o&&(p=r+1));break}var u=parseInt(this.visibleColumnsMoveData[s-1].index);if((null===p&&d>i.right||p>u)&&(this.resizeMarker.$el.offset({left:i.right-c}),p=u),this.colToMoveToIndex=p,a=i,d>this.prevPageX){if(l.offset().left+l.width()+c-5<a.right&&!this.isScrollingRight){this.isScrollingRight=!0;var h=this;l.animate({scrollLeft:"+="+(a.width+10)},{duration:1e3,queue:!1}).promise().then((function(){h.isScrollingRight=!1}))}}else if(a.left-c-5<=l.offset().left&&!this.isScrollingLeft){this.isScrollingLeft=!0;h=this;l.animate({scrollLeft:"-="+(a.width-10)},{duration:1e3,queue:!1}).promise().then((function(){h.isScrollingLeft=!1}))}this.prevPageX=d}function qe(e,t){null!=this.colToMoveToIndex&&this.colToMoveToIndex!=this.currentColumn.get("columnIndex")&&this.currentColumn.move({index:this.colToMoveToIndex})}function Ge(e){this.headerToolbar.buttons.options[0].$el[0].contains(e.target)||this.overlay.$el[0].contains(e.target)||this.resizeMarker.$el[0].contains(e.target)||(Ue.call(this),d()(document).off("click touchend",this.onClickOutside))}const Je=i.Z.extend({init:function(){this.reportContainer=this.getReportContainer(this.getReportId()),this.setGenericProperties(this.model.config.genericProperties),this.initJiveComponents(this.reportContainer),this.initTableEvents()},initTableEvents:function(){var e=this.model.get("id");this.headerToolbar&&this.listenTo(this.headerToolbar,"select",a().bind($e,this)),this.overlay&&this.listenTo(this.overlay,"overlayClicked",a().bind(Ue,this)),this.tableElement=this.getReportContainer(this.getReportId()),this.tableElement.on("click touchend",".jrPage .jrcolHeader.interactiveElement[data-tableuuid="+e+"]",a().bind(He,this)),this.tableElement.on("click touchend",".jrPage .jrcel[data-tableuuid="+e+"]",a().bind(He,this)),this.resizeMarker&&(this.listenTo(this.resizeMarker,"marker:dragStart",a().bind(Ve,this)),this.listenTo(this.resizeMarker,"marker:drag",a().bind(Ze,this)),this.listenTo(this.resizeMarker,"marker:dragStop",a().bind(Be,this))),this.stateModel.isFloatingTableHeaderEnabled()&&this.model.get("hasFloatingHeader")&&(this.$scrollContainer=d()(this.stateModel.get("container")),this.$scrollContainer.on("scroll",a().throttle(a().bind(this._scrollHeader,this),100,{leading:!0,trailing:!0})),this.scrollData={bMoved:!1,reportContainerPositionAtMove:null},this.listenTo(this.model,"change:scaleFactor",(function(){this.$scrollContainer.find("table.jr_floating_header").is(":visible")&&this._scrollHeader(!0)}))),this.onClickOutside=a().bind(Ge,this),this.listenTo(this.model,"change:scaleFactor",(function(){Ue.call(this)}))},initJiveComponents:function(e){var t=this;this.overlay=new l.Z({parentElement:e}),this.filterDialog=new x({i18n:s.Z,modal:this.stateModel.get("modalDialogs")}),this.listenTo(this.filterDialog,"validationError",(function(e){this.errorDialog.setMessage(e),this.errorDialog.open()})),this.formatDialog=new Le({i18n:s.Z,modal:this.stateModel.get("modalDialogs")}),this.headerToolbar=(0,r.Z)(this.model.get("type"),{parentElement:e,children:this.getHoverMenuChildren(),hideColumnOptionTestFn:a().partial(Fe,this.model.config.allColumnsData),showColumnsOptionTestFn:a().partial(Ae,this.model.config.allColumnsData)}),this.headerToolbar.$el.addClass("jr_table"),this.resizeMarker=new h({parentElement:e});var n,i,o,c,p,u=(n=Qe,i=t,o=50,p=null,{apply:function(){var e=arguments;c?n.apply(i,e):(clearTimeout(p),p=setTimeout((function(){p=null,n.apply(i,e)}),o))},isRunning:function(){return null!=p},cancelAndExecute:function(){null!=p&&(clearTimeout(p),n.apply(i,arguments))}});this.overlay.$el.draggable({cursorAt:{top:40,left:-30},scroll:!1,start:function(e,n){ze.call(t,e,n)},drag:function(e,t){u.apply(e,t)},stop:function(e,n){u.isRunning()&&u.cancelAndExecute(e,n),qe.call(t,e,n)},helper:function(e){return d()(a().template('<span class="jive_drag_label" style="display: none;">\n\n    <js-templateNonce></js-templateNonce>\n    {{- i18n["net.sf.jasperreports.components.headertoolbar.label.draghelper"] }}</span>',{i18n:s.Z})).show()}}),We.call(this)},sort:function(e){var t=e.get("order");t&&this.currentColumn.sort({order:t})},filter:function(e,t){this.filterDialog.open(this.currentColumn)},format:function(e,t){this.formatDialog.open(this.currentColumn)},hideColumn:function(e){this.currentColumn.hide()},showColumn:function(e){var t=e.get("index");this.currentColumn.unhide(a().isArray(t)?t:[t])},setGenericProperties:function(e){this.genericProperties=e},getGenericProperties:function(){return this.genericProperties},getHoverMenuChildren:function(){var e=[],t=this.model,n=a().reduce(t.config.allColumnsData,(function(n,i){return i&&i.interactive&&(e.push(i.index),n.push({label:i.label,id:i.uuid,message:De.Z.SHOW_COLUMN,action:"select",index:i.index,test:function(){return!a().find(t.columns,(function(e){return e&&e.get("id")===i.uuid}))}})),n}),[]);return n.unshift({label:s.Z["net.sf.jasperreports.components.headertoolbar.label.showcolumns.all"],action:"select",message:De.Z.SHOW_COLUMN,index:e}),n},getColumnData:function(e){var t,n,i=e.hasClass("jrcolHeader")?e.data("cellid"):e.attr("class").split(" ")[1].substring(4),o=this.reportContainer.find("table.jrPage .jrcolHeader[data-cellid='"+i+"']"),a=o.eq(0),s=null,r=a.offset().left,l=this.model.get("scaleFactor");return t=n=a.outerWidth(),o.each((function(e,i){var o=d()(i);o.offset().left<r&&(n+=r-o.offset().left,r=o.offset().left),o.offset().left+o.outerWidth()>r+n&&(n=o.offset().left+o.outerWidth()-r,t+=o.outerWidth())})),i=(""+i).replace(/\./g,"\\."),a.parents().each((function(e,t){var n,o=d()(".cel_"+i+":last",t);if(o&&o.length>0)return n=(n=o.css("height")).substring(0,n.indexOf("px")),s=o.offset().top+parseFloat(n)*l-a.offset().top,!1})),{$header:a,width:t*l,height:s||a.outerHeight()*l}},setCurrentColumn:function(e){this.currentColumn=a().find(this.model.columns,(function(t){return t&&t.get("id")===e}))},selectColumn:function(e,t){var n=t.$header,i={my:"left top",at:"left top",of:n,collision:"none"};this.setCurrentColumn(e),this.overlay.show().css({width:t.width,height:t.height}).setPosition(i).setPosition(i),this.scrollData&&this.scrollData.bMoved?(this.headerToolbar.show(!0),this._setToolbarPositionWhenFloating(this._getHeaderTable())):this.headerToolbar.show(!0).setPosition({my:"left bottom+1",at:"left top",of:n,collision:"none"}),this.currentColumn.get("canSort")?(this.headerToolbar.buttons.enable("sortAsc"),this.headerToolbar.buttons.enable("sortDesc")):(this.headerToolbar.buttons.disable("sortAsc"),this.headerToolbar.buttons.disable("sortDesc")),this.currentColumn.get("canFilter")?this.headerToolbar.buttons.enable("filter"):this.headerToolbar.buttons.disable("filter"),this.resizeMarker.show().css({height:t.height}).setPosition({my:"left top",at:"right top",of:this.overlay.$el,collision:"none"}),d()(document).on("click touchend",this.onClickOutside)},render:function(e){var t=new(d().Deferred);return this.setDataReportId(e,this.getReportId()),this.errorDialog=new fe({additionalCssClasses:"jive_dialog"}),this.listenTo(this.model,"serverError",this.showError),this.stateModel.isDefaultJiveUiEnabled()?(this.init(),this.overlay&&this.overlay.render(),this.headerToolbar&&this.headerToolbar.render(),this.resizeMarker&&this.resizeMarker.render(),Re.debug("Apply table jive component: ",this.jiveColumn),t.resolve(),t):(t.resolve(),t)},showError:function(e){this.errorDialog.setMessage(e.devmsg),this.errorDialog.open()},detachEvents:function(){this.tableElement&&this.tableElement.off()},remove:function(){this.overlay&&this.overlay.remove(),this.filterDialog&&this.filterDialog.remove(),this.formatDialog&&this.formatDialog.remove(),this.resizeMarker&&this.resizeMarker.remove(),this.headerToolbar&&this.headerToolbar.remove(),this.$scrollContainer&&this.$scrollContainer.find("table.jr_floating_header").remove(),d()(document).off("click touchend",this.onClickOutside),i.Z.prototype.remove.call(this,arguments)},_scrollHeader:function(e){var t=this.$scrollContainer,n=!1,i=!1,o=this.scrollData;if(null!=o.scrollTop?t.scrollTop()!=o.scrollTop&&(o.scrollTop=t.scrollTop(),n=!0):0!==t.scrollTop()&&(o.scrollTop=t.scrollTop(),n=!0),null!=o.scrollLeft?t.scrollLeft()!=o.scrollLeft&&(o.scrollLeft=t.scrollLeft(),i=!0):0!==t.scrollLeft()&&(o.scrollLeft=t.scrollLeft(),i=!0),i||n||e){var a=t.find(".jrcolHeader").first();if(a.length){var s=this._getHeaderTable(a),r=a.closest("table"),l=t.offset().top,c=a.closest("tr").offset().top,d=a.closest("table").find(".jrcel").last(),p=d.length?d.offset().top-s.outerHeight()-l:-1,u=this.model.get("scaleFactor");!o.bMoved&&c-l<0&&p>0?(s.show(),u?(this._applyScaleTransform(s,u),s.offset({top:l,left:r.offset().left}),s.offset({top:l,left:r.offset().left})):s.offset({top:l,left:r.offset().left}),this._setToolbarPositionWhenFloating(s),o.bMoved=!0,o.reportContainerPositionAtMove||(o.reportContainerPositionAtMove=l)):o.bMoved&&c-l<0&&p>0?(s.show(),u?(this._applyScaleTransform(s,u),s.offset({top:l,left:r.offset().left})):s.offset({top:l,left:r.offset().left}),this._setToolbarPositionWhenFloating(s)):o.bMoved&&(s.hide(),o.bMoved=!1,this._setToolbarDefaultPosition())}}},_getHeaderTable:function(e){var t=this.$scrollContainer.find("table.jr_floating_header");if(0===t.length){(t=d()("<table class='jr_floating_header' style='display:none'></table>").appendTo(this.$scrollContainer)).on("click touchend",".jrcolHeader",(function(e){if(!d()(e.target).parent().is("._jrHyperLink")){var n=d()(this).data("coluuid"),i=t.parent().find("table.jrPage .jrcolHeader[data-coluuid="+n+"]:first");return i.length&&i.trigger("click"),!1}}));var n,i,o,a,s,r,l,c,p,u,h,m,v,f=e.closest("table"),b=f.find(".jrcolHeader").last(),g=[],T=[];if(e.length>0){if(i=e.closest("tr"),a=b.closest("tr"),m=e.closest("table"),i===a)g.push(i);else for(v=f.find("tr"),c=v.index(i),p=v.index(a),u=c;u<=p;u++)g.push(v.get(u));d().each(g,(function(e,i){for(o=d()(i),l=o.find("td,th"),n=d()("<tr></tr>"),o.attr("valign")&&n.attr("valign",o.attr("valign")),T[e]=0,c=0,h=l.length;c<h;c++)r=d()(l.get(c)),s=r.clone(),T[e]=T[e]+r.outerWidth(),s.css("width",r.css("width")),s.css("height",r.css("height")),n.append(s);t.append(n)})),t.css({position:"relative",width:Math.max.apply(Math,T),"empty-cells":m.css("empty-cells"),"border-collapse":m.css("border-collapse"),"background-color":m.css("background-color")}),t.attr("cellpadding",m.attr("cellpadding")),t.attr("cellspacing",m.attr("cellspacing")),t.attr("border",m.attr("border"))}}return t},_setToolbarPositionWhenFloating:function(e){var t,n,i=this.headerToolbar;i.$el.is(":visible")&&((t=e.find(".jrcolHeader[data-cellid='"+this.currentColumnData.$header.data("cellid")+"']").first()).offset().top>e.offset().top?(n=t.offset().top-e.offset().top-i.$el.outerHeight())<0?i.setPosition({my:"left bottom+"+Math.abs(n),at:"left top",of:t,collision:"none"}):i.setPosition({my:"left bottom",at:"left top",of:t,collision:"none"}):i.setPosition({my:"left top",at:"left top",of:t,collision:"none"}))},_setToolbarDefaultPosition:function(){this.headerToolbar.$el.is(":visible")&&this.headerToolbar.setPosition({my:"left bottom+1",at:"left top",of:this.currentColumnData.$header})}})},62561:(e,t,n)=>{e.exports=n(97653)()}}]);
//# sourceMappingURL=chunk.3734.js.map