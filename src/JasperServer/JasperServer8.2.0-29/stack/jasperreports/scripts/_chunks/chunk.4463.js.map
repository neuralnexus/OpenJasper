{"version":3,"sources":["webpack://jrs-ui/./src/controls/controls.dataconverter.js","webpack://jrs-ui/./src/controls/controls.datatransfer.js","webpack://jrs-ui/./src/controls/controls.basecontrol.js","webpack://jrs-ui/./src/controls/rest/enum/restParamsEnum.ts","webpack://jrs-ui/./src/controls/controls.viewmodel.js","webpack://jrs-ui/./src/controls/predicate/isControlInCascade.ts","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/listWithNavigationModelTrait.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/manager/KeyboardManager.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/model/SingleSelectListModel.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/view/ScalableList.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/templates/viewPortChunksTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/scalableList/templates/itemsTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/scalableList/view/ListWithSelection.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/view/ListWithNavigation.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/view/SingleSelectList.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/dataprovider/SearcheableDataProvider.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/manager/DropDownManager.js","webpack://jrs-ui/../js-sdk/src/i18n/ScalableInputControlsBundle.properties.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/view/SingleSelect.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/singleSelectTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/singleSelectTemplate_IE10_11.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/dropDownTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/listTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/templates/itemsTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/scalableList/model/ListWithSelectionAsObjectHashModel.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/model/SingleSelectListModelNew.js","webpack://jrs-ui/../js-sdk/src/components/singleSelect/view/SingleSelectNew.js","webpack://jrs-ui/../js-sdk/src/components/scalableList/util/domAndCssUtil.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/mixin/scalableListItemHeightCalculationTrait.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/listTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/view/AvailableItemsList.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/availableItemsTemplate_IE10_11.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/availableItemsTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/view/ListViewForSelectedItemsList.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/view/SelectedItemsList.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/selectedItemsTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/selectedItemsListTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/singleSelect/dataprovider/CacheableDataProvider.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/dataprovider/SelectedItemsDataProvider.js","webpack://jrs-ui/../js-sdk/src/components/sizer/Sizer.js","webpack://jrs-ui/../js-sdk/src/components/sizer/template/sizerTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/view/MultiSelect.js","webpack://jrs-ui/../js-sdk/src/components/multiSelect/templates/multiSelectTemplate.htm","webpack://jrs-ui/../js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory.js","webpack://jrs-ui/./src/controls/dataprovider/InputControlsDataProvider.ts","webpack://jrs-ui/./src/controls/dataprovider/InputControlsDataProviderWithDataLabelHash.ts","webpack://jrs-ui/./src/controls/dataprovider/util/getInputControlsDataProviderNewPageOptions.ts","webpack://jrs-ui/./src/controls/controls.components.js","webpack://jrs-ui/./src/controls/rest/InputControlsService.ts","webpack://jrs-ui/./src/controls/rest/InputControlsServiceWithCache.ts","webpack://jrs-ui/./src/controls/converter/inputControlsToViewModelConverter.ts","webpack://jrs-ui/./src/controls/enum/inputControlTypeEnum.ts","webpack://jrs-ui/./src/controls/converter/getControlPaginationOptionsByControlIdAndType.ts","webpack://jrs-ui/./src/controls/predicate/isQueryControl.ts","webpack://jrs-ui/./src/controls/converter/getControlsPaginationOptionsByControlId.ts","webpack://jrs-ui/./src/controls/service/InputControlsReportViewerService.ts","webpack://jrs-ui/./src/controls/controls.controller.js","webpack://jrs-ui/./src/controls/controls.logging.js","webpack://jrs-ui/./src/core/core.ajax.utils.js","webpack://jrs-ui/./src/scheduler/template/schedulerOverlayIframeTemplate.htm","webpack://jrs-ui/./src/scheduler/util/schedulerConstants.js","webpack://jrs-ui/./src/scheduler/util/schedulerUtils.js","webpack://jrs-ui/../js-sdk/src/common/component/dialog/ConfirmationDialog.js","webpack://jrs-ui/../js-sdk/src/common/util/domUtil.js","webpack://jrs-ui/../js-sdk/src/components/dateAndTime/DateAndTimePicker.js","webpack://jrs-ui/../js-sdk/src/components/dateAndTime/template/dateTimePopupContainer.htm","webpack://jrs-ui/../js-sdk/src/common/component/dialog/template/confirmDialogTemplate.htm","webpack://jrs-ui/./src/i18n/all.properties.js"],"names":["exp","_","Controls","DataConverter","JRS","Base","extend","structureFormater","response","formatedResponse","map","inputControl","res","readOnly","String","uri","replace","state","controlStructure","compact","each","structure","this","convertResponseToControlsState","rawState","result","requestStates","inputControlState","convertOptionFunc","option","opt","value","label","selected","convertToValues","requestState","isUndefined","isNull","options","isArray","id","error","values","JSON","jQuery","commonErrorHandler","err","errorObject","parse","responseText","e","viewModel","getViewModel","controlUri","inputControlUri","control","find","errorCode","set","defaultMessage","getResponseHeader","status","document","location","__jrsConfigs__","indexOf","message","errorObjectMessage","parameters","length","template","window","statusText","dialogs","DataTransfer","CONTROLS_STRUCTURE_TEMPLATE_URI","INITIAL_CONTROLS_VALUES_TEMPLATE_URL","CONTROLS_VALUES_TEMPLATE_URL","constructor","dataConverter","initialize","setReportUri","reportUri","currentReportUri","buildUrl","reportPath","controlIds","urlTemplate","join","TemplateEngine","renderUrl","sendRequest","url","data","settings","defaultSettings","type","dataType","cache","isEmpty","processData","stringify","contentType","requestSettings","defaults","headers","ajax","fail","fetchControlsStructure","uris","selectedData","controlsStructure","then","bind","Utils","showLoadingDialogOn","updateControlsStructure","updatedStructure","fetchInitialControlValues","initialControlsValues","fetchControlsUpdatedValues","ids","fullUpdateDeferred","reject","Deferred","triggerRequestDeferred","wait","FREQUENT_CHANGES_MIN_DELAY","done","resolve","arguments","BaseControl","elem","templateChunks","args","apply","getElem","setElem","element","bindCustomEventListeners","isSingleSelect","get","isSingleValue","getTemplateSection","section","createTemplateSection","baseRender","isVisible","fireControlSelectionChangeEvent","selection","trigger","CHANGE_CONTROL","createTemplate","setValue","selectedValues","fetch","clearFilter","render","attribute","isValid","undefined","visible","updateWarningMessage","text","reset","attributes","preventNotification","disabled","disable","enable","mandatory","key","keys","val","prop","merge","selections","RestParamsEnum","scrollTimeout","lastScrollAt","isIE","browserDetection","scrollStartStopCallback","Date","getTime","now","self","clearTimeout","setTimeout","ViewModel","containerSelector","DEFAULT_CONTAINER","controls","bindAll","registerEvents","ignore","onControlChange","listen","event","controlInCascade","slaveDependencies","isControlInCascade","CHANGE_SELECTION","CHANGE_VALUES","CHANGE_ORDER","isSelectionChanged","previous","next","previousControlIds","nextControlIds","union","previousFlattenValues","flatten","nextFlattenValues","difference","Model","getControls","instantiate","dataUri","inputControlsService","initialSelectedValues","paginatedValuesOptions","forEach","controlId","createControl","Control","property","toLowerCase","Error","removeControl","reorderControl","oldIndex","newIndex","t","shiftDirection","start","Math","min","max","end","i","controlsOptions","draw","update","Array","findControl","pluck","View","jsonStructure","container","getContainer","empty","attr","controlJson","append","Report","icReorderEnabled","horizontalLayout","layouts","LAYOUT_TOP_OF_PAGE","reportControlsLayout","test","navigator","userAgent","_initSortable","controlSelection","removeValidationMessages","areAllControlsValid","filter","setContainer","reloadContainer","keepSortableAlive","sortableContainer","sortable","delay","placeholder","axis","items","cancel","ui","item","index","stop","parent","off","on","prototype","activate","setActive","that","getData","offset","limit","fetchFailed","active","silent","getActive","KeyboardManager","systemKeyCodes","keydownHandlers","preventKeydownHandlers","stopPropagation","keydownTimeout","context","deferredKeydownHandler","immediateHandleCondition","immediateKeydownHandler","onKeydown","_isSystemKeyPressed","_canImmediatelyHandleKeyboardEvent","_immediatelyHandleKeyboardEvent","deferredHandleKeyboardEvent","deferredTimeout","call","which","_immediateHandleCondition","keydownHandler","_immediatePreventdefaultHandler","preventDefault","SingleSelectListModel","ListWithSelectionModel","listWithNavigationModelTrait","select","_convertInitialArrayToSelection","pendingSelection","_addToSelection","_triggerSelectionChange","_convertSelectionObject","hasOwnProperty","parseInt","_select","convertedSelection","shouldFetchLabel","Backbone","ListModel","ScalableListModel","listItemSelector","events","model","chunksTemplate","itemsTemplate","defaultChunkHeight","chunkHeight","manualScrollInterval","lazy","defaultItemHeight","listItemHeight","initListeners","listenTo","onModelChange","onFetchFailed","onScroll","scrollTimer","_fetchVisibleData","scrollPos","target","scrollTop","restoreScrollPos","$el","renderData","responseStatus","postProcessChunkModelItem","$","_renderItems","bufferStart","bufferEnd","firstChunkWithData","itemsPerChunk","ceil","lastChunkWithData","chunk","$chunk","chunkModel","_getChunkModel","total","totalItems","itemHeight","chunkHtml","child","children","removeChild","_renderViewChunks","force","slice","chunks","_getViewChunksModel","$firstViewChunk","totalChunksToShow","lastChunkHeight","viewChunks","push","height","_calcViewPortConstants","viewPortConstantsInitialized","outerHeight","_calcViewPortHeight","floor","resizeViewPort","viewPortHeight","itemsPerView","_getItemsPerView","firstItemForChunk","lastItemForChunk","top","visibleItems","_getVisibleItems","bottom","_getScrollPos","topVisibleItem","elOffset","viewChunkOffset","has","resize","is","componentHeight","_componentHeight","callback","keepPosition","once","scrollTo","newTopVisibleItemPos","itemPos","BUTTONS","LEFT","RIGHT","ScalableList","eventListenerPattern","markerClass","selectedClass","_initSelection","delegateEvents","onMousedown","onMousemove","onMousedblclick","onItemEvent","undelegateEvents","selectionAllowed","allowed","leftButtonSelection","left","right","multiple","clearSelection","selectValue","selectRange","deselectValue","onGlobalMouseup","onGlobalMousemove","selectionContains","getDisabled","itemData","_getDomItemData","currentTarget","_singleSelect","selectionChanged","_triggerSelectionChanged","_triggerDblclicked","getItemByEvent","eventType","buttonType","mouseDownPos","_getMousePos","_multiSelect","_allowMouseMoveSelection","_stopAutoScroll","_mouseMoved","addRangeToSelection","leftMouseButtonPressed","rightMouseButtonPressed","mousePosY","clientY","scrollInterval","setInterval","_autoScroll","removeClass","_selectItemByIndex","visibleRangeStart","visibleRangeEnd","$item","addClass","_deselectItemByIndex","newScrollPos","viewPortTop","shouldScroll","_selectRangeOnAutoScroll","oldScrollPos","clearInterval","shiftKey","ctrlKey","metaKey","toggleSelection","addValueToSelection","getValue","modelItem","mousePos","abs","x","clientX","y","getSelection","modelOptions","selectAll","selectNone","invertSelection","setDisabled","remove","ListWithSelection","canActivate","ListWithNavigationModel","mouseMovePos","setCanActivate","getCanActivate","activateFirst","activateLast","activateNext","_getActiveIndex","activatePrevious","pageDown","pageUp","getActiveValue","activeIndex","ListWithNavigation","onMouseup","SearcheableDataProvider","indexMapping","internalGetData","deferred","criteria","dataCache","promise","_shouldFilter","_resolvePromise","reverseIndexMapping","_filterValues","getIndexMapping","getReverseIndexMapping","first","last","dataSegment","_getDataSegment","filteredData","j","$body","DropDownManager","$dropDownEl","dropDownEl","calcOffset","isOffsetChanged","_isOffsetChanged","recalcInterval","onOffsetChanged","startCalc","checkOffset","setNewOffset","recalcTimer","stopCalc","whereItNeedsToBe","currentOffset","position","bodyOffset","width","newDimensions","css","currentDimensions","bundle","Object","reduce","acc","keyboardManager","dropUpDirection","dropDownTemplate","processKeydown","listViewModel","_createListViewModel","listView","_createListView","dropDownManager","$dropDownElContainer","calcOffsetForListView","isDimensionsChangedForListView","collapse","SingleSelectList","el","listElement","searcheableDataProvider","_getGetData","bufferSize","loadFactor","_getActiveValueIndex","selectionChange","itemMouseup","listRenderError","changeExpandedState","changeValue","changeDisabled","changeFilter","onGlobalMousedown","singleSelect","isIPad","expanded","i18n","renderListView","$singleSelect","$searchBlock","$inputBlock","$input","listRendered","platform","$scalablelist","show","hide","preventBlur","focus","activeValue","unset","updateValueFromActive","onClickOnInput","expand","onFocus","onBlur","doExpand","doCollapse","updateControlLabel","removeAttr","onUpKey","onDownKey","onEnterKey","onEscKey","onHomeKey","onEndKey","onPageUpKey","onPageDownKey","onTabKey","updateDropDirection","scrollHeight","elHeight","searchBlockHeight","topHeight","bottomHeight","maxSize","expandListView","setValueToList","getBoundingClientRect","convertExternalValueToInternalFormat","internalValue","$inputBlockPlaceholder","$inputBlockSelection","getControlLabelByValue","html","xssUtil","BaseListWithSelectionModel","caseSensitiveSelection","_removeFromSelection","_clearSelection","_selectionContains","_getSelection","_afterSelect","listPrototype","ListWithSelectionAsObjectHashModel","_calcSelectionStartIndex","afterSelect","getSelectionIndex","SingleSelect","formatValue","singleSelectListModelNew","SingleSelectListModelNew","_getSelectionIndex","bufferStartIndex","classes","appendTo","alwaysClone","cloneHandlers","clone","$tmp","doCalcOnVisibleNodeCloneObject","doCalcOnVisibleNodeClone","_itemHeightSet","_calcItemHeight","_model","_lazy","_visibility","_display","BUTTON_TESTS","selector","strings","className","_debouncedOnResize","onResize","availableItemsTemplate","list","listTemplate","scalableListItemHeightCalculationTrait","activeChange","onRenderData","onListViewModelChanged","selectionClear","selectionAdd","selectionAddRange","selectionRemove","onChangeTotalValue","getModelForRendering","_tuneCSS","setBulkSelectionText","_paddingHeightsSet","searchBarHeight","round","buttonsContainerHeight","activeChangedWithShift","currentValues","range","onSelectAll","processSelectionThroughApi","onSelectNone","onInvertSelection","componentWidth","outerWidth","_componentWidth","$bulkButtonsBar","bulkButtonsBarWidth","isAvailableTabInActive","hasClass","$clone","buttonTest","widthOk","buttonString","$button","$buttonText","input","_onUpDownNavigation","activateItem","resetToInitialActiveItem","prevActive","onAKey","newValues","convertSelectionForListViewModel","ListViewForSelectedItemsList","focusStateChanged","selectedItemsList","onMouseupOnDeleteButton","onDeleteKey","emptySelection","CacheableDataProvider","setData","getAllCachedData","SelectedItemsDataProvider","sortFunc","_sortFunc","formatLabel","_formatLabel","_convertToStandardData","_sortData","item1","item2","localeCompare","sort","log","logger","sizerOptions","$container","minHeight","handles","s","resizable","updateMinMax","boundaries","maxHeight","debug","doCalcOnVisibleNodeCloneObj","numberUtils","NumberUtils","available","heightAutoAdjustment","availableItemsListModel","_createAvailableItemsListModel","availableItemsList","_createAvailableItemsList","selectedItemsDataProvider","_createSelectedItemsListDataProvider","_createSelectedItemsList","sizer","Sizer","AvailableItemsList","selectedListOptions","SelectedItemsList","_availableItemsTotalCountChange","selectionRemoved","detach","$toggleContainer","insertAfter","_updateAvailableItemsCountLabel","_updateSelectedItemsCountLabel","_renderSizer","_handleHeight","_cssDepententSizesSet","toggleContainerHeight","_tuneCSSInternal","_emptyContainerHeight","_calcHeightByItemsCount","toggleLists","evt","toggleClass","selectionChangeTimeout","selectionChangeInternal","currentAvailableValues","triggerSelectionChange","_setToggleLabel","count","labelText","formatNumber","currentHeight","_updateSizerVisibility","$noSelection","specialValue","InputControlsDataProvider","additionalParams","serviceOptions","getInputControlsPaginatedValues","controlData","totalCount","InputControlsDataProviderWithDataLabelHash","inputControlsDataProvider","dataLabelHash","controlOptions","name","getInitialSelectedValuesToLabelMap","memo","selectedValue","changeDateFunc","dateText","prevSelection","getNormalizedDatetimeValue","rawValue","toUpperCase","Bool","SingleValueText","ControlsBase","inputValue","SingleValueNumber","SingleValueDate","setupCalendar","localizedDate","dateUtil","picker","DateAndTimePicker","showOn","dateFormat","onSelect","change","after","wrap","SingleValueDatetime","getInput","destroyCalendar","timeFormat","localizedDateTime","SingleValueTime","onClose","localizedTime","initialOptions","inputControlsDataProviderWithDataLabelHash","dataProviderWithCache","DataProviderWithSearchCache","pageSize","maxSearchCacheSize","saveLastCriteria","request","getInputControlsDataProviderNewPageOptions","assign","dfd","initialSelectedValuesToLabelMap","getLabelByValue","makeResizable","updateSelectionOnOptionChange","xhr","showErrorPopup","responseJSON","clear","MultiSelect","multiSelect","selectedItemsDataProviderSorterFactory","_resize","debounce","$sizer","SingleSelectRadio","_fetchData","_renderData","getOptionName","uuid","uniqueId","setInnerHtml","clientHeight","MultiSelectCheckbox","boxes","box","checked","InputControlsService","jrsConfigs","Accept","inputControlIds","ip","c","reportParameter","executionId","getCacheKey","params","concat","InputControlsServiceWithCache","getInputControlsSelectedValues","getInputControlsMetadata","getInputControlsValues","getReportRawParameterValues","getInputControlsOnlySelectedValue","cacheKey","cacheValue","metadata","InputControlTypeEnum","omitLimit","controlSpecificOptionsMap","addControlSpecificOptions","queryControls","getControlPaginationOptionsByControlIdAndType","getPaginatedValuesOptionsForQueryControls","controlsMap","mapper","isQueryControl","newMemo","getControlsPaginationOptionsByControlId","InputControlsReportViewerService","allRequestParameters","inputControlsToViewModelConverter","fetchInitialInputControlsValuesByUriAndStructure","preSelectedData","structureMemo","paginationOptions","paginationOptionsPerControl","fetchInputControlsOptionsByPaginatedValuesOptionsAndUri","controlsWithValueOrDefaultSelection","controlMemo","additionalOptions","masterDependencies","getControlsPaginationOptionsByControlIdOnSelectionChange","newSelection","selectedOnlyOptions","newInitialValuesPromise","selectionPerControl","ICStateMemo","preSelectionData","fetchLabelOfControls","fetchKeysOfParams","requestedSelectionParams","getControlIdInRequestParams","fetchRequestParamsThroughURL","initialPaginatedValuesOptions","initialPaginatedValuesPromise","selectedValuesPromise","paginatedValuesResponse","selectedValuesResponse","paginatedValues","selectedMemo","setCacheValueForControlPaginatedValues","optionsForValues","stateMemo","clearCache","controlPaginationOptions","validatePaginatedValuesResponse","controlsData","areControlsValid","Controller","inputControlsReportViewerService","_onViewModelSelectionChange","_onReportOptionsSelectionChanged","getController","CustomEvent","detail","dispatchEvent","selectionChangedControlId","inCascade","fetchInputControlsValuesOnControlSelectionChange","promises","when","reportOption","previousReportOption","fetchInitialInputControlsValuesByUri","controlPaginatedOptions","reportOptions","reportOptionUri","fetchReportRawParameterValues","fetchAndSetInputControlsState","fetchInputControlsInitialState","resetControlsToSelection","fetchInputControlsOptionsBySelectionAndUri","validate","console","errorMessage","baseErrorHandler","ajaxAgent","body","errorHandler","showMessageDialog","SCHEDULER_BACK_URL_STORAGE_NAME","schedulerConstants","getParamsFromUri","parts","search","substr","split","part","tmp","decodeURIComponent","hash","hashParts","shift","saveCurrentLocation","referrer","localStorage","setItem","encodeURIComponent","getBackToPreviousLocation","currentUrl","href","lastUrl","getItem","redirectToUrl","config","_scheduleDashboard","paramsMap","schedulerPageUrl","_onWindowResize","_getIframeUrl","bannerHeight","_addDimmer","encodeParams","_serializeParams","encode","substring","_ParamMapping","_closeScheduleOverlay","slideUp","getElementsByClassName","getElementById","$dimmer","resizeTimer","_detachEvents","Dialog","confirmDialogTemplate","modal","additionalCssClasses","title","content","buttons","yesLabel","action","primary","noLabel","close","setContent","scrollbarWidth","getScrollbarWidth","scrollDiv","createElement","style","overflow","appendChild","offsetWidth","clientWidth","hasScrollBar","direction","isScrollable","getComputedStyle","currentStyle","overflowX","overflowY","getElementOffset","offsetParent","offsetLeft","offsetTop","getMargins","$element","isNaN","getPaddings","disableBackForwordCache","onpageshow","persisted","reload","DATE_TIME_DEFAULTS","stepHour","stepMinute","stepSecond","showSecond","changeMonth","changeYear","showButtonPanel","onChangeMonthYear","constrainInput","TIME_DEFAULTS","warn","pickerOptions","inline","skipMoving","pickerType","discoverPickerType","provideDefaultPickerOptions","fixPopupPositionAndStyling","_callPickerAction","getDate","setDate","date","stopListening","setDefaults","configs","locale","time","Helpers","movePickerRelativelyToTriggerIcon","stylePopupContainer","originalBeforeShowFn","beforeShow","afterInject","inst","parseFloat","dpDiv","move","marginLeft","$dpDiv","$popupContainer","$parent"],"mappings":"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","file":"_chunks/chunk.4463.js","sourcesContent":["/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @author: agodovanets, inesterenko\n * @version: $Id$\n */\nimport {JRS} from \"../namespace/namespace\";\nimport _ from 'underscore';\nimport './controls.core';\n\n(function (exp, _, Controls) {\n    var DataConverter = Controls.Base.extend({\n        //Clean up input structure from mess\n        structureFormater: function (response) {\n            if (!response) {\n                return response;\n            }\n            var formatedResponse = _.map(response.inputControl, function (res) {\n                res.readOnly = String(res.readOnly) == 'true';\n                res.uri = res.uri.replace('repo:', '');\n                return res;\n            });\n            var state = _.map(formatedResponse, function (controlStructure) {\n                return controlStructure.state;\n            });\n            state = _.compact(state);\n            _.each(formatedResponse, function (structure) {\n                delete structure['state'];\n            });\n            return _.extend({ structure: formatedResponse }, this.convertResponseToControlsState(state));\n        },\n        //Convert controls update response to data structure compatible with controls\n        convertResponseToControlsState: function (rawState) {\n            var result = {};\n            var requestStates = rawState.inputControlState ? rawState.inputControlState : rawState;\n            var convertOptionFunc = function (option) {\n                var opt = {\n                    value: option.value,\n                    label: option.label\n                };\n                if (String(option.selected) == 'true') {\n                    opt.selected = true;\n                }\n                return opt;\n            };\n            var convertOptionsFunc = function (options) {\n                var values;\n                if (_.isArray(options)) {\n                    values = _.map(options, convertOptionFunc);\n                } else {\n                    values = [];\n                }\n                return values;\n            };\n            var convertToValues = function (requestState) {\n                if (!_.isUndefined(requestState.value) && !_.isNull(requestState.value)) {\n                    return requestState.value;\n                }\n                return convertOptionsFunc(requestState.options);\n            };\n            _.each(requestStates, function (requestState) {\n                if (requestState && requestState.uri) {\n                    result[requestState.id] = {\n                        error: _.isUndefined(requestState.error) ? null : requestState.error,\n                        values: convertToValues(requestState)\n                    };\n                }\n            });\n            return { state: result };\n        }\n    });\n    exp.DataConverter = DataConverter;\n    return exp;\n}(JRS.Controls, _, JRS.Controls));\n\nexport default JRS.Controls;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n */\n\n/* global errorObject, statusText*/\n\nimport {JRS} from \"../namespace/namespace\";\nimport __jrsConfigs__ from 'js-sdk/src/jrs.configs';\nimport dialogs from '../components/components.dialogs';\nimport _ from 'underscore';\nimport jQuery from 'jquery';\n\nimport './controls.core';\nimport './controls.dataconverter';\n\nJRS.Controls = (function (JSON, jQuery, _, Controls) {\n\n    //module:\n    //\n    //  controls.datatransfer\n    //\n    //summary:\n    //\n    //DataTransfer    - REST wrapper, returns normalized data\n    //\n    //dependencies:\n    //\n    //\n    //  jQuery          - v1.7.1\n    //  _,              - underscore.js 1.3.1\n    //  Controls,       - controls.core module\n\n\n    //Common error handing\n    function commonErrorHandler(err) {\n        var errorObject;\n        try {\n            try {\n                errorObject = JSON.parse(err.responseText);\n            } catch (e) {}\n\n            if (errorObject && errorObject.error) {\n                _.each(errorObject.error, function (error) {\n                    //TODO: try to avoid it\n                    var viewModel = Controls.getViewModel();\n                    var controlUri = error.inputControlUri.replace(\"repo:\", \"\");\n                    var control = viewModel.find({uri:controlUri});\n                    if (error.errorCode) {\n                        control.set({error:error.errorCode});\n                    } else if (error.defaultMessage) {\n                        control.set({error:error.defaultMessage});\n                    }\n                });\n            } else {\n                if (err.getResponseHeader(\"LoginRequested\") || err.status === 401) {\n                    document.location = __jrsConfigs__.urlContext;\n                } else if ([400, 500].indexOf(err.status) >= 0 || (err.getResponseHeader(\"JasperServerError\")\n                    && !err.getResponseHeader(\"SuppressError\"))) {\n\n                    var message = \"\";\n                    if (errorObject) {\n                        var errorObjectMessage = errorObject.message || \"Unknown error\";\n                        if (errorObject.parameters && errorObject.parameters.length > 0) {\n                            var template = _.template(\"<div><b>{{-message}}</b></div><p>{{ if (parameters) for (var i = 0; i < parameters.length; i++) { }}<div>{{-parameters[i]}}</div>{{ } }}</p>\");\n                            message = template({\n                                message: errorObjectMessage,\n                                parameters: errorObject.parameters\n                            });\n                        } else {\n                            message = errorObjectMessage\n                        }\n                    } else {\n                        message = window.statusText;\n                    }\n\n                    dialogs.errorPopup.show(message);\n                }\n            }\n        } catch (e) {\n            // In this scenario security error is handled earlier, in errorHandler, so we can ignore exception here.\n            // Comment this because it will not work in IE, but can be uncommented for debug purpose.\n            // console.error(\"Can't parse server response: %s\", \"controls.core\", err.responseText);\n        }\n    }\n\n    return _.extend(Controls, {\n\n        //REST wrapper, returns normalized data\n        DataTransfer:Controls.Base.extend({\n            CONTROLS_STRUCTURE_TEMPLATE_URI:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}\",\n\n            INITIAL_CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/values\",\n\n            CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}/values\",\n\n            constructor : function(options) {\n                this.dataConverter = options.dataConverter;\n                this.initialize(options);\n            },\n\n            initialize : function(options) {},\n\n            setReportUri:function (reportUri) {\n                this.currentReportUri = reportUri;\n            },\n            buildUrl : function(reportPath, controlIds, urlTemplate) {\n                controlIds = _.isArray(controlIds) ? controlIds.join(\";\") : controlIds || \"\";\n\n                return Controls.TemplateEngine.renderUrl(urlTemplate, {\n                    reportUri: reportPath,\n                    controlIds: controlIds\n                });\n\n            },\n            /**\n             * Send request\n             * @param url\n             * @param data\n             * @param settings\n             * @returns {*}\n             */\n            sendRequest : function(url, data, settings) {\n                var defaultSettings = {\n                    url : url,\n                    type : \"GET\",\n                    dataType : \"json\",\n                    cache : false\n                };\n                if (!_.isEmpty(data)) {\n                    _.extend(defaultSettings, {\n                        type : \"POST\",\n                        processData : false,\n                        data : JSON.stringify(data),\n                        contentType : \"application/json\"\n                    });\n                }\n\n                var requestSettings = _.defaults(settings || {}, defaultSettings);\n                requestSettings.headers || (requestSettings.headers = {});\n\n                _.defaults(requestSettings.headers, {\n                    /**\n                     *  Use custom HTTP header to prevent 401 response from server.\n                     *  401 response makes browsers to show native login dialog.\n                     *  We don't want that.\n                     */\n                    \"X-Suppress-Basic\" : \"true\",\n\n                    /**\n                     * Overwrite locale of browser, use locale of current user\n                     */\n                    \"Accept-Language\": __jrsConfigs__.userLocale.replace(/_/g, \"-\")\n                });\n\n                return jQuery.ajax(requestSettings)\n                    .fail(commonErrorHandler);\n            },\n\n            fetchControlsStructure:function (uris, selectedData) {\n                var url = this.buildUrl(this.currentReportUri, uris, this.CONTROLS_STRUCTURE_TEMPLATE_URI);\n\n                var controlsStructure = this.sendRequest(url, selectedData).then(_.bind(this.dataConverter.structureFormater, this.dataConverter));\n\n                Controls.Utils.showLoadingDialogOn(controlsStructure, null, true);\n                return  controlsStructure;\n            },\n\n            updateControlsStructure: function(updatedStructure, uri){\n                var url = this.buildUrl(uri || this.currentReportUri, null, this.CONTROLS_STRUCTURE_TEMPLATE_URI);\n\n                return this.sendRequest(url, updatedStructure, {type : \"PUT\"}).then(_.bind(this.dataConverter.structureFormater, this.dataConverter));\n            },\n\n            fetchInitialControlValues:function (reportUri, selectedData) {\n                var url = this.buildUrl(reportUri, null, this.INITIAL_CONTROLS_VALUES_TEMPLATE_URL);\n\n                var initialControlsValues = this.sendRequest(url, selectedData).\n                    then(this.dataConverter.convertResponseToControlsState);\n\n                Controls.Utils.showLoadingDialogOn(initialControlsValues, null, true);\n                return initialControlsValues;\n            },\n\n            fetchControlsUpdatedValues:function (ids, selectedData) {\n                var url = this.buildUrl(this.currentReportUri, ids, this.CONTROLS_VALUES_TEMPLATE_URL);\n                var dataConverter = this.dataConverter;\n                if (this.fullUpdateDeferred && this.fullUpdateDeferred.state() == \"pending\") {\n                    this.fullUpdateDeferred.reject();\n                }\n\n                var fullUpdateDeferred = new jQuery.Deferred();\n\n                var triggerRequestDeferred = Controls.Utils.wait(Controls.DataTransfer.FREQUENT_CHANGES_MIN_DELAY);\n\n                triggerRequestDeferred.done(_.bind(function () {\n                    this.sendRequest(url, selectedData).\n                        then(dataConverter.convertResponseToControlsState).done(\n                            function (data) {\n                                if (fullUpdateDeferred.state() == \"pending\") {\n                                    fullUpdateDeferred.resolve(data);\n                                }\n                            }).\n                        fail(function() {\n                            fullUpdateDeferred.reject(this, arguments);\n                        });\n                }, this));\n\n                fullUpdateDeferred.fail(function () {\n                    triggerRequestDeferred.reject();\n                });\n\n                Controls.Utils.showLoadingDialogOn(fullUpdateDeferred, null, true);\n\n                this.fullUpdateDeferred = fullUpdateDeferred;\n\n                return fullUpdateDeferred;\n            }\n\n        }, {\n\n            //Static props\n\n            CONTROLS_STRUCTURE_TEMPLATE_URI:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}\",\n\n            INITIAL_CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/values\",\n\n            CONTROLS_VALUES_TEMPLATE_URL:__jrsConfigs__.contextPath + \"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}/values\",\n\n            FREQUENT_CHANGES_MIN_DELAY : 400\n        })\n    });\n\n})(\n    JSON,\n    jQuery,\n    _,\n    JRS.Controls\n);\n\nexport default JRS.Controls;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n */\nimport {JRS} from \"../namespace/namespace\";\nimport _ from 'underscore';\nimport jQuery from 'jquery';\nimport './controls.core';\n\nJRS.Controls = function (jQuery, _, Controls) {\n    //module:\n    //\n    //  controls.basecontrol\n    //\n    //summary:\n    //\n    //BaseControl - prototype for all input controls\n    //\n    //dependencies:\n    //\n    //\n    //  jQuery          - v1.7.1\n    //  _,              - underscore.js 1.3.1\n    //  Controls,       - controls.core module\n    function getSelectedValues(values) {\n        if (_.isArray(values)) {\n            var filteredValues = _.filter(values, function (val) {\n                return val.selected;\n            });\n            return _.map(filteredValues, function (opt) {\n                //TODO: decouple from controls.options data structure\n                if (opt.id || opt.id === '') {\n                    return opt;\n                }\n                return opt.value;\n            });\n        } else {\n            return values;\n        }\n    }\n    return _.extend(Controls, {\n        //Base object for all input controls types\n        BaseControl: Controls.Base.extend({\n            /* Id of the control. */\n            id: null,\n            /* Store jQuery object presentation of each control. */\n            elem: null,\n            /* Validation message:\n             In case of incorrect value it will contain error message from server.\n             In case of correct value it will be null. */\n            error: null,\n            // Store template's chunks functions\n            templateChunks: {},\n            constructor: function (args) {\n                this.initialize.apply(this, arguments);\n            },\n            // Return jQuery object\n            getElem: function () {\n                return this.elem;\n            },\n            //Save reference to control's DOM as jQuery object\n            setElem: function (element) {\n                this.elem = element;\n            },\n            //bind custom events in inherited objects\n            bindCustomEventListeners: function () {\n            },\n            isSingleSelect: function () {\n                return !_.isArray(this.get('selection'));\n            },\n            isSingleValue: function () {\n                return !_.isArray(this.get('values'));\n            },\n            //get template function for chunk of template\n            getTemplateSection: function (section) {\n                if (!this.templateChunks[this.type + '_' + section]) {\n                    this.templateChunks[this.type + '_' + section] = Controls.TemplateEngine.createTemplateSection(section, this.type);\n                }\n                return this.templateChunks[this.type + '_' + section];\n            },\n            initialize: function(...args) {\n                this.baseRender(...args);\n                this.isVisible(...args) && this.bindCustomEventListeners();\n            },\n            fireControlSelectionChangeEvent: function (selection) {\n                //this.selection = selection;\n                jQuery(document).trigger(Controls.CHANGE_CONTROL, {\n                    control: this,\n                    selection\n                });\n            },\n            // Render the control from main template\n            baseRender: function (controlStructure) {\n                controlStructure && _.extend(this, controlStructure);\n                var template = Controls.TemplateEngine.createTemplate(this.type);\n                if (template) {\n                    var element = jQuery(template(this));\n                    this.setElem(element);\n                }\n            },\n            // Refresh values of the control.\n            setValue: function (selectedValues) {},\n\n            fetch: function(options) {},\n\n            clearFilter: function() {},\n\n            render: function() {},\n            // Returns selected values from the control.\n            get: function (attribute) {\n                return this[attribute];\n            },\n            // Check for validation\n            isValid: function () {\n                return this.error === null || this.error && this.error instanceof String && this.error.length === 0;\n            },\n            //Check whether control is visible\n            //Also returns true if visible property was not set at all\n            isVisible: function (args) {\n                return !args || args.visible === undefined || args.visible === true;\n            },\n            //render message\n            updateWarningMessage: function () {\n                var message = this.error != null ? this.error : '';\n                this.getElem() && this.getElem().find('.warning').text(message);\n            },\n\n            reset: function(options) {\n                this.set(options);\n\n                const values = this.get('values');\n\n                if (this.isVisible(this) && typeof values === 'undefined') {\n                    this.setValue(values);\n                }\n            },\n            // Store attributes and do some actions according changed attribute\n            set: function (attributes, preventNotification) {\n                _.extend(this, attributes);\n\n                if (attributes.values !== undefined) {\n                    const { values } = attributes;\n\n                    this.isVisible(this) && this.setValue(values);\n\n                    if (this.isSingleValue()) {\n                        this['selection'] = values;\n                    } else {\n                        if (this.isSingleSelect()) {\n                            this['selection'] = values[0];\n                        } else {\n                            this['selection'] = values;\n                        }\n                    }\n                }\n                if (attributes['selection'] !== undefined) {\n                    if (this.isSingleValue()) {\n                        this['values'] = attributes['selection'];\n                    }\n                    !preventNotification && this.fireControlSelectionChangeEvent(\n                        attributes['selection']\n                    );\n                }\n                if (attributes['disabled'] !== undefined && !this.get('readOnly')) {\n                    var disabled = attributes['disabled'];\n                    if (!preventNotification) {\n                        disabled ? this.disable() : this.enable();\n                    }\n                }\n                if (attributes['error'] !== undefined) {\n                    this.updateWarningMessage();\n                    if (this.mandatory && this['selection'] === undefined) {\n                        this['selection'] = [];\n                    }\n                }\n            },\n            find: function (attributes) {\n                if (attributes !== undefined && attributes && typeof attributes == 'object') {\n                    var key = _.keys(attributes)[0];\n                    var value = _.values(attributes)[0];\n                    return _.find(this.get('values'), function (val) {\n                        return val[key] === value;\n                    });\n                }\n            },\n            enable: function () {\n                this.getElem().find('input').prop('disabled', false);\n                this.getElem().find('select').prop('disabled', false);\n            },\n            disable: function () {\n                this.getElem().find('input').prop('disabled', true);\n                this.getElem().find('select').prop('disabled', true);\n            }\n        }, {\n            //merge  values  with selection\n            merge: function (values, selections) {\n                if (_.isNull(values) || _.isUndefined(values)) {\n                    return selections;\n                }\n                if (_.isNull(selections) || _.isUndefined(selections)) {\n                    return values;\n                }\n                if (_.isArray(selections)) {\n                    return _.map(values, function (option) {\n                        var selectedValue = _.find(selections, function (selection) {\n                            return selection === option.value;\n                        });\n                        if (selectedValue !== undefined) {\n                            option.selected = true;\n                        } else {\n                            delete option.selected;\n                        }\n                        return option;\n                    });\n                } else {\n                    return this.merge(values, [selections]);\n                }\n            }\n        }),\n        CHANGE_CONTROL: 'changed:control'\n    });\n}(jQuery, _, JRS.Controls);\n\nexport default JRS.Controls;","enum RestParamsEnum {\n    SELECTED_VALUES = 'selectedValues',\n    NOTHING_SUBSTITUTION_VALUE= '~NOTHING~'\n}\n\nexport default RestParamsEnum;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n */\n/* global Report */\nimport {JRS} from \"../namespace/namespace\";\nimport _ from 'underscore';\nimport jQuery from 'jquery';\nimport browserDetection from 'js-sdk/src/common/util/browserDetection';\n\nimport './controls.core';\nimport './controls.basecontrol';\n\nimport 'jquery-ui/ui/widgets/sortable';\n\nimport RestParamsEnum from './rest/enum/restParamsEnum';\nimport isControlInCascade from './predicate/isControlInCascade';\n\nJRS.Controls = function (jQuery, _, Controls) {\n    //module:\n    //\n    //  controls.viewmodel\n    //\n    //main types:\n    //\n    // ViewModel      - initialize, draw, update controls, no any communication with server\n    //\n    //dependencies:\n    //\n    //\n    //  jQuery          - v1.7.1\n    //  _,              - underscore.js 1.3.1\n    //  Controls,       - controls.components\n    var isIE = browserDetection.isIE();\n\n    // JS-33242\n    var scrollStartStopCallback = (function() {\n        var lastScrollAt = (new Date()).getTime(),\n            scrollTimeout;\n\n        return function() {\n            var now = (new Date()).getTime();\n            var self = this;\n\n            if (now - lastScrollAt > 400) {\n                lastScrollAt = now;\n\n                jQuery(this).trigger(\"scrollstart\");\n            }\n\n            clearTimeout(scrollTimeout);\n\n            scrollTimeout = setTimeout(function(){\n                jQuery(self).trigger(\"scrollstop\");\n            }, 300);\n        }\n    })();\n\n    // ViewModel initialize, updates and adds controls to the DOM\n    var ViewModel = Controls.Base.extend({\n\n        constructor:function (args) {\n            this.containerSelector = (args && args.containerSelector) || Controls.ViewModel.DEFAULT_CONTAINER;\n            this.controls = {};\n\n            //save reference to initialized manager object\n            Controls.getViewModel = _.bind(function () {\n                return this;\n            }, this);\n\n            _.bindAll(this,\n                \"registerEvents\",\n                \"onControlChange\"\n            );\n\n            this.registerEvents();\n        },\n\n        registerEvents : function() {\n            Controls.ignore(\"changed:control\", this.onControlChange);\n            Controls.listen({\n                \"changed:control\":this.onControlChange\n            });\n        },\n\n        /* Listens for controls change and triggers controls update */\n        onControlChange:function (event, options) {\n            const {\n                control,\n                selection\n            } = options;\n\n            const controlInCascade = isControlInCascade(control);\n\n            jQuery(document).trigger(Controls.ViewModel.CHANGE_SELECTION, [\n                control.id,\n                selection,\n                controlInCascade\n            ]);\n\n            if (!controlInCascade) {\n                //TODO: update state before sending it to subscribers\n                jQuery(document).trigger(Controls.ViewModel.CHANGE_VALUES, [this.state]);\n            }\n        }\n    }, {\n        //Static props\n        DEFAULT_CONTAINER: '#inputControlsContainer',\n        CHANGE_VALUES: 'viewmodel:values:changed',\n        CHANGE_SELECTION: 'viewmodel:selection:changed',\n        CHANGE_ORDER: 'viewmodel:order:changed',\n        //check for changes between two objects\n        isSelectionChanged: function (previous, next) {\n            var previousControlIds = previous ? _(previous).keys() : [];\n            var nextControlIds = next ? _(next).keys() : [];\n            var controlsIdUnion = _.union(previousControlIds, nextControlIds);\n            if (controlsIdUnion.length === previousControlIds.length) {\n                var previousFlattenValues = previous ? _.flatten(_(previous).values()) : [];\n                var nextFlattenValues = next ? _.flatten(_(next).values()) : [];\n                return _.difference(previousFlattenValues, nextFlattenValues).length > 0 || _.difference(nextFlattenValues, previousFlattenValues).length > 0;\n            }\n            return true;\n        }\n    });\n\n    var Model = {\n\n        //Get array of all instantiated controls\n        getControls: function () {\n            return this.controls;\n        },\n\n        // Creates instances of all controls. Not adding them to DOM\n        instantiate: function (controlsStructure, options) {\n            this.controls = {};\n\n            const {\n                dataUri,\n                inputControlsService,\n                initialSelectedValues,\n                paginatedValuesOptions,\n            } = options;\n\n            controlsStructure.forEach((controlStructure) => {\n                const controlId = controlStructure.id;\n\n                this.createControl(controlStructure,{\n                    dataUri,\n                    inputControlsService,\n                    initialSelectedValues: initialSelectedValues[controlId] || [],\n                    paginatedValuesOptions: paginatedValuesOptions[controlId] || []\n                });\n            });\n        },\n\n        // Create control and add it to controls but do not add to the DOM\n        createControl: function (controlStructure, options) {\n            // Find instantiated control by it's type\n            var Control = function (type) {\n                for (var property in Controls) {\n                    if (type.toLowerCase() === property.toLowerCase()) {\n                        return Controls[property];\n                    }\n                }\n            }(controlStructure.type);    // Is such control implementation present?\n\n            if (Control) {\n                this.controls[controlStructure.id] = new Control(controlStructure, options);\n            } else {\n                throw new Error('Can not find implementation of the control type: ' + controlStructure.type);\n            }\n            return this.controls[controlStructure.id];\n        },\n\n        // Remove control from state\n        removeControl: function (controlId) {\n            delete this.controls[controlId];\n        },\n\n        // reorders controls in state\n        reorderControl: function (oldIndex, newIndex) {\n            if (this.structure.length == 1) {\n                // nothing to reorder\n                return;\n            }\n\n            var shiftDirection = oldIndex < newIndex ? 1 : -1;\n            var start = oldIndex < newIndex ? Math.min(oldIndex, newIndex) : Math.max(oldIndex, newIndex);\n            var end = oldIndex < newIndex ? Math.max(oldIndex, newIndex) : Math.min(oldIndex, newIndex);\n            var t;\n            for (var i = start; i != end; i = i + shiftDirection) {\n                t = this.structure[i];\n                this.structure[i] = this.structure[i + shiftDirection];\n                this.structure[i + shiftDirection] = t;\n            }\n            jQuery(document).trigger(Controls.ViewModel.CHANGE_ORDER, [this.structure]);\n        },\n\n        // Invoke specific actions according specified attributes\n        set: function (attributes, preventNotification) {\n            if (attributes) {\n                _.extend(this, attributes);\n\n                const {\n                    structure,\n                } = attributes;\n\n                const {\n                    initialSelectedValues,\n                } = attributes.controlsOptions || {};\n\n                if (structure) {\n                    this.instantiate(structure, attributes.controlsOptions);\n                    this.draw(structure);\n                }\n\n                if (initialSelectedValues) {\n                    this.update(initialSelectedValues);\n\n                    !preventNotification && jQuery(document)\n                        .trigger(Controls.ViewModel.CHANGE_VALUES, initialSelectedValues);\n                }\n            }\n        },\n        get: function (attribute) {\n            if (!attribute) {\n                return;\n            }\n            if (attribute === 'selection') {\n                var result = {};\n                _.each(this.getControls(), function (control) {\n                    var selectedData = control.get('selection');    // Should be array of values, so check it.\n                    // Also check if value is undefined then do not pass it to the result array.\n                    // Should be array of values, so check it.\n                    // Also check if value is undefined then do not pass it to the result array.\n                    if (selectedData instanceof Array) {\n                        result[control.id] = result[control.id] = selectedData.length > 0 ? selectedData : control.mandatory ? [] : [RestParamsEnum.NOTHING_SUBSTITUTION_VALUE];\n                    } else if (!_.isUndefined(selectedData)) {\n                        result[control.id] = [selectedData];\n                    }\n\n                });\n                return result;\n            }\n            return this[attribute];\n        },\n        // Find control by specified attribute\n        findControl: function (attribute) {\n            var key = _.keys(attribute)[0];\n            var value = _.values(attribute)[0];\n            return _.find(this.getControls(), function (control) {\n                return control[key] === value;\n            });\n        },\n\n        // Returns specified properties from all controls\n        pluck: function (property) {\n            return _.pluck(this.getControls(), property);\n        }\n    };\n\n    var View = {\n        // Draw structure of all controls. Put them to already selected container\n        draw: function (jsonStructure) {\n            const container = this.getContainer();\n\n            container.empty();\n\n            if (isIE) {\n                // https://jira.tibco.com/browse/JS-32279 - Scroll jumps up on any click inside control aria (item select, title, tab)\n                // Solution is to skip stdnav handling on root container of this component.\n                container.attr('js-stdnav', 'false');\n                container.attr('js-navtype', 'none');\n            }\n\n            jsonStructure.forEach((controlJson) => {\n                if (controlJson.visible) {\n                    const control = this.findControl({ id: controlJson.id });\n\n                    control.render();\n\n                    container.append(control.getElem());\n                }\n            });\n\n            if (window.Report && window.Report.icReorderEnabled) {\n                const horizontalLayout = window.Controls.layouts.LAYOUT_TOP_OF_PAGE === Report.reportControlsLayout;\n\n                if(!(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent))) {\n                    this._initSortable({\n                        container: container,\n                        horizontalLayout: horizontalLayout\n                    });\n                }\n            }\n        },\n\n        // Fill content of all controls\n        update: function (initialSelectedValues) {\n            _.each(initialSelectedValues, (controlSelection, controlId) => {\n                const control = this.findControl({ id: controlId });\n\n                control.set({\n                    values: Array.isArray(controlSelection) ? controlSelection.map(option => option.value) : controlSelection,\n                    error: null\n                });\n            });\n        },\n\n        // Getter for IC container.\n        // Fetch DOM object only once.\n        getContainer: function () {\n            if (this.container && this.container.length == 1) {\n                return this.container;\n            } else {\n                this.container = jQuery(this.containerSelector);\n                return this.container;\n            }\n        },\n\n        // Clear all warning messages\n        removeValidationMessages: function () {\n            _.each(this.getControls(), function (control) {\n                control.set({ error: null });\n            });\n        },\n\n        // check valid\n        areAllControlsValid: function () {\n            return _.isEmpty(_.filter(this.getControls(), function (control) {\n                return !control.isValid();\n            }));\n        },\n        // Setter for IC container.\n        setContainer: function (containerSelector) {\n            this.container = jQuery(containerSelector);\n        },\n\n        // Reload container, used in case when DOM has been changed.\n        reloadContainer: function () {\n            this.container = jQuery(this.containerSelector);\n            return this.container;\n        },\n\n        // Prevent user action on control\n        disable: function () {\n            _.each(this.getControls(), function (control) {\n                control.set({ disabled: true });\n            });\n        },\n\n        // Allow user action on control\n        enable: function () {\n            _.each(this.getControls(), function (control) {\n                control.set({ disabled: false });\n            });\n        },\n\n        _initSortable: function(options) {\n            var container = options.container,\n                horizontalLayout = options.horizontalLayout,\n                keepSortableAlive = false;\n\n            var self = this;\n\n            var sortableContainer = jQuery(container).sortable({\n                delay: 200,\n                placeholder: horizontalLayout ? \"verticalPlaceholder\" : \"horizontalPlaceholder\",\n                axis: horizontalLayout ? \"x\" : \"y\",\n                items: \"> .leaf\",\n                cancel: \"input,textarea,button,select,option,.list.inputSet,.jr-mSizer\",\n                start: function(event, ui) {\n                    ui.item.data('oldIndex', ui.item.index());\n                    keepSortableAlive = true;\n                },\n                stop: _.bind(function(event, ui) {\n                    var oldIndex = ui.item.data('oldIndex');\n                    var newIndex = ui.item.index();\n                    oldIndex != newIndex && this.reorderControl(oldIndex, newIndex);\n                    keepSortableAlive = false;\n                }, this)\n            });\n\n            // JS-33242\n            if (isIE) {\n                var parent = options.parent || sortableContainer.parent();\n\n                parent.off(\"scroll\", scrollStartStopCallback);\n                parent.off(\"scrollstart\");\n                parent.off(\"scrollstop\");\n\n                parent.on(\"scroll\", scrollStartStopCallback);\n\n                parent.on(\"scrollstart\", function () {\n                    if (!keepSortableAlive) {\n                        try {\n                            sortableContainer.sortable(\"destroy\");\n                        } catch (e) {}\n                    }\n                });\n\n                parent.on(\"scrollstop\", function () {\n                    !keepSortableAlive && self._initSortable({\n                        parent: parent,\n                        container: container,\n                        horizontalLayout: horizontalLayout\n                    });\n                });\n            }\n        }\n    };\n    _.extend(ViewModel.prototype, Model, View);\n    return _.extend(Controls, { ViewModel: ViewModel });\n}(jQuery, _, JRS.Controls);\n\nexport default JRS.Controls;\n","export default (\n    control: {\n       // masterDependencies?: string[],\n        slaveDependencies?: string[],\n       // selection?: any\n    }\n) => {\n    const {\n        // masterDependencies,\n        slaveDependencies,\n        // selection\n    } = control;\n\n    // const hasMasterDependencies = masterDependencies ? masterDependencies.length > 0 : false;\n    const hasSlaveDependencies = slaveDependencies ? slaveDependencies.length > 0 : false;\n\n    // return hasMasterDependencies || hasSlaveDependencies;\n    return hasSlaveDependencies;\n};\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nvar listWithNavigationModelTrait = {\n    activate: function (index, options) {\n        if (typeof index !== 'number') {\n            this.setActive(_.extend({}, options));\n            return;\n        }\n        options = options || {};\n        if (index >= this.get('bufferStartIndex') && index <= this.get('bufferEndIndex')) {\n            var item = this.get('items')[index - this.get('bufferStartIndex')];\n            if (item) {\n                this.setActive(_.extend(options, {\n                    index: index,\n                    item: item\n                }));\n            }\n        } else {\n            var that = this;\n            this.getData({\n                offset: index,\n                limit: 1\n            }).done(function (values) {\n                that.setActive(_.extend(options, {\n                    index: index,\n                    item: values.data[0]\n                }));\n            }).fail(this.fetchFailed);\n        }\n    },\n    setActive: function (options) {\n        if (this.active && options.index === this.active.index && options.item.value === this.active.value) {\n            return;\n        }\n        this.active = options && typeof options.index === 'number' ? {\n            index: options.index,\n            value: options.item.value,\n            label: options.item.label\n        } : undefined;\n        if (!options || !options.silent) {\n            this.trigger('change');\n            this.trigger('active:changed', this.active);\n        }\n    },\n    getActive: function () {\n        return this.active;\n    }\n};\nexport default listWithNavigationModelTrait;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nvar DEFAULT_KEY_DOWN_TIMEOUT = 200;\nvar KeyboardManager = function (options) {\n    this.initialize(options);\n    return this;\n};\n_.extend(KeyboardManager.prototype, {\n    systemKeyCodes: [\n        16,\n        17,\n        18,\n        91\n    ],\n    keydownHandlers: {\n        '38': 'onUpKey',\n        '40': 'onDownKey',\n        '13': 'onEnterKey',\n        '27': 'onEscKey',\n        '36': 'onHomeKey',\n        '35': 'onEndKey',\n        '9': 'onTabKey',\n        '33': 'onPageUpKey',\n        '34': 'onPageDownKey'\n    },\n    preventKeydownHandlers:{\n        '33': 'onPageUpKey',\n        '34': 'onPageDownKey'\n    },\n    initialize: function (options) {\n        _.bindAll(this, 'onKeydown');\n        if (options.keydownHandlers) {\n            this.keydownHandlers = options.keydownHandlers;\n        }\n        this.stopPropagation = options.stopPropagation;\n        this.keydownTimeout = options.keydownTimeout || DEFAULT_KEY_DOWN_TIMEOUT;\n        this.context = options.context;\n        this.deferredKeydownHandler = options.deferredKeydownHandler;\n        this.immediateHandleCondition = options.immediateHandleCondition;\n        this.immediateKeydownHandler = options.immediateKeydownHandler;\n    },\n    onKeydown: function (event) {\n        if (this._isSystemKeyPressed(event)) {\n            return;\n        } else if (this._canImmediatelyHandleKeyboardEvent(event)) {\n            this._immediatelyHandleKeyboardEvent(event);\n        } else {\n            this.deferredHandleKeyboardEvent(event);\n        }\n        if (this.stopPropagation) {\n            event.stopPropagation();\n        }\n    },\n    deferredHandleKeyboardEvent: function (event) {\n        if (this.deferredKeydownHandler) {\n            if (this.keydownTimeout > 0) {\n                clearTimeout(this.deferredTimeout);\n                this.deferredTimeout = setTimeout(_.bind(this.deferredKeydownHandler, this.context, event), this.keydownTimeout);\n            } else {\n                this.deferredKeydownHandler.call(this.context, event);\n            }\n        }\n    },\n    _isSystemKeyPressed: function (event) {\n        return _.indexOf(this.systemKeyCodes, event.which) > -1;\n    },\n    _immediateHandleCondition: function (event) {\n        return this.immediateHandleCondition && this.immediateHandleCondition.call(this.context, event);\n    },\n    _canImmediatelyHandleKeyboardEvent: function (event) {\n        var keydownHandler = this.keydownHandlers['' + event.which];\n        return keydownHandler && typeof this.context[keydownHandler] === 'function' || this._immediateHandleCondition(event);\n    },\n    _immediatelyHandleKeyboardEvent: function (event) {\n        var keydownHandler = this.keydownHandlers['' + event.which];\n        if (keydownHandler && typeof this.context[keydownHandler] === 'function') {\n            this.context[keydownHandler].call(this.context, event);\n            this._immediatePreventdefaultHandler(event);\n        } else if (this._immediateHandleCondition(event)) {\n            this.immediateKeydownHandler && this.immediateKeydownHandler.call(this.context, event);\n        }\n    },\n    _immediatePreventdefaultHandler:function(event){\n        if(this.preventKeydownHandlers['' + event.which]){\n            event.preventDefault();\n        }\n    }\n});\nexport default KeyboardManager;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport ListWithSelectionModel from '../../scalableList/model/ListWithSelectionModel';\nimport listWithNavigationModelTrait from '../../scalableList/model/listWithNavigationModelTrait';\nvar SingleSelectListModel = ListWithSelectionModel.extend(listWithNavigationModelTrait);\nSingleSelectListModel = SingleSelectListModel.extend({\n    setActive: function (options) {\n        listWithNavigationModelTrait.setActive.call(this, _.extend(options, { silent: true }));\n        var selection = {};\n        if (typeof options.index === 'number') {\n            selection[options.index] = options.item.value;\n        }\n        this.select(selection);\n    },\n    _convertInitialArrayToSelection: function (data, pendingSelection, options) {\n        for (var i = 0; i < data.length; i++) {\n            if (pendingSelection[data[i].value]) {\n                this._addToSelection(data[i].value, i);\n                if (!this.getActive()) {\n                    listWithNavigationModelTrait.setActive.call(this, {\n                        index: i,\n                        item: data[i],\n                        silent: true\n                    });\n                }\n            }\n        }\n        this._triggerSelectionChange(options);\n    },\n    _convertSelectionObject: function (selection) {\n        for (var index in selection) {\n            if (selection.hasOwnProperty(index) && selection[index] !== undefined) {\n                var value = selection[index];\n                return {\n                    index: parseInt(index, 10),\n                    value: value\n                };\n            }\n        }\n    },\n    _select: ListWithSelectionModel.prototype.select,\n    select: function (selection, options) {\n        var convertedSelection;\n        var shouldFetchLabel = false;\n        if (!selection || typeof selection === 'string' || _.isArray(selection)) {\n            listWithNavigationModelTrait.setActive.call(this, { silent: true });\n        } else {\n            convertedSelection = this._convertSelectionObject(selection);\n            if (!convertedSelection) {\n                listWithNavigationModelTrait.setActive.call(this, { silent: true });\n            } else {\n                var active = this.getActive();\n                if (!active || convertedSelection.value !== active.value || convertedSelection.index !== active.index) {\n                    shouldFetchLabel = true;\n                }\n            }\n        }\n        if (shouldFetchLabel) {\n            this.activate(convertedSelection.index);\n        } else {\n            this._select(selection, options);\n        }\n        return this;\n    }\n});\nexport default SingleSelectListModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport ScalableListModel from '../model/ScalableListModel';\nimport defaultChunksTemplate from '../templates/viewPortChunksTemplate.htm';\nimport defaultItemsTemplate from '../templates/itemsTemplate.htm';\nvar DEFAULT_VIEW_PORT_CHUNK_HEIGHT = 1000000;\nvar DEFAULT_SCROLL_TIMEOUT = 50;\nvar DEFAULT_MANUAL_SCROLL_INTERVAL = 50;\nvar DEFAULT_LIST_ITEM_HEIGHT = 21;\nvar MIN_ITEM_HEIGHT_TRESHOLD = 2;\nvar ScalableList = Backbone.View.extend({\n    ListModel: ScalableListModel,\n    listItemSelector: 'li',\n    events: {\n        'scroll': 'onScroll',\n        'touchmove': 'onScroll'\n    },\n    attributes: { 'style': 'overflow-y: auto; height: 100px; min-height: 100px;' },\n    initialize: function (options) {\n        _.bindAll(this, '_fetchVisibleData');\n        this.model = options.model || new this.ListModel(options);\n        this.chunksTemplate = _.template(options.chunksTemplate || defaultChunksTemplate);\n        this.itemsTemplate = _.template(options.itemsTemplate || defaultItemsTemplate);\n        this.defaultChunkHeight = this.chunkHeight = options.chunkHeight || DEFAULT_VIEW_PORT_CHUNK_HEIGHT;\n        this.scrollTimeout = typeof options.scrollTimeout !== 'undefined' ? options.scrollTimeout : DEFAULT_SCROLL_TIMEOUT;\n        this.manualScrollInterval = options.manualScrollInterval || DEFAULT_MANUAL_SCROLL_INTERVAL;\n        this.lazy = options.lazy;\n        this.defaultItemHeight = options.listItemHeight || DEFAULT_LIST_ITEM_HEIGHT;\n        this.listItemSelector = options.listItemSelector || this.listItemSelector;\n        this.render();\n        this.initListeners();\n        if (!this.lazy) {\n            this.model.fetch();\n        }\n        return this;\n    },\n    initListeners: function () {\n        this.listenTo(this.model, 'change', this.onModelChange, this);\n        this.listenTo(this.model, 'fetchFailed', this.onFetchFailed, this);\n    },\n    render: function () {\n        return this;\n    },\n    onScroll: function (event) {\n        if (this.scrollTimeout > 0) {\n            clearTimeout(this.scrollTimer);\n            this.scrollTimer = setTimeout(this._fetchVisibleData, this.scrollTimeout);\n        } else {\n            this._fetchVisibleData();\n        }\n        this.scrollPos = event && event.target && event.target.scrollTop;\n    },\n    restoreScrollPos: function () {\n        this.$el.scrollTop(this.scrollPos);\n    },\n    onModelChange: function () {\n        this.renderData();\n    },\n    onFetchFailed: function (responseStatus, error) {\n        this.trigger('listRenderError', responseStatus, error);\n    },\n    postProcessChunkModelItem: function (item, i) {\n        item.index = this.model.get('bufferStartIndex') + i;\n        if (item.label === undefined) {\n            item.label = item.value;\n        }\n        item.label = $.trim(item.label);\n    },\n    _renderItems: function () {\n        var bufferStart = this.model.get('bufferStartIndex');\n        var bufferEnd = this.model.get('bufferEndIndex');\n        var firstChunkWithData = this.itemsPerChunk ? Math.ceil((bufferStart + 1) / this.itemsPerChunk) : 1;\n        var lastChunkWithData = this.itemsPerChunk ? Math.ceil((bufferEnd + 1) / this.itemsPerChunk) : 1;\n        var that = this;\n        this.$el.find('.jr-jViewPortChunk').each(function (index, chunk) {\n            var $chunk = $(chunk);\n            var chunkModel = that._getChunkModel({\n                index: index + 1,\n                firstChunkWithData: firstChunkWithData,\n                lastChunkWithData: lastChunkWithData,\n                bufferStart: bufferStart,\n                bufferEnd: bufferEnd,\n                total: that.totalItems,\n                itemsPerChunk: that.itemsPerChunk,\n                itemHeight: that.itemHeight,\n                chunkHeight: that.chunkHeight,\n                model: that.model\n            });\n            var chunkHtml = chunkModel ? that.itemsTemplate(chunkModel) : '';\n            var child = chunk.children[0];\n            child && chunk.removeChild(child);\n            $chunk.append(chunkHtml);\n        });\n    },\n    _renderViewChunks: function (force) {\n        var self = this, childChunks;\n        if (this.totalItems !== this.model.get('total') || force) {\n            this.totalItems = this.model.get('total');\n            childChunks = Array.prototype.slice.call(this.$el[0].children);\n            childChunks.forEach(function (chunk) {\n                self.$el[0].removeChild(chunk);\n            });\n            this.$el.append(this.chunksTemplate({\n                _: _,\n                chunks: this._getViewChunksModel()\n            }));\n            this.$firstViewChunk = this.$el.find('.jr-jViewPortChunk:first');\n        }\n    },\n    _getViewChunksModel: function () {\n        var totalChunksToShow = this.itemsPerChunk ? Math.ceil(this.totalItems / this.itemsPerChunk) : 1;\n        var lastChunkHeight = totalChunksToShow > 0 ? this.itemHeight ? this.totalItems * this.itemHeight - (totalChunksToShow - 1) * this.chunkHeight : this.chunkHeight : 1;\n        var viewChunks = [];\n        for (var i = 1; i < totalChunksToShow; i++) {\n            viewChunks.push({ height: this.chunkHeight });\n        }\n        viewChunks.push({ height: lastChunkHeight });\n        return viewChunks;\n    },\n    _calcViewPortConstants: function () {\n        if (!this.viewPortConstantsInitialized) {\n            this.itemHeight = this.defaultItemHeight;\n            if (this.$firstViewChunk) {\n                this.itemHeight = this.$el.find(this.listItemSelector + ':first').outerHeight(true);\n                if (!this.itemHeight || this.itemHeight <= MIN_ITEM_HEIGHT_TRESHOLD) {\n                    this.itemHeight = this.defaultItemHeight;\n                    this.viewPortConstantsInitialized = false;\n                } else {\n                    this.viewPortConstantsInitialized = true;\n                }\n            }\n            this._calcViewPortHeight();\n            this.itemsPerChunk = Math.floor(this.defaultChunkHeight / this.itemHeight);\n            this.chunkHeight = this.itemsPerChunk * this.itemHeight;\n            this._renderViewChunks(true);\n            this._renderItems();\n        }\n    },\n    resizeViewPort: function (viewPortHeight) {\n        this.viewPortHeight = viewPortHeight;\n        this.$el.outerHeight(this.viewPortHeight);\n        this.itemsPerView = Math.floor(this.viewPortHeight / this.itemHeight) - 1;\n        this.itemsPerChunk = Math.floor(this.defaultChunkHeight / this.itemHeight);\n        this.chunkHeight = this.itemsPerChunk * this.itemHeight;\n        this._renderViewChunks(true);\n        this._renderItems();\n    },\n    _calcViewPortHeight: function () {\n        this.viewPortHeight = this.$el.height();\n        this.itemsPerView = Math.floor(this.viewPortHeight / this.itemHeight) - 1;\n    },\n    _getItemsPerView: function () {\n        this._calcViewPortConstants();\n        return this.itemsPerView;\n    },\n    _getChunkModel: function (options) {\n        var index = options.index;\n        if (index < options.firstChunkWithData || index > options.lastChunkWithData) {\n            return null;\n        }\n        var firstItemForChunk = options.itemsPerChunk ? Math.max(options.bufferStart, options.itemsPerChunk * (index - 1)) : options.bufferStart;\n        var lastItemForChunk = options.itemsPerChunk ? Math.min(options.bufferEnd, options.itemsPerChunk * index - 1) : options.bufferEnd;\n        var top = options.itemHeight ? firstItemForChunk * options.itemHeight - (index - 1) * options.chunkHeight : 0;\n        var items = Array.prototype.slice.call(options.model.get('items'), firstItemForChunk - options.bufferStart, lastItemForChunk - options.bufferStart + 1);\n        _.each(items, function (item, i) {\n            this.postProcessChunkModelItem(item, i + (firstItemForChunk - options.bufferStart));\n        }, this);\n        return {\n            top: top,\n            items: items\n        };\n    },\n    _fetchVisibleData: function () {\n        var visibleItems = this._getVisibleItems();\n        this.model.fetch({\n            top: visibleItems.top,\n            bottom: visibleItems.bottom\n        });\n    },\n    _getVisibleItems: function () {\n        var scrollPos = this._getScrollPos();\n        var total = this.model.get('total');\n        var topVisibleItem = Math.min(total - this.itemsPerView, Math.floor(scrollPos / this.itemHeight));\n        var bottomVisibleItem = Math.min(total - 1, topVisibleItem + this.itemsPerView + 1);\n        return {\n            top: topVisibleItem,\n            bottom: bottomVisibleItem\n        };\n    },\n    _getScrollPos: function () {\n        this._calcViewPortConstants();\n        var scrollPos = 0;\n        if (this.$firstViewChunk) {\n            var elOffset = this.$el.offset();\n            var viewChunkOffset = this.$firstViewChunk.offset();\n            if (elOffset && viewChunkOffset) {\n                scrollPos = elOffset.top - viewChunkOffset.top;\n            }\n        }\n        return scrollPos;\n    },\n    renderData: function () {\n        if (this.lazy || !this.model.has('bufferStartIndex') || !this.model.has('bufferEndIndex')) {\n            this.lazy = null;\n            this.model.fetch();\n        } else {\n            this.trigger('before:render:data');\n            this._renderViewChunks();\n            this._renderItems();\n            this._calcViewPortConstants();\n            this.trigger('render:data');\n        }\n        return this;\n    },\n    resize: function () {\n        if (!this.$el.is(':visible')) {\n            return;\n        }\n        var componentHeight = this.$el.outerHeight();\n        if (componentHeight === this._componentHeight) {\n            return;\n        } else {\n            this._componentHeight = componentHeight;\n        }\n        this.viewPortConstantsInitialized = false;\n        this._calcViewPortConstants();\n    },\n    fetch: function (callback, options) {\n        this.lazy = false;\n        options = options || {};\n        var scrollPos;\n        if (options.keepPosition) {\n            scrollPos = this.$el.get(0).scrollTop;\n        } else {\n            this.reset({\n                silent: true,\n                lazy: false\n            });\n        }\n        this.model.once('change', function () {\n            if (options.keepPosition) {\n                this.$el.scrollTop(scrollPos);\n            }\n            callback && callback.apply(this, arguments);\n        }, this).fetch({ force: true });\n    },\n    reset: function (options) {\n        options = _.defaults(options || {}, { lazy: true });\n        this.$el.scrollTop(0);\n        this.lazy = options.lazy;\n        this.model.reset(options);\n    },\n    scrollTo: function (index) {\n        if (typeof index !== 'number') {\n            return;\n        }\n        var scrollPos = this._getScrollPos();\n        if (!this.viewPortConstantsInitialized) {\n            return;\n        }\n        this._calcViewPortHeight();\n        var newTopVisibleItemPos = null;\n        var itemPos = index * this.itemHeight;\n        if (itemPos < scrollPos) {\n            newTopVisibleItemPos = itemPos;\n        } else if (itemPos + this.itemHeight > scrollPos + this.viewPortHeight) {\n            newTopVisibleItemPos = itemPos + this.itemHeight - this.viewPortHeight;\n        }\n        if (newTopVisibleItemPos !== null) {\n            this.$el.scrollTop(newTopVisibleItemPos);\n        }\n    }\n});\nexport default ScalableList;","export default \"{{_.each(chunks, function(chunk) { }}\\n<div class=\\\"jr-jViewPortChunk\\\" style=\\\"height: {{- chunk.height}}px\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\\n{{ }); }}\\n\";","export default \"<ul class=\\\"jr-mSelectlist jr\\\" style=\\\"top: {{- top}}px; position: relative;\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{_.each(items, function(item) { }}\\n    <li class=\\\"jr-mSelectlist-item {{ if (item.selected) print('jr-isSelected'); }} {{ if (item.active) print(' jr-isHovered'); }} jr\\\" title=\\\"{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}\\\" data-index=\\\"{{- item.index}}\\\">\\n        <div class=\\\"jr-mSelectlist-item-wrapper jr\\\">\\n            <a class=\\\"jr-mSelectlist-item-text jr\\\">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}</a>\\n        </div>\\n    </li>\\n    {{ }); }}\\n</ul>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport ListWithSelectionModel from '../model/ListWithSelectionModel';\nimport ScalableList from './ScalableList';\nvar MOUSE_MOVE_MIN_PIXELS = 1;\nvar BUTTONS = {\n    LEFT: 'left',\n    RIGHT: 'right'\n};\nvar ListWithSelection = ScalableList.extend({\n    ListModel: ListWithSelectionModel,\n    initialize: function (options) {\n        _.bindAll(this, 'onGlobalMouseup', 'onGlobalMousemove', '_autoScroll', 'fetch');\n        this.eventListenerPattern = options.eventListenerPattern || 'li';\n        this.markerClass = options.markerClass ? options.markerClass : '';\n        this.selectedClass = options.selectedClass ? options.selectedClass : 'jr-isSelected';\n        this._initSelection(options.selection);\n        return ScalableList.prototype.initialize.call(this, options);\n    },\n    delegateEvents: function () {\n        var res = ScalableList.prototype.delegateEvents.apply(this, arguments);\n        this.$el.on('mousedown', this.eventListenerPattern, _.bind(this.onMousedown, this)).on('mousemove', this.eventListenerPattern, _.bind(this.onMousemove, this)).on('dblclick', this.eventListenerPattern, _.bind(this.onMousedblclick, this)).on('contextmenu', this.eventListenerPattern, _.bind(this.onItemEvent, this, this.$el)).on('click', this.eventListenerPattern, _.bind(this.onItemEvent, this, this.$el)).on('mouseout', this.eventListenerPattern, _.bind(this.onItemEvent, this, this.$el)).on('mouseover', this.eventListenerPattern, _.bind(this.onItemEvent, this, this.$el));\n        return res;\n    },\n    undelegateEvents: function () {\n        var res = ScalableList.prototype.undelegateEvents.apply(this, arguments);\n        this.$el.off('mouseup').off('mousedown').off('mousemove').off('dblclick').off('contextmenu').off('click').off('mouseout').off('mouseover');\n        return res;\n    },\n    _initSelection: function (selection) {\n        selection = _.extend({ allowed: {} }, selection);\n        var selectionAllowed = selection.allowed ?? {}, leftButtonSelection = !_.isObject(selectionAllowed) ? selectionAllowed : selectionAllowed.left;\n        this.selection = {\n            allowed: {\n                left: typeof leftButtonSelection !== 'undefined' ? leftButtonSelection : true,\n                right: typeof selectionAllowed.right !== 'undefined' ? selectionAllowed.right : false\n            },\n            multiple: typeof selection.multiple !== 'undefined' ? selection.multiple : true\n        };\n    },\n    initListeners: function () {\n        ScalableList.prototype.initListeners.call(this);\n        this.listenTo(this.model, 'selection:clear', this.clearSelection, this);\n        this.listenTo(this.model, 'selection:add', this.selectValue, this);\n        this.listenTo(this.model, 'selection:addRange', this.selectRange, this);\n        this.listenTo(this.model, 'selection:remove', this.deselectValue, this);\n        $('body').on('mouseup', this.onGlobalMouseup).on('mousemove', this.onGlobalMousemove);\n    },\n    postProcessChunkModelItem: function (item, i) {\n        ScalableList.prototype.postProcessChunkModelItem.call(this, item, i);\n        item.selected = this.model.selectionContains && this.model.selectionContains(item.value, item.index);\n    },\n    onMousedblclick: function (event) {\n        if (!this.selection.multiple) {\n            if ((this.selection.allowed.left || this.selection.allowed.right) && !this.getDisabled()) {\n                var itemData = this._getDomItemData(event.currentTarget);\n                this._singleSelect(event, itemData.value, itemData.index);\n                if (this.selectionChanged) {\n                    this._triggerSelectionChanged();\n                    this._triggerDblclicked();\n                    this.selectionChanged = false;\n                }\n            }\n        }\n    },\n    getItemByEvent: function (e) {\n        return this._getDomItemData(e.currentTarget).item;\n    },\n    onItemEvent: function (element, e) {\n        var eventType = e.type, item = this.getItemByEvent(e);\n        this.trigger('list:item:' + eventType, item, e);\n    },\n    onMousedown: function (event) {\n        if (!this.getDisabled() && (this.selection.allowed.left && event.which === 1 || this.selection.allowed.right && event.which === 3)) {\n            var buttonType = event.which === 1 ? BUTTONS.LEFT : BUTTONS.RIGHT;\n            if (this.selection.multiple) {\n                this[buttonType + 'MouseButtonPressed'] = true;\n                this.mouseDownPos = this._getMousePos(event);\n            }\n            var itemData = this._getDomItemData(event.currentTarget);\n            this.selection.multiple ? this._multiSelect(event, itemData.value, itemData.index) : this._singleSelect(event, itemData.value, itemData.index);\n        }\n    },\n    onMousemove: function (event) {\n        if (this._allowMouseMoveSelection()) {\n            this._stopAutoScroll();\n            if (this._mouseMoved(event, this.mouseDownPos)) {\n                this.mouseDownPos = this._getMousePos(event);\n                var itemData = this._getDomItemData(event.currentTarget);\n                if (!this.model.selectionContains(itemData.value, itemData.index)) {\n                    this.model.addRangeToSelection(itemData.value, itemData.index);\n                }\n            }\n        }\n    },\n    onGlobalMouseup: function (event) {\n        var self = this;\n        if (this.leftMouseButtonPressed || this.rightMouseButtonPressed) {\n            _.each(BUTTONS, function (buttonType) {\n                self[buttonType + 'MouseButtonPressed'] = false;\n            });\n            delete this.mouseDownPos;\n            this._stopAutoScroll();\n            if (this.selectionChanged) {\n                this._triggerSelectionChanged();\n                this.selectionChanged = false;\n            }\n        }\n    },\n    onGlobalMousemove: function (event) {\n        if (this._allowMouseMoveSelection()) {\n            this.mousePosY = event.clientY;\n            if (!this.scrollInterval) {\n                this.scrollInterval = setInterval(this._autoScroll, this.manualScrollInterval);\n            }\n        }\n    },\n    clearSelection: function () {\n        this.$el.find('li.' + this.selectedClass + this.markerClass).removeClass(this.selectedClass);\n        this.selectionChanged = true;\n    },\n    selectValue: function (selection) {\n        this._selectItemByIndex(selection.index);\n        if (this.selection.multiple) {\n            this.selectionChanged = true;\n        } else {\n            this._triggerSelectionChanged();\n        }\n    },\n    selectRange: function (options) {\n        var self = this;\n        var visibleRangeStart = Math.max(this.model.get('bufferStartIndex'), options.start);\n        var visibleRangeEnd = Math.min(this.model.get('bufferEndIndex'), options.end);\n        this.$el.find('li' + this.markerClass + ':not(.' + this.selectedClass + ')').each(function () {\n            var $item = $(this);\n            var index = parseInt($item.attr('data-index'), 10);\n            if (index >= visibleRangeStart && index <= visibleRangeEnd) {\n                var item = self.model.get('items')[index - self.model.get('bufferStartIndex')];\n                if (self.model.selectionContains(item && item.value, index)) {\n                    $item.addClass(self.selectedClass);\n                }\n            }\n        });\n        this.selectionChanged = true;\n    },\n    deselectValue: function (selection) {\n        this._deselectItemByIndex(selection.index);\n        if (this.selection.multiple) {\n            this.selectionChanged = true;\n        } else {\n            this._triggerSelectionChanged();\n        }\n    },\n    _selectItemByIndex: function (index) {\n        this.$el.find('li' + this.markerClass + '[data-index=\\'' + index + '\\']:not(.' + this.selectedClass + ')').addClass(this.selectedClass);\n    },\n    _deselectItemByIndex: function (index) {\n        this.$el.find('li[data-index=\\'' + index + '\\'].' + this.selectedClass + this.markerClass).removeClass(this.selectedClass);\n    },\n    _autoScroll: function () {\n        var viewPortTop = this.$el.offset().top;\n        var scrollTop = this.$el.scrollTop();\n        var scrollPos = typeof this.scrollTop !== 'undefined' ? this.scrollTop : scrollTop;\n        var newScrollPos;\n        var shouldScroll = false;\n        if (this.mousePosY < viewPortTop) {\n            newScrollPos = scrollPos - this.itemHeight * 3;\n            shouldScroll = newScrollPos < scrollTop;\n        } else if (this.mousePosY > viewPortTop + this.viewPortHeight) {\n            newScrollPos = scrollPos + this.itemHeight * 3;\n            shouldScroll = newScrollPos > scrollTop;\n        }\n        if (shouldScroll) {\n            this.$el.scrollTop(newScrollPos);\n            this.scrollTop = this.$el.scrollTop();\n            this._fetchVisibleData();\n        }\n        this._selectRangeOnAutoScroll(scrollPos, newScrollPos);\n    },\n    _selectRangeOnAutoScroll: function (oldScrollPos, newScrollPos) {\n        var index;\n        if (oldScrollPos < newScrollPos) {\n            index = this._getVisibleItems().bottom;\n        } else if (oldScrollPos > newScrollPos) {\n            index = this._getVisibleItems().top;\n        }\n        if (index) {\n            var item = this.model.get('items')[index - this.model.get('bufferStartIndex')];\n            if (item) {\n                if (!this.model.selectionContains(item.value, index)) {\n                    this.model.addRangeToSelection(item.value, index);\n                }\n            }\n        }\n    },\n    _stopAutoScroll: function () {\n        if (this.scrollInterval) {\n            clearInterval(this.scrollInterval);\n            this.scrollInterval = undefined;\n            this.scrollTop = undefined;\n        }\n    },\n    _multiSelect: function (event, value, index) {\n        if (event.shiftKey) {\n            this.model.addRangeToSelection(value, index);\n        } else if (event.ctrlKey || event.metaKey) {\n            this._singleSelect(event, value, index);\n        } else {\n            this.model.toggleSelection(value, index);\n        }\n    },\n    _singleSelect: function (event, value, index) {\n        this.model.clearSelection().addValueToSelection(value, index);\n    },\n    _triggerSelectionChanged: function () {\n        this.trigger('selection:change', this.getValue());\n    },\n    _triggerDblclicked: function () {\n        this.trigger('item:dblclick', this.getValue());\n    },\n    _getDomItemData: function (item) {\n        var $item = $(item);\n        var index = $item.attr('data-index');\n        while (index === undefined) {\n            $item = $item.parent();\n            index = $item.attr('data-index');\n        }\n        index = parseInt(index, 10);\n        var modelItem = this.model.get('items')[index - this.model.get('bufferStartIndex')];\n        return {\n            item: modelItem,\n            value: modelItem && modelItem.value,\n            index: index\n        };\n    },\n    _mouseMoved: function (event, mousePos) {\n        return Math.abs(mousePos.x - event.clientX) + Math.abs(mousePos.y - event.clientY) >= MOUSE_MOVE_MIN_PIXELS;\n    },\n    _getMousePos: function (event) {\n        return {\n            x: event.clientX,\n            y: event.clientY\n        };\n    },\n    _allowMouseMoveSelection: function () {\n        return (this.selection.allowed.left && this.leftMouseButtonPressed || this.selection.allowed.right && this.rightMouseButtonPressed) && this.selection.multiple && !this.getDisabled();\n    },\n    getValue: function () {\n        return this.model.getSelection();\n    },\n    setValue: function (selection, options) {\n        options = options || {};\n        if (!options.silent && (!options.modelOptions || !options.modelOptions.silent)) {\n            this.model.once('selection:change', this._triggerSelectionChanged, this);\n        }\n        options = options.modelOptions;\n        this.model.select(selection, options);\n        return this;\n    },\n    selectAll: function (options) {\n        if (!options || !options.silent) {\n            this.model.once('selection:change', this._triggerSelectionChanged, this);\n        }\n        this.model.selectAll();\n        return this;\n    },\n    selectNone: function (options) {\n        return this.setValue({}, options);\n    },\n    invertSelection: function (options) {\n        if (!options || !options.silent) {\n            this.model.once('selection:change', this._triggerSelectionChanged, this);\n        }\n        this.model.invertSelection();\n        return this;\n    },\n    setDisabled: function (disabled) {\n        this.disabled = disabled;\n        this.disabled ? this.$el.addClass('disabled') : this.$el.removeClass('disabled');\n        return this;\n    },\n    getDisabled: function () {\n        return this.disabled;\n    },\n    remove: function () {\n        $('body').off('mouseup', this.onGlobalMouseup).off('mousemove', this.onGlobalMousemove);\n        return ScalableList.prototype.remove.call(this);\n    }\n});\nexport default ListWithSelection;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport ListWithSelection from './ListWithSelection';\nimport ListWithSelectionModel from '../model/ListWithSelectionModel';\nimport listWithNavigationModelTrait from '../model/listWithNavigationModelTrait';\nvar ListWithNavigation = ListWithSelection.extend({\n    canActivate: true,\n    initialize: function (options) {\n        options = options || {};\n        var ListWithNavigationModel = ListWithSelectionModel.extend(listWithNavigationModelTrait);\n        options.model = options.model || new ListWithNavigationModel(options);\n        ListWithSelection.prototype.initialize.call(this, options);\n    },\n    onMousemove: function (event) {\n        ListWithSelection.prototype.onMousemove.call(this, event);\n        if (!this.mouseMovePos || this._mouseMoved(event, this.mouseMovePos)) {\n            this.mouseMovePos = this._getMousePos(event);\n            var itemData = this._getDomItemData(event.currentTarget);\n            this.activate(itemData.index);\n        }\n    },\n    setCanActivate: function (canActivate) {\n        this.canActivate = canActivate;\n    },\n    getCanActivate: function () {\n        return this.canActivate && !this.getDisabled();\n    },\n    activateFirst: function () {\n        this.activate(0);\n    },\n    activateLast: function () {\n        this.activate(Math.max(0, this.model.get('total') - 1));\n    },\n    activateNext: function () {\n        this.activate(Math.min(this.model.get('total') - 1, this._getActiveIndex() + 1));\n    },\n    activatePrevious: function () {\n        this.activate(Math.max(0, this._getActiveIndex() - 1));\n    },\n    pageDown: function () {\n        this.activate(Math.min(this.model.get('total') - 1, this._getActiveIndex() + this._getItemsPerView()));\n    },\n    pageUp: function () {\n        this.activate(Math.max(0, this._getActiveIndex() - this._getItemsPerView()));\n    },\n    getActiveValue: function () {\n        return this.model.getActive && this.model.getActive();\n    },\n    activate: function (index, options) {\n        if (this.getCanActivate()) {\n            var active = this.getActiveValue();\n            if (active && active.index === index) {\n                return;\n            }\n            if (!options || !options.silent) {\n                var that = this;\n                this.model.once('active:changed', function () {\n                    that.trigger('active:changed', that.getActiveValue());\n                });\n            }\n            this.model.activate(index, options);\n        }\n    },\n    postProcessChunkModelItem: function (item, i) {\n        ListWithSelection.prototype.postProcessChunkModelItem.call(this, item, i);\n        var activeIndex = this._getActiveIndex && this._getActiveIndex();\n        item.active = typeof activeIndex !== 'undefined' && activeIndex === this.model.get('bufferStartIndex') + i;\n    },\n    _getActiveIndex: function () {\n        var active = this.getActiveValue();\n        return active && active.index;\n    }\n});\nexport default ListWithNavigation;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport SingleSelectListModel from '../model/SingleSelectListModel';\nimport ListWithNavigation from '../../scalableList/view/ListWithNavigation';\nvar SingleSelectList = ListWithNavigation.extend({\n    events: _.extend({}, ListWithNavigation.prototype.events, { 'mouseup li': 'onMouseup' }),\n    initialize: function (options) {\n        var model = options.model || new SingleSelectListModel(options);\n        ListWithNavigation.prototype.initialize.call(this, _.extend({\n            model: model,\n            lazy: true,\n            selection: {\n                allowed: true,\n                multiple: false\n            }\n        }, options));\n    },\n    onMouseup: function () {\n        this.trigger('item:mouseup');\n    },\n    activate: function (index) {\n        if (this.getCanActivate()) {\n            var active = this.getActiveValue();\n            if (active && active.index === index) {\n                return;\n            }\n            this.model.once('selection:change', this._triggerSelectionChanged, this).activate(index);\n        }\n    }\n});\nexport default SingleSelectList;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nvar SearcheableDataProvider = function (options) {\n    _.bindAll(this, 'getData', '_filterValues', '_shouldFilter');\n    this.indexMapping = {};\n    this.internalGetData = options.getData;\n};\n_.extend(SearcheableDataProvider.prototype, {\n    getData: function (options) {\n        var deferred = new $.Deferred();\n        if (options && typeof options.criteria !== 'undefined') {\n            this.dataCache = null;\n            this.criteria = options.criteria;\n            deferred.resolve();\n            return deferred.promise();\n        }\n        let that = this;\n\n        if (that._shouldFilter()) {\n            if (this.dataCache) {\n                this._resolvePromise(options, deferred);\n            } else {\n                this.internalGetData().done(function (values) {\n                    that.indexMapping = {};\n                    that.reverseIndexMapping = {};\n                    that.dataCache = that._filterValues(values.data);\n                    that._resolvePromise(options, deferred);\n                }).fail(deferred.reject);\n            }\n            return deferred.promise();\n        } else {\n            this.indexMapping = null;\n            this.reverseIndexMapping = null;\n            this.dataCache = null;\n            return this.internalGetData(options);\n        }\n    },\n    getIndexMapping: function () {\n        return this.indexMapping;\n    },\n    getReverseIndexMapping: function () {\n        return this.reverseIndexMapping;\n    },\n    _resolvePromise: function (options, deferred) {\n        var first = options && options.offset ? options.offset : 0;\n        var last = options && options.limit ? first + options.limit : this.dataCache.length;\n        var dataSegment = this._getDataSegment(this.dataCache, first, last);\n        deferred.resolve({\n            data: dataSegment,\n            total: this.dataCache.length\n        });\n    },\n    _shouldFilter: function () {\n        return this.criteria;\n    },\n    _filterValues: function (data) {\n        var filteredData = [];\n        var j = 0;\n        for (var i = 0; i < data.length; i++) {\n            var value = data[i];\n            var searchIn = value.label === undefined ? value.value : value.label;\n            if (searchIn.toLowerCase().indexOf(this.criteria.toLowerCase()) > -1) {\n                filteredData[j] = value;\n                this.indexMapping[j] = i;\n                this.reverseIndexMapping[i] = j;\n                j += 1;\n            }\n        }\n        return filteredData;\n    },\n    _getDataSegment: function (values, first, last) {\n        last = Math.min(last, values.length);\n        var result = [];\n        for (var i = first; i < last; i++) {\n            result.push({\n                label: values[i].label,\n                value: values[i].value\n            });\n        }\n        return result;\n    }\n});\nexport default SearcheableDataProvider;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport $ from 'jquery';\nvar RECALC_DROP_DOWN_POS_INTERVAL = 500;\nvar $body = $('body');\nvar DropDownManager = function (options) {\n    this.initialize(options);\n    return this;\n};\n_.extend(DropDownManager.prototype, {\n    initialize: function (options) {\n        _.bindAll(this, 'checkOffset', 'setNewOffset');\n        this.$dropDownEl = options.dropDownEl;\n        this.calcOffset = options.calcOffset;\n        this.isOffsetChanged = options.isOffsetChanged || this._isOffsetChanged;\n        this.recalcInterval = options.recalcInterval || RECALC_DROP_DOWN_POS_INTERVAL;\n        this.onOffsetChanged = options.onOffsetChanged;\n    },\n    startCalc: function () {\n        this.checkOffset(this.setNewOffset);\n        clearInterval(this.recalcTimer);\n        this.recalcTimer = setInterval(_.bind(this.checkOffset, this, this.onOffsetChanged), this.recalcInterval);\n    },\n    stopCalc: function () {\n        clearInterval(this.recalcTimer);\n    },\n    checkOffset: function (callback) {\n        var whereItNeedsToBe = this.calcOffset();\n        var currentOffset = this.$dropDownEl.position();\n        var bodyOffset = $body.offset();\n        if (bodyOffset.top || bodyOffset.left) {\n            currentOffset.top += bodyOffset.top;\n            currentOffset.left += bodyOffset.left;\n        }\n        if (this.$dropDownEl.width() !== whereItNeedsToBe.width) {\n            this.setNewOffset(whereItNeedsToBe);\n        }\n        if (this.isOffsetChanged(currentOffset, whereItNeedsToBe)) {\n            callback && callback(whereItNeedsToBe);\n        }\n    },\n    setNewOffset: function (newDimensions) {\n        this.$dropDownEl.css('top', newDimensions.top - $body.offset().top).css('left', newDimensions.left - $body.offset().left).css('width', newDimensions.width);\n    },\n    _isOffsetChanged: function (currentDimensions, newDimensions) {\n        return Math.floor(currentDimensions.top) !== Math.floor(newDimensions.top) || Math.floor(currentDimensions.left) !== Math.floor(newDimensions.left);\n    }\n});\nexport default DropDownManager;","\n        import {store, MERGED_BUNDLES_NAME} from 'bundleStore';\n        \n        let bundle;\n        \n        if ('ScalableInputControlsBundle' !== MERGED_BUNDLES_NAME) {\n            store['ScalableInputControlsBundle'] = store['ScalableInputControlsBundle'] || {};\n            bundle = store['ScalableInputControlsBundle'];\n        } else {\n            bundle = Object.keys(store).reduce((acc, key) => {\n                return {\n                    ...acc,\n                    ...store[key]\n                }\n            }, {});\n        }\n                                     \n        export default bundle;\n    ","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n* @author Sergey Prilukin\n* @version: $Id: SingleSelect.js 2411 2016-03-14 18:03:07Z psavushc $\n*/\n\n/**\n* Single select component which supports view port, and filtering via search.\n*/\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport KeyboardManager from '../manager/KeyboardManager';\nimport SingleSelectList from './SingleSelectList';\nimport SingleSelectListModel from '../model/SingleSelectListModel';\nimport SearcheableDataProvider from '../dataprovider/SearcheableDataProvider';\nimport DropDownManager from '../manager/DropDownManager';\nimport singleSelectTemplate from '../templates/singleSelectTemplate.htm';\nimport singleSelectTemplate_IE10_11 from '../templates/singleSelectTemplate_IE10_11.htm';\nimport singleSelectListTemplate from '../templates/listTemplate.htm';\nimport singleSelectItemsTemplate from '../templates/itemsTemplate.htm';\nimport dropDownTemplate from '../templates/dropDownTemplate.htm';\nimport i18n from '../../../i18n/ScalableInputControlsBundle.properties';\nimport browserDetection from '../../../common/util/browserDetection';\nimport xssUtil from '../../../common/util/xssUtil';\n\nvar $body = $(\"body\");\n\nvar SingleSelect = Backbone.View.extend({\n\n    events: function() {\n        return {\n            \"keydown\": this.keyboardManager.onKeydown,\n            \"input\": this.keyboardManager.onKeydown,\n            \"focus input\": \"onFocus\",\n            \"blur input\": \"onBlur\",\n            \"mousedown\": \"onMousedown\",\n            \"mouseup\": \"onMouseup\",\n            \"click .jr-mSingleselect-input\": \"onClickOnInput\"\n        };\n    },\n\n    initialize: function(options) {\n        _.bindAll(this, \"onGlobalMouseup\", \"onGlobalMousedown\",\n            \"onGlobalMousemove\", \"onMousedown\", \"calcOffsetForListView\", \"collapse\");\n\n        if (!this.model) {\n            this.model = new Backbone.Model();\n        }\n\n        this.model.set(\"expanded\", false, {silent: true});\n        this.model.set(\"criteria\", \"\", {silent: true});\n        this.model.set(\"value\", {}, {silent: true});\n\n        let template = singleSelectTemplate;\n\n        // THIS IS A HACK TO COMPENSATE FOR AN IE10 and IE11 BUGS:\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/274987/\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/101220/\n        if (browserDetection.isIE10() || browserDetection.isIE11()) {\n            template = singleSelectTemplate_IE10_11;\n        }\n\n        this.dropUpDirection = false;\n        this.label = options.label;\n        this.template = _.template(options.template || template);\n        this.dropDownTemplate = _.template(options.dropDownTemplate || dropDownTemplate);\n\n        this.keyboardManager = new KeyboardManager({\n            keydownTimeout: options.keydownTimeout,\n            context: this,\n            deferredKeydownHandler: this.processKeydown,\n            immediateHandleCondition: this.immediateHandleCondition,\n            immediateKeydownHandler: this.immediateKeydownHandler,\n            stopPropagation: true\n        });\n\n        //Initialize internal list view model\n        this.listViewModel = this._createListViewModel(options);\n\n        //initialize list view\n        this.listView = this._createListView(options);\n\n        this.render();\n\n        this.dropDownManager = new DropDownManager({\n            dropDownEl: this.$dropDownElContainer,\n            calcOffset: this.calcOffsetForListView,\n            isOffsetChanged: this.isDimensionsChangedForListView,\n            onOffsetChanged: this.collapse\n        });\n\n        this.initListeners();\n        this.setValue(options.value, {\n            modelOptions: {silent: true}\n        });\n    },\n\n    _createListView: function(options) {\n        return new SingleSelectList({\n            el: options.listElement || $(singleSelectListTemplate),\n            model: this.listViewModel,\n            chunksTemplate: options.chunksTemplate,\n            itemsTemplate: options.itemsTemplate || singleSelectItemsTemplate,\n            scrollTimeout: options.scrollTimeout\n        });\n    },\n\n    _createListViewModel: function(options) {\n        this.searcheableDataProvider = new SearcheableDataProvider({getData: options.getData});\n\n        return new SingleSelectListModel({\n            getData: this._getGetData(),\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor\n        });\n    },\n\n    _getGetData: function() {\n        return this.searcheableDataProvider.getData;\n    },\n\n    _getActiveValueIndex: function(active) {\n        var indexMapping = this.searcheableDataProvider.getIndexMapping();\n        return indexMapping ? indexMapping[active.index] : active.index;\n    },\n\n    /*\n     Bind event listeners\n     */\n    initListeners: function() {\n        this.listenTo(this.listView, \"selection:change\", this.selectionChange, this);\n        this.listenTo(this.listView, \"item:mouseup\", this.itemMouseup, this);\n        this.listenTo(this.listView, \"listRenderError\", this.listRenderError, this);\n        this.listenTo(this.model, \"change:expanded\", this.changeExpandedState, this);\n        this.listenTo(this.model, \"change:value\", this.changeValue, this);\n        this.listenTo(this.model, \"change:disabled\", this.changeDisabled, this);\n        this.listenTo(this.model, \"change:criteria\", this.changeFilter, this);\n\n        this.$dropDownEl.on(\"mousedown\", this.onMousedown);\n\n        $body.on(\"mousedown\", this.onGlobalMousedown)\n            .on(\"dataavailable\", this.onGlobalMousedown) /* hack to handle prototype custom events */\n            .on(\"mouseup\", this.onGlobalMouseup)\n            .on(\"mousemove\", this.onGlobalMousemove);\n    },\n\n    render: function() {\n\n        var singleSelect = $(this.template({\n            label: this.label,\n            isIPad: browserDetection.isIPad(),\n            value: this.model.get(\"value\").label,\n            expanded: this.model.get(\"expanded\"),\n            i18n: i18n\n        }));\n\n        this.renderListView();\n\n        this.$el.empty();\n        this.$el.append(singleSelect);\n\n        this.$singleSelect = singleSelect;\n        this.$searchBlock = this.$el.find(\".jr-mSingleselect-search\");\n        this.$inputBlock = this.$el.find(\".jr-mSingleselect-input\");\n        this.$input = this.$searchBlock.find(\"input\");\n\n        return this;\n    },\n\n    renderListView: function() {\n        if (!this.listRendered) {\n            this.$dropDownElContainer = $(this.dropDownTemplate(\n                {isIPad: navigator.platform === \"iPad\"}\n            ));\n            this.$dropDownEl = this.$dropDownElContainer.find(\".jr-mSingleselect-dropdown\");\n\n            this.listView.undelegateEvents();\n            this.$dropDownEl.append(this.listView.$el);\n            $body.append(this.$dropDownElContainer);\n            this.listView.delegateEvents();\n\n            this.listRendered = true;\n        }\n\n        this.$scalablelist = this.$dropDownElContainer.find(\".jr-mScalablelist\");\n\n        this.model.get(\"expanded\")\n            ? this.$dropDownElContainer.show()\n            : this.$dropDownElContainer.hide();\n    },\n\n    renderData: function() {\n        this.listView.renderData();\n        return this;\n    },\n\n    /* Event handlers */\n    listRenderError: function(responseStatus, error) {\n        this.trigger(\"listRenderError\", responseStatus, error);\n    },\n\n    itemMouseup: function() {\n        if (this.model.get(\"disabled\")) {\n            return;\n        }\n\n        //Remove flag to allow blur\n        delete this.preventBlur;\n\n        //Preserve focus\n        this.$input.focus();\n\n        var activeValue = this.model.get(\"activeValue\");\n\n        if (activeValue.value !== this.model.get(\"value\").value) {\n            this.model.unset(\"activeValue\");\n            this.model.set(\"value\", activeValue);\n        } else {\n            this.collapse();\n        }\n    },\n\n    selectionChange: function() {\n        var active = this.listView.getActiveValue();\n\n        if (active) {\n            this.listView.scrollTo(active.index);\n\n            this.model.set(\"activeValue\", {\n                value: active.value,\n                label: active.label,\n                index: this._getActiveValueIndex(active)\n            });\n\n            this.updateValueFromActive();\n        } else {\n            this.model.unset(\"activeValue\");\n        }\n    },\n\n    onClickOnInput: function() {\n        this.model.get(\"expanded\") ? this.collapse() : this.expand();\n    },\n\n    onFocus: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.$inputBlock.addClass(\"jr-isFocused\")\n        }\n    },\n\n    onBlur: function() {\n        if (!this.preventBlur) {\n            this.collapse();\n\n            this.$inputBlock.removeClass(\"jr-isFocused\");\n        }\n    },\n\n    onMousedown: function() {\n        this.preventBlur = true;\n    },\n\n    onMouseup: function() {\n        if (this.preventBlur) {\n            delete this.preventBlur;\n\n            if (this.model.get(\"expanded\")) {\n                this.$input.focus();\n            }\n        }\n    },\n\n    changeExpandedState: function(model) {\n        if (model.get(\"expanded\")) {\n            this.doExpand();\n        } else {\n            this.doCollapse();\n        }\n    },\n\n    changeValue: function() {\n        this.collapse();\n        this.updateControlLabel();\n\n        if (!this.silent) {\n            this.trigger(\"selection:change\", this.model.get(\"value\").value);\n        } else {\n            delete this.silent;\n        }\n\n        this.$input.val(\"\");\n        this.model.set(\"criteria\", \"\");\n    },\n\n    changeDisabled: function() {\n        var disabled = this.model.get(\"disabled\");\n\n        if (disabled) {\n            this.$input.attr(\"disabled\", \"disabled\");\n            this.collapse();\n        } else {\n            this.$input.removeAttr(\"disabled\");\n        }\n\n        this.listView.setDisabled(disabled);\n    },\n\n    onGlobalMousedown: function(event) {\n        if (this.model.get(\"expanded\")) {\n            if (event.target === this.el || this.$el.find(event.target).length > 0 ||\n                event.target === this.$dropDownEl[0] || this.$dropDownEl.find(event.target).length > 0) {\n                //Do not collapse if mousedown performed on this component\n                this.$input.focus();\n                return;\n            }\n\n            this.preventBlur = false;\n        }\n        this.onBlur();\n    },\n\n    onGlobalMouseup: function() {\n        this.onMouseup();\n    },\n\n    onGlobalMousemove: function(event) {\n        if (this.preventBlur) {\n            event.stopPropagation();\n        }\n    },\n\n    /* Key handlers for KeyboardManager */\n\n    onUpKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            var active = this.listView.getActiveValue();\n\n            if (!active || active.index === 0) {\n                this.collapse();\n                return;\n            } else {\n                this.listView.activatePrevious();\n            }\n        }\n    },\n\n    onDownKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            var active = this.listView.getActiveValue();\n\n            if (active) {\n                this.listView.activateNext();\n            } else {\n                this.listView.activateFirst();\n            }\n        }\n    },\n\n    onEnterKey: function(event) {\n        event.preventDefault();\n\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            if (this.model.get(\"activeValue\")) {\n                this.itemMouseup();\n            } else {\n                this.collapse();\n            }\n        }\n    },\n\n    onEscKey: function() {\n        if (this.model.get(\"expanded\")) {\n            this.collapse();\n        }\n    },\n\n    onHomeKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            this.listView.activateFirst();\n        }\n    },\n\n    onEndKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            this.listView.activateLast();\n        }\n    },\n\n    onPageUpKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            this.listView.pageUp();\n        }\n    },\n\n    onPageDownKey: function() {\n        if (!this.model.get(\"expanded\")) {\n            this.expand();\n        } else {\n            this.listView.pageDown();\n        }\n    },\n\n    onTabKey: function() {\n        /* do nothing */\n    },\n\n    /* Internal helper methods */\n\n    updateDropDirection: function() {\n        // calc max height up and down\n        var scrollHeight = $(\"html\").scrollTop();\n        var offset = this.$el.offset();\n        var elHeight = this.$el.height();\n        var searchBlockHeight = this.$searchBlock.outerHeight();\n\n        var topHeight = offset.top - scrollHeight;\n        var bottomHeight = $(window).height() - topHeight - elHeight;\n\n        this.dropUpDirection = topHeight > bottomHeight;\n\n        // set list max height\n        var maxSize = this.dropUpDirection ? topHeight : (bottomHeight);\n        maxSize -= searchBlockHeight + elHeight;\n\n        this.$scalablelist.css(\"max-height\", (maxSize) + \"px\");\n    },\n\n    doExpand: function() {\n        this.updateDropDirection();\n\n        if (this.dropUpDirection) {\n            this.$dropDownEl.addClass(\"jr-mSingleselect-dropdownTop\");\n            this.$singleSelect.addClass(\"jr-mSingleselectTop\");\n        }\n\n        this.$searchBlock.addClass(\"jr-isOpen\");\n        this.$inputBlock.addClass(\"jr-isOpen\");\n        this.$inputBlock.removeClass(\"jr-isFocused\");\n        this.$input.focus();\n\n        this.listView.onScroll();\n        this.expandListView();\n\n        if (this.listView.lazy) {\n            this.listView.fetch(_.bind(this.listView.resize, this.listView));\n        } else {\n            this.listView.resize();\n        }\n\n        if (typeof this.model.get(\"value\").value !== \"undefined\") {\n            this.setValueToList();\n        }\n\n        this.trigger(\"expand\", this);\n    },\n\n    expandListView: function() {\n        this.$dropDownElContainer.show();\n        this.dropDownManager.startCalc();\n    },\n\n    doCollapse: function() {\n        this.model.unset(\"activeValue\");\n        this.$searchBlock.removeClass(\"jr-isOpen\");\n        this.$inputBlock.removeClass(\"jr-isOpen\");\n\n        this.$dropDownEl.removeClass(\"jr-mSingleselect-dropdownTop\");\n        this.$singleSelect.removeClass(\"jr-mSingleselectTop\");\n\n        this.$inputBlock.addClass(\"jr-isFocused\");\n        this.$input.val(\"\");\n        this.$dropDownElContainer.hide();\n        this.model.set(\"criteria\", \"\");\n        this.dropDownManager.stopCalc();\n        this.trigger(\"collapse\", this);\n    },\n\n    calcOffsetForListView: function() {\n        var top;\n        var offset = this.$el.offset();\n        var left = $body.offset().left + offset.left;\n        var elHeight = this.$el.height();\n\n        if (this.dropUpDirection) {\n            top = $body.offset().top + offset.top  - this.$searchBlock.outerHeight();\n        } else {\n            top = $body.offset().top + offset.top + elHeight + this.$searchBlock.height();\n        }\n\n\n        return {\n            top: top,\n            left: left,\n            width: this.el.getBoundingClientRect().width\n        }\n    },\n\n    isDimensionsChangedForListView: function(currentDimensions, newDimensions) {\n        // we allow some slight change in dimensions which we don't notice as a change\n        const threshold = 2;\n        return (Math.abs(currentDimensions.top - newDimensions.top) > threshold\n            || Math.abs(currentDimensions.left - newDimensions.left) > threshold);\n    },\n\n    immediateHandleCondition: function(event) {\n        return !this.model.get(\"expanded\");\n    },\n\n    immediateKeydownHandler: function(event) {\n        this.expand();\n        this.keyboardManager.deferredHandleKeyboardEvent(event);\n    },\n\n    processKeydown: function() {\n        this.model.set(\"criteria\", this.$input.val());\n    },\n\n    changeFilter: function() {\n        var that = this;\n        this._getGetData()({criteria: this.model.get(\"criteria\")}).done(function() {\n            that.listView.fetch(function () {\n                that.setValueToList();\n            });\n        });\n    },\n\n    setValueToList: function(options) {\n        var value = this.model.get(\"value\");\n\n        var selection = value.value;\n\n        if (typeof value.index !== \"undefined\") {\n            var indexMapping = this.searcheableDataProvider.getReverseIndexMapping();\n\n            var index = (indexMapping ? indexMapping[value.index] : value.index);\n            selection = {};\n\n            if (typeof index !== \"undefined\") {\n                selection[index] = value.value;\n            }\n        }\n\n        this.listView.setValue(selection, options);\n    },\n\n    //value is external usual value: either string, or array of strings or object\n    convertExternalValueToInternalFormat: function(value) {\n        var internalValue = {};\n\n        if (typeof value !== \"undefined\") {\n            if (typeof value === \"string\" || value === null) {\n                internalValue = {value: value};\n            } else {\n                for (var index in value) {\n                    if (value.hasOwnProperty(index) && value[index] !== undefined) {\n\n                        if (typeof value[index] === 'object') {\n                            internalValue = {\n                                value: value[index].value,\n                                index: parseInt(index, 10),\n                                label: value[index].label\n                            };\n                        } else {\n                            internalValue = {\n                                value: value[index],\n                                index: parseInt(index, 10)\n                            };\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n\n        return internalValue;\n    },\n\n    updateValueFromActive: function() {\n        var value = this.model.get(\"value\");\n        var activeValue = this.model.get(\"activeValue\");\n\n        if (value.value === activeValue.value && typeof value.label === \"undefined\") {\n            value.label = activeValue.label;\n            this.updateControlLabel();\n        }\n    },\n\n    updateControlLabel: function() {\n        var value = this.model.get(\"value\");\n        var $inputBlockPlaceholder = this.$inputBlock.find(\".jr-mSingleselect-input-placeholder\");\n        var $inputBlockSelection = this.$inputBlock.find(\".jr-mSingleselect-input-selection\");\n        var label;\n\n        if (_.isEmpty(value) || value.value == null){\n            $inputBlockPlaceholder.removeClass(\"jr-isHidden\");\n            this.render();\n        } else {\n            label = this.getControlLabelByValue(value);\n            $inputBlockPlaceholder.addClass(\"jr-isHidden\");\n            this.$inputBlock.attr(\"title\", label);\n            $inputBlockSelection.html(xssUtil.hardEscape(label));\n        }\n    },\n\n    getControlLabelByValue: function (value) {\n        return value.label == null\n            ? value.value\n            : value.label;\n    },\n\n    /* API */\n\n    fetch: function(callback, options) {\n        this.listView.fetch(callback, options);\n        return this;\n    },\n\n    reset: function(options) {\n        this.listView.reset(options);\n        return this;\n    },\n\n    expand: function() {\n        if (this.model.get(\"disabled\")) {\n            return;\n        }\n\n        this.model.set(\"expanded\", true);\n        return this;\n    },\n\n    collapse: function() {\n        this.model.set(\"expanded\", false);\n        return this;\n    },\n\n    getValue: function() {\n        return this.model.get(\"value\").value;\n    },\n\n    setValue: function(value, options) {\n        value = this.convertExternalValueToInternalFormat(value);\n\n        if (options && options.silent) {\n            this.silent = true;\n        }\n\n        this.model.set(\"value\", value);\n        this.setValueToList();\n    },\n\n    setDisabled: function(disabled) {\n        this.model.set(\"disabled\", disabled);\n        return this;\n    },\n\n    getDisabled: function() {\n        return this.model.get(\"disabled\");\n    },\n\n    remove: function() {\n        this.$dropDownEl.off(\"mousedown\", this.onMousedown).remove();\n        this.listView.remove();\n        this.$dropDownElContainer.remove();\n        Backbone.View.prototype.remove.call(this);\n        $body.off(\"mousedown\", this.onGlobalMousedown)\n            .off(\"dataavailable\", this.onGlobalMousedown)\n            .off(\"mouseup\", this.onGlobalMouseup)\n            .off(\"mousemove\", this.onGlobalMousemove);\n    }\n});\n\nexport default SingleSelect;\n","export default \"<div class=\\\"jr-mSingleselect jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <a class=\\\"jr-mSingleselect-input jr\\\">\\n        <span class=\\\"jr-mSingleselect-input-placeholder jr\\\">{{- i18n['sic.singleselect.select.one'] }}</span>\\n        <span class=\\\"jr-mSingleselect-input-selection jr\\\">{{- value}}</span>\\n        <div class=\\\"jr-mSingleselect-input-expander jr\\\"></div>\\n    </a>\\n    <div class=\\\"jr-mSingleselect-search jr\\\">\\n        <input type=\\\"text\\\" placeholder=\\\"{{- i18n['sic.multiselect.search'] }}\\\" class=\\\"jr-mInput-search jr\\\" value=\\\"{{- value}}\\\">\\n    </div>\\n</div>\\n\";","export default \"<div class=\\\"jr-mSingleselect jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <a class=\\\"jr-mSingleselect-input jr\\\">\\n        <span class=\\\"jr-mSingleselect-input-placeholder jr\\\">Click to select item...</span>\\n        <span class=\\\"jr-mSingleselect-input-selection jr\\\">{{- value}}</span>\\n        <div class=\\\"jr-mSingleselect-input-expander jr\\\"></div>\\n    </a>\\n    <div class=\\\"jr-mSingleselect-search jr\\\">\\n        <input type=\\\"text\\\" class=\\\"jr-mInput-search jr\\\" value=\\\"{{- value}}\\\">\\n    </div>\\n</div>\\n\";","export default \"<div class=\\\"jr-mSingleselect-dropdownContainer jr\\\">\\n    <js-templateNonce></js-templateNonce>\\n    <div class=\\\"jr-mSingleselect-dropdown jr\\\"></div>\\n</div>\\n\";","export default \"<div class=\\\"jr-mScalablelist jr\\\" draggable=\\\"false\\\" ondragstart=\\\"return false\\\" unselectable=\\\"on\\\" onselectstart=\\\"return false\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\";","export default \"<ul class=\\\"jr-mSelectlist jr\\\" style=\\\"top: {{- top}}px;\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{_.each(items, function(item) { }}\\n    <li class=\\\"jr-mSelectlist-item {{ if (item.selected) print('jr-isSelected'); }} jr\\\" title=\\\"{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}\\\" data-index=\\\"{{- item.index}}\\\">\\n        <div class=\\\"jr-mSelectlist-item-wrapper jr\\\">\\n            <a class=\\\"jr-mSelectlist-item-text jr\\\">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}</a>\\n        </div>\\n    </li>\\n    {{ }); }}\\n</ul>\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport BaseListWithSelectionModel from './BaseListWithSelectionModel';\nvar ListWithSelectionAsObjectHashModel = BaseListWithSelectionModel.extend({\n    initialize: function(options) {\n        BaseListWithSelectionModel.prototype.initialize.call(this, options);\n\n        this.caseSensitiveSelection = typeof options.caseSensitiveSelection !== 'undefined' ? options.caseSensitiveSelection : true;\n    },\n\n    _addToSelection: function (value, index) {\n        if (this.caseSensitiveSelection) {\n            this.selection[value] = true;\n        } else {\n            this.selection[value.toLowerCase()] = value;\n        }\n    },\n\n    _removeFromSelection: function (value, index) {\n        if (!this.caseSensitiveSelection) {\n            value = value.toLowerCase();\n        }\n        delete this.selection[value];\n    },\n    _clearSelection: function () {\n        this.selection = {};\n    },\n    _selectionContains: function (value, index) {\n        if (!this.caseSensitiveSelection) {\n            value = value.toLowerCase();\n        }\n        return this.selection[value];\n    },\n    _getSelection: function () {\n        if (this.caseSensitiveSelection) {\n            return _.keys(this.selection);\n        }\n        return _.values(this.selection);\n    },\n    select: function (selection, options) {\n        this._clearSelection();\n        if (typeof selection === 'string') {\n            this._addToSelection(selection);\n        } else if (_.isArray(selection)) {\n            for (var i = 0; i < selection.length; i++) {\n                this._addToSelection(selection[i]);\n            }\n        } else if (typeof selection !== 'undefined') {\n            for (var key in selection) {\n                if (selection.hasOwnProperty(key)) {\n                    var value = selection[key];\n                    if (value !== undefined) {\n                        this._addToSelection(value, key);\n                    }\n                }\n            }\n        }\n        this._afterSelect && this._afterSelect(selection, options);\n        this._triggerSelectionChange(options);\n    }\n});\nexport default ListWithSelectionAsObjectHashModel;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport SingleSelectListModel from './SingleSelectListModel';\nimport ListWithSelectionAsObjectHashModel from '../../scalableList/model/ListWithSelectionAsObjectHashModel';\nvar listPrototype = ListWithSelectionAsObjectHashModel.prototype;\n\nvar SingleSelectListModelNew = SingleSelectListModel.extend({\n\n    initialize: function(options) {\n        SingleSelectListModel.prototype.initialize.call(this, options);\n\n        this.caseSensitiveSelection = typeof options.caseSensitiveSelection !== 'undefined' ? options.caseSensitiveSelection : true;\n    },\n\n    _addToSelection: listPrototype._addToSelection,\n    _removeFromSelection: listPrototype._removeFromSelection,\n    _clearSelection: listPrototype._clearSelection,\n    _selectionContains: listPrototype._selectionContains,\n    _getSelection: listPrototype._getSelection,\n    _calcSelectionStartIndex: undefined,\n    _select: listPrototype.select\n});\nexport default SingleSelectListModelNew;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport listWithNavigationModelTrait from '../../scalableList/model/listWithNavigationModelTrait';\nimport SingleSelect from './SingleSelect';\nimport SingleSelectListModelNew from '../model/SingleSelectListModelNew';\nfunction afterSelect(getSelectionIndex, selection) {\n    if (selection && typeof selection === 'string') {\n        if (!this.getActive()) {\n            var index = getSelectionIndex(selection);\n            if (typeof index !== 'undefined') {\n                listWithNavigationModelTrait.setActive.call(this, {\n                    index: index,\n                    item: { value: selection },\n                    silent: true\n                });\n            }\n        }\n    }\n}\nvar SingleSelectNew = SingleSelect.extend({\n    initialize: function (options) {\n        _.bindAll(this, '_getSelectionIndex');\n        this.formatValue = options.formatValue;\n        SingleSelect.prototype.initialize.call(this, options);\n    },\n    _createListViewModel: function (options) {\n        this.getData = options.getData;\n        if (options.model) {\n            return options.model;\n        }\n        const singleSelectListModelNew = new SingleSelectListModelNew(options);\n        return _.extend(singleSelectListModelNew, { _afterSelect: _.partial(afterSelect, this._getSelectionIndex) });\n    },\n    _getSelectionIndex: function (selection) {\n        var bufferStartIndex = this.listViewModel.get('bufferStartIndex');\n        var items = this.listViewModel.get('items');\n        for (var i = 0; i < items.length; i++) {\n            if (selection === items[i].value) {\n                return bufferStartIndex + i;\n            }\n        }\n        return undefined;\n    },\n    _getGetData: function () {\n        return this.getData;\n    },\n    _getActiveValueIndex: function (active) {\n        return this._getSelectionIndex(active.value);\n    },\n    changeFilter: function () {\n        var self = this;\n        var criteria = this.model.get('criteria');\n        this.listView.scrollTo(0);\n        this._getGetData()({\n            criteria: criteria,\n            offset: 0,\n            limit: 1\n        }).done(function () {\n            self.listView.fetch(function () {\n                self.listView.resize();\n                self.setValueToList();\n            });\n        });\n    },\n    getControlLabelByValue: function (value) {\n        return value.label == null ? this.formatValue ? this.formatValue(value.value) : value.value : value.label;\n    },\n    setValue: function (value, options) {\n        value = this.convertExternalValueToInternalFormat(value);\n        if (options && options.silent) {\n            this.silent = true;\n        }\n        this.model.set('value', value);\n        this.setValueToList(options);\n        if(this.silent) {\n            delete this.silent;\n        }\n    },\n    setValueToList: function (options) {\n        var selection = this.model.get('value'), value = {};\n        if (selection && selection.index) {\n            value[selection.index] = selection.value;\n        } else if (selection) {\n            value = selection.value;\n        }\n        this.listView.setValue(value, options);\n    }\n});\nexport default SingleSelectNew;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport $ from 'jquery';\nexport default {\n    doCalcOnVisibleNodeClone: function (options) {\n        if (!options || !options.el) {\n            throw 'Missing required option: el';\n        }\n        _.defaults(options, {\n            css: {},\n            classes: '',\n            container: '<div></div>',\n            appendTo: 'body',\n            callback: function () {\n                throw 'no callback was defined';\n            },\n            alwaysClone: false,\n            cloneHandlers: false\n        });\n        _.defaults(options.css, {\n            'position': 'absolute',\n            'left': '-9999px'\n        });\n        if (!options.alwaysClone && $(options.el).is(':visible')) {\n            options.callback($(options.el));\n        } else {\n            var $el = $(options.el).clone();\n            var $tmp = $(options.container).css(options.css).addClass(options.classes).appendTo($(options.appendTo)).append($el);\n            options.callback($el);\n            $tmp.remove();\n        }\n    }\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport ScalableListModel from '../../scalableList/model/ScalableListModel';\nimport browserDetection from '../../../common/util/browserDetection';\nimport doCalcOnVisibleNodeClone from '../../scalableList/util/domAndCssUtil';\n\nlet doCalcOnVisibleNodeCloneObject = doCalcOnVisibleNodeClone.doCalcOnVisibleNodeClone;\n\nvar scalableListItemHeightCalculationTrait = {\n    render: function () {\n        if (!this._itemHeightSet) {\n            this._calcItemHeight();\n            this._itemHeightSet = true;\n        }\n        return this;\n    },\n    _calcItemHeight: function () {\n        var self = this;\n        this._model = this.model;\n        this._lazy = this.lazy;\n        this._visibility = this.$el.css('visibility');\n        this._display = this.$el.css('display');\n        this.model = new ScalableListModel({\n            getData: function () {\n                var deferred = new $.Deferred();\n                deferred.resolve({\n                    total: 1,\n                    data: [{\n                        value: 'test value',\n                        label: 'test label'\n                    }]\n                });\n                return deferred;\n            }\n        });\n        this.$el.css({\n            'visibility': 'hidden',\n            'display': 'block'\n        });\n        this.model.once('change', this.onModelChange, this);\n        this.renderData();\n        doCalcOnVisibleNodeCloneObject({\n            el: this.$el,\n            css: { 'width': '100px' },\n            classes: ' jr ' + (browserDetection.isIPad() ? 'ipad' : ''),\n            callback: function ($el) {\n                self.itemHeight = $el.find('li').outerHeight(true);\n                self.itemsPerChunk = Math.floor(self.defaultChunkHeight / self.itemHeight);\n                self.chunkHeight = self.itemsPerChunk * self.itemHeight;\n            }\n        });\n        this.$el.empty().css({\n            'visibility': this._visibility,\n            'display': this._display\n        });\n        delete this._visibility;\n        delete this._display;\n        this.totalItems = undefined;\n        this.$firstViewChunk = undefined;\n        this.model = this._model;\n        delete this._model;\n        this.lazy = this._lazy;\n        this._lazy && delete this._lazy;\n    },\n    _calcViewPortConstants: function () {\n        if (!this.viewPortConstantsInitialized) {\n            if (!this._itemHeightSet) {\n                return;\n            }\n            this._calcViewPortHeight();\n            this._renderViewChunks(true);\n            this._renderItems();\n            this.viewPortConstantsInitialized = true;\n        }\n    }\n};\nexport default scalableListItemHeightCalculationTrait;","export default \"<div class=\\\"jr-mScalablelist jr j-scalable-list\\\" onselectstart=\\\"return false\\\" unselectable=\\\"on\\\" ondragstart=\\\"return false\\\" draggable=\\\"false\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author Sergey Prilukin; modified by Ken Penn\n * @version: $Id: AvailableItemsList.js 812 2015-01-27 11:01:30Z psavushchik $\n */\n\n/**\n * AvailableItems list -  Part of Tabbed MultiSelect\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport browserDetection from '../../../common/util/browserDetection';\nimport i18n from '../../../i18n/ScalableInputControlsBundle.properties';\n\nimport KeyboardManager from '../../singleSelect/manager/KeyboardManager';\nimport ListWithNavigation from '../../scalableList/view/ListWithNavigation';\n\nimport doCalcOnVisibleNodeClone from '../../scalableList/util/domAndCssUtil';\n\nimport listWithNavigationModelTrait from '../../scalableList/model/listWithNavigationModelTrait';\nimport ListWithSelectionAsObjectHashModel from '../../scalableList/model/ListWithSelectionAsObjectHashModel';\nimport scalableListItemHeightCalculationTrait from '../mixin/scalableListItemHeightCalculationTrait';\nimport availableItemsTabTemplate from '../templates/availableItemsTemplate.htm';\nimport availableItemsTabTemplate_IE10_11 from '../templates/availableItemsTemplate_IE10_11.htm';\nimport listTemplate from '../templates/listTemplate.htm';\n\nlet doCalcOnVisibleNodeCloneObject = doCalcOnVisibleNodeClone.doCalcOnVisibleNodeClone;\n\nvar BUTTON_TESTS = [\n    {\n        selector: \".jr-jSelectAll\",\n        strings: [\n            i18n[\"sic.multiselect.selectAll\"],\n            i18n[\"sic.multiselect.all\"],\n            \"\"\n        ]\n    },\n    {\n        selector: \".jr-jSelectNone\",\n        strings: [\n            i18n[\"sic.multiselect.deselectAll\"],\n            i18n[\"sic.multiselect.none\"],\n            \"\"\n        ]\n    },\n    {\n        selector: \".jr-jInvert\",\n        strings: [\n            i18n[\"sic.multiselect.inverse\"],\n            \"\"\n        ]\n    }\n];\n\nvar AvailableItemsList = Backbone.View.extend({\n\n    className: \"jr-mMultiselect-listContainer jr-isActive jr\",\n\n    events: function() {\n        return {\n            \"keydown input.jr-mInput-search\": this.keyboardManager.onKeydown,\n            \"focus input.jr-mInput-search\": \"onFocus\",\n            \"blur input.jr-mInput-search\": \"onBlur\",\n            \"click .jr-jSelectAll\": \"onSelectAll\",\n            \"click .jr-jSelectNone\": \"onSelectNone\",\n            \"click .jr-jInvert\": \"onInvertSelection\",\n            \"click input.jr-mInput-search\": \"onClickOnInput\",\n            \"touchend input.jr-mInput-search\": \"onClickOnInput\",\n            \"mousedown\": \"onMousedown\",\n            \"mouseup\": \"onMouseup\"\n        };\n    },\n\n    keydownHandlers: _.extend({\n        \"65\": \"onAKey\"\n    }, KeyboardManager.prototype.keydownHandlers),\n\n    initialize: function(options) {\n        _.bindAll(this, \"onGlobalMouseup\", \"onGlobalMousedown\", \"onResize\", \"onGlobalMousemove\",\n            \"onMousedown\", \"onMouseup\", \"onEscKey\", \"onSelectAll\", \"onSelectNone\",\n            \"onInvertSelection\");\n\n        this._debouncedOnResize = _.debounce(this.onResize, 500);\n\n        if (!this.model) {\n            this.model = new Backbone.Model();\n        }\n\n        this.model.set(\"criteria\", \"\", {silent: true});\n\n        // THIS IS A HACK TO COMPENSATE FOR AN IE10 and IE11 BUGS:\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/274987/\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/101220/\n        let template;\n\n        if (browserDetection.isIE10() || browserDetection.isIE11()) {\n            template = availableItemsTabTemplate_IE10_11;\n        } else {\n            template = availableItemsTabTemplate;\n        }\n\n        this.label = options.label;\n        this.caseSensitiveSelection = options.caseSensitiveSelection;\n        this.template = _.template(options.availableItemsTemplate || template);\n\n        this.keyboardManager = new KeyboardManager({\n            keydownHandlers: this.keydownHandlers,\n            keydownTimeout: options.keydownTimeout,\n            context: this,\n            deferredKeydownHandler: this.processKeydown,\n            immediateHandleCondition: this.immediateHandleCondition,\n            immediateKeydownHandler: this.immediateKeydownHandler,\n            stopPropagation: true\n        });\n\n        this.listViewModel = this._createListViewModel(options);\n\n        this.setValue(options.value, {silent: true});\n\n        this.listView = this._createListView(options);\n\n        this.render();\n\n        this.initListeners();\n    },\n\n    _createListViewModel: function(options) {\n        this.getData = options.getData;\n\n        var Model = ListWithSelectionAsObjectHashModel.extend(listWithNavigationModelTrait);\n\n        return options.listViewModel || new Model({\n            getData: options.getData,\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor,\n            caseSensitiveSelection: options.caseSensitiveSelection\n        });\n    },\n\n    _createListView: function(options) {\n        var list = options.listView || new ListWithNavigation({\n            el: options.listElement || $(listTemplate),\n            model: this.listViewModel,\n            chunksTemplate: options.chunksTemplate,\n            itemsTemplate: options.itemsTemplate,\n            scrollTimeout: options.scrollTimeout,\n            lazy: true,\n            selectedClass: \"jr-isSelected\",\n            selection: {\n                allowed: true,\n                multiple: true\n            }\n        });\n\n        _.extend(list, scalableListItemHeightCalculationTrait);\n\n        return list;\n    },\n\n    initListeners: function() {\n        this.listenTo(this.listView, \"active:changed\", this.activeChange, this);\n        this.listenTo(this.listView, \"mousedown\", this.onMousedown, this);\n        this.listenTo(this.listView, \"render:data\", this.onRenderData, this);\n        this.listenTo(this.listView, \"listRenderError\", this.listRenderError, this);\n        this.listenTo(this.listViewModel, \"change\", this.onListViewModelChanged, this);\n        this.listenTo(this.listViewModel, \"selection:clear\", this.selectionClear, this);\n        this.listenTo(this.listViewModel, \"selection:add\", this.selectionAdd, this);\n        this.listenTo(this.listViewModel, \"selection:addRange\", this.selectionAddRange, this);\n        this.listenTo(this.listViewModel, \"selection:remove\", this.selectionRemove, this);\n\n        this.listenTo(this.model, \"change:totalValue\", this.onChangeTotalValue, this);\n        this.listenTo(this.model, \"change:value\", this.changeValue, this);\n        this.listenTo(this.model, \"change:disabled\", this.changeDisabled, this);\n        this.listenTo(this.model, \"change:criteria\", this.changeFilter, this);\n\n        $(\"body\").on(\"mousedown\", this.onGlobalMousedown)\n            .on(\"mouseup\", this.onGlobalMouseup)\n            .on(\"mousemove\", this.onGlobalMousemove);\n\n        $(window).on(\"resize\", this._debouncedOnResize);\n    },\n\n    render: function() {\n\n        this.$el.empty();\n        this.$el.append($(this.template(this.getModelForRendering())));\n\n        this.listView.undelegateEvents();\n\n        this.$el.find('.jr-mMultiselect-list').append(this.listView.el);\n\n        this.listView.render();\n\n        this.listView.fetch(_.bind(this.listView.resize, this.listView));\n\n        this.listView.delegateEvents();\n\n        this._tuneCSS();\n\n        this.setBulkSelectionText();\n\n        return this;\n    },\n\n    _tuneCSS: function() {\n        var self = this;\n\n        // only need to do this once\n        if (!this._paddingHeightsSet) {\n\n            doCalcOnVisibleNodeCloneObject({\n                el: this.$el,\n                css: {\"width\": \"500px\"},\n                classes: \"jr \" + (browserDetection.isIPad() ? \"ipad\" : \"\"),\n                callback: function($el) {\n                    self.searchBarHeight = Math.round($el.find(\".jr-mMultiselect-search\").outerHeight());\n                    self.buttonsContainerHeight = Math.round($el.find(\".jr-mMultiselect-buttonContainer\").outerHeight());\n                }\n            });\n\n            this._paddingHeightsSet = true;\n        }\n\n        this.$el.find(\".jr-mMultiselect-list\").css({\n            \"height\": \"100%\",\n            \"padding-top\": this.searchBarHeight,\n            \"padding-bottom\": this.buttonsContainerHeight\n        });\n    },\n\n    renderData: function() {\n        this.listView.renderData();\n        return this;\n    },\n\n    /* Event Handlers */\n\n    activeChange: function(active) {\n        if (active) {\n            if (this.activeChangedWithShift) {\n                delete this.activeChangedWithShift;\n                this.listViewModel.addRangeToSelection(active.value, active.index);\n            }\n\n            this.listView.scrollTo(active.index);\n        }\n    },\n\n    selectionAdd: function(selection) {\n        const currentValues = this.model.get(\"value\");\n        if (this.caseSensitiveSelection) {\n            currentValues[selection.value] = true;\n        } else {\n            currentValues[selection.value.toLowerCase()] = selection.value;\n        }\n        this.model.trigger(\"change:value\");\n    },\n\n    selectionAddRange: function(range) {\n        const selection = range.selection,\n            currentValues = this.model.get(\"value\");\n\n        for (let i = 0; i < selection.length; i +=1 ) {\n            const value = selection[i];\n            if (this.caseSensitiveSelection) {\n                currentValues[value] = true;\n            } else {\n                currentValues[value.toLowerCase()] = value;\n            }\n        }\n\n        this.model.trigger(\"change:value\");\n    },\n\n    selectionRemove: function(selection) {\n        const currentValues = this.model.get(\"value\");\n        if (this.caseSensitiveSelection) {\n            delete currentValues[selection.value];\n        } else {\n            delete currentValues[selection.value.toLowerCase()];\n        }\n\n        this.model.trigger(\"change:value\");\n    },\n\n    selectionClear: function() {\n        this.model.attributes.value = {};\n    },\n\n    onSelectAll: function() {\n        if (!this.model.get(\"disabled\")) {\n            this.listView.once(\"selection:change\", this.processSelectionThroughApi, this);\n            this.clearFilter(_.bind(this.listView.selectAll, this.listView));\n        }\n    },\n\n    onSelectNone: function() {\n        if (!this.model.get(\"disabled\")) {\n            this.listView.once(\"selection:change\", this.processSelectionThroughApi, this);\n            this.clearFilter(_.bind(this.listView.selectNone, this.listView));\n        }\n    },\n\n    onInvertSelection: function() {\n        if (!this.model.get(\"disabled\")) {\n            this.listView.once(\"selection:change\", this.processSelectionThroughApi, this);\n            this.clearFilter(_.bind(this.listView.invertSelection, this.listView));\n        }\n    },\n\n    onRenderData: function() {\n        this.trigger(\"render:data\");\n    },\n\n    listRenderError: function(responseStatus, error) {\n        this.trigger(\"listRenderError\", responseStatus, error);\n    },\n\n    onListViewModelChanged: function() {\n        if (typeof this.model.get(\"totalValues\") == \"undefined\") {\n            var total = this.listViewModel.get(\"total\");\n\n            if (_.isNumber(total) && !_.isNaN(total)) {\n                this.model.set(\"totalValues\", total);\n            }\n        }\n    },\n\n    onChangeTotalValue: function() {\n        this.listView.resize();\n    },\n\n    setBulkSelectionText: function() {\n        if (!this.$el.is(\":visible\")) {\n            //We can not measure bulk buttons width\n            //so no text will be changed\n            return;\n        }\n\n        var componentWidth = this.$el.outerWidth();\n\n        if (componentWidth === this._componentWidth) {\n            //no need to check text since size was not changed since last check\n            return;\n        } else {\n            this._componentWidth = componentWidth;\n        }\n\n        var $bulkButtonsBar = this.$el.find(\".jr-mMultiselect-buttonContainer\"),\n            bulkButtonsBarWidth = $bulkButtonsBar.outerWidth(),\n            isAvailableTabInActive = this.$el.hasClass('jr-isInactive')\n\n        doCalcOnVisibleNodeCloneObject({\n            el: $bulkButtonsBar,\n            css: {\n                \"left\" : (0 - (bulkButtonsBarWidth * 2)) + \"px\",\n                \"width\" : bulkButtonsBarWidth + \"px\"\n            },\n            classes: \"jr \" + (browserDetection.isIPad() ? \"ipad\" : \"\"), //add additional classes to parent container of cloned node\n            alwaysClone: true,\n            callback: function($clone) {\n                _.each(BUTTON_TESTS, function(buttonTest) {\n                    var widthOk = false;\n\n                    _.each(buttonTest.strings, function(buttonString) {\n                        if (widthOk) {\n                            return;\n                        }\n\n                        var $button = $clone.find(buttonTest.selector),\n                            $buttonText = $button.find(\".jr-mItemselector-button-label span\")\n                                .text(buttonString),\n                            btnRight = $button[0].getBoundingClientRect().right,\n                            txtRight = $buttonText[0].getBoundingClientRect().right;\n\n                        if (btnRight - txtRight >= 3 || buttonString === \"\" || isAvailableTabInActive) {\n                            widthOk = true;\n                            $bulkButtonsBar.find(buttonTest.selector + \" .jr-mItemselector-button-label span\")\n                                .text(buttonString);\n                        }\n                    });\n                });\n            }\n        });\n    },\n\n    changeValue: function() {\n        this.trigger(\"selection:change\", this.getValue());\n    },\n\n    changeDisabled: function() {\n        var disabled = this.model.get(\"disabled\");\n\n        if (disabled) {\n            this.$el.find(\"input[type='text']\").attr(\"disabled\", \"disabled\");\n        } else {\n            this.$el.find(\"input[type='text']\").removeAttr(\"disabled\");\n        }\n\n        this.listView.setDisabled(disabled);\n    },\n\n    onClickOnInput: function() {\n        this.onFocus();\n    },\n\n    onFocus: function() {\n\n        //Workaround for input's HTML5 placeholder attribute\n        var input = this.$el.find(\"input\");\n        if (input.val() == input.attr('placeholder')) {\n            input.val('');\n            input.removeClass('jr-mMultiselect-input-placeholder');\n        }\n    },\n\n    onBlur: function() {\n        //Workaround for input's HTML5 placeholder attribute\n        var input = this.$el.find(\"input\");\n        if (input.val() === '' || input.val() === input.attr('placeholder')) {\n            input.addClass('jr-mMultiselect-input-placeholder');\n            input.val(input.attr('placeholder'));\n        }\n        // End of workaround\n\n        if (this.preventBlur) {\n            return false;\n        }\n    },\n\n    onMousedown: function() {\n        if (!browserDetection.isIPad()) {\n            this.preventBlur = true;\n        }\n    },\n\n    onMouseup: function() {\n        if (this.preventBlur) {\n            delete this.preventBlur;\n\n            this.$el.find(\"input.jr-mInput-search\").focus();\n        }\n    },\n\n    onGlobalMousedown: function(event) {\n        if (this.preventBlur) {\n            if (event.target !== this.el && this.$el.find(event.target).length === 0) {\n                delete this.preventBlur;\n                this.onBlur();\n            }\n        }\n    },\n\n    onGlobalMouseup: function() {\n        this.onMouseup();\n    },\n\n    onGlobalMousemove: function(event) {\n        if (this.preventBlur) {\n            event.stopPropagation();\n        }\n    },\n\n    onResize: function() {\n        this.resize();\n    },\n\n    /* Key handlers for KeyboardManager */\n\n    onUpKey: function(event) {\n        var self = this;\n\n        this._onUpDownNavigation(event, function() {\n            self.listView.activatePrevious();\n        }, function() {\n            self.listView.activateLast();\n        });\n    },\n\n    onDownKey: function(event) {\n        var self = this;\n\n        this._onUpDownNavigation(event, function() {\n            self.listView.activateNext();\n        }, function() {\n            self.listView.activateFirst();\n        });\n    },\n\n    _onUpDownNavigation: function(event, activateItem, resetToInitialActiveItem) {\n        var nextActive,\n            prevActive = this.listView.getActiveValue();\n\n        if (prevActive) {\n            if (event.shiftKey) {\n                this.activeChangedWithShift = true;\n            }\n\n            activateItem();\n\n            nextActive = this.listView.getActiveValue();\n\n            if (nextActive.index === prevActive.index) {\n                resetToInitialActiveItem();\n            }\n        } else {\n            resetToInitialActiveItem();\n        }\n    },\n\n    onEnterKey: function(event) {\n        event.preventDefault();\n\n        var active = this.listView.getActiveValue();\n        if (!active) {\n            return;\n        }\n\n        if (event.shiftKey) {\n            this.listViewModel.addRangeToSelection(active.value, active.index);\n        } else if (event.ctrlKey || event.metaKey) {\n            this.listViewModel.clearSelection();\n            this.listViewModel.addValueToSelection(active.value, active.index);\n        } else {\n            this.listViewModel.toggleSelection(active.value, active.index);\n        }\n    },\n\n    onEscKey: function() {\n        /* do nothing */\n    },\n\n    onHomeKey: function(event) {\n\n        if (event.shiftKey) {\n            this.activeChangedWithShift = true;\n        }\n\n        this.listView.activateFirst();\n    },\n\n    onEndKey: function(event) {\n\n        if (event.shiftKey) {\n            this.activeChangedWithShift = true;\n        }\n\n        this.listView.activateLast();\n    },\n\n    onPageUpKey: function(event) {\n\n        if (event.shiftKey) {\n            this.activeChangedWithShift = true;\n        }\n\n        this.listView.pageUp();\n    },\n\n    onPageDownKey: function(event) {\n\n        if (event.shiftKey) {\n            this.activeChangedWithShift = true;\n        }\n\n        this.listView.pageDown();\n    },\n\n    onTabKey: function() {\n        /* do nothing */\n    },\n\n    onAKey: function(event) {\n        if (!event.ctrlKey && !event.metaKey) {\n            this.keyboardManager.deferredHandleKeyboardEvent(event);\n        } else {\n            event.stopPropagation();\n            this.onSelectAll();\n        }\n    },\n\n    /* Internal helper methods */\n\n    processKeydown: function() {\n        this.model.set(\"criteria\", this.$el.find(\"input.jr-mInput-search\").val());\n    },\n\n    changeFilter: function(callback) {\n        var self = this,\n            criteria = this.model.get(\"criteria\");\n\n        if (typeof criteria == \"undefined\" || criteria === \"\") {\n            this.model.unset(\"totalValues\", {silent: true});\n        }\n\n        this.listView.scrollTo(0);\n        self.listView.activate(null, {silent: true}); //we have to drop active element before filter change\n\n        this.getData({\n            criteria: criteria,\n            offset: 0,\n            limit: this.listView.model.bufferSize\n        }).done(function () {\n            self.listViewModel.once(\"change\", callback && typeof callback === \"function\" ? callback : function() {\n                //need to set selected values again after change search criteria\n                self.listView.setValue(_.keys(self.model.get(\"value\")), {silent: true});\n                self.listView.activate(0);\n            });\n            self.listView.fetch();\n        });\n    },\n\n    clearFilter: function(callback) {\n        if (this.model.get(\"criteria\")) {\n            this.$el.find(\"input\").val(\"\");\n            this.model.set(\"criteria\", \"\", {silent: true});\n\n            this.changeFilter(callback);\n        } else {\n            this.model.unset(\"totalValues\", {silent: true});\n            callback && callback();\n        }\n    },\n\n    processSelectionThroughApi: function(selection, options) {\n        var newValues = {};\n\n        this.selectionClear();\n\n        for (let i = 0; i < selection.length; i += 1) {\n            const value = selection[i];\n            if (this.caseSensitiveSelection) {\n                newValues[value] = true;\n            } else {\n                newValues[value.toLowerCase()] = value;\n            }\n        }\n\n        this.model.attributes.value = newValues;\n        if (!options || !options.silent) {\n            this.model.trigger(\"change:value\");\n        }\n    },\n\n    convertSelectionForListViewModel: function(selection) {\n        return selection;\n    },\n\n    /* Internal methods */\n\n    getModelForRendering: function() {\n        return {\n            label: this.label,\n            isIPad: browserDetection.isIPad(),\n            disabled: this.model.get(\"disabled\"),\n            i18n: i18n\n        }\n    },\n\n    /* API */\n\n    fetch: function(callback, options) {\n        var criteria = this.model.get(\"criteria\");\n\n        if (typeof criteria === \"undefined\" || criteria === \"\") {\n            this.model.unset(\"totalValues\", {silent: true});\n        }\n\n        this.listView.fetch(callback, options);\n    },\n\n    resize: function() {\n        this.listView.resize();\n        this.setBulkSelectionText();\n    },\n\n    reset: function(options) {\n        var self = this;\n\n        this.clearFilter(function() {\n            self.listView.reset(options);\n        });\n    },\n\n    getValue: function() {\n        const currentValues = this.model.get(\"value\");\n        if (this.caseSensitiveSelection) {\n            return Object.keys(currentValues);\n        } else {\n            return Object.values(currentValues);\n        }\n    },\n\n    setValue: function(value, options) {\n        options = options || {};\n\n        this.listViewModel.once(\"selection:change\", function () {\n            this.selectionClear();\n            const selection = this.listViewModel.getSelection();\n\n            for (let i = 0; i < selection.length; i++) {\n                const value = selection[i];\n                if (this.caseSensitiveSelection) {\n                    this.model.attributes.value[value] = true;\n                } else {\n                    this.model.attributes.value[value.toLowerCase()] = value;\n                }\n            }\n\n            if (!options || !options.silent) {\n                this.changeValue();\n            }\n        }, this);\n\n        if (!_.isArray(value) && typeof value !== \"string\") {\n            value = this.convertSelectionForListViewModel(value);\n        }\n\n        this.listViewModel.select(value, options.modelOptions);\n    },\n\n    setDisabled: function(disabled) {\n        this.model.set(\"disabled\", disabled);\n    },\n\n    getDisabled: function() {\n        return this.model.get(\"disabled\");\n    },\n\n    remove: function() {\n        this.listView.remove();\n        Backbone.View.prototype.remove.call(this);\n\n        $(\"body\").off(\"mousedown\", this.onGlobalMousedown)\n            .off(\"mouseup\", this.onGlobalMouseup)\n            .off(\"mousemove\", this.onGlobalMousemove);\n\n        $(window).off(\"resize\", this._debouncedOnResize);\n    }\n\n});\n\nexport default AvailableItemsList;\n","export default \"<div class=\\\"jr-mMultiselect-search jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <input class=\\\"jr-mInput-search jr\\\" type=\\\"text\\\">\\n</div>\\n\\n<div class=\\\"jr-mMultiselect-list jr\\\"></div>\\n\\n<div class=\\\"jr-mMultiselect-buttonContainer jr\\\">\\n    <ul class=\\\"jr-mItemselector jr\\\">\\n        <li  title=\\\"{{- i18n['sic.multiselect.selectAll'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectAll\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-checkmark jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.selectAll'] }}</span>\\n            </a>\\n        </li>\\n\\n        <li  title=\\\"{{- i18n['sic.multiselect.deselectAll'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectNone\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-cancel jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.deselectAll'] }}</span>\\n            </a>\\n        </li>\\n\\n        <li  title=\\\"{{- i18n['sic.multiselect.inverse'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-40pc jr jr-jInvert\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-invert jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.inverse'] }}</span>\\n            </a>\\n        </li>\\n    </ul>\\n</div>\";","export default \"<div class=\\\"jr-mMultiselect-search jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <input class=\\\"jr-mInput-search jr\\\" type=\\\"text\\\" placeholder=\\\"{{- i18n['sic.multiselect.search']}}\\\">\\n</div>\\n\\n<div class=\\\"jr-mMultiselect-list jr\\\"></div>\\n\\n<div class=\\\"jr-mMultiselect-buttonContainer jr\\\">\\n    <ul class=\\\"jr-mItemselector jr\\\">\\n        <li  title=\\\"{{- i18n['sic.multiselect.selectAll'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectAll\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-checkmark jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.selectAll'] }}</span>\\n            </a>\\n        </li>\\n\\n        <li  title=\\\"{{- i18n['sic.multiselect.deselectAll'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectNone\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-cancel jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.deselectAll'] }}</span>\\n            </a>\\n        </li>\\n\\n        <li  title=\\\"{{- i18n['sic.multiselect.inverse'] }}\\\" class=\\\"jr-mItemselector-button jr-uWidth-40pc jr jr-jInvert\\\">\\n            <span class=\\\"jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-invert jr\\\"></span>\\n            <a class=\\\"jr-mItemselector-button-label jr\\\">\\n                <span class=\\\"jr\\\">{{- i18n['sic.multiselect.inverse'] }}</span>\\n            </a>\\n        </li>\\n    </ul>\\n</div>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport ListWithNavigation from '../../scalableList/view/ListWithNavigation';\nvar ListViewForSelectedItemsList = ListWithNavigation.extend({\n    _multiSelect: function (event, value, index) {\n        if ($(event.target).hasClass('jr-mSelectlist-item-delete')) {\n            if (!this.model.selectionContains(value, index)) {\n                this._singleSelect(event, value, index);\n            }\n        } else {\n            ListWithNavigation.prototype._multiSelect.call(this, event, value, index);\n        }\n    }\n});\nexport default ListViewForSelectedItemsList;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport browserDetection from '../../../common/util/browserDetection';\nimport i18n from '../../../i18n/ScalableInputControlsBundle.properties';\n\nimport KeyboardManager from '../../singleSelect/manager/KeyboardManager';\nimport ListWithSelectionModel from '../../scalableList/model/ListWithSelectionModel';\nimport listWithNavigationModelTrait from '../../scalableList/model/listWithNavigationModelTrait';\nimport scalableListItemHeightCalculationTrait from '../mixin/scalableListItemHeightCalculationTrait';\nimport selectedItemsListTemplate from '../templates/selectedItemsTemplate.htm';\nimport itemsTemplate from '../templates/selectedItemsListTemplate.htm';\nimport listTemplate from '../templates/listTemplate.htm';\nimport ListViewForSelectedItemsList from '../view/ListViewForSelectedItemsList';\n\nvar SelectedItemsList = Backbone.View.extend({\n    className: 'jr-mMultiselect-listContainer jr-isInactive jr',\n    events: function () {\n        return {\n            'keydown input': this.keyboardManager.onKeydown,\n            'focus input': 'onFocus',\n            'blur input': 'onBlur',\n            'mouseup .jr-mSelectlist-item-delete': 'onMouseupOnDeleteButton',\n            'mousedown': 'onMousedown',\n            'mouseup': 'onMouseup'\n        };\n    },\n    keydownHandlers: _.extend({\n        '65': 'onAKey',\n        '8': 'onDeleteKey',\n        '46': 'onDeleteKey'\n    }, KeyboardManager.prototype.keydownHandlers),\n    initialize: function (options) {\n        if (!this.model) {\n            this.model = new Backbone.Model();\n        }\n        this.model.set('focused', false, { silent: true });\n        this.template = _.template(selectedItemsListTemplate);\n        this.keyboardManager = new KeyboardManager({\n            keydownHandlers: this.keydownHandlers,\n            keydownTimeout: options.keydownTimeout,\n            context: this,\n            deferredKeydownHandler: this.processKeydown,\n            immediateHandleCondition: this.immediateHandleCondition,\n            immediateKeydownHandler: this.immediateKeydownHandler,\n            stopPropagation: true\n        });\n        var ListWithNavigationModel = ListWithSelectionModel.extend(listWithNavigationModelTrait);\n        this.listViewModel = options.listViewModel || new ListWithNavigationModel({\n            getData: options.getData,\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor\n        });\n        this.listView = options.listView || _.extend(new ListViewForSelectedItemsList({\n            el: options.listElement || $(listTemplate),\n            model: this.listViewModel,\n            chunksTemplate: options.chunksTemplate,\n            itemsTemplate: options.itemsTemplate || itemsTemplate,\n            scrollTimeout: options.scrollTimeout,\n            lazy: true,\n            selectedClass: 'is-selected',\n            selection: {\n                allowed: true,\n                multiple: false\n            }\n        }), scalableListItemHeightCalculationTrait);\n        this.initListeners();\n        this.render().resize();\n    },\n    initListeners: function () {\n        this.listenTo(this.listView, 'active:changed', this.activeChange, this);\n        this.listenTo(this.model, 'change:focused', this.focusStateChanged, this);\n        this.listenTo(this.model, 'change:disabled', this.changeDisabled, this);\n        this.listenTo(this.listViewModel, 'change', this.onModelChange, this);\n    },\n    render: function () {\n        this.listView.undelegateEvents();\n        var selectedItemsList = $(this.template({\n            disabled: this.model.get('disabled'),\n            i18n: i18n\n        }));\n        this.$el.empty().append(selectedItemsList).find('.jr-mMultiselect-list').append(this.listView.el);\n        this.listView.render();\n        this.listView.delegateEvents();\n        return this;\n    },\n    renderData: function () {\n        this.listView.renderData();\n        return this;\n    },\n    activeChange: function (active) {\n        if (active) {\n            this.listView.scrollTo(active.index);\n        } else {\n            this.listViewModel.clearSelection();\n        }\n    },\n    changeDisabled: function () {\n        var disabled = this.model.get('disabled');\n        if (disabled) {\n            this.$el.find('input[type=\\'text\\']').attr('disabled', 'disabled');\n            this.listView.setValue({});\n            this.listView.activate(undefined);\n        } else {\n            this.$el.find('input[type=\\'text\\']').removeAttr('disabled');\n        }\n        this.listView.setDisabled(disabled);\n    },\n    focusStateChanged: function () {\n        if (this.model.get('focused')) {\n            this.$el.find('.mSelect-svListPlaceholder').addClass('focused');\n        } else {\n            this.$el.find('.mSelect-svListPlaceholder').removeClass('focused');\n        }\n    },\n    onModelChange: function () {\n        if (!this.listViewModel.get('total')) {\n            this.listView.$el.hide();\n        } else {\n            this.listView.$el.show();\n        }\n    },\n    onFocus: function () {\n        this.model.set('focused', true);\n    },\n    onBlur: function () {\n        if (!this.preventBlur) {\n            this.model.set('focused', false);\n        }\n    },\n    onMouseupOnDeleteButton: function (event) {\n        this.onDeleteKey(event);\n    },\n    onMousedown: function () {\n        if (!browserDetection.isIPad()) {\n            this.preventBlur = true;\n            if (!this.model.get('focused')) {\n                this.$el.find('input').focus();\n            }\n        }\n    },\n    onMouseup: function () {\n        if (this.preventBlur) {\n            this.$el.find('input').focus();\n            delete this.preventBlur;\n        }\n    },\n    onUpKey: function (event) {\n        this.listView.activatePrevious();\n    },\n    onDownKey: function (event) {\n        var active = this.listView.getActiveValue();\n        if (active) {\n            this.listView.activateNext();\n        } else {\n            this.listView.activateFirst();\n        }\n    },\n    onEnterKey: function (event) {\n    },\n    onHomeKey: function (event) {\n        this.listView.activateFirst();\n    },\n    onEndKey: function (event) {\n        this.listView.activateLast();\n    },\n    onPageUpKey: function (event) {\n        this.listView.pageUp();\n    },\n    onPageDownKey: function (event) {\n        this.listView.pageDown();\n    },\n    onTabKey: function () {\n    },\n    onAKey: function (event) {\n    },\n    onDeleteKey: function (event) {\n        const selectedValues = this.listViewModel.getSelection();\n        if (!selectedValues || selectedValues.length === 0) {\n            return;\n        }\n        let emptySelection = true;\n        for (let index in selectedValues) {\n            if (selectedValues.hasOwnProperty(index) && selectedValues[index] !== undefined) {\n                emptySelection = false;\n                break;\n            }\n        }\n        if (!emptySelection) {\n            this.trigger('selection:remove', selectedValues);\n        }\n    },\n    fetch: function (callback, options) {\n        this.listView.setValue({});\n        this.listView.activate(undefined);\n        this.listView.fetch(callback, options);\n    },\n    resize: function () {\n        this.listView.resize();\n    },\n    setDisabled: function (disabled) {\n        this.model.set('disabled', disabled);\n    },\n    getDisabled: function () {\n        return this.model.get('disabled');\n    },\n    remove: function () {\n        this.listView.remove();\n        Backbone.View.prototype.remove.call(this);\n    }\n});\nexport default SelectedItemsList;","export default \"<!--\\nthis input only for technical purposes:\\nit allows selected items list to get focus\\nand have proper tab position\\n(simple tabindex=\\\"0\\\" on DOM element will broke tab index sequence)\\n-->\\n\\n    <js-templateNonce></js-templateNonce>\\n<div class=\\\"jr-mMultiselect-list jr\\\">\\n    <input type=\\\"text\\\" style=\\\"position: absolute; left: -9999px\\\" {{ if (disabled) { }}disabled=\\\"disabled\\\"{{ } }}>\\n    <!-- list position -->\\n    <div class=\\\"jr-mMultiselect-list-message jr-isHidden jr\\\">\\n        {{- i18n['sic.multiselect.noSelection'] }}\\n    </div>\\n</div>\";","export default \"<ul class=\\\"jr-mSelectlist jr-mSelectlistSelected jr\\\" style=\\\"top: {{- top}}px; position: relative;\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{_.each(items, function(item) { }}\\n    <li class=\\\"jr-mSelectlist-item jr-isSelected {{ if (item.active) print(' jr-isHovered'); }} jr\\\" title=\\\"{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}\\\" data-index=\\\"{{- item.index}}\\\">\\n        <div class=\\\"jr-mSelectlist-item-wrapper jr\\\">\\n            <a class=\\\"jr-mSelectlist-item-delete jr\\\"></a>\\n            <a class=\\\"jr-mSelectlist-item-text jr\\\">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : '&nbsp;')}}</a>\\n        </div>\\n    </li>\\n    {{ }); }}\\n</ul>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport _ from 'underscore';\nvar CacheableDataProvider = function (data) {\n    _.bindAll(this, 'getData', 'getAllCachedData');\n    this.data = data || [];\n};\n_.extend(CacheableDataProvider.prototype, {\n    setData: function (data) {\n        this.data = data || [];\n    },\n    getAllCachedData: function () {\n        return this.data;\n    },\n    getData: function (options) {\n        var deferred = new $.Deferred();\n        var first = options && options.offset ? options.offset : 0;\n        var last = options && options.limit ? first + options.limit : this.data.length;\n        var dataSegment = this._getDataSegment(this.data, first, last);\n        deferred.resolve({\n            data: dataSegment,\n            total: this.data.length\n        });\n        return deferred.promise();\n    },\n    _getDataSegment: function (values, first, last) {\n        last = Math.min(last, values.length);\n        var result = [];\n        for (var i = first; i < last; i++) {\n            result.push({\n                label: values[i].label,\n                value: values[i].value\n            });\n        }\n        return result;\n    }\n});\nexport default CacheableDataProvider;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport CacheableDataProvider from '../../singleSelect/dataprovider/CacheableDataProvider';\nvar SelectedItemsDataProvider = function (options) {\n    options = options || {};\n    _.defaults(options, {\n        sortFunc: this._sortFunc,\n        formatLabel: this._formatLabel\n    });\n    this.sortFunc = options.sortFunc;\n    this.formatLabel = options.formatLabel;\n    CacheableDataProvider.call(this, options.data);\n};\n_.extend(SelectedItemsDataProvider.prototype, CacheableDataProvider.prototype);\n_.extend(SelectedItemsDataProvider.prototype, {\n    setData: function (data) {\n        data = this._convertToStandardData(data);\n        data = this._sortData(data);\n        CacheableDataProvider.prototype.setData.call(this, data);\n    },\n    _sortFunc: function (item1, item2) {\n        return item1.label.localeCompare(item2.label);\n    },\n    _formatLabel: function (value) {\n        return value;\n    },\n    _sortData: function (data) {\n        data = data || [];\n        return data.sort(this.sortFunc);\n    },\n    _convertToStandardData: function (data) {\n        var self = this;\n        return _.map(data, function (value) {\n            return {\n                value: value,\n                label: self.formatLabel(value)\n            };\n        });\n    }\n});\nexport default SelectedItemsDataProvider;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport sizerTemplate from './template/sizerTemplate.htm';\nimport logger from \"../../common/logging/logger\";\n\nimport 'jquery-ui/ui/widgets/resizable';\n\nlet log = logger.register(\"Sizer\");\n\nexport default Backbone.View.extend({\n    template: _.template(sizerTemplate),\n    el: function () {\n        return this.template();\n    },\n    initialize: function (options) {\n        this.container = options.container;\n        this.sizerOptions = _.clone(options);\n        delete this.sizerOptions.container;\n        this.$container = $(this.container);\n        this.render();\n    },\n    render: function () {\n        _.defaults(this.sizerOptions, {\n            minHeight: this.$container.height(),\n            handles: { s: this.$el }\n        });\n        this.$container.resizable(this.sizerOptions);\n        return this;\n    },\n    show: function () {\n        this.$el.removeClass('jr-isInvisible');\n        return this;\n    },\n    hide: function () {\n        this.$el.addClass('jr-isInvisible');\n        return this;\n    },\n    updateMinMax: function (boundaries) {\n        this.$container.resizable('option', 'minHeight', boundaries.minHeight);\n        this.$container.resizable('option', 'maxHeight', boundaries.maxHeight);\n    },\n    remove: function () {\n        try {\n            this.$container.resizable('destroy');\n        } catch (err) {\n            log.debug(err);\n        }\n        Backbone.View.prototype.remove.apply(this, arguments);\n    }\n});","export default \"<div class=\\\"jr-mSizer jr-mSizerVertical ui-resizable-s jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <span class=\\\"ui-icon ui-icon-grip-solid-horizontal\\\"></span>\\n</div>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\nimport _ from 'underscore';\nimport NumberUtils from '../../../common/util/parse/NumberUtils';\nimport doCalcOnVisibleNodeClone from '../../scalableList/util/domAndCssUtil';\nimport browserDetection from '../../../common/util/browserDetection';\nimport i18n from '../../../i18n/ScalableInputControlsBundle.properties';\nimport xssUtil from '../../../common/util/xssUtil';\nimport AvailableItemsList from '../view/AvailableItemsList';\nimport SelectedItemsList from '../view/SelectedItemsList';\nimport multiSelectTemplate from '../templates/multiSelectTemplate.htm';\nimport SelectedItemsDataProvider from '../dataprovider/SelectedItemsDataProvider';\nimport Sizer from '../../sizer/Sizer';\n\nlet doCalcOnVisibleNodeCloneObj = doCalcOnVisibleNodeClone.doCalcOnVisibleNodeClone;\n\nvar numberUtils = new NumberUtils();\nvar SELECTION_CHANGE_TIMEOUT = 300;\nvar DEFAULT_VISIBLE_ITEMS_COUNT = 10;\nvar DEFAULT_MIN_ITEMS_COUNT = 3;\nexport default Backbone.View.extend({\n    className: 'jr-mMultiselect jr',\n    events: function () {\n        return { 'click  .jr-mMultiselect-toggle': 'toggleLists' };\n    },\n    initialize: function (options) {\n        this.template = _.template(multiSelectTemplate);\n        this.i18n = {\n            selected: i18n['sic.multiselect.toggle.selected'],\n            available: i18n['sic.multiselect.toggle.available']\n        };\n        this.heightAutoAdjustment = _.isUndefined(options.heightAutoAdjustment) ? true : options.heightAutoAdjustment;\n        this.availableItemsListModel = this._createAvailableItemsListModel(options);\n        this.availableItemsList = this._createAvailableItemsList(options);\n        this.selectedItemsDataProvider = this._createSelectedItemsListDataProvider(options);\n        this.selectedItemsList = this._createSelectedItemsList(options);\n        this.height = options.height;\n        this.resizable = options && options.resizable;\n        this.caseSensitiveSelection = options.caseSensitiveSelection;\n        this.initListeners();\n        if (typeof options.value !== 'undefined') {\n            this.silent = true;\n            this.availableItemsList.setValue(options.value);\n        }\n        if (options && options.resizable) {\n            this.sizer = new Sizer({\n                container: this.$el,\n                stop: _.bind(function () {\n                    this.resize();\n                }, this)\n            });\n        }\n        this.render();\n    },\n    _createAvailableItemsListModel: function (options) {\n        return new Backbone.Model();\n    },\n    _createAvailableItemsList: function (options) {\n        return options.availableItemsList || new AvailableItemsList({\n            model: this.availableItemsListModel,\n            getData: options.getData,\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor,\n            chunksTemplate: options.chunksTemplate,\n            scrollTimeout: options.scrollTimeout,\n            keydownTimeout: options.keydownTimeout,\n            caseSensitiveSelection: options.caseSensitiveSelection\n        });\n    },\n    _createSelectedItemsListDataProvider: function (options) {\n        return options.selectedItemsDataProvider || new SelectedItemsDataProvider(options.selectedListOptions);\n    },\n    _createSelectedItemsList: function (options) {\n        this.formatValue = options.formatValue;\n        return new SelectedItemsList({\n            getData: this.selectedItemsDataProvider.getData,\n            bufferSize: options.bufferSize,\n            loadFactor: options.loadFactor,\n            chunksTemplate: options.chunksTemplate,\n            scrollTimeout: options.scrollTimeout\n        });\n    },\n    initListeners: function () {\n        this.listenTo(this.availableItemsList, 'selection:change', this.selectionChange, this);\n        this.listenTo(this.availableItemsList, 'listRenderError', this.listRenderError, this);\n        this.listenTo(this.availableItemsListModel, 'change:totalValues', this._availableItemsTotalCountChange, this);\n        this.listenTo(this.selectedItemsList, 'selection:remove', this.selectionRemoved, this);\n    },\n    render: function () {\n        this.sizer && this.sizer.$el.detach();\n        this.$el.html($(this.template({ i18n: i18n })));\n        this.$toggleContainer = this.$el.find('.jr-mMultiselect-toggleContainer');\n        this.availableItemsList.undelegateEvents();\n        this.selectedItemsList.undelegateEvents();\n        this.selectedItemsList.$el.insertAfter(this.$toggleContainer);\n        this.availableItemsList.$el.insertAfter(this.$toggleContainer);\n        this.availableItemsList.render();\n        this.selectedItemsList.render();\n        this._updateAvailableItemsCountLabel();\n        this._updateSelectedItemsCountLabel();\n        this.availableItemsList.delegateEvents();\n        this.selectedItemsList.delegateEvents();\n        this._tuneCSS();\n        this._renderSizer();\n        return this;\n    },\n    _renderSizer: function () {\n        if (this.sizer) {\n            this.heightAutoAdjustment && this._handleHeight();\n            this.$el.append(this.sizer.$el);\n        }\n    },\n    _tuneCSS: function () {\n        var self = this;\n        if (!this._cssDepententSizesSet) {\n            doCalcOnVisibleNodeCloneObj({\n                el: this.$el,\n                css: { 'width': '500px' },\n                classes: 'jr',\n                alwaysClone: true,\n                callback: function ($el) {\n                    self.toggleContainerHeight = $el.find('.jr-mMultiselect-toggleContainer').outerHeight();\n                    self._tuneCSSInternal($el);\n                    $el.find('.jr-mScalablelist').css({ height: '0' });\n                    self._emptyContainerHeight = $el.outerHeight();\n                    var height;\n                    if (self.height) {\n                        height = self.height;\n                    } else {\n                        height = self._calcHeightByItemsCount(DEFAULT_VISIBLE_ITEMS_COUNT);\n                    }\n                    self.$el.css('height', height);\n                }\n            });\n            this._cssDepententSizesSet = true;\n        }\n        this._tuneCSSInternal(this.$el);\n    },\n    _tuneCSSInternal: function ($el) {\n        var toggleContainerHeight = this.toggleContainerHeight;\n        browserDetection.isIPad() && this.$el.addClass('ipad');\n        $el.find('.jr-mMultiselect-listContainer').css('padding-top', toggleContainerHeight);\n    },\n    listRenderError: function (responseStatus, error) {\n        this.trigger('listRenderError', responseStatus, error);\n    },\n    toggleLists: function (evt) {\n        evt.stopPropagation();\n        if ($(evt.currentTarget).hasClass('jr-isActive')) {\n            return;\n        }\n        this.$el.find('.jr-mMultiselect-toggle').toggleClass('jr-isActive jr-isInactive');\n        this.$el.find('.jr-mMultiselect-listContainer').toggleClass('jr-isActive jr-isInactive');\n        if (!browserDetection.isIPad()) {\n            this.$el.find('.jr-mMultiselect-listContainer.jr-isActive input').focus();\n        }\n    },\n    selectionChange: function (selection) {\n        clearTimeout(this.selectionChangeTimeout);\n        this.selectionChangeTimeout = setTimeout(_.bind(this.selectionChangeInternal, this, selection), SELECTION_CHANGE_TIMEOUT);\n    },\n    selectionRemoved: function (selection) {\n        const currentAvailableValues = this.availableItemsList.model.get('value');\n\n        for (let i = 0; i < selection.length; i += 1) {\n            let value = selection[i];\n            if (!value) {\n                continue;\n            }\n            if (!this.caseSensitiveSelection) {\n                value = value.toLowerCase();\n            }\n            delete currentAvailableValues[value];\n        }\n\n        let newValues;\n        if (this.caseSensitiveSelection) {\n            newValues = Object.keys(currentAvailableValues);\n        } else {\n            newValues = Object.values(currentAvailableValues);\n        }\n        this.availableItemsList.setValue(newValues);\n    },\n    selectionChangeInternal: function (selection) {\n        var self = this, activeValue = this.selectedItemsList.listView.getActiveValue(), scrollTop = this.selectedItemsList.listView.$el.scrollTop();\n        this.selectedItemsDataProvider.setData(selection);\n        this.selectedItemsList.fetch(function () {\n            self._updateSelectedItemsCountLabel();\n            self.selectedItemsList.resize();\n            self.selectedItemsList.listView.$el.scrollTop(scrollTop);\n            if (activeValue && self.selectedItemsList.$el.hasClass('j-active')) {\n                var total = self.selectedItemsList.listView.model.get('total');\n                if (total && total > activeValue.index) {\n                    self.selectedItemsList.listView.activate(activeValue.index);\n                } else if (total) {\n                    self.selectedItemsList.listView.activate(activeValue.index - 1);\n                }\n            }\n        });\n        if (!this.silent) {\n            this.triggerSelectionChange();\n        } else {\n            delete this.silent;\n        }\n    },\n    _setToggleLabel: function (target, count, text) {\n        var labelCount = numberUtils.formatNumber(count), $labelEl = this.$el.find(target + ' .jr-mMultiselect-toggle-label'), labelText = text + ': ' + labelCount;\n        $labelEl.text(labelText).attr('title', xssUtil.hardEscape(labelText));\n    },\n    _handleHeight: function () {\n        var totalItems = this.availableItemsList.model.get('totalValues') || 0;\n        if (!this._cssDepententSizesSet || !totalItems) {\n            return;\n        }\n        var currentHeight = this.$el.height(), height = this.$el.height();\n        var minHeight = this._calcHeightByItemsCount(DEFAULT_MIN_ITEMS_COUNT);\n        var maxHeight = this._calcHeightByItemsCount(totalItems);\n        if (totalItems <= DEFAULT_VISIBLE_ITEMS_COUNT) {\n            minHeight = maxHeight = height = this._calcHeightByItemsCount(Math.max(DEFAULT_MIN_ITEMS_COUNT, totalItems));\n        } else if (currentHeight > maxHeight) {\n            height = this._calcHeightByItemsCount(totalItems);\n        }\n        this.$el.css('height', height + 'px');\n        this._updateSizerVisibility({\n            minHeight: minHeight,\n            maxHeight: maxHeight\n        });\n    },\n    _updateSizerVisibility: function (boundaries) {\n        if (!this.sizer) {\n            return;\n        }\n        this.sizer.updateMinMax(boundaries);\n        if (boundaries.minHeight === boundaries.maxHeight) {\n            this.sizer.hide();\n        } else {\n            this.sizer.show();\n        }\n    },\n    _calcHeightByItemsCount: function (items) {\n        var itemHeight = this.availableItemsList.listView.itemHeight;\n        return items * itemHeight + this._emptyContainerHeight;\n    },\n    _availableItemsTotalCountChange: function () {\n        this._updateAvailableItemsCountLabel();\n        this.heightAutoAdjustment && this._handleHeight();\n    },\n    _updateAvailableItemsCountLabel: function () {\n        var total = this.availableItemsList.model.get('totalValues') || 0;\n        this._setToggleLabel('.jr-mMultiselect-toggleAvailable', total || 0, this.i18n.available);\n    },\n    _updateSelectedItemsCountLabel: function () {\n        var $noSelection = this.$el.find('.jr-mMultiselect-list-message'), count = this.selectedItemsList.listView.model.get('total') || 0;\n        this._setToggleLabel('.jr-mMultiselect-toggleSelected', count, this.i18n.selected);\n        if (count === 0) {\n            $noSelection.removeClass('jr-isHidden');\n        } else {\n            $noSelection.addClass('jr-isHidden');\n        }\n    },\n    triggerSelectionChange: function () {\n        this.trigger('selection:change', this.getValue());\n    },\n    renderData: function () {\n        this.availableItemsList.renderData();\n        this.selectedItemsList.renderData();\n        return this;\n    },\n    fetch: function (callback, options) {\n        this.availableItemsList.fetch(callback, options);\n    },\n    reset: function (options) {\n        this.availableItemsList.reset(options);\n    },\n    resize: function () {\n        _.debounce(_.bind(function () {\n            this.availableItemsList.resize();\n            this.selectedItemsList.resize();\n        }, this), 500)();\n    },\n    setValue: function (value, options) {\n        if (options && options.silent) {\n            this.silent = true;\n        }\n        delete options.silent;\n        this.availableItemsList.setValue(value, options);\n    },\n    getValue: function () {\n        var value = this.availableItemsList.getValue();\n        var result = [];\n        var i = 0;\n        for (var index in value) {\n            if (value.hasOwnProperty(index) && value[index] !== undefined) {\n                result[i++] = value[index];\n            }\n        }\n        return result;\n    },\n    setDisabled: function (disabled) {\n        this.availableItemsList.setDisabled(disabled);\n        this.selectedItemsList.setDisabled(disabled);\n        return this;\n    },\n    getDisabled: function () {\n        return this.availableItemsList.getDisabled();\n    },\n    remove: function () {\n        this.availableItemsList.remove();\n        this.selectedItemsList.remove();\n        this.sizer && this.sizer.remove();\n        Backbone.View.prototype.remove.call(this);\n    },\n    clearFilter: function () {\n        this.availableItemsList.clearFilter();\n    }\n});\n","export default \"<div class=\\\"jr-mMultiselect-toggleContainer jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n    <div class=\\\"jr-mMultiselect-toggle jr-mMultiselect-toggleAvailable jr-isActive jr\\\" title=\\\"\\\">\\n        <span class=\\\"jr-mMultiselect-toggle-label jr\\\" title=\\\"\\\"></span>\\n    </div>\\n    <div class=\\\"jr-mMultiselect-toggle jr-mMultiselect-toggleSelected jr-isInactive jr\\\">\\n        <span class=\\\"jr-mMultiselect-toggle-label jr\\\" title=\\\"\\\"></span>\\n    </div>\\n</div>\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport default {\n    create: function (specialValue) {\n        return function (item1, item2) {\n            if (item1.label === specialValue) {\n                return -1;\n            } else if (item2.label === specialValue) {\n                return 1;\n            } else {\n                return item1.label.localeCompare(item2.label);\n            }\n        };\n    }\n};","import {\n    InputControlsServiceType, PaginatedControl, PaginatedControlOption,\n    PaginatedValuesOptions\n} from '../rest/types/InputControlsServiceType';\nimport {\n    InputControlsDataProviderType as InputControlsDataProviderInterface,\n    InputControlsDataProviderOptions\n} from './types/InputControlsDataProviderType';\n\nexport default class InputControlsDataProvider implements InputControlsDataProviderInterface {\n    private readonly inputControlsService: InputControlsServiceType;\n\n    private readonly controlId: string;\n\n    // @ts-ignore: unused property TODO: why we need it? it's really never used\n    private additionalParams: {select?: string, value?: string[]};\n\n    constructor(options: InputControlsDataProviderOptions) {\n        this.controlId = options.controlId;\n        this.inputControlsService = options.inputControlsService;\n        this.additionalParams = {};\n    }\n\n    getData(uri: string, serviceOptions: PaginatedValuesOptions[]) {\n        const result = this.inputControlsService\n            .getInputControlsPaginatedValues(uri, serviceOptions).then((response) => {\n                const state: PaginatedControl[] = response && response.inputControlState ? response.inputControlState : [];\n                const controlData = state.find((control) => {\n                    return control.id === this.controlId;\n                }) || {\n                    id: '',\n                    uri: '',\n                    options: [],\n                    totalCount: '0'\n                };\n\n                const data = controlData.options && controlData.options.map((option) => {\n                    return {\n                        ...option\n                    };\n                });\n\n                return {\n                    data,\n                    total: parseInt(controlData.totalCount, 10)\n                }\n            });\n\n        return (result as unknown) as Promise<{\n            data: PaginatedControlOption[],\n            total: number\n        }>\n    }\n}\n","import { InputControlsDataProviderType } from './types/InputControlsDataProviderType';\nimport { InputControlsDataProviderWithDataLabelHashType } from './types/InputControlsDataProviderWithDataLabelHashType';\nimport { PaginatedValuesOptions } from '../rest/types/InputControlsServiceType';\n\ninterface InputControlsDataProviderWithDataLabelHashOptions {\n    inputControlsDataProvider: InputControlsDataProviderType\n}\n\nexport default class InputControlsDataProviderWithDataLabelHash implements InputControlsDataProviderWithDataLabelHashType {\n    private readonly inputControlsDataProvider: InputControlsDataProviderType;\n\n    private readonly dataLabelHash: {[key: string]: string};\n\n    constructor(options: InputControlsDataProviderWithDataLabelHashOptions) {\n        this.dataLabelHash = {};\n        this.inputControlsDataProvider = options.inputControlsDataProvider;\n    }\n\n    getData(uri: string, options: PaginatedValuesOptions[]) {\n        return this.inputControlsDataProvider.getData(uri, options).then((response) => {\n            const {\n                data,\n                total\n            } = response;\n\n            data.forEach((option) => {\n                this.dataLabelHash[option.value] = option.label;\n            });\n\n            return {\n                data,\n                total\n            }\n        });\n    }\n\n    getLabelByValue(value: string) {\n        return this.dataLabelHash[value];\n    }\n}\n","import { PaginatedValuesOptions } from '../../rest/types/InputControlsServiceType';\n\nexport default (\n    options: {\n        criteria?: string,\n        offset: number,\n        limit?: number,\n        name: string,\n        paginatedValuesOptions: PaginatedValuesOptions[] | undefined\n    }\n) => {\n    const {\n        paginatedValuesOptions,\n        ...controlOptions\n    } = options;\n\n    if (paginatedValuesOptions && paginatedValuesOptions.length > 0) {\n        return paginatedValuesOptions.map((option) => {\n            if (option.name === controlOptions.name) {\n                return { ...option, ...controlOptions };\n            }\n\n            return option;\n        });\n    }\n\n    return [\n        {\n            ...controlOptions\n        }\n    ]\n};\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n *\n * TODO: Not_Used_Anywhere\n */\n\n/* global updateYearMonth*/\n\nimport {JRS} from \"../namespace/namespace\";\nimport jQuery from 'jquery';\nimport _ from 'underscore';\nimport './controls.core';\nimport {ControlsBase} from \"./controls.base\";\nimport SingleSelect from \"js-sdk/src/components/singleSelect/view/SingleSelectNew\";\nimport MultiSelect from \"js-sdk/src/components/multiSelect/view/MultiSelect\";\nimport DateAndTimePicker from \"js-sdk/src/components/dateAndTime/DateAndTimePicker\";\nimport selectedItemsDataProviderSorterFactory from \"js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory\";\nimport dateUtil from 'js-sdk/src/common/util/parse/date';\n\nimport InputControlsDataProvider from './dataprovider/InputControlsDataProvider';\nimport InputControlsDataProviderWithDataLabelHash from './dataprovider/InputControlsDataProviderWithDataLabelHash';\nimport DataProviderWithSearchCache from 'js-sdk/src/common/component/tree/dataprovider/DataProviderWithSearchCache';\n\nimport getInputControlsDataProviderNewPageOptions from './dataprovider/util/getInputControlsDataProviderNewPageOptions';\n\nimport \"./controls.basecontrol\";\nimport { showErrorPopup } from '../core/core.ajax.utils';\nimport RestParamsEnum from './rest/enum/restParamsEnum';\n\nconst getInitialSelectedValuesToLabelMap = (initialSelectedValues) => {\n    return initialSelectedValues.reduce((memo, selectedValue) => {\n        memo[selectedValue.value] = selectedValue.label || selectedValue.value;\n        return memo;\n    }, {});\n};\n\nJRS.Controls = (function (jQuery, _, Controls) {\n\n    //module:\n    //\n    //  controls.components\n    //\n    //summary:\n    //\n    //  Provide default input controls types\n    //\n    //main types:\n    //\n    //  Bool, SingleValue, SingleValueDate, SingleSelect, MultiSelect, MultiSelectCheckbox, SingleSelectRadio - default\n    //  input controls\n    //\n    //  ReportOptions - special control, not connected with cascade\n    //\n    //dependencies:\n    //\n    //  jQuery          - jquery v1.7.1\n    //  _,         - underscore.js 1.3.1\n    //  Controls   - controls.core module\n    function changeDateFunc(dateText) {\n        const prevSelection = Controls.BaseControl.prototype.get.call(this, 'selection');\n        if (!prevSelection || prevSelection[0] !== dateText) {\n            this.set({ selection: [dateText] });\n        }\n    }\n\n    function getNormalizedDatetimeValue(rawValue) {\n        var normalizedValue = rawValue.toUpperCase().replace(/([\\s]+$|^[\\s]+)/g, \"\");\n        return normalizedValue.replace(/[\\s]*(\\+|\\-)[\\s]*/g, \"$1\");\n    }\n\n    return _.extend(Controls, {\n        Bool: Controls.BaseControl.extend({\n\n            setValue:function (controlData) {\n                var container = this.getElem();\n                var input = container.find('input');\n                if (controlData == \"true\") {\n                    input.prop('checked', true);\n                } else {\n                    input.prop('checked', false);\n                }\n            },\n\n            bindCustomEventListeners:function () {\n                this.getElem() && this.getElem().on('change', 'input', _.bind(function (evt) {\n                    var value = evt.target.getValue() == null ? \"false\" : \"true\";\n                    this.set({ selection: [value] });\n                }, this));\n            }\n        }),\n\n        SingleValueText: Controls.BaseControl.extend({\n\n            setValue:function (controlData) {\n                var value = controlData == ControlsBase.NULL_SUBSTITUTION_VALUE ? ControlsBase.NULL_SUBSTITUTION_LABEL : controlData;\n                var container = this.getElem();\n                if (container) {\n                    container.find('input').attr('value', value);\n                    container.find('input').val(value);\n                }\n            },\n\n            bindCustomEventListeners:function () {\n                this.getElem() && this.getElem().on('change', 'input', _.bind(function (evt) {\n                    var inputValue = evt.target.value;\n                    var value = inputValue == ControlsBase.NULL_SUBSTITUTION_LABEL ? ControlsBase.NULL_SUBSTITUTION_VALUE : inputValue;\n                    this.set({ selection: [value] });\n                }, this));\n\n            }\n        }),\n\n        SingleValueNumber: Controls.BaseControl.extend({\n\n            setValue:function (controlData) {\n                this.getElem().find('input').attr('value', controlData);\n                this.getElem().find('input').val(controlData);\n            },\n\n            bindCustomEventListeners:function () {\n                this.getElem() && this.getElem().on('change', 'input', _.bind(function (evt) {\n                    this.set({ selection: [evt.target.value] });\n                }, this));\n            }\n        }),\n\n        SingleValueDate: Controls.BaseControl.extend({\n\n            initialize:function (args) {\n                this.baseRender(args);\n                args.visible && this.getElem() && this.setupCalendar();\n            },\n\n            get: function(attribute){\n                var localizedDate = Controls.BaseControl.prototype.get.call(this, attribute);\n                return dateUtil.localizedDateToIsoDate(localizedDate);\n            },\n\n            set: function(attributes, preventNotification){\n                if(attributes.values){\n                    attributes.values = dateUtil.isoDateToLocalizedDate(attributes.values);\n                }\n                Controls.BaseControl.prototype.set.call(this, attributes, preventNotification);\n            },\n\n            setupCalendar:function () {\n                var input = this.getElem().find('input');\n\n                this.picker = new DateAndTimePicker({\n                    el: input,\n                    showOn: \"button\",\n                    dateFormat: JRS.i18n[\"bundledCalendarFormat\"],\n                    disabled: input[0].disabled,\n                    onSelect: _.bind(changeDateFunc, this)\n                });\n\n                input.change(_.bind(function (evt) {\n                    //prevent triggering of global control change event\n                    evt.stopPropagation();\n\n                    //remove all spaces and convert to upper case\n                    jQuery(evt.target).val(getNormalizedDatetimeValue(evt.target.value));\n\n                    changeDateFunc.call(this, jQuery(evt.target).val());\n                }, this));\n\n                input.after('&nbsp;');\n                var button = this.getElem().find('button');\n                button.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty();\n            },\n\n            setValue:function (controlData) {\n                var container = this.getElem();\n                container.find('input').attr('value', controlData);\n                container.find('input').val(controlData);\n            }\n\n        }),\n\n        SingleValueDatetime: Controls.BaseControl.extend({\n\n            initialize:function (args) {\n                this.baseRender(args);\n                args.visible && this.getElem() && this.setupCalendar();\n            },\n\n            getInput: function() {\n                var $el = this.getElem();\n\n                return $el && $el.find('input');\n            },\n\n            destroyCalendar: function() {\n                var $input = this.getInput();\n                $input.off();\n\n                this.picker && this.picker.remove();\n            },\n\n            setupCalendar:function () {\n                var $el = this.getElem(),\n                    $input = this.getInput();\n\n                this.destroyCalendar();\n\n                this.picker = new DateAndTimePicker({\n                    el: $input[0],\n                    showOn: \"button\",\n                    dateFormat: JRS.i18n[\"bundledCalendarFormat\"],\n                    timeFormat: JRS.i18n[\"bundledCalendarTimeFormat\"],\n                    disabled: $input[0].disabled,\n                    onSelect: _.bind(changeDateFunc, this)\n                });\n\n                $input.change(_.bind(function (evt) {\n                    //prevent triggering of global control change event\n                    evt.stopPropagation();\n\n                    //remove all spaces an  d convert to upper case\n                    jQuery(evt.target).val(getNormalizedDatetimeValue(evt.target.value));\n                    changeDateFunc.call(this, jQuery(evt.target).val());\n                }, this));\n                $input.after('&nbsp;');\n\n                var button = $el.find('button');\n\n                button.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty();\n            },\n\n            get: function(attribute){\n                var localizedDateTime = Controls.BaseControl.prototype.get.call(this, attribute);\n                return dateUtil.localizedTimestampToIsoTimestamp(localizedDateTime);\n            },\n\n            set: function(attributes, preventNotification) {\n                if(attributes.values){\n                    attributes.values = dateUtil.isoTimestampToLocalizedTimestamp(attributes.values);\n                }\n\n                if (!attributes.values && !attributes.selection && this.getInput()) {\n                    this.setupCalendar();\n                }\n\n                Controls.BaseControl.prototype.set.call(this, attributes, preventNotification);\n            },\n            setValue:function (controlData) {\n                var container = this.getElem();\n                container.find('input').attr('value', controlData);\n                container.find('input').val(controlData);\n            }\n        }),\n\n        SingleValueTime: Controls.BaseControl.extend({\n\n            initialize:function (args) {\n                this.baseRender(args);\n                args.visible && this.getElem() && this.setupCalendar();\n            },\n\n            getInput: function() {\n                var $el = this.getElem();\n\n                return $el && $el.find('input');\n            },\n\n            destroyCalendar: function() {\n                var $input = this.getInput();\n                $input.off();\n\n                this.picker && this.picker.remove();\n            },\n\n            setupCalendar:function () {\n                var $el = this.getElem(),\n                    $input = this.getInput();\n\n                this.destroyCalendar();\n\n                this.picker = new DateAndTimePicker({\n                    el: $input[0],\n                    showOn: \"button\",\n                    timeFormat: JRS.i18n[\"bundledCalendarTimeFormat\"],\n                    disabled: $input[0].disabled,\n                    onClose: _.bind(changeDateFunc, this)\n                });\n                $input.change(_.bind(function (evt) {\n                    //prevent triggering of global control change event\n                    evt.stopPropagation();\n\n                    //remove all spaces an  d convert to upper case\n                    jQuery(evt.target).val(getNormalizedDatetimeValue(evt.target.value));\n                    changeDateFunc.call(this, jQuery(evt.target).val());\n                }, this));\n\n                $input.after('&nbsp;');\n                var button = $el.find('button');\n                button.wrap(ControlsBase.CALENDAR_ICON_SPAN).empty();\n            },\n\n            get: function(attribute){\n                var localizedTime = Controls.BaseControl.prototype.get.call(this, attribute);\n                return dateUtil.localizedTimeToIsoTime(localizedTime);\n            },\n\n            set: function(attributes, preventNotification){\n                if (attributes.values) {\n                    attributes.values = dateUtil.isoTimeToLocalizedTime(attributes.values);\n                }\n\n                if (!attributes.values && !attributes.selection && this.getInput()) {\n                    this.setupCalendar();\n                }\n\n                Controls.BaseControl.prototype.set.call(this, attributes, preventNotification);\n            },\n            setValue:function (controlData) {\n                var container = this.getElem();\n                container.find('input').attr('value', controlData);\n                container.find('input').val(controlData);\n            }\n        }),\n\n        SingleSelect: Controls.BaseControl.extend({\n            initialize(controlStructure, initialOptions = {}) {\n                const {\n                    initialSelectedValues\n                } = initialOptions;\n\n                this.dataUri = initialOptions.dataUri;\n                this.inputControlsService = initialOptions.inputControlsService;\n                this.paginatedValuesOptions = initialOptions.paginatedValuesOptions\n\n                if (!this.singleSelect) {\n                    this.inputControlsDataProviderWithDataLabelHash = new InputControlsDataProviderWithDataLabelHash({\n                        inputControlsDataProvider: new InputControlsDataProvider({\n                            controlId: controlStructure.id,\n                            inputControlsService: this.inputControlsService\n                        })\n                    });\n\n                    this.dataProviderWithCache = new DataProviderWithSearchCache({\n                        pageSize: 100,\n                        maxSearchCacheSize: 1,\n                        saveLastCriteria: true,\n                        request: (options) => {\n                            options = getInputControlsDataProviderNewPageOptions(Object.assign({\n                                name: this.id,\n                                paginatedValuesOptions: this.paginatedValuesOptions\n                            }, options));\n\n                            var dfd = this.inputControlsDataProviderWithDataLabelHash.getData(this.dataUri, options);\n                            Controls.Utils.showLoadingDialogOn(dfd, null, true)\n                            return dfd;\n\n                        }\n                    });\n\n                    this.initialSelectedValuesToLabelMap = getInitialSelectedValuesToLabelMap(initialSelectedValues);\n\n                    this.singleSelect = new SingleSelect({\n                        getData: this.dataProviderWithCache.getData,\n                        keydownTimeout: ControlsBase.KEY_DOWN_TIMEOUT,\n                        formatValue: (value) => {\n                            return this.inputControlsDataProviderWithDataLabelHash.getLabelByValue(value)\n                                ?? this.initialSelectedValuesToLabelMap[value];\n                        },\n                        keydownTimeout: ControlsBase.KEY_DOWN_TIMEOUT\n                    }).setDisabled(controlStructure.readOnly);\n\n                    if (controlStructure) {\n                        _.extend(this, controlStructure);\n                    }\n                }\n            },\n\n            render() {\n                const template = Controls.TemplateEngine.createTemplate(this.type);\n\n                if (template) {\n                    this.singleSelect.undelegateEvents();\n\n                    const element = jQuery(template(this));\n\n                    this.singleSelect.render().renderData();\n\n                    element.find(\".ssPlaceholder\").append(this.singleSelect.el);\n\n                    this.setElem(element);\n                    this.singleSelect.delegateEvents();\n\n                    this.makeResizable && this.makeResizable();\n                    this.isVisible(this) && this.bindCustomEventListeners();\n                }\n            },\n\n            setValue(selectedValues) {\n                this.singleSelect.setValue(selectedValues, { silent: true });\n            },\n\n            updateSelectionOnOptionChange(selection) {\n                this.initialSelectedValuesToLabelMap = getInitialSelectedValuesToLabelMap(selection);\n            },\n\n            fetch(uri, paginatedValuesOptions) {\n                this.dataUri = uri;\n                this.paginatedValuesOptions = paginatedValuesOptions;\n\n                const dfd = jQuery.Deferred();\n\n                this.singleSelect.off('listRenderError').once('listRenderError', (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                    dfd.reject(xhr);\n\n                    this.bindCustomEventListeners();\n                });\n\n                this.dataProviderWithCache.clear();\n\n                this.singleSelect.fetch((...args) => {\n                    dfd.resolve(...args);\n                });\n\n                return dfd;\n            },\n\n            bindCustomEventListeners() {\n                this.singleSelect.off(\"selection:change\").on(\"selection:change\", function (selection) {\n                    this.fireControlSelectionChangeEvent([selection]);\n                }, this);\n\n                this.singleSelect.off('listRenderError').on('listRenderError', (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                });\n            }\n        }),\n\n        MultiSelect: Controls.BaseControl.extend({\n            initialize(controlStructure, initialOptions = {}) {\n                const {\n                    initialSelectedValues\n                } = initialOptions;\n\n                this.dataUri = initialOptions.dataUri;\n                this.inputControlsService = initialOptions.inputControlsService;\n                this.paginatedValuesOptions = initialOptions.paginatedValuesOptions;\n\n                if (!this.multiSelect) {\n                    this.inputControlsDataProviderWithDataLabelHash = new InputControlsDataProviderWithDataLabelHash({\n                        inputControlsDataProvider: new InputControlsDataProvider({\n                            controlId: controlStructure.id,\n                            inputControlsService: this.inputControlsService\n                        })\n                    });\n\n                    this.dataProviderWithCache = new DataProviderWithSearchCache({\n                        pageSize: 100,\n                        maxSearchCacheSize: 1,\n                        saveLastCriteria: true,\n\n                        request: (options) => {\n                            options = getInputControlsDataProviderNewPageOptions(Object.assign({\n                                name: this.id,\n                                paginatedValuesOptions: this.paginatedValuesOptions\n                            }, options));\n\n                            var dfd = this.inputControlsDataProviderWithDataLabelHash.getData(this.dataUri, options);\n                            Controls.Utils.showLoadingDialogOn(dfd, null, true)\n                            return dfd;\n                        }\n                    });\n\n                    this.initialSelectedValuesToLabelMap = getInitialSelectedValuesToLabelMap(initialSelectedValues);\n\n                    this.multiSelect = new MultiSelect({\n                        getData: this.dataProviderWithCache.getData,\n                        selectedListOptions: {\n                            formatLabel: (value) => {\n                                return this.inputControlsDataProviderWithDataLabelHash.getLabelByValue(value)\n                                     ?? this.initialSelectedValuesToLabelMap[value];\n                            },\n                            sortFunc: selectedItemsDataProviderSorterFactory.create(ControlsBase.NULL_SUBSTITUTION_LABEL)\n                        },\n                        resizable : true,\n                        keydownTimeout: ControlsBase.KEY_DOWN_TIMEOUT\n                    });\n\n                    this.multiSelect.setDisabled(controlStructure.readOnly);\n\n                    this._resize = _.debounce(_.bind(this.multiSelect.resize, this.multiSelect), 500);\n\n                    if (controlStructure) {\n                        _.extend(this, controlStructure);\n                    }\n                }\n            },\n\n            render() {\n                const template = Controls.TemplateEngine.createTemplate(this.type);\n\n                if (template) {\n                    this.multiSelect.undelegateEvents();\n\n                    const element = jQuery(template(this));\n\n                    this.multiSelect.render().renderData();\n\n                    element.find(\".msPlaceholder\").append(this.multiSelect.el);\n\n                    this.setElem(element);\n                    this.multiSelect.delegateEvents();\n\n                    this.makeResizable && this.makeResizable();\n                    this.isVisible(this) && this.bindCustomEventListeners();\n                }\n            },\n\n            setValue(selectedValues) {\n                selectedValues = _.isArray(selectedValues) && _.first(selectedValues)=== RestParamsEnum.NOTHING_SUBSTITUTION_VALUE ? [] : selectedValues\n                this.multiSelect.setValue(selectedValues, {silent: true});\n                this._resize();\n            },\n\n            updateSelectionOnOptionChange(selection) {\n                this.initialSelectedValuesToLabelMap = getInitialSelectedValuesToLabelMap(selection);\n            },\n\n            fetch(uri, paginatedValuesOptions) {\n                const dfd = jQuery.Deferred();\n\n                this.dataUri = uri;\n                this.paginatedValuesOptions = paginatedValuesOptions;\n\n                this.dataProviderWithCache.clear();\n\n                this.multiSelect.off('listRenderError').once('listRenderError', (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                    dfd.reject(xhr);\n\n                    this.bindCustomEventListeners();\n                });\n\n                this.multiSelect.fetch((...args) => {\n                    dfd.resolve(...args);\n                });\n\n                return dfd;\n            },\n\n            clearFilter() {\n                this.multiSelect.clearFilter();\n            },\n\n            bindCustomEventListeners() {\n                this.multiSelect.off(\"selection:change\").on(\"selection:change\", function (selection) {\n                    this.fireControlSelectionChangeEvent(selection);\n                }, this);\n\n                this.multiSelect.off('listRenderError').on('listRenderError', (xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n                });\n            },\n\n            get(attribute) {\n                const result = this[attribute];\n\n                if (attribute === 'selection' && _.isEmpty(result)) {\n                    return [];\n                } else {\n                    return result;\n                }\n            },\n\n            makeResizable() {\n                const $sizer = this.multiSelect.$el.find(\".jr-mSizer\");\n\n                //according to IC specifics, sizer should be after alert message\n                if ($sizer.length){\n                    $sizer.detach().insertAfter(this.getElem() && this.getElem().find('.resizeOverlay'));\n                }\n            }\n        }),\n\n        SingleSelectRadio: Controls.BaseControl.extend({\n            initialize(controlStructure, options = {}) {\n                controlStructure && _.extend(this, controlStructure);\n\n                this.dataUri = options.dataUri;\n                this.inputControlsService = options.inputControlsService;\n                this.paginatedValuesOptions = options.paginatedValuesOptions;\n                this.inputControlsDataProvider = new InputControlsDataProvider({\n                    controlId: controlStructure.id,\n                    inputControlsService: this.inputControlsService\n                });\n            },\n\n            render() {\n                const template = Controls.TemplateEngine.createTemplate(this.type);\n\n                if (template) {\n                    const element = jQuery(template(this));\n                    this.setElem(element);\n\n                    this.makeResizable && this.makeResizable();\n                    this.isVisible(this) && this.bindCustomEventListeners();\n                }\n\n                return this.fetch(this.dataUri, this.paginatedValuesOptions);\n            },\n\n            fetch(uri, paginatedValuesOptions) {\n                return this._fetchData(uri, paginatedValuesOptions).then((result) => {\n                    this._renderData(result.data);\n                });\n            },\n\n            _fetchData(uri, paginatedValuesOptions) {\n                this.dataUri = uri;\n                this.paginatedValuesOptions = paginatedValuesOptions;\n\n                const options = getInputControlsDataProviderNewPageOptions({\n                    name: this.id,\n                    paginatedValuesOptions: this.paginatedValuesOptions,\n                    offset: 0\n                });\n\n                return this.inputControlsDataProvider.getData(this.dataUri, options);\n            },\n\n            _renderData(controlData) {\n                let list = this.getElem() && this.getElem().find('ul')[0];\n                if(list){\n                    const data = controlData.map((val) => {\n                        const result = _.clone(val);\n\n                        result.readOnly = this.readOnly;\n                        result.name = this.getOptionName();\n                        result.uuid = _.uniqueId(this.id);\n\n                        return result;\n                    });\n\n                    const template = this.getTemplateSection('data');\n\n                    Controls.Utils.setInnerHtml(list, template, {\n                        data\n                    });\n\n                    list = jQuery(list);\n                    list.html(list.html() + \"&nbsp;\"); //workaround for IE scrollbar\n\n                    //TODO move to decorator\n                    if (list.find('li').length < 5 && this.getElem()[0].clientHeight < 125) {\n                        this.getElem().find('.jr-mSizer').addClass('hidden');\n                        this.getElem().find('.inputSet').removeClass('sizable').attr('style', false);\n                    } else {\n                        if (this.resizable) {\n                            this.getElem().find('.jr-mSizer').removeClass('hidden');\n                            this.getElem().find('.inputSet').addClass('sizable');\n                        }\n                    }\n                }\n\n            },\n\n            getOptionName() {\n                return this.id + \"_option\";\n            },\n\n            bindCustomEventListeners() {\n                this.getElem().on('change', 'input', (evt) => {\n                    const selection = evt.target.value;\n                    // for better performance in IE7\n                    setTimeout(() => {\n                        this.set({selection:[selection]})\n                    });\n                });\n            },\n\n            //TODO move to decorator\n            makeResizable() {\n                this.resizable = true;\n\n                const list = this.getElem().find('ul');\n                const sizer = this.getElem().find('.jr-mSizer').removeClass('hidden');\n\n                sizer.addClass(\"ui-resizable-s\");\n                list.resizable({\n                    handles:{\n                        's': sizer\n                    }\n                });\n            }\n        }),\n\n        MultiSelectCheckbox: Controls.BaseControl.extend({\n            initialize(controlStructure, options = {}) {\n                controlStructure && _.extend(this, controlStructure);\n\n                this.dataUri = options.dataUri;\n                this.inputControlsService = options.inputControlsService;\n                this.paginatedValuesOptions = options.paginatedValuesOptions;\n\n                this.inputControlsDataProvider = new InputControlsDataProvider({\n                    controlId: controlStructure.id,\n                    inputControlsService: this.inputControlsService\n                });\n            },\n\n            render() {\n                const template = Controls.TemplateEngine.createTemplate(this.type);\n\n                if (template) {\n                    const element = jQuery(template(this));\n                    this.setElem(element);\n\n                    this.makeResizable && this.makeResizable();\n                    this.isVisible(this) && this.bindCustomEventListeners();\n                }\n\n                return this.fetch(this.dataUri, this.paginatedValuesOptions);\n            },\n\n            fetch(uri, paginatedValuesOptions) {\n                return this._fetchData(uri, paginatedValuesOptions).then((result) => {\n                    this._renderData(result.data);\n                });\n            },\n\n            _fetchData(uri, paginatedValuesOptions) {\n                this.dataUri = uri;\n                this.paginatedValuesOptions = paginatedValuesOptions;\n\n                const options = getInputControlsDataProviderNewPageOptions({\n                    name: this.id,\n                    paginatedValuesOptions: this.paginatedValuesOptions,\n                    offset: 0\n                });\n\n                return this.inputControlsDataProvider.getData(this.dataUri, options);\n            },\n\n            _renderData(controlData) {\n                const data = controlData.map((val) => {\n                    const result = _.clone(val);\n\n                    result.readOnly = this.readOnly;\n                    result.uuid = _.uniqueId(this.id);\n\n                    return result;\n                });\n\n                const list = this.getElem() && this.getElem().find('ul')[0];\n                if(list){\n                    const template = this.getTemplateSection('data');\n\n                    Controls.Utils.setInnerHtml(list, template, {data:data});\n\n                    //TODO move to decorator\n                    if (jQuery(list).find('li').length < 5 && this.getElem()[0].clientHeight < 125) {\n                        this.getElem().find('.jr-mSizer').addClass('hidden');\n                        this.getElem().find('.inputSet').removeClass('sizable').attr('style', false);\n                    } else {\n                        if (this.resizable) {\n                            this.getElem().find('.jr-mSizer').removeClass('hidden');\n                            this.getElem().find('.inputSet').addClass('sizable');\n                        }\n                    }\n                }\n\n            },\n\n            getSelection() {\n                const boxes = this.getElem().find(\":checkbox\").filter(\":checked\");\n\n                return _.map(boxes, function (box) {\n                    return jQuery(box).val();\n                });\n            },\n\n            bindCustomEventListeners() {\n                this.getElem().on('change', 'input', (evt) => {\n                    const selection = this.getSelection();\n                    // for better performance in IE7\n                    setTimeout(() => {\n                        this.set({selection:selection})\n                    });\n                });\n\n                this.getElem().on('click','a', (evt) => {\n                    const options = this.getElem().find('input');\n                    const name = jQuery(evt.target)[0].name;\n\n                    if (name === \"multiSelectAll\" || name === \"multiSelectNone\") {\n                        _.each(options, function(opt){\n                            opt.checked = name === \"multiSelectAll\";\n                        });\n                    } else if (name === \"multiSelectInverse\") {\n                        _.each(options,  function(opt){\n                            opt.checked = !opt.checked;\n                        });\n                    }\n\n                    this.getElem().find('input').change(); // trigger the cascading request\n                });\n            },\n\n            get(attribute) {\n                const result = this[attribute];\n\n                if (attribute === 'selection' && _.isEmpty(result)) {\n                    return [];\n                } else {\n                    return result;\n                }\n            },\n\n            //TODO move to decorator\n            makeResizable() {\n                this.resizable = true;\n\n                const list = this.getElem().find('ul');\n                const sizer = this.getElem().find('.jr-mSizer').removeClass('hidden');\n\n                sizer.addClass(\"ui-resizable-s\");\n                list.resizable({\n                    handles:{\n                        's': sizer\n                    }\n                });\n            }\n        })\n    });\n})(\n    jQuery,\n    _,\n    JRS.Controls\n);\n\nexport default JRS.Controls;\n\n","// @ts-ignore\nimport jrsConfigs from 'js-sdk/src/jrs.configs';\n// @ts-ignore\nimport request from 'js-sdk/src/common/transport/request';\nimport RequestOptions from '../types/request';\nimport {\n    InputControlsServiceType as InputControlsServiceInterface,\n    PaginatedValuesOptions, SelectedOnlyOptions\n} from './types/InputControlsServiceType';\n\ninterface InputControlsServiceOptions {\n    request(options: RequestOptions): JQueryXHR\n}\n\nexport default class InputControlsService implements InputControlsServiceInterface {\n    private readonly request: (options: RequestOptions) => JQueryXHR;\n\n    constructor(options: InputControlsServiceOptions) {\n        this.request = options.request || request;\n    }\n\n    getInputControlsSelectedValues(reportUri: string) {\n        return this.request({\n            type: 'GET',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls/selectedValues`,\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n\n    getInputControlsMetadata(reportUri: string) {\n        return this.request({\n            type: 'GET',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls?exclude=state`,\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n\n    getInputControlsValues(reportUri: string, inputControlIds: string[]) {\n\n        return this.request({\n            type: 'GET',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls/${inputControlIds.join(';')}/values?freshData=false&includeTotalCount=true`,\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n\n    getInputControlsOnlySelectedValue(reportUri: string, options: SelectedOnlyOptions) {\n        const controlIds = Object.keys(options).map((ip) => ip).join(';');\n        return this.request({\n            type: 'POST',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls/${controlIds}/values?freshData=false&selectedOnly=true`,\n            data: JSON.stringify(options),\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n        });\n    }\n\n    getInputControlsPaginatedValues(reportUri: string, options: PaginatedValuesOptions[]) {\n        const controlIds = options.map((c) => c.name).join(';');\n\n        return this.request({\n            type: 'POST',\n            url: `${jrsConfigs.urlContext}/rest_v2/reports${reportUri}/inputControls/${controlIds}/values/pagination?freshData=false&includeTotalCount=true`,\n            data: JSON.stringify({\n                reportParameter: options\n            }),\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n        });\n    }\n\n    getReportRawParameterValues(executionId: string) {\n        return this.request({\n            type: 'GET',\n            url: `${jrsConfigs.urlContext}/rest_v2/reportExecutions/${executionId}/rawParameterValues`,\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n}\n","import $ from 'jquery';\nimport _ from 'underscore';\n\nimport {\n    InputControlsServiceType as InputControlsServiceInterface,\n    PaginatedValuesOptions, PaginatedValuesResponse, SelectedOnlyOptions\n} from './types/InputControlsServiceType';\n\ninterface InputControlsServiceOptions {\n    inputControlsService: InputControlsServiceInterface\n}\n\nconst getCacheKey = (reportUri: string, options: PaginatedValuesOptions[]) => {\n    const sortedOptions = _.sortBy(options, 'name');\n\n    return sortedOptions.reduce((memo, option) => {\n        const {\n            name,\n            offset,\n            limit\n        } = option;\n\n        const params = [name, offset, limit]\n            .concat(option.criteria || [])\n            .concat(option.value || [])\n            .concat(option.select || []);\n\n        return `${memo} ${JSON.stringify(params)}`;\n    }, `${reportUri}`);\n};\n\nexport interface InputControlsServiceWithCacheInterface\n    extends Pick<InputControlsServiceInterface, 'getInputControlsSelectedValues' | 'getInputControlsMetadata' | 'getInputControlsValues' | 'getReportRawParameterValues'> {\n    getInputControlsPaginatedValues(reportUri: string, options: PaginatedValuesOptions[]): JQueryDeferred<PaginatedValuesResponse>,\n    setCacheValueForControlPaginatedValues(\n        reportUri: string,\n        options: PaginatedValuesOptions[],\n        cacheValue: PaginatedValuesResponse\n    ): void,\n    getInputControlsOnlySelectedValue(reportUri: string, options: SelectedOnlyOptions): JQueryXHR,\n    clearCache(): void\n}\n\nexport default class InputControlsServiceWithCache implements InputControlsServiceWithCacheInterface {\n    private readonly inputControlsService: InputControlsServiceInterface;\n\n    private cache: { [key: string]: PaginatedValuesResponse };\n\n    constructor(options: InputControlsServiceOptions) {\n        this.cache = {};\n        this.inputControlsService = options.inputControlsService;\n    }\n\n    getInputControlsSelectedValues(reportUri: string) {\n        return this.inputControlsService.getInputControlsSelectedValues(reportUri);\n    }\n\n    getInputControlsMetadata(reportUri: string) {\n        return this.inputControlsService.getInputControlsMetadata(reportUri);\n    }\n\n    getInputControlsValues(reportUri: string, inputControlIds: string[]) {\n        return this.inputControlsService.getInputControlsValues(reportUri, inputControlIds);\n    }\n\n    getReportRawParameterValues(executionId: string) {\n        return this.inputControlsService.getReportRawParameterValues(executionId);\n    }\n\n    getInputControlsOnlySelectedValue(reportUri: string, options: SelectedOnlyOptions) {\n        return this.inputControlsService.getInputControlsOnlySelectedValue(reportUri, options)\n    }\n\n    getInputControlsPaginatedValues(reportUri: string, options: PaginatedValuesOptions[]) {\n        const cacheKey = getCacheKey(reportUri, options);\n        const cacheValue = this.cache[cacheKey];\n\n        const dfd = $.Deferred();\n\n        if (cacheValue) {\n            dfd.resolve(cacheValue);\n        } else {\n            this.inputControlsService.getInputControlsPaginatedValues(\n                reportUri,\n                options\n            ).then((...args) => {\n                const [\n                    response\n                ] = args;\n\n                this.cache[cacheKey] = response;\n\n                dfd.resolve(response);\n            }, (...args) => {\n                dfd.reject(...args);\n            });\n        }\n\n        return dfd;\n    }\n\n    setCacheValueForControlPaginatedValues(\n        reportUri: string,\n        options: PaginatedValuesOptions[],\n        cacheValue: PaginatedValuesResponse\n    ) {\n        const cacheKey = getCacheKey(reportUri, options);\n\n        this.cache[cacheKey] = cacheValue;\n    }\n\n    clearCache() {\n        this.cache = {};\n    }\n}\n","import InputControlTypeEnum from '../enum/inputControlTypeEnum';\n\ninterface InputControlsMetadata {\n    inputControl: {\n        uri: string,\n        id: string,\n        type: InputControlTypeEnum,\n        slaveDependencies?: string[],\n        masterDependencies?: string[]\n    }[]\n}\n\nexport default {\n    metadataToViewModelConverter(metadata: InputControlsMetadata) {\n        return metadata.inputControl.map((control) => ({\n            ...control,\n            uri: control.uri.replace('repo:', '')\n        }));\n    }\n};\n","enum InputControlTypeEnum {\n    BOOL = 'bool',\n    SINGLE_VALUE_TEXT = 'singleValueText',\n    SINGLE_VALUE_NUMBER = 'singleValueNumber',\n    SINGLE_VALUE_DATE = 'singleValueDate',\n    SINGLE_VALUE_DATE_TIME = 'singleValueDatetime',\n    SINGLE_VALUE_TIME = 'singleValueTime',\n    SINGLE_SELECT = 'singleSelect',\n    SINGLE_SELECT_RADIO = 'singleSelectRadio',\n    MULTI_SELECT = 'multiSelect',\n    MULTI_SELECT_CHECKBOX = 'multiSelectCheckbox'\n}\n\nexport default InputControlTypeEnum;\n","import _ from 'underscore';\nimport RestParamsEnum from '../rest/enum/restParamsEnum';\nimport { PaginatedValuesOptions } from '../rest/types/InputControlsServiceType';\nimport InputControlTypeEnum from '../enum/inputControlTypeEnum';\n\nconst LIMIT = 100;\n\nconst omitLimit = (paginatedValuesOptions: PaginatedValuesOptions) => {\n    return _.omit(paginatedValuesOptions, ['limit']);\n};\n\ntype ControlSpecificOptionsFn = (paginatedValuesOptions: PaginatedValuesOptions) => PaginatedValuesOptions;\ntype ControlSpecificOptionsMap = {\n    [key: string]: ControlSpecificOptionsFn | undefined\n}\n\nconst controlSpecificOptionsMap: ControlSpecificOptionsMap = {\n    [InputControlTypeEnum.SINGLE_SELECT_RADIO]: (paginatedValuesOptions: PaginatedValuesOptions) => {\n        return omitLimit(paginatedValuesOptions);\n    },\n    [InputControlTypeEnum.MULTI_SELECT_CHECKBOX]: (paginatedValuesOptions: PaginatedValuesOptions) => {\n        return omitLimit(paginatedValuesOptions);\n    }\n};\n\nexport default (\n    id: string,\n    type: string,\n    options: {\n        select?: RestParamsEnum.SELECTED_VALUES\n        value?: string[]\n    } = {}\n) => {\n    const result = {\n        name: id,\n        offset: 0,\n        limit: LIMIT,\n        ...options\n    };\n\n    const addControlSpecificOptions = controlSpecificOptionsMap[type];\n\n    if (addControlSpecificOptions) {\n        return addControlSpecificOptions(result);\n    }\n\n    return result;\n};\n","import InputControlTypeEnum from '../enum/inputControlTypeEnum';\n\nconst queryControls = [\n    InputControlTypeEnum.SINGLE_SELECT,\n    InputControlTypeEnum.MULTI_SELECT,\n    InputControlTypeEnum.SINGLE_SELECT_RADIO,\n    InputControlTypeEnum.MULTI_SELECT_CHECKBOX\n];\n\nexport default (control: {\n    type: InputControlTypeEnum\n}) => {\n    return queryControls.indexOf(control.type) > -1;\n};\n","import _ from 'underscore';\nimport RestParamsEnum from '../rest/enum/restParamsEnum';\n\nimport getControlPaginationOptionsByControlIdAndType from './getControlPaginationOptionsByControlIdAndType';\nimport InputControlTypeEnum from '../enum/inputControlTypeEnum';\n\ninterface Control {\n    slaveDependencies?: string[],\n    masterDependencies?: string[],\n    type: InputControlTypeEnum,\n    select?: RestParamsEnum.SELECTED_VALUES\n    value?: string[]\n}\n\ninterface Controls {\n    [key: string]: Control\n}\n\nexport default (\n    options: {\n        controlId: string,\n        controls: Controls\n    }\n) => {\n    const {\n        controls\n    } = options;\n\n    return (\n        Object.keys(controls).map((id) => {\n            return {\n                ...getControlPaginationOptionsByControlIdAndType(\n                    id,\n                    controls[id].type,\n                    controls[id].value ? _.pick(controls[id], ['value']) : _.pick(controls[id], ['select'])\n                )\n            }\n        })\n    );\n};\n","import $ from 'jquery';\nimport _ from 'underscore';\n\nimport {\n    PaginatedValuesOptions, PaginatedValuesResponse,\n    SelectedValuesResponse, SelectedOnlyResponse, SelectedOnlyOptions\n} from '../rest/types/InputControlsServiceType';\nimport inputControlsToViewModelConverter from '../converter/inputControlsToViewModelConverter';\nimport InputControlTypeEnum from '../enum/inputControlTypeEnum';\nimport getControlPaginationOptionsByControlIdAndType from '../converter/getControlPaginationOptionsByControlIdAndType';\nimport RestParamsEnum from '../rest/enum/restParamsEnum';\nimport isQueryControl from '../predicate/isQueryControl';\nimport getControlsPaginationOptionsByControlId from '../converter/getControlsPaginationOptionsByControlId';\nimport { InputControlsServiceWithCacheInterface } from '../rest/InputControlsServiceWithCache';\n\ninterface ControlStructure {\n    id: string,\n    type: InputControlTypeEnum,\n    slaveDependencies?: string[],\n    masterDependencies?: string[]\n}\n\ninterface Options {\n    inputControlsService: InputControlsServiceWithCacheInterface\n}\n\nconst getPaginatedValuesOptionsForQueryControls = (\n    structure: ControlStructure[],\n    controlsMap: {\n        [key: string]: ControlStructure\n    },\n    mapper: (option: PaginatedValuesOptions) => PaginatedValuesOptions,\n    callback?: (option: PaginatedValuesOptions[]) => void\n) => {\n    return structure.reduce((memo, control) => {\n        if (isQueryControl(control)) {\n            const newMemo: {\n                [key: string]: PaginatedValuesOptions[]\n            } = {\n                ...memo,\n                [control.id]: getControlsPaginationOptionsByControlId({\n                    controlId: control.id,\n                    controls: controlsMap\n                }).map(mapper)\n            };\n\n            if (typeof callback !== 'undefined') {\n                callback(newMemo[control.id]);\n            }\n\n            return newMemo;\n        }\n\n        return memo;\n    }, {});\n};\n\nconst getControlsPaginationOptionsByControlIdOnSelectionChange = (options: {\n    controlId: string,\n    value: string[],\n    selection: {\n        [key: string]: string[]\n    },\n    controls: {\n        [key: string]: ControlStructure\n    }\n}) => {\n    const {\n        controlId,\n        value,\n        controls,\n        selection\n    } = options;\n\n    const controlsWithValueOrDefaultSelection = _.reduce(controls, (controlMemo, control) => {\n        let additionalOptions = {};\n\n        if (control.id === controlId) {\n            additionalOptions = {\n                value: value.length > 0 ? value : [RestParamsEnum.NOTHING_SUBSTITUTION_VALUE]\n            }\n        } else {\n            additionalOptions = {\n                value: selection[control.id],\n                select: RestParamsEnum.SELECTED_VALUES\n            }\n        }\n\n        return {\n            ...controlMemo,\n            [control.id]: {\n                masterDependencies: control.masterDependencies || [],\n                slaveDependencies: control.slaveDependencies || [],\n                type: control.type,\n                ...additionalOptions\n            }\n        }\n    }, {});\n\n    return getControlsPaginationOptionsByControlId({\n        controlId,\n        controls: controlsWithValueOrDefaultSelection\n    });\n};\n\nconst fetchRequestParamsThroughURL = (structure: ControlStructure[], allRequestParameters: any) => {\n    const fetchLabelOfControls: Array<string> = _.pluck(structure, 'id');\n    const fetchKeysOfParams: Array<string> = _.keys(allRequestParameters);\n    const requestedSelectionParams: any = {};\n    const getControlIdInRequestParams: Array<string> = _.intersection(fetchLabelOfControls, fetchKeysOfParams);\n\n    if (getControlIdInRequestParams.length > 0) {\n        getControlIdInRequestParams.forEach((val) => {\n            requestedSelectionParams[val] = allRequestParameters[val]\n        });\n    }\n    return requestedSelectionParams\n};\n\nexport default class InputControlsReportViewerService {\n    private readonly inputControlsService: InputControlsServiceWithCacheInterface;\n\n    constructor(options: Options) {\n        this.inputControlsService = options.inputControlsService;\n    }\n\n    fetchInputControlsInitialState(uri: string, allRequestParameters: { [key: string]: string[] }) {\n        // flow when user is setting values through uri.\n        return this.inputControlsService.getInputControlsMetadata(uri).then((response) => {\n            if (response) {\n                const structure = inputControlsToViewModelConverter.metadataToViewModelConverter(response);\n                return this.fetchInitialInputControlsValuesByUriAndStructure(uri, structure, allRequestParameters);\n            }\n            return $.Deferred().resolve(response);\n        });\n    }\n\n    fetchInitialInputControlsValuesByUri(uri: string, structure: ControlStructure[], preSelectedData: { [key: string]: string[] }) {\n        return this.fetchInitialInputControlsValuesByUriAndStructure(uri, structure, preSelectedData);\n    }\n\n    fetchInputControlsOptionsBySelectionAndUri(\n        selection: {\n            [key: string]: string[]\n        },\n        uri: string,\n        structure: ControlStructure[]\n    ) {\n        const controlsMap: {\n            [key: string]: ControlStructure\n        } = structure.reduce((structureMemo, control) => {\n            return {\n                ...structureMemo,\n                [control.id]: control\n            };\n        }, {});\n\n        const paginationOptions = _.map(selection, (value, controlId) => {\n            return getControlPaginationOptionsByControlIdAndType(\n                controlId,\n                controlsMap[controlId].type,\n                {\n                    value: value && value.length === 0 ? [RestParamsEnum.NOTHING_SUBSTITUTION_VALUE] : selection[controlId] || []\n                }\n            );\n        });\n\n        const paginationOptionsPerControl = getPaginatedValuesOptionsForQueryControls(\n            structure,\n            controlsMap,\n            (option) => {\n                return {\n                    ...option,\n                    value: selection[option.name] || []\n                }\n            }\n        );\n\n        return this.fetchInputControlsOptionsByPaginatedValuesOptionsAndUri({\n            paginationOptions,\n            paginationOptionsPerControl,\n            uri\n        }).then((response) => {\n            return $.Deferred().resolve(response, paginationOptions, paginationOptionsPerControl);\n        });\n    }\n\n    fetchInputControlsValuesOnControlSelectionChange(options: {\n        controlId: string,\n        value: string[],\n        uri: string,\n        structure: ControlStructure[],\n        selection: {\n            [key: string]: string[]\n        },\n        initialSelectedValues: {\n            [key: string]: { value: string }[]\n        }\n    }) {\n        const {\n            controlId,\n            value,\n            uri,\n            structure,\n            selection\n        } = options;\n\n        const controlsMap: {\n            [key: string]: ControlStructure\n        } = structure.reduce((controlMemo, control) => {\n            return {\n                ...controlMemo,\n                [control.id]: control\n            };\n        }, {});\n\n        const paginationOptions = getControlsPaginationOptionsByControlIdOnSelectionChange({\n            controlId,\n            value,\n            selection,\n            controls: controlsMap\n        });\n        const newSelection: { [key: string]: string[] } = { ...selection };\n        const selectedOnlyOptions: SelectedOnlyOptions = _.pick(newSelection, _.pluck(paginationOptions, 'name'));\n        selectedOnlyOptions[controlId] = value;\n\n        const newInitialValuesPromise = this.inputControlsService\n            .getInputControlsOnlySelectedValue(uri, selectedOnlyOptions);\n\n        return this.fetchInputControlsOptionsByPaginatedValuesOptionsAndUri({\n            paginationOptions,\n            uri\n        }).then((response) => {\n            return $.when<SelectedOnlyResponse>(newInitialValuesPromise).then((res) => {\n                const { inputControlState } = res;\n                const selectionPerControl = inputControlState && inputControlState.reduce((ICStateMemo, controlSelection) => {\n                    return {\n                        ...ICStateMemo,\n                        [controlSelection.id]: controlSelection.options ? _.pluck(controlSelection.options, 'value') || []\n                            : controlSelection.value\n                    }\n                }, {});\n                return $.Deferred().resolve(response, selectionPerControl, paginationOptions)\n            })\n        });\n    }\n\n    fetchInitialInputControlsValuesByUriAndStructure(\n        uri: string,\n        structure: ControlStructure[],\n        preSelectionData: { [key: string]: string[] }\n    ) {\n        const preSelectedData: { [key: string]: string[] } = fetchRequestParamsThroughURL(structure, preSelectionData);\n        const initialPaginatedValuesOptions = structure.map((control) => {\n            return getControlPaginationOptionsByControlIdAndType(\n                control.id,\n                control.type,\n                preSelectedData[control.id] ? {\n                    value: preSelectedData[control.id]\n                }\n                    : {\n                        select: RestParamsEnum.SELECTED_VALUES\n                    }\n            );\n        });\n\n        const initialPaginatedValuesPromise = this.inputControlsService\n            .getInputControlsPaginatedValues(uri, initialPaginatedValuesOptions);\n\n        const selectedValuesPromise = this.inputControlsService\n            .getInputControlsSelectedValues(uri);\n\n        return $.when<\n            PaginatedValuesResponse | [PaginatedValuesResponse],\n            [SelectedValuesResponse]\n        >(initialPaginatedValuesPromise, selectedValuesPromise)\n            .then((\n                paginatedValuesResponse,\n                selectedValuesResponse\n            ) => {\n                const [\n                    selectedValues\n                ] = selectedValuesResponse;\n\n                const paginatedValues = paginatedValuesResponse instanceof Array\n                    ? paginatedValuesResponse[0]\n                    : paginatedValuesResponse;\n\n                let selection = {};\n                selection = selectedValues ? selectedValues.selectedValue.reduce((selectedMemo, controlSelection) => {\n                    return {\n                        ...selectedMemo,\n                        [controlSelection.id]: controlSelection.options || []\n                    };\n                }, {}) : {};\n\n                const controlsMap = structure.reduce((structureMemo, control) => {\n                    return {\n                        ...structureMemo,\n                        [control.id]: preSelectedData[control.id] ? {\n                            ...control,\n                            value: preSelectedData[control.id]\n                        } : {\n                            ...control,\n                            select: RestParamsEnum.SELECTED_VALUES\n                        }\n                    };\n                }, {});\n\n                const paginationOptionsPerControl = getPaginatedValuesOptionsForQueryControls(\n                    structure,\n                    controlsMap,\n                    (option) => {\n                        return preSelectedData[option.name] ? {\n                            ...option,\n                            value: preSelectedData[option.name]\n                        } : {\n                            ...option,\n                            select: RestParamsEnum.SELECTED_VALUES\n                        }\n                    },\n                    (options) => {\n                        this.inputControlsService.setCacheValueForControlPaginatedValues(\n                            uri,\n                            options,\n                            paginatedValues\n                        );\n                    }\n                );\n\n                // case when selection is passing through URL\n                if (!_.isEmpty(preSelectedData)) {\n                    const newSelection: { [key: string]: string[] } = { ...selection };\n                    let optionsForValues: { [key: string]: string[] } = {};\n                    Object.keys(newSelection).forEach((ip) => {\n                        optionsForValues[ip] = _.pluck(newSelection[ip], 'value');\n                    });\n                    optionsForValues = { ...optionsForValues, ...preSelectedData };\n                    const newInitialValuesPromise = this.inputControlsService\n                        .getInputControlsOnlySelectedValue(uri, optionsForValues);\n                    return $.when<SelectedOnlyResponse>(newInitialValuesPromise).then((res) => {\n                        const { inputControlState } = res;\n                        selection = inputControlState && inputControlState.reduce((stateMemo, controlSelection) => {\n                            return {\n                                ...stateMemo,\n                                [controlSelection.id]: controlSelection.options ? controlSelection.options.map((ip) => _.omit(ip, 'selected')) || []\n                                    : [{ value: controlSelection.value, label: controlSelection.value }]\n                            };\n                        }, {});\n\n                        return $.Deferred().resolve({\n                            structure,\n                            selection,\n                            paginationOptionsPerControl,\n                            paginatedValuesResponse: paginatedValues\n                        });\n                    })\n                }\n                return $.Deferred().resolve({\n                    structure,\n                    selection,\n                    paginationOptionsPerControl,\n                    paginatedValuesResponse: paginatedValues\n                });\n            });\n    }\n\n    fetchReportRawParameterValues(executionId: string) {\n        return this.inputControlsService.getReportRawParameterValues(executionId).then((response) => response);\n    }\n\n    private fetchInputControlsOptionsByPaginatedValuesOptionsAndUri(options: {\n        paginationOptions: PaginatedValuesOptions[],\n        paginationOptionsPerControl?: {\n            [key: string]: PaginatedValuesOptions[]\n        },\n        uri: string\n    }) {\n        const {\n            paginationOptions,\n            paginationOptionsPerControl = {},\n            uri\n        } = options;\n\n        this.inputControlsService.clearCache();\n\n        return this.inputControlsService.getInputControlsPaginatedValues(uri, paginationOptions)\n            .then((response) => {\n                paginationOptions.forEach((controlPaginationOptions) => {\n                    const controlId = controlPaginationOptions.name;\n\n                    if (paginationOptionsPerControl[controlId]) {\n                        this.inputControlsService.setCacheValueForControlPaginatedValues(\n                            uri,\n                            paginationOptionsPerControl[controlId],\n                            response\n                        );\n                    }\n                });\n                return response;\n            });\n    }\n}\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author: afomin, inesterenko\n * @version: $Id$\n */\nimport jQuery from 'jquery';\nimport {JRS} from \"../namespace/namespace\";\nimport _ from 'underscore';\n\nimport './controls.core';\nimport './controls.datatransfer';\nimport './controls.viewmodel';\nimport './controls.components';\n\nimport 'jquery.urldecoder';\n\nimport request from 'js-sdk/src/common/transport/request';\nimport InputControlsService from './rest/InputControlsService';\nimport InputControlsServiceWithCache from './rest/InputControlsServiceWithCache';\nimport InputControlsReportViewerService from './service/InputControlsReportViewerService';\n\nimport { showErrorPopup } from '../core/core.ajax.utils';\n\nimport InputControlTypeEnum from './enum/inputControlTypeEnum';\n\nconst validatePaginatedValuesResponse = (response, controls) => {\n    const controlsData = response && response.inputControlState ? response.inputControlState : [];\n    let areControlsValid = true;\n\n    controlsData.forEach((controlData) => {\n        const control = controls[controlData.id];\n\n        if (control && control.get('error')) {\n            control.set({\n                error: null\n            });\n        }\n\n        if (controlData.error) {\n            control.set({\n                error: controlData.error\n            });\n\n            areControlsValid = false;\n        }\n\n        // singleValueNumber ICs may have a validated value e.g. from \"1.20\" to \"1.2\" that needs to be re-applied\n        if (!controlData.error &&\n            control && InputControlTypeEnum.SINGLE_VALUE_NUMBER === control.type &&\n            controlData.value) {\n\n            control.set({\n                values: [controlData.value]\n            });\n        }\n    });\n\n    return areControlsValid;\n};\n\n;(function(jQuery,_, Controls) {\n\n    //module:\n    //\n    //  controls.controller\n    //\n    //summary:\n    //\n    //  Connect input controls with server\n    //\n    //main types:\n    //\n    //  Controller - provide common functions around input controls, like update, reset, etc.\n    //\n    //dependencies:\n    //\n    //  jQuery          - v1.7.1\n    //  _,              - underscore.js 1.3.1\n    //  Controls        - controls.viewmodel and controls.datatransfer\n\n    return _.extend(Controls, {\n\n        //Provides common operations under input controls\n        Controller : Controls.Base.extend({\n\n            constructor: function(options) {\n                _.bindAll(this,\n                    \"getViewModel\",\n                    \"resetControlsToSelection\",\n                    \"validate\"\n                );\n\n                this.inputControlsService = new InputControlsServiceWithCache({\n                    inputControlsService: new InputControlsService({\n                        request\n                    })\n                });\n\n                this.inputControlsReportViewerService = new InputControlsReportViewerService({\n                    inputControlsService: this.inputControlsService\n                });\n\n                this.viewModel = options && options.viewModel?  options.viewModel : new Controls.ViewModel();\n\n                // Common initialization\n                this.initialize(options);\n\n                Controls.ignore('reportoptions:selection:changed');\n                Controls.listen({\n                    \"viewmodel:selection:changed\": (...args) => {\n                        this._onViewModelSelectionChange(...args);\n                    },\n\n                    \"reportoptions:selection:changed\": (...args) => {\n                        this._onReportOptionsSelectionChanged(...args);\n                    }\n                });\n\n                Controls.getController =_.bind(function () {\n                    return this;\n                }, this);\n\n                // Triggered right after controller is initialized but before\n                // this allows custom code to listen when controls are actually initialized\n                // and override draw method of viewModel\n                var event = new CustomEvent('controls:initialized', {\n                    detail: this.getViewModel()\n                });\n\n                document.dispatchEvent(event);\n            },\n\n            _onViewModelSelectionChange: function(event, selectionChangedControlId, value, inCascade) {\n                const viewModel = this.getViewModel();\n                const controls = viewModel.getControls();\n                if (value && inCascade) {\n                    const dfd = this.inputControlsReportViewerService.fetchInputControlsValuesOnControlSelectionChange({\n                        controlId: selectionChangedControlId,\n                        value,\n                        uri: this.dataUri,\n                        structure: viewModel.structure,\n                        selection: viewModel.get('selection'),\n                        initialSelectedValues: viewModel.controlsOptions.initialSelectedValues\n                    }).then((response, selectionPerControl, paginationOptions) => {\n                        const promises = paginationOptions.map((controlPaginationOptions) => {\n                            const controlId = controlPaginationOptions.name;\n                            controls[controlId].paginatedValuesOptions = paginationOptions;\n                            return selectionChangedControlId !== controlId && controls[controlId].fetch(this.dataUri, paginationOptions);\n                        });\n\n                        return jQuery.when(...promises).then(() => {\n                            return jQuery.Deferred().resolve(selectionPerControl, response);\n                        });\n                    }).then((selectionPerControl, response) => {\n                        selectionPerControl = Object.assign({}, selectionPerControl, {\n                            [selectionChangedControlId]: value\n                        });\n\n                        _.each(selectionPerControl, (values, id) => {\n                            controls[id].set({ values });\n                        });\n\n                        validatePaginatedValuesResponse(response, controls);\n                    }).catch((xhr) => {\n                        const control = controls[selectionChangedControlId];\n\n                        control.set({\n                            values: control.selection\n                        });\n\n                        showErrorPopup(xhr.responseJSON.message);\n\n                        return jQuery.Deferred().reject(xhr);\n                    });\n\n                    Controls.Utils.showLoadingDialogOn(dfd, null, true);\n                }else{\n                    selectionChangedControlId && this.viewModel.controls[selectionChangedControlId].set({'selection':value},true);\n                }\n            },\n\n            _onReportOptionsSelectionChanged: function(event, data) {\n                const {\n                    reportOption,\n                    previousReportOption\n                } = data;\n\n                const viewModel = this.viewModel;\n                const controls = viewModel.getControls();\n\n                this.dataUri = reportOption && reportOption.uri || this.dataUri;\n\n                const dfd = this.inputControlsReportViewerService.fetchInitialInputControlsValuesByUri(\n                    this.dataUri,\n                    viewModel.structure,\n                    data.selectedData\n                ).then((options) => {\n                    const {\n                        selection, paginatedValuesResponse, paginationOptionsPerControl\n                    } = options;\n\n                    const promises = _.map(paginationOptionsPerControl, (controlPaginatedOptions, id) => {\n                        const control = controls[id];\n                        // update initialselectedvalues on report option change\n                        control.updateSelectionOnOptionChange && control.updateSelectionOnOptionChange(selection[id] || [])\n\n                        return control.fetch(this.dataUri, controlPaginatedOptions);\n                    });\n\n                    return jQuery.when(...promises).then(() => {\n                        return jQuery.Deferred().resolve(selection, paginatedValuesResponse);\n                    });\n                }).then((selection, response) => {\n                    _.each(controls,(control,key) =>{\n                        control.set({\n                            values: _.pluck(selection[key], 'value')\n                        })\n                    })\n\n                    validatePaginatedValuesResponse(response, controls);\n                }).catch((xhr) => {\n                    showErrorPopup(xhr.responseJSON.message);\n\n                    Controls.reportOptions.set({\n                        selection: previousReportOption\n                    }, true);\n\n                    return jQuery.Deferred().reject(xhr);\n                });\n\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n            },\n\n            /**\n             * Common initialization method that can be overridden by inherited classes\n             * @param args\n             */\n            initialize : function(options) {\n                this.dataUri = options.reportOptionUri || options.reportUri;\n            },\n\n            fetchReportRawParameterValues: function(executionId) {\n                var dfd = this.inputControlsReportViewerService.fetchReportRawParameterValues(executionId)\n                    .then(values => {\n                        return jQuery.Deferred().resolve(values);\n                    });\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n                return dfd;\n            },\n\n            fetchAndSetInputControlsState: function (allRequestParameters) {\n                var dfd = this.inputControlsReportViewerService.fetchInputControlsInitialState(\n                    this.dataUri, allRequestParameters\n                ).then((options) => {\n                    if(options) {\n                        this.viewModel.set({\n                            structure: options.structure,\n                            controlsOptions: {\n                                dataUri: this.dataUri,\n                                inputControlsService: this.inputControlsService,\n                                initialSelectedValues: options.selection,\n                                paginatedValuesOptions: options.paginationOptionsPerControl,\n                                paginatedValuesResponse: options.paginatedValuesResponse\n                            }\n                        });\n\n                        const viewModel = this.getViewModel();\n                        const controls = viewModel.getControls();\n\n                        validatePaginatedValuesResponse(options.paginatedValuesResponse, controls);\n                    }\n                    return jQuery.Deferred().resolve(options);\n                });\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n                return dfd;\n            },\n\n            //Returns object responsible for initialization and drawing of controls\n            getViewModel:function () {\n                return this.viewModel;\n            },\n\n            //update controls by given selection or by current selection\n            resetControlsToSelection: function(selectedData) {\n                const viewModel = this.getViewModel();\n                const controls = viewModel.getControls();\n\n                if (!selectedData) {\n                    selectedData = viewModel.get(\"selection\");\n                }\n\n                return this.inputControlsReportViewerService.fetchInputControlsOptionsBySelectionAndUri(\n                    selectedData,\n                    this.dataUri,\n                    viewModel.structure\n                ).then((response, paginationOptions, paginationOptionsPerControl) => {\n                    const promises = paginationOptions.map((controlPaginationOptions) => {\n                        const control = controls[controlPaginationOptions.name];\n                        control.clearFilter();\n                        return control.fetch(this.dataUri,\n                            paginationOptionsPerControl[controlPaginationOptions.name] || paginationOptions);\n                    });\n\n                    return jQuery.when(...promises).then(() => {\n                        return response;\n                    });\n                }).then((response) => {\n                    validatePaginatedValuesResponse(response, controls);\n\n                    _.each(controls, (control, id) => {\n                        const value = selectedData[id];\n                        let options;\n\n                        if (value) {\n                            options = {\n                                values: value\n                            };\n                        } else {\n                            options = {\n                                error: null,\n                                values: undefined,\n                                selection: undefined\n                            };\n                        }\n\n                        control.reset(options);\n                    });\n                });\n            },\n\n            //validate controls values and update only invalid controls\n            validate: function() {\n                const viewModel = this.getViewModel();\n                const controls = viewModel.getControls();\n\n                const selectedData = viewModel.get(\"selection\");\n                const dfd = this.inputControlsReportViewerService.fetchInputControlsOptionsBySelectionAndUri(\n                    selectedData,\n                    this.dataUri,\n                    viewModel.structure\n                ).then((response) => {\n                    const areControlsValid = validatePaginatedValuesResponse(response, controls);\n                    return jQuery.Deferred().resolve(areControlsValid);\n                });\n                Controls.Utils.showLoadingDialogOn(dfd, null, true);\n                return dfd;\n            }\n        })\n    });\n})(\n    jQuery,\n    _,\n    JRS.Controls\n);\n\nexport default JRS.Controls;\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n * @author; inesterenko\n * @version: $Id$\n */\nimport {JRS} from \"../namespace/namespace\";\n\nJRS.Log = (function (args) {\n\n    //module:\n    //\n    //  controls.logging\n    //\n    //summary:\n    //\n    //  Safe using of console object even in IE\n    //\n    //main object:\n    //\n    //  console\n    //\n\n\n    if (!window.console) {\n        window.console =   {\n\n            log:function () {\n                //stub\n            },\n\n            debug:function () {\n                //stub\n            },\n            error : function(){\n                //stub\n            }\n        };\n    }\n\n})();\n\nexport default JRS.Log;","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport dialogs from \"../components/components.dialogs\";\nimport {JRS} from \"../namespace/namespace\";\nimport jQuery from 'jquery';\n\nfunction showErrorPopup(errorMessage, options) {\n    if ((errorMessage && errorMessage.indexOf('sessionAttributeMissingException')) > -1) {\n        dialogs.clusterErrorPopup.show(errorMessage);\n    } else {\n        dialogs.errorPopup.show(errorMessage, false, options);\n    }\n}\nfunction baseErrorHandler(ajaxAgent) {\n    //Handling HTTP 500 - Internal server error\n    if (ajaxAgent.status == 500) {\n        showErrorPopup(ajaxAgent.responseText);\n        return true;\n    }\n    var sessionTimeout = ajaxAgent.getResponseHeader('LoginRequested');\n    if (sessionTimeout) {\n        var newloc = '.';\n        document.location = newloc;\n        return true;\n    }\n    var isErrorPage = ajaxAgent.getResponseHeader('JasperServerError');\n    if (isErrorPage) {\n        var suppressError = ajaxAgent.getResponseHeader('SuppressError');\n        if (!suppressError) {\n            // For dashboard frame we should render error message as frame content.\n            var dashboardViewFrame = jQuery('.dashboardViewFrame');\n            if (dashboardViewFrame.length == 1) {\n                jQuery(document.body).html(ajaxAgent.responseText);\n                var iFrame = jQuery('#' + JRS.fid, window.parent.document);\n                iFrame.removeClass('hidden').show();\n            } else {\n                // In other cases we render error message as popup.\n                showErrorPopup(ajaxAgent.responseText);\n            }\n        }\n        return true;\n    }\n    return false;\n}\n\nfunction errorHandler() {}\nfunction showMessageDialog() {}\n\nexport {\n    showErrorPopup,\n    baseErrorHandler,\n    errorHandler,\n    showMessageDialog\n}","export default \"<iframe class='schedulerOverlayIframe'>\\n    <js-templateNonce></js-templateNonce>\\n</iframe>\\n\\n\";","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.\n * Licensed pursuant to commercial TIBCO End User License Agreement.\n */\n\nexport default {\n    SCHEDULER_BACK_URL_STORAGE_NAME: 'tibco-jrs-scheduler-back-url',\n    DASHBOARD_SCHEDULAR_IFRAME_MARGIN: 15,\n    DASHBOARD_SCHEDULAR_IFRAME_Z_INDEX: 9999,\n    SCHEDULER_EMPTY:'',\n    DIALOG_DIMMER_IFRAME_Z_INDEX: 5000\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport $ from 'jquery';\nimport config from 'js-sdk/src/jrs.configs';\nimport _ from 'underscore';\nimport { redirectToUrl } from \"../../util/utils.common\";\nimport xssUtil from 'js-sdk/src/common/util/xssUtil';\nimport schedulerOverlayIframeTemplate from \"../template/schedulerOverlayIframeTemplate.htm\";\nimport schedulerConstants from './schedulerConstants';\nimport i18n from '../../i18n/all.properties';\n\nexport default {\n    el: $(_.template(schedulerOverlayIframeTemplate, {i18n: i18n})),\n    SCHEDULER_BACK_URL_STORAGE_NAME: schedulerConstants.SCHEDULER_BACK_URL_STORAGE_NAME,\n    getParamsFromUri: function () {\n        var params = {};    // first, let's parse normal query parameters\n        // first, let's parse normal query parameters\n        var parts = document.location.search.substr(1).split('&');\n        _.each(parts, function (part) {\n            var tmp = part.split('='), key = tmp[0], value = tmp[1];\n            if (value === '') {\n                return;\n            }\n            params[key] = decodeURIComponent(value);\n        });    /// then, let's parse hash\n        /// then, let's parse hash\n        var hash = document.location.hash.substr(1);    // get rid of \"runInBackground@\" mark in document.location.hash\n        // get rid of \"runInBackground@\" mark in document.location.hash\n        if (hash.indexOf('runInBackground@') === 0) {\n            hash = hash.replace('runInBackground@', '');\n        }\n        var hashParts = hash.split('@@');\n        params['reportUri'] = hashParts.shift();    // get first element from array\n        // get first element from array\n        _.each(hashParts, function (part) {\n            var tmp = part.split('='), key = tmp[0], value = tmp[1];\n            if (value === '') {\n                return;\n            }\n            params[key] = decodeURIComponent(value);\n        });\n        return params;\n    },\n    saveCurrentLocation: function () {\n        if (document.referrer.indexOf('login.html') === -1) {\n            window.localStorage && localStorage.setItem(this.SCHEDULER_BACK_URL_STORAGE_NAME, encodeURIComponent(document.referrer));\n        }\n    },\n    getBackToPreviousLocation: function () {\n        var currentUrl = encodeURIComponent(document.location.href);\n        var lastUrl = window.localStorage ? localStorage.getItem(this.SCHEDULER_BACK_URL_STORAGE_NAME) : '';\n        if (lastUrl && lastUrl !== currentUrl) {\n            var url = decodeURIComponent(lastUrl);\n            if (url) {\n                redirectToUrl(url);\n                return;\n            }\n        }    // in bad scenario, we need to get to the standard URL\n        // in bad scenario, we need to get to the standard URL\n        redirectToUrl(config.contextPath + '/flow.html?_flowId=searchFlow');\n    },\n    _scheduleDashboard: function _scheduleDashboard(paramsMap, schedulerPageUrl) {\n        _.bindAll(this, '_onWindowResize');\n        $(window).on('resize', this._onWindowResize);\n\n        let url = this._getIframeUrl(paramsMap, schedulerPageUrl);\n\n        if (schedulerPageUrl) {\n            let body = $('body'),\n                bannerHeight = $(\"body\").find(\"> #banner\").outerHeight(true) || 0;\n\n            this._addDimmer();\n            this.el.attr('src', url).css({\n                'width': '100%',\n                'height':body.find('> #frame').height() - bannerHeight,\n                'z-index': schedulerConstants.DASHBOARD_SCHEDULAR_IFRAME_Z_INDEX,\n                'position': 'absolute',\n                'top': bannerHeight * 2 + 'px'\n            }).show();\n            body.append(this.el);\n        }\n    },\n\n    _getIframeUrl: function (paramsMap, schedulerPageUrl) {\n\n        const encode = true;\n        const encodeParams = this._serializeParams(paramsMap, encode) ? '?' + this._serializeParams(paramsMap, encode) : '';\n        const link = config.contextPath + schedulerPageUrl;\n\n        const url = link + ($.isEmptyObject(paramsMap) ? '' : encodeParams);\n\n        return xssUtil.softHtmlEscape(url);\n    },\n\n    _serializeParams: function _serializeParams(paramsMap, encode) {\n        let result = schedulerConstants.SCHEDULER_EMPTY;\n\n        for (let name in paramsMap) {\n            if (!Object.isUndefined(name)) {\n                result += '&' + name + '=' + (encode ? encodeURIComponent(paramsMap[name]) : paramsMap[name]);\n            }\n        }\n        result = result !== schedulerConstants.SCHEDULER_EMPTY ? result.substring(1) : schedulerConstants.SCHEDULER_EMPTY;\n        return result;\n    },\n    _ParamMapping: function _ParamMapping(paramsMap) {\n        this._scheduleDashboard(paramsMap, '/scheduler/main.html');\n    },\n    _closeScheduleOverlay: function _closeScheduleOverlay() {\n        $('.schedulerAccelerator').slideUp('slow',function () {\n            window.parent.document.getElementsByClassName(\"schedulerOverlayIframe\")[0].hide();\n            window.parent.document.getElementById(\"dialogDimmer\").hide();\n        })\n    },\n    _addDimmer: function () {\n        if (!$('#dialogDimmer').length) {\n            this.$dimmer = $('<div id=\\'dialogDimmer\\' class=\\'dimmer hidden\\' style=\\'z-index:' + schedulerConstants.DIALOG_DIMMER_IFRAME_Z_INDEX + '; display: none;\\'></div>');\n            $('body').append(this.$dimmer);\n        } else {\n            !this.$dimmer && (this.$dimmer = $('#dialogDimmer'));\n        }\n        this.$dimmer.removeClass('hidden').show();\n    },\n    _onWindowResize: function () {\n        let body = $('body'),\n            bannerHeight = $(\"body\").find(\"> #banner\").outerHeight(true) || 0;\n        this.resizeTimer && clearTimeout(this.resizeTimer);\n        this.resizeTimer = setTimeout(_.bind(function () {\n            this.el && this.el.height(body.find('> #frame').height() - bannerHeight);\n            this.el && this.el.width(body.width());\n        }, this), 100);\n    },\n    _detachEvents: function () {\n        $(window).off('resize', this._onWindowResize);\n        this.el.css('display','none');\n    }\n};\n","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nimport Dialog from './Dialog';\nimport confirmDialogTemplate from './template/confirmDialogTemplate.htm';\nimport i18n from '../../../i18n/CommonBundle.properties';\nexport default Dialog.extend({\n    constructor: function (options) {\n        options || (options = {});\n        this.confirmDialogTemplate = options.confirmDialogTemplate || _.template(confirmDialogTemplate);\n        Dialog.prototype.constructor.call(this, {\n            modal: true,\n            additionalCssClasses: options.additionalCssClasses || 'confirmationDialog',\n            title: options.title || i18n['dialog.confirm.title'],\n            content: this.confirmDialogTemplate({ text: options.text }),\n            buttons: options.buttons || [\n                {\n                    label: options.yesLabel || i18n['button.yes'],\n                    action: 'yes',\n                    primary: true\n                },\n                {\n                    label: options.noLabel || i18n['button.no'],\n                    action: 'no',\n                    primary: false\n                }\n            ]\n        });\n    },\n    initialize: function () {\n        Dialog.prototype.initialize.apply(this, arguments);\n        this.on('button:yes', this.close);\n        this.on('button:no', this.close);\n    },\n    setContent: function (content) {\n        Dialog.prototype.setContent.call(this, this.confirmDialogTemplate({ text: content }));\n    }\n});","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport _ from 'underscore';\nvar scrollbarWidth = 0;\nexport default {\n    getScrollbarWidth: function () {\n        if (scrollbarWidth) {\n            return scrollbarWidth;\n        }\n        var scrollDiv = document.createElement('div');\n        scrollDiv.style.width = '100px';\n        scrollDiv.style.height = '100px';\n        scrollDiv.style.overflow = 'scroll';\n        scrollDiv.style.position = 'absolute';\n        scrollDiv.style.top = '-9999px';\n        document.body.appendChild(scrollDiv);\n        scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;\n        document.body.removeChild(scrollDiv);\n        return scrollbarWidth;\n    },\n    hasScrollBar: function (el, direction) {\n        direction = direction === 'vertical' ? 'scrollTop' : 'scrollLeft';\n        var result = !!el[direction];\n        if (!result) {\n            el[direction] = 1;\n            result = !!el[direction];\n            el[direction] = 0;\n        }\n        return result;\n    },\n    isScrollable: function (el) {\n        var style = window.getComputedStyle ? window.getComputedStyle(el) : el.currentStyle;\n        if (!style) {\n            return;\n        }\n        return style.overflow == 'scroll' || style.overflow == 'auto' || style.overflowX == 'scroll' || style.overflowX == 'auto' || style.overflowY == 'scroll' || style.overflowY == 'auto';\n    },\n    getElementOffset: function (el) {\n        var left = 0, top = 0;\n        if (el.offsetParent) {\n            left = el.offsetLeft;\n            top = el.offsetTop;\n            while (el = el.offsetParent) { // jshint ignore: line\n                left += el.offsetLeft;\n                top += el.offsetTop;\n            }\n        }\n        return {\n            left: left,\n            top: top\n        };\n    },\n    getMargins: function ($element) {\n        var values = {\n            top: parseInt($element.css('margin-top'), 10),\n            right: parseInt($element.css('margin-right'), 10),\n            bottom: parseInt($element.css('margin-bottom'), 10),\n            left: parseInt($element.css('margin-left'), 10)\n        };\n        _.each(values, function (ignore, key) {\n            if (isNaN(values[key])) {\n                values[key] = 0;\n            }\n        });\n        return values;\n    },\n    getPaddings: function ($element) {\n        var values = {\n            top: parseInt($element.css('padding-top'), 10),\n            right: parseInt($element.css('padding-right'), 10),\n            bottom: parseInt($element.css('padding-bottom'), 10),\n            left: parseInt($element.css('padding-left'), 10)\n        };\n        _.each(values, function (ignore, key) {\n            if (isNaN(values[key])) {\n                values[key] = 0;\n            }\n        });\n        return values;\n    },\n    disableBackForwordCache: function () {\n        window.onpageshow = function () {\n            if (event.persisted) {\n                window.location.reload();\n            }\n        };\n    }\n};","/*\n * Copyright (C) 2005 - 2022 TIBCO Software Inc. All rights reserved.\n * http://www.jaspersoft.com.\n *\n * Unless you have purchased a commercial license agreement from Jaspersoft,\n * the following license terms apply:\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n/**\n* @author: Igor Nesterenko\n* @version: $Id$\n*/\n\nimport Backbone from 'backbone';\nimport $ from 'jquery';\nimport _ from 'underscore';\nimport popupContainerTemplate from './template/dateTimePopupContainer.htm';\n\nimport logger from \"../../common/logging/logger\";\n\nimport \"../../common/extension/jQueryTimepickerExtension\";\n\nvar DATE_TIME_DEFAULTS = {\n        stepHour: 1,\n        stepMinute: 1,\n        stepSecond: 1,\n        showSecond: true,\n        changeMonth: true,\n        changeYear: true,\n        showButtonPanel: true,\n        onChangeMonthYear: null,\n        constrainInput: false\n    },\n    TIME_DEFAULTS = {\n        showSecond:true,\n        constrainInput:false\n    };\n\nlet log = logger.register(\"DateAndTimePicker\");\n\n$.timepicker.log = function (err) {\n    //redirect error messages to our logger\n    log.warn(err);\n};\n\nexport default Backbone.View.extend({\n\n    /**\n     * @constructor DateAndTimePicker\n     * @class DateAndTimePicker\n     * @classdesc DateAndTimePicker decorator over jQuery datetime pickers\n     * @extends Backbone.View\n     * @param {object} options - mixin on Backbone standard properties and jQuery datetime pickers\n     * @description - You have to pass 'el' property to point to element in DOM. We have next behaviour\n     *  - by default it renders with  datetimepicker\n     *  - if only `dateFormat` it renders with datepicker\n     *  - if only `timeFormat` it renders with  timepicker\n     *  - if `dateFormat` and `timeFormat` specified it renders with datetimepicker\n     */\n\n    constructor: function (options) {\n        this.pickerOptions = _.clone(options);\n\n        if (this.pickerOptions.hasOwnProperty(\"dateFormat\") && !_.isString(this.pickerOptions.dateFormat)) {\n            delete this.pickerOptions.dateFormat;\n        }\n        if (this.pickerOptions.hasOwnProperty(\"timeFormat\") && !_.isString(this.pickerOptions.timeFormat)) {\n            delete this.pickerOptions.timeFormat;\n        }\n\n        this.inline = !!this.pickerOptions.el || false;\n        this.skipMoving = this.pickerOptions.skipMoving || false;\n        //clean up from backbone props\n        delete this.pickerOptions.el;\n        delete this.pickerOptions.skipMoving;\n\n        this.pickerType = discoverPickerType(this.pickerOptions);\n\n        this.pickerOptions = provideDefaultPickerOptions(this.pickerOptions, this.pickerType);\n\n        this.pickerOptions = fixPopupPositionAndStyling(this.pickerOptions, this.skipMoving);\n\n        this.log = options.log ? options.log : log;\n\n        Backbone.View.apply(this, arguments);\n    },\n\n    initialize: function () {\n        var self = this;\n\n        //initialize picker\n        this.$el[this.pickerType](this.pickerOptions);\n\n        this._callPickerAction = function (options) {\n            self.$el[self.pickerType](options);\n        }\n    },\n\n    /**\n     * @return {Date} - standart date object\n     * @description Return Date if components has it\n     */\n\n    getDate: function(){\n        var date;\n\n        if (this.pickerType !== \"timepicker\"){\n            date = this.$el[this.pickerType].getDate();\n        }else{\n            date = this.$el[this.pickerType].getTime();\n        }\n        return date;\n    },\n\n    /**\n     * @params {Date|String} date\n     * @return this\n     */\n\n    setDate: function(date){\n\n        if (!date) return this;\n\n        try{\n            //try to convert string to date object\n            // we don't need to convert time because setTime method accepts string time format\n            if (_.isString(date)){\n                if (this.pickerType === \"datetimepicker\") {\n                    date = $.datepicker.parseDateTime(this.pickerOptions.dateFormat, this.pickerOptions.timeFormat,  date);\n                } else if (this.pickerType === \"datepicker\") {\n                    date = $.datepicker.parseDate(this.pickerOptions.dateFormat, date);\n                }\n            }\n\n            if (this.pickerType === \"datepicker\"){\n                this.$el[this.pickerType](\"setDate\", date);\n            }else if (this.pickerType === \"timepicker\") {\n                this.$el[this.pickerType](\"setTime\", date);\n            }else if (this.pickerType === \"datetimepicker\"){\n                this.$el[this.pickerType](\"setTime\", date);\n                this.$el[this.pickerType](\"setDate\", date);\n            }\n\n        }catch(err){\n            this.log.debug(err);\n        }\n        return this;\n    },\n\n    /**\n     * @description Show picker\n     */\n\n    show: function () {\n        this._callPickerAction(\"show\");\n        return this;\n    },\n\n    /**\n     * @description Hide picker\n     */\n\n    hide: function () {\n        this._callPickerAction(\"hide\");\n        return this;\n    },\n\n    remove: function () {\n        this._callPickerAction(\"destroy\");\n        if (this.inline) {\n            this.$el.empty().off();\n            this.stopListening();\n        } else {\n            Backbone.View.prototype.remove.apply(this, arguments);\n        }\n\n    }\n\n}, {\n\n    /**\n     * @param {object} configs - which should contains 'locale', configs for 'date' amd configs for 'time'\n     * @description Provide defaults for locale specific configuration\n     */\n\n    setDefaults : function(configs){\n        $.datepicker.regional[configs.locale] = configs.date;\n        $.datepicker.setDefaults(configs.date);\n        $.timepicker.setDefaults(configs.time);\n    },\n\n    Helpers : {\n\n        fixPopupPositionAndStyling: fixPopupPositionAndStyling,\n\n        movePickerRelativelyToTriggerIcon: movePickerRelativelyToTriggerIcon,\n\n        stylePopupContainer: stylePopupContainer,\n\n        discoverPickerType: discoverPickerType,\n\n        provideDefaultPickerOptions: provideDefaultPickerOptions\n    }\n});\n\nfunction discoverPickerType(options) {\n    var result = \"datetimepicker\";\n    if (options.dateFormat && options.timeFormat) {\n        return result;\n    } else if (options.dateFormat) {\n        result = \"datepicker\"\n    } else if (options.timeFormat) {\n        result = \"timepicker\"\n    }\n    return result;\n}\n\nfunction provideDefaultPickerOptions(options, type){\n\n    var result = options;\n\n    if (\"datetimepicker\" == type || \"datepicker\" == type){\n        result = _.defaults(options, DATE_TIME_DEFAULTS);\n    }else if(\"timepicker\" == type){\n        result = _.defaults(options, TIME_DEFAULTS)\n    }\n\n    return result;\n}\n\nfunction fixPopupPositionAndStyling(options, skipMoving) {\n\n    var originalBeforeShowFn = options.beforeShow;\n\n    options.beforeShow = function () {\n        stylePopupContainer.apply(this, arguments);\n        skipMoving || movePickerRelativelyToTriggerIcon.apply(this, arguments);\n        originalBeforeShowFn && originalBeforeShowFn.apply(this, arguments);\n    };\n\n    options.afterInject = function() {\n        stylePopupContainer.apply(this, [this.$input[0], this.inst]);\n    };\n\n    return options;\n}\n\nfunction movePickerRelativelyToTriggerIcon(input, inst) {\n    var offset = $(input).offset().left;\n    var width = parseFloat(inst.dpDiv.css(\"width\").replace(\"px\", \"\"));\n    var move = offset + input.offsetWidth + width < $(window).width();\n    inst.dpDiv.css({\n        marginLeft: move ? input.offsetWidth + \"px\" : 0\n    });\n}\n\nfunction stylePopupContainer(input, inst) {\n    var $popupContainer = inst.dpDiv,\n        $parent = $popupContainer.parent(),\n        $dpDiv;\n\n    if ($parent && $parent.is('body')) {\n        $dpDiv = $popupContainer.detach();\n        $popupContainer = $(popupContainerTemplate);\n        $popupContainer.append($dpDiv);\n        $('body').append($popupContainer);\n    }\n}\n","export default \"<div class=\\\"jr-jDatepickerPopupContainer jr\\\">\\n\\n    <js-templateNonce></js-templateNonce>\\n</div>\\n\";","export default \"<p class='confirmationText'>\\n\\n    <js-templateNonce></js-templateNonce>\\n    {{ print(_.xssSoftEscape(text)) }}\\n</p>\";","\n        import {store, MERGED_BUNDLES_NAME} from 'bundleStore';\n        \n        let bundle;\n        \n        if ('all' !== MERGED_BUNDLES_NAME) {\n            store['all'] = store['all'] || {};\n            bundle = store['all'];\n        } else {\n            bundle = Object.keys(store).reduce((acc, key) => {\n                return {\n                    ...acc,\n                    ...store[key]\n                }\n            }, {});\n        }\n                                     \n        export default bundle;\n    "],"sourceRoot":""}